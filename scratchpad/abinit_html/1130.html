<html><head><title>variables_abinit.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" type="text/css" href="sourcestyles.css" />
</head><body link="blue" vlink="blue">
<h3>File: /Users/rkrsn/vcs/se4sci/data-collection/scratchpad/sources/abinit/abimkdocs/variables_abinit.py</h3>
<SCRIPT>
defaultStatus = "File: /Users/rkrsn/vcs/se4sci/data-collection/scratchpad/sources/abinit/abimkdocs/variables_abinit.py";
top.document.title  = "variables_abinit.py";
</SCRIPT>
<pre><span class="default"></span><a name="1"><font size=-1>1     </font></a><span class="default"></span><span class="comment"># coding: utf-8</span>
<a name="2"><font size=-1>2     </font></a><span class="comment"></span><span class="keyword">from </span><span class="default">__future__ </span><span class="keyword">import </span><span class="default">print_function, division, unicode_literals, absolute_import</span>
<a name="3"><font size=-1>3     </font></a><span class="default"></span>
<a name="4"><font size=-1>4     </font></a><span class="default"><a href="dictionary_A.html#51105">executable</a> = </span><span class="string">&quot;abinit&quot;</span>
<a name="5"><font size=-1>5     </font></a><span class="string"></span>
<a name="6"><font size=-1>6     </font></a><span class="string"></span><span class="keyword">from <a href="dictionary_A.html#27783">abimkdocs</a></span><span class="default">.variables </span><span class="keyword">import <a href="dictionary_A.html#9325">ValueWithUnit</a></span><span class="default">, <a href="dictionary_A.html#6402">MultipleValue</a>, <a href="dictionary_A.html#7747">Range</a>, <a href="dictionary_A.html#9320">ValueWithConditions</a></span>
<a name="7"><font size=-1>7     </font></a><span class="default"></span>
<a name="8"><font size=-1>8     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>=dict</span>
<a name="9"><font size=-1>9     </font></a><span class="default"><a href="dictionary_A.html#133591">variables</a> = [</span>
<a name="10"><font size=-1>10     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11"><font size=-1>11     </font></a><span class="default">    abivarname=</span><span class="string">&quot;accuracy&quot;</span><span class="default">,</span>
<a name="12"><font size=-1>12     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="13"><font size=-1>13     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14"><font size=-1>14     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_basic'</span><span class="default">, </span><span class="string">'SCFControl_basic'</span><span class="default">],</span>
<a name="15"><font size=-1>15     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16"><font size=-1>16     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17"><font size=-1>17     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ACCURACY&quot;</span><span class="default">,</span>
<a name="18"><font size=-1>18     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="19"><font size=-1>19     </font></a><span class="string">Allows to tune the accuracy of a calculation by setting automatically the</span>
<a name="20"><font size=-1>20     </font></a><span class="string">variables according to the following table:</span>
<a name="21"><font size=-1>21     </font></a><span class="string"></span>
<a name="22"><font size=-1>22     </font></a><span class="string">accuracy         | 1         | 2          | 3            | 4            | 5         | 6</span>
<a name="23"><font size=-1>23     </font></a><span class="string">---              |---        |---         |---           |---           |---        |---</span>
<a name="24"><font size=-1>24     </font></a><span class="string">[[ecut]]         | E_min     | E_med      | E_med        | E_max        | E_max     | E_max</span>
<a name="25"><font size=-1>25     </font></a><span class="string">[[pawecutdg]]    | ecut      | ecut       | 1.2 * ecut   | 1.5 * ecut   | 2 * ecut  | 2 * ecut</span>
<a name="26"><font size=-1>26     </font></a><span class="string">[[fband]]        | 0.5       | 0.5        | 0.5          | 0.5          | 0.75      | 0.75</span>
<a name="27"><font size=-1>27     </font></a><span class="string">[[boxcutmin]]    | 1.5       | 1.8        | 1.8          | 2.0          | 2.0       | 2.0</span>
<a name="28"><font size=-1>28     </font></a><span class="string">[[bxctmindg]]    | 1.5       | 1.8        | 1.8          | 2.0          | 2.0       | 2.0</span>
<a name="29"><font size=-1>29     </font></a><span class="string">[[pawxcdev]]     | 1         | 1          | 1            | 1            | 2         | 2</span>
<a name="30"><font size=-1>30     </font></a><span class="string">[[pawmixdg]]     | 0         | 0          | 0            | 0            | 1         | 1</span>
<a name="31"><font size=-1>31     </font></a><span class="string">[[pawovlp]]      | 10        | 7          | 7            | 5            | 5         | 5</span>
<a name="32"><font size=-1>32     </font></a><span class="string">[[pawnhatxc]]    | 0         | 1          | 1            | 1            | 1         | 1</span>
<a name="33"><font size=-1>33     </font></a><span class="string">[[tolvrs]]       | 1.0d-3    | 1.0d-5     | 1.0d-7       | 1.0d-9       | 1.0d-10   | 1.0d-12</span>
<a name="34"><font size=-1>34     </font></a><span class="string">[[tolmxf]]       | 1.0d-3    | 5.0d-4     | 1.0d-4       | 5.0d-5       | 1.0d-6    | 1.0d-6</span>
<a name="35"><font size=-1>35     </font></a><span class="string">[[optforces]]    | 1         | 1          | 2            | 2            | 2         | 2</span>
<a name="36"><font size=-1>36     </font></a><span class="string">[[timopt]]       | 0         | 0          | 1            | 1            | 1         | 1</span>
<a name="37"><font size=-1>37     </font></a><span class="string">[[npulayit]]     | 4         | 7          | 7            | 7            | 15        | 15</span>
<a name="38"><font size=-1>38     </font></a><span class="string">[[nstep]]        | 30        | 30         | 30           | 30           | 50        | 50</span>
<a name="39"><font size=-1>39     </font></a><span class="string">[[prteig]]       | 0         | 0          | 1            | 1            | 1         | 1</span>
<a name="40"><font size=-1>40     </font></a><span class="string">[[prtden]]       | 0         | 0          | 1            | 1            | 1         | 1</span>
<a name="41"><font size=-1>41     </font></a><span class="string"></span>
<a name="42"><font size=-1>42     </font></a><span class="string"></span>
<a name="43"><font size=-1>43     </font></a><span class="string">[[accuracy]] = 4 corresponds to the default tuning of ABINIT. It is already a very accurate tuning.</span>
<a name="44"><font size=-1>44     </font></a><span class="string">For a parallel calculation, [[timopt]] is enforced to be 0.</span>
<a name="45"><font size=-1>45     </font></a><span class="string">E_min, E_med and E_max may be read from the pseudopotential file (available</span>
<a name="46"><font size=-1>46     </font></a><span class="string">only for XML PAW atomic data files). If E_min, E_med and E_max are not given</span>
<a name="47"><font size=-1>47     </font></a><span class="string">in the pseudopotential file, [[ecut]] must be given in the input file and E_max=E_med=E_max=ecut.</span>
<a name="48"><font size=-1>48     </font></a><span class="string">If the user wants to modify one of the input variable automatically tuned by [[accuracy]],</span>
<a name="49"><font size=-1>49     </font></a><span class="string">they must put it in the input file. The other input variables automatically tuned</span>
<a name="50"><font size=-1>50     </font></a><span class="string">by [[accuracy]] will not be affected.</span>
<a name="51"><font size=-1>51     </font></a><span class="string">[[accuracy]] = 0 means that this input variable is deactivated.</span>
<a name="52"><font size=-1>52     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="53"><font size=-1>53     </font></a><span class="default">),</span>
<a name="54"><font size=-1>54     </font></a><span class="default"></span>
<a name="55"><font size=-1>55     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="56"><font size=-1>56     </font></a><span class="default">    abivarname=</span><span class="string">&quot;acell&quot;</span><span class="default">,</span>
<a name="57"><font size=-1>57     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="58"><font size=-1>58     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="59"><font size=-1>59     </font></a><span class="default">    topics=[</span><span class="string">'UnitCell_basic'</span><span class="default">],</span>
<a name="60"><font size=-1>60     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="61"><font size=-1>61     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">1</span><span class="default">),</span>
<a name="62"><font size=-1>62     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CELL lattice vector scaling&quot;</span><span class="default">,</span>
<a name="63"><font size=-1>63     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">, </span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="64"><font size=-1>64     </font></a><span class="default">    commentdims=</span><span class="string">&quot;represented internally as acell(3,[[nimage]])&quot;</span><span class="default">,</span>
<a name="65"><font size=-1>65     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="66"><font size=-1>66     </font></a><span class="string">Gives the length scales by which dimensionless primitive translations (in</span>
<a name="67"><font size=-1>67     </font></a><span class="string">[[rprim]]) are to be multiplied. By default, given in Bohr atomic units (1</span>
<a name="68"><font size=-1>68     </font></a><span class="string">Bohr=0.5291772108 Angstroms), although Angstrom can be specified, if</span>
<a name="69"><font size=-1>69     </font></a><span class="string">preferred, since [[acell]] has the '[[LENGTH]]' characteristics. See further</span>
<a name="70"><font size=-1>70     </font></a><span class="string">description of [[acell]] related to the [[rprim]] input variable, the</span>
<a name="71"><font size=-1>71     </font></a><span class="string">[[scalecart]] input variable, and the associated internal [[rprimd]] input</span>
<a name="72"><font size=-1>72     </font></a><span class="string">variable.</span>
<a name="73"><font size=-1>73     </font></a><span class="string"></span>
<a name="74"><font size=-1>74     </font></a><span class="string">Note that [[acell]] is NOT the length of the conventional orthogonal basis</span>
<a name="75"><font size=-1>75     </font></a><span class="string">vectors, but the scaling factors of the primitive vectors. Use [[scalecart]]</span>
<a name="76"><font size=-1>76     </font></a><span class="string">to scale the cartesian coordinates.</span>
<a name="77"><font size=-1>77     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="78"><font size=-1>78     </font></a><span class="default">),</span>
<a name="79"><font size=-1>79     </font></a><span class="default"></span>
<a name="80"><font size=-1>80     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="81"><font size=-1>81     </font></a><span class="default">    abivarname=</span><span class="string">&quot;adpimd&quot;</span><span class="default">,</span>
<a name="82"><font size=-1>82     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="83"><font size=-1>83     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="84"><font size=-1>84     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_expert'</span><span class="default">],</span>
<a name="85"><font size=-1>85     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="86"><font size=-1>86     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="87"><font size=-1>87     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ADiabatic Path-Integral Molecular Dynamics&quot;</span><span class="default">,</span>
<a name="88"><font size=-1>88     </font></a><span class="default">    requires=</span><span class="string">&quot;[[imgmov]] == 9 or [[imgmov]] == 13&quot;</span><span class="default">,</span>
<a name="89"><font size=-1>89     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="90"><font size=-1>90     </font></a><span class="string">Controls whether adiabatic Path-Integral Molecular Dynamics is performed or not.</span>
<a name="91"><font size=-1>91     </font></a><span class="string">The corresponding adiabaticity parameter is given by [[adpimd_gamma]].</span>
<a name="92"><font size=-1>92     </font></a><span class="string"></span>
<a name="93"><font size=-1>93     </font></a><span class="string">If equal to 0, no adiabatic Path-Integral Molecular Dynamics (standard PIMD) is performed.</span>
<a name="94"><font size=-1>94     </font></a><span class="string">If equal to 1, adiabatic Path-Integral Molecular Dynamics is activated.</span>
<a name="95"><font size=-1>95     </font></a><span class="string">Only relevant with [[pitransform]] = 1 (normal mode transformation). In that case,</span>
<a name="96"><font size=-1>96     </font></a><span class="string">- the mass associated with the zero-frequency mode is the true mass [[amu]],</span>
<a name="97"><font size=-1>97     </font></a><span class="string">- the mass associated to the other higher frequency modes of the polymer</span>
<a name="98"><font size=-1>98     </font></a><span class="string">chains is equal to the normal mode mass divided by [[adpimd_gamma]] (adiabaticity parameter),</span>
<a name="99"><font size=-1>99     </font></a><span class="string">- the equation of motion on the zero-frequency mode is not thermostated.</span>
<a name="100"><font size=-1>100     </font></a><span class="string">NOT YET USABLE</span>
<a name="101"><font size=-1>101     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="102"><font size=-1>102     </font></a><span class="default">),</span>
<a name="103"><font size=-1>103     </font></a><span class="default"></span>
<a name="104"><font size=-1>104     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="105"><font size=-1>105     </font></a><span class="default">    abivarname=</span><span class="string">&quot;adpimd_gamma&quot;</span><span class="default">,</span>
<a name="106"><font size=-1>106     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="107"><font size=-1>107     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="108"><font size=-1>108     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_expert'</span><span class="default">],</span>
<a name="109"><font size=-1>109     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="110"><font size=-1>110     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="111"><font size=-1>111     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ADiabatic Path-Integral Molecular Dynamics: GAMMA factor&quot;</span><span class="default">,</span>
<a name="112"><font size=-1>112     </font></a><span class="default">    requires=</span><span class="string">&quot;[[adpimd]] == 1 and [[imgmov]] in [9,13]&quot;</span><span class="default">,</span>
<a name="113"><font size=-1>113     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="114"><font size=-1>114     </font></a><span class="string">Adiabaticity parameter to be used in adiabatic Path-Integral Molecular Dynamics.</span>
<a name="115"><font size=-1>115     </font></a><span class="string">NOT YET USABLE</span>
<a name="116"><font size=-1>116     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="117"><font size=-1>117     </font></a><span class="default">),</span>
<a name="118"><font size=-1>118     </font></a><span class="default"></span>
<a name="119"><font size=-1>119     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="120"><font size=-1>120     </font></a><span class="default">    abivarname=</span><span class="string">&quot;algalch&quot;</span><span class="default">,</span>
<a name="121"><font size=-1>121     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="122"><font size=-1>122     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="123"><font size=-1>123     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_expert'</span><span class="default">],</span>
<a name="124"><font size=-1>124     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypalch]]'</span><span class="default">],</span>
<a name="125"><font size=-1>125     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="string">'[[ntypalch]]'</span><span class="default">, value=</span><span class="number">1</span><span class="default">),</span>
<a name="126"><font size=-1>126     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ALGorithm for generating ALCHemical pseudopotentials&quot;</span><span class="default">,</span>
<a name="127"><font size=-1>127     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="128"><font size=-1>128     </font></a><span class="string">Used for the generation of alchemical pseudopotentials, that is, when</span>
<a name="129"><font size=-1>129     </font></a><span class="string">[[ntypalch]] is non-zero.</span>
<a name="130"><font size=-1>130     </font></a><span class="string"></span>
<a name="131"><font size=-1>131     </font></a><span class="string">Give the algorithm to be used to generate the [[ntypalch]] alchemical</span>
<a name="132"><font size=-1>132     </font></a><span class="string">potentials from the different [[npspalch]] pseudopotentials dedicated to this use.</span>
<a name="133"><font size=-1>133     </font></a><span class="string"></span>
<a name="134"><font size=-1>134     </font></a><span class="string">Presently, [[algalch]] can only have the value 1, that is:</span>
<a name="135"><font size=-1>135     </font></a><span class="string"></span>
<a name="136"><font size=-1>136     </font></a><span class="string">  * the local potentials are mixed, thanks to the [[mixalch]] mixing coefficients</span>
<a name="137"><font size=-1>137     </font></a><span class="string">  * the form factors of the non-local projectors are all preserved,</span>
<a name="138"><font size=-1>138     </font></a><span class="string">    and all considered to generate the alchemical potential</span>
<a name="139"><font size=-1>139     </font></a><span class="string">  * the scalar coefficients of the non-local projectors are multiplied by the</span>
<a name="140"><font size=-1>140     </font></a><span class="string">    proportion of the corresponding type of atom that is present in [[mixalch]]</span>
<a name="141"><font size=-1>141     </font></a><span class="string">  * the characteristic radius for the core charge is a linear combination of the characteristic radii</span>
<a name="142"><font size=-1>142     </font></a><span class="string">    of the core charges, build with the [[mixalch]] mixing coefficients</span>
<a name="143"><font size=-1>143     </font></a><span class="string">  * the core charge function $f(r/r_c)$ is a linear combination of the core charge functions,</span>
<a name="144"><font size=-1>144     </font></a><span class="string">    build with the [[mixalch]] mixing coefficients</span>
<a name="145"><font size=-1>145     </font></a><span class="string"></span>
<a name="146"><font size=-1>146     </font></a><span class="string">Later, other algorithms for the mixing might be included.</span>
<a name="147"><font size=-1>147     </font></a><span class="string"></span>
<a name="148"><font size=-1>148     </font></a><span class="string">!!! important</span>
<a name="149"><font size=-1>149     </font></a><span class="string"></span>
<a name="150"><font size=-1>150     </font></a><span class="string">    Note that alchemical mixing cannot be used with PAW.</span>
<a name="151"><font size=-1>151     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="152"><font size=-1>152     </font></a><span class="default">),</span>
<a name="153"><font size=-1>153     </font></a><span class="default"></span>
<a name="154"><font size=-1>154     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="155"><font size=-1>155     </font></a><span class="default">    abivarname=</span><span class="string">&quot;amu&quot;</span><span class="default">,</span>
<a name="156"><font size=-1>156     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="157"><font size=-1>157     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="158"><font size=-1>158     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_useful'</span><span class="default">, </span><span class="string">'Phonons_useful'</span><span class="default">, </span><span class="string">'AtomTypes_basic'</span><span class="default">, </span><span class="string">'Artificial_basic'</span><span class="default">],</span>
<a name="159"><font size=-1>159     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="160"><font size=-1>160     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Atomic Mass Units&quot;</span><span class="default">,</span>
<a name="161"><font size=-1>161     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="162"><font size=-1>162     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;provided by a database of atomic masses.&quot;</span><span class="default">,</span>
<a name="163"><font size=-1>163     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="164"><font size=-1>164     </font></a><span class="string">Gives the masses in atomic mass units for each kind of atom in the input cell. These</span>
<a name="165"><font size=-1>165     </font></a><span class="string">masses are used in performing molecular dynamical atomic motion if</span>
<a name="166"><font size=-1>166     </font></a><span class="string">[[ionmov]] = 1, 6, 7 or 8. They are also used in phonon calculations during the</span>
<a name="167"><font size=-1>167     </font></a><span class="string">diagonalization of the dynamical matrix. Note that one may set all masses to 1</span>
<a name="168"><font size=-1>168     </font></a><span class="string">for certain cases in which merely structural relaxation is desired and not</span>
<a name="169"><font size=-1>169     </font></a><span class="string">actual molecular dynamics.</span>
<a name="170"><font size=-1>170     </font></a><span class="string"></span>
<a name="171"><font size=-1>171     </font></a><span class="string">Using the recommended values of [[cite:Martin1987]], 1 atomic mass unit = 1.6605402e-27 kg. In this</span>
<a name="172"><font size=-1>172     </font></a><span class="string">unit the mass of Carbon 12 is exactly 12.</span>
<a name="173"><font size=-1>173     </font></a><span class="string"></span>
<a name="174"><font size=-1>174     </font></a><span class="string">A database of atomic masses is provided which provides the default values. Note that the</span>
<a name="175"><font size=-1>175     </font></a><span class="string">default database uses mixed isotope masses (for Carbon the natural occurrence</span>
<a name="176"><font size=-1>176     </font></a><span class="string">of Carbon 13 is taken into account). The values are those recommended by the</span>
<a name="177"><font size=-1>177     </font></a><span class="string">commission on Atomic Weights and Isotopic Abundances, Inorganic Chemistry</span>
<a name="178"><font size=-1>178     </font></a><span class="string">Division, IUPAC [[cite:Martin1987]]. For Tc, Pm, Po to</span>
<a name="179"><font size=-1>179     </font></a><span class="string">Ac, Pa and beyond U, none of the isotopes have a half-life greater than 3.0d10</span>
<a name="180"><font size=-1>180     </font></a><span class="string">years, and the values provided in the database do not come from that source.</span>
<a name="181"><font size=-1>181     </font></a><span class="string"></span>
<a name="182"><font size=-1>182     </font></a><span class="string">For alchemical pseudoatoms, the masses of the constituents atoms are mixed,</span>
<a name="183"><font size=-1>183     </font></a><span class="string">according to the alchemical mixing coefficients [[mixalch]]</span>
<a name="184"><font size=-1>184     </font></a><span class="string"></span>
<a name="185"><font size=-1>185     </font></a><span class="string">In most cases, the use of [[amu]] will be as a static (non-evolving) variable.</span>
<a name="186"><font size=-1>186     </font></a><span class="string">However, the possibility to have different values of [[amu]] for different</span>
<a name="187"><font size=-1>187     </font></a><span class="string">images has been coded. A population of cells with different atomic</span>
<a name="188"><font size=-1>188     </font></a><span class="string">characteristics can thus be considered, and can be made to evolve, e.g. with a</span>
<a name="189"><font size=-1>189     </font></a><span class="string">genetic algorithm (not coded in v7.0.0 though).</span>
<a name="190"><font size=-1>190     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="191"><font size=-1>191     </font></a><span class="default">),</span>
<a name="192"><font size=-1>192     </font></a><span class="default"></span>
<a name="193"><font size=-1>193     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="194"><font size=-1>194     </font></a><span class="default">    abivarname=</span><span class="string">&quot;angdeg&quot;</span><span class="default">,</span>
<a name="195"><font size=-1>195     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="196"><font size=-1>196     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="197"><font size=-1>197     </font></a><span class="default">    topics=[</span><span class="string">'UnitCell_useful'</span><span class="default">],</span>
<a name="198"><font size=-1>198     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="199"><font size=-1>199     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ANGles in DEGrees&quot;</span><span class="default">,</span>
<a name="200"><font size=-1>200     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="201"><font size=-1>201     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;deduced from '[[rprim]]'&quot;</span><span class="default">,</span>
<a name="202"><font size=-1>202     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="203"><font size=-1>203     </font></a><span class="string">Gives the angles between directions of primitive vectors of the unit cell (in</span>
<a name="204"><font size=-1>204     </font></a><span class="string">degrees), as an alternative to the input array [[rprim]]. Will be used to set</span>
<a name="205"><font size=-1>205     </font></a><span class="string">up [[rprim]], that, together with the array [[acell]], will be used to define</span>
<a name="206"><font size=-1>206     </font></a><span class="string">the primitive vectors.</span>
<a name="207"><font size=-1>207     </font></a><span class="string"></span>
<a name="208"><font size=-1>208     </font></a><span class="string">  * [[angdeg]](1) is the angle between the 2nd and 3rd vectors,</span>
<a name="209"><font size=-1>209     </font></a><span class="string">  * [[angdeg]](2) is the angle between the 1st and 3rd vectors,</span>
<a name="210"><font size=-1>210     </font></a><span class="string">  * [[angdeg]](3) is the angle between the 1st and 2nd vectors,</span>
<a name="211"><font size=-1>211     </font></a><span class="string"></span>
<a name="212"><font size=-1>212     </font></a><span class="string">If the three angles are equal within 1.0d-12 (except if they are exactly 90</span>
<a name="213"><font size=-1>213     </font></a><span class="string">degrees), the three primitive vectors are chosen so that the trigonal symmetry</span>
<a name="214"><font size=-1>214     </font></a><span class="string">that exchange them is along the z cartesian axis:</span>
<a name="215"><font size=-1>215     </font></a><span class="string"></span>
<a name="216"><font size=-1>216     </font></a><span class="string">    R1=( a, 0,c)</span>
<a name="217"><font size=-1>217     </font></a><span class="string">    R2=(-a/2, sqrt(3)/2*a,c)</span>
<a name="218"><font size=-1>218     </font></a><span class="string">    R3=(-a/2,-sqrt(3)/2*a,c)</span>
<a name="219"><font size=-1>219     </font></a><span class="string"></span>
<a name="220"><font size=-1>220     </font></a><span class="string">where a  2  +c  2  =1.0d0</span>
<a name="221"><font size=-1>221     </font></a><span class="string">If the angles are not all equal (or if they are all 90 degrees), one will have</span>
<a name="222"><font size=-1>222     </font></a><span class="string">the following generic form:</span>
<a name="223"><font size=-1>223     </font></a><span class="string"></span>
<a name="224"><font size=-1>224     </font></a><span class="string">  * R1=(1,0,0)</span>
<a name="225"><font size=-1>225     </font></a><span class="string">  * R2=(a,b,0)</span>
<a name="226"><font size=-1>226     </font></a><span class="string">  * R3=(c,d,e)</span>
<a name="227"><font size=-1>227     </font></a><span class="string"></span>
<a name="228"><font size=-1>228     </font></a><span class="string">where each of the vectors is normalized, and form the desired angles with the others.</span>
<a name="229"><font size=-1>229     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="230"><font size=-1>230     </font></a><span class="default">),</span>
<a name="231"><font size=-1>231     </font></a><span class="default"></span>
<a name="232"><font size=-1>232     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="233"><font size=-1>233     </font></a><span class="default">    abivarname=</span><span class="string">&quot;asr&quot;</span><span class="default">,</span>
<a name="234"><font size=-1>234     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="235"><font size=-1>235     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="236"><font size=-1>236     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_useful'</span><span class="default">],</span>
<a name="237"><font size=-1>237     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="238"><font size=-1>238     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="239"><font size=-1>239     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Acoustic Sum Rule&quot;</span><span class="default">,</span>
<a name="240"><font size=-1>240     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="241"><font size=-1>241     </font></a><span class="string">Govern the imposition of the Acoustic Sum Rule (ASR) in phonon calculations.</span>
<a name="242"><font size=-1>242     </font></a><span class="string">Same meaning as the corresponding anaddb variable.</span>
<a name="243"><font size=-1>243     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="244"><font size=-1>244     </font></a><span class="default">),</span>
<a name="245"><font size=-1>245     </font></a><span class="default"></span>
<a name="246"><font size=-1>246     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="247"><font size=-1>247     </font></a><span class="default">    abivarname=</span><span class="string">&quot;atvshift&quot;</span><span class="default">,</span>
<a name="248"><font size=-1>248     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="249"><font size=-1>249     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="250"><font size=-1>250     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="251"><font size=-1>251     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natvshift]]'</span><span class="default">, </span><span class="string">'[[nsppol]]'</span><span class="default">, </span><span class="string">'[[natom]]'</span><span class="default">],</span>
<a name="252"><font size=-1>252     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="253"><font size=-1>253     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ATomic potential (V) energy SHIFTs&quot;</span><span class="default">,</span>
<a name="254"><font size=-1>254     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="255"><font size=-1>255     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepawu]] /= 0 and [[natvshift]] in [5,7]&quot;</span><span class="default">,</span>
<a name="256"><font size=-1>256     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="257"><font size=-1>257     </font></a><span class="string">Defines for each atom and each spin channel (at present, can only be used with</span>
<a name="258"><font size=-1>258     </font></a><span class="string">[[nsppol]] = 1 or 2, like the +U scheme), a possible potential shift, for the d</span>
<a name="259"><font size=-1>259     </font></a><span class="string">(with [[lpawu]] = 2, [[natvshift]] = 5), or f states (with [[lpawu]] = 3,</span>
<a name="260"><font size=-1>260     </font></a><span class="string">[[natvshift]] = 7). In the case of d states, and 2 spin channels, a set of 10</span>
<a name="261"><font size=-1>261     </font></a><span class="string">numbers for each atom must be defined. The first set of 5 numbers corresponds</span>
<a name="262"><font size=-1>262     </font></a><span class="string">to real spherical harmonics m=-2 to m=+2 for the spin-up channel, the second</span>
<a name="263"><font size=-1>263     </font></a><span class="string">set of 5 numbers corresponds to real spherical harmonics m=-2 to m=+2 for the</span>
<a name="264"><font size=-1>264     </font></a><span class="string">spin-down channel. In the case of f states, the same ordering applies, for</span>
<a name="265"><font size=-1>265     </font></a><span class="string">sets of 7 numbers, corresponding to m=-3 to m=+3.</span>
<a name="266"><font size=-1>266     </font></a><span class="string"></span>
<a name="267"><font size=-1>267     </font></a><span class="string">!!! important</span>
<a name="268"><font size=-1>268     </font></a><span class="string"></span>
<a name="269"><font size=-1>269     </font></a><span class="string">    [[usepawu]] should be non-zero, [[lpawu]] should be 2 or 3.</span>
<a name="270"><font size=-1>270     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="271"><font size=-1>271     </font></a><span class="default">),</span>
<a name="272"><font size=-1>272     </font></a><span class="default"></span>
<a name="273"><font size=-1>273     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="274"><font size=-1>274     </font></a><span class="default">    abivarname=</span><span class="string">&quot;autoparal&quot;</span><span class="default">,</span>
<a name="275"><font size=-1>275     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="276"><font size=-1>276     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="277"><font size=-1>277     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_basic'</span><span class="default">],</span>
<a name="278"><font size=-1>278     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="279"><font size=-1>279     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="280"><font size=-1>280     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;AUTOmatisation of the PARALlelism&quot;</span><span class="default">,</span>
<a name="281"><font size=-1>281     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="282"><font size=-1>282     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="283"><font size=-1>283     </font></a><span class="string">This input variable is used only when running ABINIT in parallel and for Ground-State calculations.</span>
<a name="284"><font size=-1>284     </font></a><span class="string">It controls the automatic determination of parameters related to parallel work</span>
<a name="285"><font size=-1>285     </font></a><span class="string">distribution (if not imposed in input file). Given a total number of</span>
<a name="286"><font size=-1>286     </font></a><span class="string">processors, ABINIT can find a suitable distribution that fill (when possible)</span>
<a name="287"><font size=-1>287     </font></a><span class="string">all the different levels of parallelization. ABINIT can also determine optimal</span>
<a name="288"><font size=-1>288     </font></a><span class="string">parameters for the use of parallel Linear Algebra routines (using Scalapack or Cuda, at present).</span>
<a name="289"><font size=-1>289     </font></a><span class="string">The different values for [[autoparal]] are:</span>
<a name="290"><font size=-1>290     </font></a><span class="string"></span>
<a name="291"><font size=-1>291     </font></a><span class="string">  * 0 --&gt; The [[autoparal]] feature is deactivated. For ground-state and response function calculations,</span>
<a name="292"><font size=-1>292     </font></a><span class="string">    ABINIT can only activate automatically the parallelism over spins and k-points.</span>
<a name="293"><font size=-1>293     </font></a><span class="string"></span>
<a name="294"><font size=-1>294     </font></a><span class="string">  * 1 --&gt; The number of processors per parallelization level is determined by mean of a simple</span>
<a name="295"><font size=-1>295     </font></a><span class="string">    (but relatively efficient) heuristic method. A scaling factor is attributed to each level and an simple</span>
<a name="296"><font size=-1>296     </font></a><span class="string">    speedup factor is computed. The selected parameters are those giving the best speedup factor.</span>
<a name="297"><font size=-1>297     </font></a><span class="string">    Possibly concerned parameters: [[npimage]], [[npkpt]], [[npspinor]], [[npfft]], [[npband]], [[bandpp]].</span>
<a name="298"><font size=-1>298     </font></a><span class="string"></span>
<a name="299"><font size=-1>299     </font></a><span class="string">  * 2 --&gt; The number of processors per parallelization level is first determined by mean of a simple</span>
<a name="300"><font size=-1>300     </font></a><span class="string">    (but relatively efficient) heuristic method (see 1 above). Then the code performs a series of</span>
<a name="301"><font size=-1>301     </font></a><span class="string">    small benchmarks using the scheme applied for the LOBPCG algorithm (see [[wfoptalg]] = 4 or 14).</span>
<a name="302"><font size=-1>302     </font></a><span class="string">    The parallel distribution is then changed according to the benchmarks.</span>
<a name="303"><font size=-1>303     </font></a><span class="string">    Possibly concerned parameters: [[npimage]], [[npkpt]], [[npspinor]], [[npfft]], [[npband]], [[bandpp]].</span>
<a name="304"><font size=-1>304     </font></a><span class="string"></span>
<a name="305"><font size=-1>305     </font></a><span class="string">  * 3 --&gt; Same as [[autoparal]] = 1, plus automatic determination of Linear Algebra routines parameters.</span>
<a name="306"><font size=-1>306     </font></a><span class="string">    In addition, the code performs a series of small benchmarks using the Linear</span>
<a name="307"><font size=-1>307     </font></a><span class="string">    Algebra routines (ScaLapack or Cuda-GPU). The parameters used to optimize</span>
<a name="308"><font size=-1>308     </font></a><span class="string">    Linear Algebra work distribution are then changed according to the benchmarks.</span>
<a name="309"><font size=-1>309     </font></a><span class="string">    Possibly concerned parameters (in addition to those modified for</span>
<a name="310"><font size=-1>310     </font></a><span class="string">    [[autoparal]] = 1): [[use_slk]], [[np_slk]], [[gpu_linalg_limit]]</span>
<a name="311"><font size=-1>311     </font></a><span class="string"></span>
<a name="312"><font size=-1>312     </font></a><span class="string">  * 4 --&gt; combination of [[autoparal]] = 2 and [[autoparal]] = 3.</span>
<a name="313"><font size=-1>313     </font></a><span class="string"></span>
<a name="314"><font size=-1>314     </font></a><span class="string">Note that [[autoparal]] = 1 can be used on every set of processors;</span>
<a name="315"><font size=-1>315     </font></a><span class="string">[[autoparal]] &gt; 1 should be used on a sufficiently large number of MPI process.</span>
<a name="316"><font size=-1>316     </font></a><span class="string">Also note that [[autoparal]] can be used simultaneously with [[max_ncpus]]; in</span>
<a name="317"><font size=-1>317     </font></a><span class="string">this case, ABINIT performs an optimization of process distribution for each</span>
<a name="318"><font size=-1>318     </font></a><span class="string">total number of processors from 2 to [[max_ncpus]]. A weight is associated to</span>
<a name="319"><font size=-1>319     </font></a><span class="string">each distribution and the higher this weight is the better the distribution</span>
<a name="320"><font size=-1>320     </font></a><span class="string">is. After having printed out the weights, the code stops.</span>
<a name="321"><font size=-1>321     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="322"><font size=-1>322     </font></a><span class="default">),</span>
<a name="323"><font size=-1>323     </font></a><span class="default"></span>
<a name="324"><font size=-1>324     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="325"><font size=-1>325     </font></a><span class="default">    abivarname=</span><span class="string">&quot;auxc_ixc&quot;</span><span class="default">,</span>
<a name="326"><font size=-1>326     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="327"><font size=-1>327     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="328"><font size=-1>328     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_useful'</span><span class="default">],</span>
<a name="329"><font size=-1>329     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="330"><font size=-1>330     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="331"><font size=-1>331     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;AUxiliary XC functional for hybrid functional, IXC number&quot;</span><span class="default">,</span>
<a name="332"><font size=-1>332     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="333"><font size=-1>333     </font></a><span class="string">Specification of an auxiliary exchange-correlation functional, thanks to its</span>
<a name="334"><font size=-1>334     </font></a><span class="string">[[ixc]] value, to possibly replace the heavy evaluation of an hybrid</span>
<a name="335"><font size=-1>335     </font></a><span class="string">functional at specific occasions, e.g. when the Fock operator is frozen during</span>
<a name="336"><font size=-1>336     </font></a><span class="string">the self-consistent cycle, thanks to [[fockoptmix]] == 11, or when evaluating</span>
<a name="337"><font size=-1>337     </font></a><span class="string">the correction to forces due to the density residual. This auxiliary exchange-</span>
<a name="338"><font size=-1>338     </font></a><span class="string">correlation functional might be rescaled, thanks to [[auxc_scal]] when</span>
<a name="339"><font size=-1>339     </font></a><span class="string">[[fockoptmix]] == 11. If [[gwcalctyp]] == 5, 15 or 25, [[auxc_ixc]] refers to</span>
<a name="340"><font size=-1>340     </font></a><span class="string">[[ixc_sigma]] instead of [[ixc]].</span>
<a name="341"><font size=-1>341     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="342"><font size=-1>342     </font></a><span class="default">),</span>
<a name="343"><font size=-1>343     </font></a><span class="default"></span>
<a name="344"><font size=-1>344     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="345"><font size=-1>345     </font></a><span class="default">    abivarname=</span><span class="string">&quot;auxc_scal&quot;</span><span class="default">,</span>
<a name="346"><font size=-1>346     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="347"><font size=-1>347     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="348"><font size=-1>348     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_useful'</span><span class="default">],</span>
<a name="349"><font size=-1>349     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="350"><font size=-1>350     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="351"><font size=-1>351     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;AUxiliary XC functional for hybrid functional- SCALing factor&quot;</span><span class="default">,</span>
<a name="352"><font size=-1>352     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="353"><font size=-1>353     </font></a><span class="string">Possible scaling factor for the auxiliary exchange-correlation functional</span>
<a name="354"><font size=-1>354     </font></a><span class="string">defined by [[auxc_ixc]] that has the goal to replace the Fock operator or</span>
<a name="355"><font size=-1>355     </font></a><span class="string">hybrid functional when [[fockoptmix]] == 11.</span>
<a name="356"><font size=-1>356     </font></a><span class="string"></span>
<a name="357"><font size=-1>357     </font></a><span class="string">The default value 1.0 corresponds to the unmodified xc functional. When the</span>
<a name="358"><font size=-1>358     </font></a><span class="string">auxiliary functional is used to replace the hybrid functional in SCF loops, a</span>
<a name="359"><font size=-1>359     </font></a><span class="string">value of 1.5 has been observed to speed up somehow the convergence.</span>
<a name="360"><font size=-1>360     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="361"><font size=-1>361     </font></a><span class="default">),</span>
<a name="362"><font size=-1>362     </font></a><span class="default"></span>
<a name="363"><font size=-1>363     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="364"><font size=-1>364     </font></a><span class="default">    abivarname=</span><span class="string">&quot;awtr&quot;</span><span class="default">,</span>
<a name="365"><font size=-1>365     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="366"><font size=-1>366     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="367"><font size=-1>367     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_useful'</span><span class="default">],</span>
<a name="368"><font size=-1>368     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="369"><font size=-1>369     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="370"><font size=-1>370     </font></a><span class="default">    mnemonics=</span><span class="string">r&quot;evaluate the Adler-Wiser expression of $\chi^{0}_{KS}$ assuming Time-Reversal&quot;</span><span class="default">,</span>
<a name="371"><font size=-1>371     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3&quot;</span><span class="default">,</span>
<a name="372"><font size=-1>372     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="373"><font size=-1>373     </font></a><span class="string">This input variable defines whether the irreducible polarizability</span>
<a name="374"><font size=-1>374     </font></a><span class="string">$\chi^{0}_{KS}$ is evaluated taking advantage of time-reversal symmetry or not.</span>
<a name="375"><font size=-1>375     </font></a><span class="string"></span>
<a name="376"><font size=-1>376     </font></a><span class="string">* 0 --&gt; Use the &quot;standard&quot; Adler-Wiser expression without assuming time-reversal symmetry.</span>
<a name="377"><font size=-1>377     </font></a><span class="string">  In this case, the irreducible polarizability is calculated summing over all possible</span>
<a name="378"><font size=-1>378     </font></a><span class="string">  electronic transitions (both resonant and anti-resonant).</span>
<a name="379"><font size=-1>379     </font></a><span class="string">* 1 --&gt; Take advantage of time-reversal symmetry to halve the number of transitions to be explicitly considered.</span>
<a name="380"><font size=-1>380     </font></a><span class="string">  This method leads to a decrease in the CPU time by a factor two with respect to the [[awtr]] = 0 case.</span>
<a name="381"><font size=-1>381     </font></a><span class="string"></span>
<a name="382"><font size=-1>382     </font></a><span class="string">!!! important</span>
<a name="383"><font size=-1>383     </font></a><span class="string"></span>
<a name="384"><font size=-1>384     </font></a><span class="string">    Note that the parallel algorithm [[gwpara]] = 2 is not compatible with the choice [[awtr]] = 0.</span>
<a name="385"><font size=-1>385     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="386"><font size=-1>386     </font></a><span class="default">),</span>
<a name="387"><font size=-1>387     </font></a><span class="default"></span>
<a name="388"><font size=-1>388     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="389"><font size=-1>389     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bandpp&quot;</span><span class="default">,</span>
<a name="390"><font size=-1>390     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="391"><font size=-1>391     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="392"><font size=-1>392     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="393"><font size=-1>393     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="394"><font size=-1>394     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="395"><font size=-1>395     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BAND Per Processor&quot;</span><span class="default">,</span>
<a name="396"><font size=-1>396     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="397"><font size=-1>397     </font></a><span class="default">    requires=</span><span class="string">&quot;[[paral_kgb]] == 1&quot;</span><span class="default">,</span>
<a name="398"><font size=-1>398     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="399"><font size=-1>399     </font></a><span class="string">Control the size of the block in the LOBPCG algorithm. This keyword works only</span>
<a name="400"><font size=-1>400     </font></a><span class="string">with [[paral_kgb]] = 1 and has to be either 1 or a multiple of 2.</span>
<a name="401"><font size=-1>401     </font></a><span class="string"></span>
<a name="402"><font size=-1>402     </font></a><span class="string">With [[npband]] = 1:</span>
<a name="403"><font size=-1>403     </font></a><span class="string"></span>
<a name="404"><font size=-1>404     </font></a><span class="string">* 1 --&gt; band-per-band algorithm</span>
<a name="405"><font size=-1>405     </font></a><span class="string">* n --&gt; The minimization is performed using [[nband]]/n blocks of n bands.</span>
<a name="406"><font size=-1>406     </font></a><span class="string"></span>
<a name="407"><font size=-1>407     </font></a><span class="string">!!! warning</span>
<a name="408"><font size=-1>408     </font></a><span class="string"></span>
<a name="409"><font size=-1>409     </font></a><span class="string">    [[nband]]/n has to be an integer.</span>
<a name="410"><font size=-1>410     </font></a><span class="string"></span>
<a name="411"><font size=-1>411     </font></a><span class="string">With [[npband]] $\\ne$ 1:</span>
<a name="412"><font size=-1>412     </font></a><span class="string"></span>
<a name="413"><font size=-1>413     </font></a><span class="string">* 1 --&gt; The minimization is performed using [[nband]]/[[npband]] blocks of [[npband]] bands.</span>
<a name="414"><font size=-1>414     </font></a><span class="string">* n --&gt; The minimization is performed using [[nband]]/([[npband]] $\\times$ n) blocks of [[npband]]  $\\times$ n bands.</span>
<a name="415"><font size=-1>415     </font></a><span class="string"></span>
<a name="416"><font size=-1>416     </font></a><span class="string">!!! warning</span>
<a name="417"><font size=-1>417     </font></a><span class="string"></span>
<a name="418"><font size=-1>418     </font></a><span class="string">    [[nband]] / ([[npband]]  $\\times$ n) has to be an integer.</span>
<a name="419"><font size=-1>419     </font></a><span class="string"></span>
<a name="420"><font size=-1>420     </font></a><span class="string">By minimizing a larger number of bands together in LOBPCG, we increase the</span>
<a name="421"><font size=-1>421     </font></a><span class="string">convergence of the residual. The better minimization procedure (as concerns</span>
<a name="422"><font size=-1>422     </font></a><span class="string">the convergence, but not as concerns the speed) is generally performed by</span>
<a name="423"><font size=-1>423     </font></a><span class="string">using [[bandpp]]  $\\times$ [[npband]] = [[nband]]. Put [[bandpp]] = 2 when [[istwfk]] = 2</span>
<a name="424"><font size=-1>424     </font></a><span class="string">(the time spent in FFTs is divided by two).</span>
<a name="425"><font size=-1>425     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="426"><font size=-1>426     </font></a><span class="default">),</span>
<a name="427"><font size=-1>427     </font></a><span class="default"></span>
<a name="428"><font size=-1>428     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="429"><font size=-1>429     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bdberry&quot;</span><span class="default">,</span>
<a name="430"><font size=-1>430     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="431"><font size=-1>431     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="432"><font size=-1>432     </font></a><span class="default">    topics=[</span><span class="string">'Berry_basic'</span><span class="default">],</span>
<a name="433"><font size=-1>433     </font></a><span class="default">    dimensions=[</span><span class="number">4</span><span class="default">],</span>
<a name="434"><font size=-1>434     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">4</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="435"><font size=-1>435     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BanD limits for BERRY phase&quot;</span><span class="default">,</span>
<a name="436"><font size=-1>436     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] in [1, 2, 3] and [[nberry]] &gt; 0&quot;</span><span class="default">,</span>
<a name="437"><font size=-1>437     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="438"><font size=-1>438     </font></a><span class="string">Give the lower band and the upper band of the set of bands for which the Berry</span>
<a name="439"><font size=-1>439     </font></a><span class="string">phase must be computed. Irrelevant if [[nberry]] is not positive. When</span>
<a name="440"><font size=-1>440     </font></a><span class="string">[[nsppol]] is 1 (no spin-polarisation), only the two first numbers, giving the</span>
<a name="441"><font size=-1>441     </font></a><span class="string">lower and highest bands, are significant. Their occupation number is assumed</span>
<a name="442"><font size=-1>442     </font></a><span class="string">to be 2. When [[nsppol]] is 2 (spin-polarized calculation), the two first</span>
<a name="443"><font size=-1>443     </font></a><span class="string">numbers give the lowest and highest bands for spin up, and the third and</span>
<a name="444"><font size=-1>444     </font></a><span class="string">fourth numbers give the lowest and highest bands for spin down. Their</span>
<a name="445"><font size=-1>445     </font></a><span class="string">occupation number is assumed to be 1.</span>
<a name="446"><font size=-1>446     </font></a><span class="string"></span>
<a name="447"><font size=-1>447     </font></a><span class="string">!!! important</span>
<a name="448"><font size=-1>448     </font></a><span class="string"></span>
<a name="449"><font size=-1>449     </font></a><span class="string">    Presently, [[bdberry]] MUST be initialized by the user in case of a Berry</span>
<a name="450"><font size=-1>450     </font></a><span class="string">    phase calculation with [[berryopt]] = 1, 2, or 3: the above-mentioned default</span>
<a name="451"><font size=-1>451     </font></a><span class="string">    will cause an early exit.</span>
<a name="452"><font size=-1>452     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="453"><font size=-1>453     </font></a><span class="default">),</span>
<a name="454"><font size=-1>454     </font></a><span class="default"></span>
<a name="455"><font size=-1>455     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="456"><font size=-1>456     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bdeigrf&quot;</span><span class="default">,</span>
<a name="457"><font size=-1>457     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="458"><font size=-1>458     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="459"><font size=-1>459     </font></a><span class="default">    topics=[</span><span class="string">'TDepES_basic'</span><span class="default">],</span>
<a name="460"><font size=-1>460     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="461"><font size=-1>461     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="462"><font size=-1>462     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BanD for second-order EIGenvalues from Response-Function&quot;</span><span class="default">,</span>
<a name="463"><font size=-1>463     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ieig2rf]] in [1,2,3,4,5]&quot;</span><span class="default">,</span>
<a name="464"><font size=-1>464     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="465"><font size=-1>465     </font></a><span class="string"></span>
<a name="466"><font size=-1>466     </font></a><span class="string">The variable [[bdeigrf]] is the maximum number of bands for which the second-</span>
<a name="467"><font size=-1>467     </font></a><span class="string">order eigenvalues must be calculated: the full number of bands is still used</span>
<a name="468"><font size=-1>468     </font></a><span class="string">during the computation of these corrections.</span>
<a name="469"><font size=-1>469     </font></a><span class="string"></span>
<a name="470"><font size=-1>470     </font></a><span class="string">If [[bdeigrf]] is set to -1, the code will automatically set [[bdeigrf]] equal to [[nband]].</span>
<a name="471"><font size=-1>471     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="472"><font size=-1>472     </font></a><span class="default">),</span>
<a name="473"><font size=-1>473     </font></a><span class="default"></span>
<a name="474"><font size=-1>474     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="475"><font size=-1>475     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bdgw&quot;</span><span class="default">,</span>
<a name="476"><font size=-1>476     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="477"><font size=-1>477     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="478"><font size=-1>478     </font></a><span class="default">    topics=[</span><span class="string">'GW_basic'</span><span class="default">, </span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="479"><font size=-1>479     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">, </span><span class="string">'[[nkptgw]]'</span><span class="default">, </span><span class="string">'[[nsppol]]'</span><span class="default">],</span>
<a name="480"><font size=-1>480     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="481"><font size=-1>481     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BanDs for GW calculation&quot;</span><span class="default">,</span>
<a name="482"><font size=-1>482     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [4, 7]&quot;</span><span class="default">,</span>
<a name="483"><font size=-1>483     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="484"><font size=-1>484     </font></a><span class="string">For each k-point with number `ikptgw` in the range (1:[[nkptgw]]) and each spin</span>
<a name="485"><font size=-1>485     </font></a><span class="string">index `isppol`, [[bdgw]](1,`ikptgw`,`isppol`) is the number of the lowest band for</span>
<a name="486"><font size=-1>486     </font></a><span class="string">which the self-energy computation must be done.</span>
<a name="487"><font size=-1>487     </font></a><span class="string">[[bdgw]](2,`ikptgw`,`isppol`) gives the index of the highest band for which the self-energy computation must be done.</span>
<a name="488"><font size=-1>488     </font></a><span class="string"></span>
<a name="489"><font size=-1>489     </font></a><span class="string">!!! note</span>
<a name="490"><font size=-1>490     </font></a><span class="string"></span>
<a name="491"><font size=-1>491     </font></a><span class="string">    The initial values given in the input file might be changed inside</span>
<a name="492"><font size=-1>492     </font></a><span class="string">    the code so that all the degenerate states at a given k-point and spin are</span>
<a name="493"><font size=-1>493     </font></a><span class="string">    included. This might happen when [[symsigma]] = 1 is used or in the case of</span>
<a name="494"><font size=-1>494     </font></a><span class="string">    self-consistent GW calculations.</span>
<a name="495"><font size=-1>495     </font></a><span class="string">    When [[symsigma]] == 1, indeed, the diagonal matrix elements of the self-energy are</span>
<a name="496"><font size=-1>496     </font></a><span class="string">    obtained by averaging the unsymmetrized results in the subspace spanned by the degenerate states.</span>
<a name="497"><font size=-1>497     </font></a><span class="string"></span>
<a name="498"><font size=-1>498     </font></a><span class="string">When [[gwcalctyp]] &gt;= 20, the quasiparticle wavefunctions are computed and</span>
<a name="499"><font size=-1>499     </font></a><span class="string">represented as linear combination of Kohn-Sham wavefunctions. In this case</span>
<a name="500"><font size=-1>500     </font></a><span class="string">[[bdgw]] designates the range of KS wavefunctions used as basis set. For each</span>
<a name="501"><font size=-1>501     </font></a><span class="string">k-point, indeed, the quasiparticle wavefunctions are expanded considering only</span>
<a name="502"><font size=-1>502     </font></a><span class="string">the KS states between [[bdgw]](1,`ikptgw`,`isppol`) and [[bdgw]](2,`ikptgw`,`isppol`).</span>
<a name="503"><font size=-1>503     </font></a><span class="string"></span>
<a name="504"><font size=-1>504     </font></a><span class="string">For self-consistent calculations, on the other hand, the basis set used to</span>
<a name="505"><font size=-1>505     </font></a><span class="string">expand the GW wavefunctions should include all the degenerate states belonging</span>
<a name="506"><font size=-1>506     </font></a><span class="string">to the same irreducible representation. Only in this case, indeed, the initial</span>
<a name="507"><font size=-1>507     </font></a><span class="string">symmetries and energy degenerations are preserved.</span>
<a name="508"><font size=-1>508     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="509"><font size=-1>509     </font></a><span class="default">),</span>
<a name="510"><font size=-1>510     </font></a><span class="default"></span>
<a name="511"><font size=-1>511     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="512"><font size=-1>512     </font></a><span class="default">    abivarname=</span><span class="string">&quot;berryopt&quot;</span><span class="default">,</span>
<a name="513"><font size=-1>513     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="514"><font size=-1>514     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="515"><font size=-1>515     </font></a><span class="default">    topics=[</span><span class="string">'Berry_compulsory'</span><span class="default">],</span>
<a name="516"><font size=-1>516     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="517"><font size=-1>517     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="518"><font size=-1>518     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BERRY phase OPTions&quot;</span><span class="default">,</span>
<a name="519"><font size=-1>519     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="520"><font size=-1>520     </font></a><span class="string">Specifies the use of Berry phase for the computation of either the</span>
<a name="521"><font size=-1>521     </font></a><span class="string">polarization, the derivatives with respect to the wavevector, or finite</span>
<a name="522"><font size=-1>522     </font></a><span class="string">electric field calculations.</span>
<a name="523"><font size=-1>523     </font></a><span class="string"></span>
<a name="524"><font size=-1>524     </font></a><span class="string">  * 0 --&gt; no computation of expressions relying on a Berry phase (default)</span>
<a name="525"><font size=-1>525     </font></a><span class="string">  * 1 --&gt; the computation of Berry phases is activated (berryphase routine)</span>
<a name="526"><font size=-1>526     </font></a><span class="string">  * 2 --&gt; the computation of derivatives with respect to the wavevector, thanks to the</span>
<a name="527"><font size=-1>527     </font></a><span class="string">    Berry phase finite-difference formula, is activated (uderiv routine)</span>
<a name="528"><font size=-1>528     </font></a><span class="string">  * 3 --&gt; same as option 1 and 2 together</span>
<a name="529"><font size=-1>529     </font></a><span class="string"></span>
<a name="530"><font size=-1>530     </font></a><span class="string">!!! note</span>
<a name="531"><font size=-1>531     </font></a><span class="string">    Note that options 1 to 3 require the use of a serial build of Abinit.**</span>
<a name="532"><font size=-1>532     </font></a><span class="string"></span>
<a name="533"><font size=-1>533     </font></a><span class="string">  * -1 --&gt; alternative computation of Berry phases (berryphase_new routine)</span>
<a name="534"><font size=-1>534     </font></a><span class="string">  * -2 --&gt; alternative computation of derivatives with respect to the wavevector,</span>
<a name="535"><font size=-1>535     </font></a><span class="string">    thanks to the Berry phase finite-difference formula (berryphase_new routine)</span>
<a name="536"><font size=-1>536     </font></a><span class="string">  * -3 --&gt; same as option -1 and -2 together</span>
<a name="537"><font size=-1>537     </font></a><span class="string"></span>
<a name="538"><font size=-1>538     </font></a><span class="string">!!! note</span>
<a name="539"><font size=-1>539     </font></a><span class="string">    Options -1 to -3 permit use of a parallel build and will be preferred by</span>
<a name="540"><font size=-1>540     </font></a><span class="string">    most users.</span>
<a name="541"><font size=-1>541     </font></a><span class="string"></span>
<a name="542"><font size=-1>542     </font></a><span class="string">  * 4 --&gt; finite electric field calculation (unreduced E-field)</span>
<a name="543"><font size=-1>543     </font></a><span class="string">  * 6 --&gt; finite electric displacement field calculation (unreduced D-field)</span>
<a name="544"><font size=-1>544     </font></a><span class="string">  * 14 --&gt; finite reduced electric field calculation</span>
<a name="545"><font size=-1>545     </font></a><span class="string">  * 16 --&gt; finite electric displacement field calculation</span>
<a name="546"><font size=-1>546     </font></a><span class="string">  * 17 --&gt; mixed electric boundary condition: finite reduced electric field in some directions,</span>
<a name="547"><font size=-1>547     </font></a><span class="string">  finite reduced electric displacement field along other directions. See variable [[jfielddir]] for more details.</span>
<a name="548"><font size=-1>548     </font></a><span class="string"></span>
<a name="549"><font size=-1>549     </font></a><span class="string">Other related input variables are:</span>
<a name="550"><font size=-1>550     </font></a><span class="string"></span>
<a name="551"><font size=-1>551     </font></a><span class="string">  * in case of [[berryopt]] = 1,2, or 3: [[bdberry]] and [[kberry]]; also, [[nberry]] must be larger than 0;</span>
<a name="552"><font size=-1>552     </font></a><span class="string">  * in case of [[berryopt]] = -1,-2, or -3: the variable [[rfdir]] must be used to specify the primitive vector along which the projection of the polarization or the ddk will be computed. For example if [[berryopt]] = -1 and [[rfdir]] = 1 0 0, the projection of the polarization along the reciprocal lattice vector $G_1$ is computed. In case [[rfdir]] = 1 1 1, ABINIT computes the projection of P along $G_1$, $G_2$ and $G_3$ and transforms the results to cartesian coordinates;</span>
<a name="553"><font size=-1>553     </font></a><span class="string">  * in cases where [[berryopt]] is negative, [[berrystep]] allow a computation of multiple-step Berry phase in order to accelerate the convergence.</span>
<a name="554"><font size=-1>554     </font></a><span class="string">  * [[efield]] and [[rfdir]] in case of [[berryopt]] = 4;</span>
<a name="555"><font size=-1>555     </font></a><span class="string"></span>
<a name="556"><font size=-1>556     </font></a><span class="string">The cases [[berryopt]] = -1,-2,-3, 4, 6, 7, 14, 16, and 17 have to be used with [[occopt]] = 1.</span>
<a name="557"><font size=-1>557     </font></a><span class="string"></span>
<a name="558"><font size=-1>558     </font></a><span class="string">The cases [[berryopt]] = -1 and 4, 6, 7, 14, 16, 17 are compatible with PAW,</span>
<a name="559"><font size=-1>559     </font></a><span class="string">howevever, if in these cases one uses [[kptopt]] /= 3, one must also use only</span>
<a name="560"><font size=-1>560     </font></a><span class="string">symmorphic symmetries (either because the space group is symmorphic or the</span>
<a name="561"><font size=-1>561     </font></a><span class="string">variable [[symmorphi]] is set to zero).</span>
<a name="562"><font size=-1>562     </font></a><span class="string"></span>
<a name="563"><font size=-1>563     </font></a><span class="string">For a phonon calculation under a finite electric field, respect the following procedure.</span>
<a name="564"><font size=-1>564     </font></a><span class="string"></span>
<a name="565"><font size=-1>565     </font></a><span class="string">  * a) Run a scf ground-state calculation at zero electric field to get wavefunctions to initialize the ground-state calculation in finite electric fields.</span>
<a name="566"><font size=-1>566     </font></a><span class="string">  * b) Run a scf ground-state calculation in finite electric field. The electric field is controlled by the input variable [[efield]]. [[berryopt]] should be 4. The input variable [[kptopt]] should be set to be 2.</span>
<a name="567"><font size=-1>567     </font></a><span class="string">  * c) Based on the wave functions obtained in step (2), perform phonon calculation by setting [[berryopt]] = 4, [[kptopt]] = 3 and The same value of [[efield]] than in step 2. [[nsym]] should be set to 1 currently but this restriction may be removed later. The other parameters are the same as phonon calculation at zero electric field.</span>
<a name="568"><font size=-1>568     </font></a><span class="string"></span>
<a name="569"><font size=-1>569     </font></a><span class="string">!!! important</span>
<a name="570"><font size=-1>570     </font></a><span class="string">    The choice of k-point sampling N x N x N should be the same in the three runs and N should be an even number.</span>
<a name="571"><font size=-1>571     </font></a><span class="string"></span>
<a name="572"><font size=-1>572     </font></a><span class="string">In case of finite electric and displacement field calculations</span>
<a name="573"><font size=-1>573     </font></a><span class="string">([[berryopt]] = 4,6,7,14,16,17), see also the input variables [[berrysav]],</span>
<a name="574"><font size=-1>574     </font></a><span class="string">[[dfield]], [[red_dfield]], [[red_efield]], [[ddamp]]</span>
<a name="575"><font size=-1>575     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="576"><font size=-1>576     </font></a><span class="default">),</span>
<a name="577"><font size=-1>577     </font></a><span class="default"></span>
<a name="578"><font size=-1>578     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="579"><font size=-1>579     </font></a><span class="default">    abivarname=</span><span class="string">&quot;berrysav&quot;</span><span class="default">,</span>
<a name="580"><font size=-1>580     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="581"><font size=-1>581     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="582"><font size=-1>582     </font></a><span class="default">    topics=[</span><span class="string">'Berry_useful'</span><span class="default">],</span>
<a name="583"><font size=-1>583     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="584"><font size=-1>584     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="585"><font size=-1>585     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BERRY SAVe&quot;</span><span class="default">,</span>
<a name="586"><font size=-1>586     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="587"><font size=-1>587     </font></a><span class="string">  * 0 --&gt; for finite electric field calculation ([[berryopt]] = 4/14),</span>
<a name="588"><font size=-1>588     </font></a><span class="string">    the polarization branch will be chosen on each iteration from (-pi, pi).</span>
<a name="589"><font size=-1>589     </font></a><span class="string">    For finite electric displacement field calculation([[berryopt]] = 6/7/16/17),</span>
<a name="590"><font size=-1>590     </font></a><span class="string">    the polarization will be chosen to minimize the internal energy.</span>
<a name="591"><font size=-1>591     </font></a><span class="string">  * 1 --&gt; the polarization will be kept in the same branch on each iteration.</span>
<a name="592"><font size=-1>592     </font></a><span class="string">    At the end of the run, a file &quot;POLSAVE&quot; will be saved containing the reduced polarization in atomic units.</span>
<a name="593"><font size=-1>593     </font></a><span class="string"></span>
<a name="594"><font size=-1>594     </font></a><span class="string">    !!! note</span>
<a name="595"><font size=-1>595     </font></a><span class="string">        Make sure that &quot;POLSAVE&quot; is empty or it does not exist before the calculation, or else that</span>
<a name="596"><font size=-1>596     </font></a><span class="string">        it specifies the desired polarization branch.</span>
<a name="597"><font size=-1>597     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="598"><font size=-1>598     </font></a><span class="default">),</span>
<a name="599"><font size=-1>599     </font></a><span class="default"></span>
<a name="600"><font size=-1>600     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="601"><font size=-1>601     </font></a><span class="default">    abivarname=</span><span class="string">&quot;berrystep&quot;</span><span class="default">,</span>
<a name="602"><font size=-1>602     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="603"><font size=-1>603     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="604"><font size=-1>604     </font></a><span class="default">    topics=[</span><span class="string">'Berry_expert'</span><span class="default">],</span>
<a name="605"><font size=-1>605     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="606"><font size=-1>606     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="607"><font size=-1>607     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BERRY phase: multiple STEP&quot;</span><span class="default">,</span>
<a name="608"><font size=-1>608     </font></a><span class="default">    requires=</span><span class="string">&quot;0 &gt; [[berryopt]]&quot;</span><span class="default">,</span>
<a name="609"><font size=-1>609     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="610"><font size=-1>610     </font></a><span class="string">If [[berryopt]] is negative, this variable is used to compute berry phases</span>
<a name="611"><font size=-1>611     </font></a><span class="string">using multiple discrete steps, in order to accelerate convergence. The single-</span>
<a name="612"><font size=-1>612     </font></a><span class="string">step berry phase is the standard calculation using strings of k-points based</span>
<a name="613"><font size=-1>613     </font></a><span class="string">on overlap of Bloch function separated by $dk$, while the two-step berry phase</span>
<a name="614"><font size=-1>614     </font></a><span class="string">use strings use overlaps based on dk and $2*dk$, the three-step use overlaps</span>
<a name="615"><font size=-1>615     </font></a><span class="string">based on dk, $2*dk$ and $3*dk$...</span>
<a name="616"><font size=-1>616     </font></a><span class="string"></span>
<a name="617"><font size=-1>617     </font></a><span class="string">The default value of this variable is 1, meaning that only the single-step</span>
<a name="618"><font size=-1>618     </font></a><span class="string">berry phase calculation is done. If a larger value is set, ABINIT will compute</span>
<a name="619"><font size=-1>619     </font></a><span class="string">all the multiple-step berry phase from the single-step to the</span>
<a name="620"><font size=-1>620     </font></a><span class="string">[[berrystep]]-step, and use the large-step values of berry phase to correct</span>
<a name="621"><font size=-1>621     </font></a><span class="string">the single-step berry phase. Use with care: while experience is still to be</span>
<a name="622"><font size=-1>622     </font></a><span class="string">gained with this procedure, the outlook is promising.</span>
<a name="623"><font size=-1>623     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="624"><font size=-1>624     </font></a><span class="default">),</span>
<a name="625"><font size=-1>625     </font></a><span class="default"></span>
<a name="626"><font size=-1>626     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="627"><font size=-1>627     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bfield&quot;</span><span class="default">,</span>
<a name="628"><font size=-1>628     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="629"><font size=-1>629     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="630"><font size=-1>630     </font></a><span class="default">    topics=[</span><span class="string">'MagField_expert'</span><span class="default">],</span>
<a name="631"><font size=-1>631     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="632"><font size=-1>632     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="633"><font size=-1>633     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;finite B FIELD calculation&quot;</span><span class="default">,</span>
<a name="634"><font size=-1>634     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="635"><font size=-1>635     </font></a><span class="string">Perform finite magnetic field calculation.</span>
<a name="636"><font size=-1>636     </font></a><span class="string"></span>
<a name="637"><font size=-1>637     </font></a><span class="string">!!! important</span>
<a name="638"><font size=-1>638     </font></a><span class="string">    **THIS CODE IS UNDER DEVELOPMENT AND IS NOT READY FOR USE.**</span>
<a name="639"><font size=-1>639     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="640"><font size=-1>640     </font></a><span class="default">),</span>
<a name="641"><font size=-1>641     </font></a><span class="default"></span>
<a name="642"><font size=-1>642     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="643"><font size=-1>643     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bmass&quot;</span><span class="default">,</span>
<a name="644"><font size=-1>644     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="645"><font size=-1>645     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="646"><font size=-1>646     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="647"><font size=-1>647     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="648"><font size=-1>648     </font></a><span class="default">    defaultval=</span><span class="number">10</span><span class="default">,</span>
<a name="649"><font size=-1>649     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Barostat MASS&quot;</span><span class="default">,</span>
<a name="650"><font size=-1>650     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="651"><font size=-1>651     </font></a><span class="string">bmass is the mass of the barostat when [[ionmov]] = 13 (constant pressure molecular dynamics)</span>
<a name="652"><font size=-1>652     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="653"><font size=-1>653     </font></a><span class="default">),</span>
<a name="654"><font size=-1>654     </font></a><span class="default"></span>
<a name="655"><font size=-1>655     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="656"><font size=-1>656     </font></a><span class="default">    abivarname=</span><span class="string">&quot;boxcenter&quot;</span><span class="default">,</span>
<a name="657"><font size=-1>657     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="658"><font size=-1>658     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="659"><font size=-1>659     </font></a><span class="default">    topics=[</span><span class="string">'TDDFT_basic'</span><span class="default">],</span>
<a name="660"><font size=-1>660     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="661"><font size=-1>661     </font></a><span class="default">    defaultval=[</span><span class="number">0.5</span><span class="default">, </span><span class="number">0.5</span><span class="default">, </span><span class="number">0.5</span><span class="default">],</span>
<a name="662"><font size=-1>662     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BOX CENTER&quot;</span><span class="default">,</span>
<a name="663"><font size=-1>663     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="664"><font size=-1>664     </font></a><span class="string">Defines the center of the box, in reduced coordinates. At present, this</span>
<a name="665"><font size=-1>665     </font></a><span class="string">information is only used in the case of Time-Dependent DFT computation of the</span>
<a name="666"><font size=-1>666     </font></a><span class="string">oscillator strength. One must take [[boxcenter]] such as to be roughly the center</span>
<a name="667"><font size=-1>667     </font></a><span class="string">of the cluster or molecule. The default is sensible when the vacuum</span>
<a name="668"><font size=-1>668     </font></a><span class="string">surrounding the cluster or molecule has xred 0 or 1. On the contrary, when the</span>
<a name="669"><font size=-1>669     </font></a><span class="string">cluster or molecule is close to the origin, it is better to take [[boxcenter]] = [0.0, 0.0, 0.0].</span>
<a name="670"><font size=-1>670     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="671"><font size=-1>671     </font></a><span class="default">),</span>
<a name="672"><font size=-1>672     </font></a><span class="default"></span>
<a name="673"><font size=-1>673     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="674"><font size=-1>674     </font></a><span class="default">    abivarname=</span><span class="string">&quot;boxcutmin&quot;</span><span class="default">,</span>
<a name="675"><font size=-1>675     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="676"><font size=-1>676     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="677"><font size=-1>677     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_useful'</span><span class="default">, </span><span class="string">'TuningSpeed_basic'</span><span class="default">],</span>
<a name="678"><font size=-1>678     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="679"><font size=-1>679     </font></a><span class="default">    defaultval=</span><span class="number">2.0</span><span class="default">,</span>
<a name="680"><font size=-1>680     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BOX CUT-off MINimum&quot;</span><span class="default">,</span>
<a name="681"><font size=-1>681     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="682"><font size=-1>682     </font></a><span class="string">The box cut-off ratio is the ratio between the wavefunction plane wave sphere</span>
<a name="683"><font size=-1>683     </font></a><span class="string">radius, and the radius of the sphere that can be inserted in the FFT box, in reciprocal space.</span>
<a name="684"><font size=-1>684     </font></a><span class="string"></span>
<a name="685"><font size=-1>685     </font></a><span class="string">In order for the density to be exact (in the case of the plane wave part, not the PAW on-site terms),</span>
<a name="686"><font size=-1>686     </font></a><span class="string">this ratio should be at least two. If one uses a smaller ratio, one will gain speed, at the expense of accuracy.</span>
<a name="687"><font size=-1>687     </font></a><span class="string">In the case of pure ground state calculation (e.g. for the determination of geometries), this is sensible.</span>
<a name="688"><font size=-1>688     </font></a><span class="string"></span>
<a name="689"><font size=-1>689     </font></a><span class="string">Prior to v8.9, the use of boxcutmin for DFPT calculations was forbidden. However, after testing, it was seen that</span>
<a name="690"><font size=-1>690     </font></a><span class="string">the deterioration in phonon band structures could be alleviated to a large extent by the imposition of the Acoustic Sum Rule [[asr]].</span>
<a name="691"><font size=-1>691     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="692"><font size=-1>692     </font></a><span class="default">),</span>
<a name="693"><font size=-1>693     </font></a><span class="default"></span>
<a name="694"><font size=-1>694     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="695"><font size=-1>695     </font></a><span class="default">    abivarname=</span><span class="string">&quot;brvltt&quot;</span><span class="default">,</span>
<a name="696"><font size=-1>696     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="697"><font size=-1>697     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="698"><font size=-1>698     </font></a><span class="default">    topics=[</span><span class="string">'UnitCell_useful'</span><span class="default">, </span><span class="string">'SmartSymm_basic'</span><span class="default">],</span>
<a name="699"><font size=-1>699     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="700"><font size=-1>700     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="701"><font size=-1>701     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BRaVais LaTTice type&quot;</span><span class="default">,</span>
<a name="702"><font size=-1>702     </font></a><span class="default">    requires=</span><span class="string">&quot;[[spgroup]] != 0&quot;</span><span class="default">,</span>
<a name="703"><font size=-1>703     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="704"><font size=-1>704     </font></a><span class="string">Set the type of Bravais lattice. The cell defined by [[acell]] and [[rprim]]</span>
<a name="705"><font size=-1>705     </font></a><span class="string">or [[angdeg]] should be the CONVENTIONAL cell.</span>
<a name="706"><font size=-1>706     </font></a><span class="string"></span>
<a name="707"><font size=-1>707     </font></a><span class="string">If brvltt=0, the code will assign brvltt from the space group information</span>
<a name="708"><font size=-1>708     </font></a><span class="string">[[spgroup]], and produce the symmetry operations for the conventional unit</span>
<a name="709"><font size=-1>709     </font></a><span class="string">cell. If the conventional cell is not primitive, the user should set [[chkprim]] = 0.</span>
<a name="710"><font size=-1>710     </font></a><span class="string"></span>
<a name="711"><font size=-1>711     </font></a><span class="string">If brvltt=-1, the code will assign brvltt from the space group information,</span>
<a name="712"><font size=-1>712     </font></a><span class="string">then reduce the unit cell to a primitive unit cell. The echo of [[acell]] and</span>
<a name="713"><font size=-1>713     </font></a><span class="string">[[rprim]] might thus differ from those derived directly from the input</span>
<a name="714"><font size=-1>714     </font></a><span class="string">variables. Also, the input variable [[xred]] will refer to the CONVENTIONAL</span>
<a name="715"><font size=-1>715     </font></a><span class="string">unit cell, but its echo will refer to the preprocessed PRIMITIVE unit cell.</span>
<a name="716"><font size=-1>716     </font></a><span class="string">There is of course no problem with [[xangst]] and [[xcart]], as they are</span>
<a name="717"><font size=-1>717     </font></a><span class="string">independent of the unit cell.</span>
<a name="718"><font size=-1>718     </font></a><span class="string"></span>
<a name="719"><font size=-1>719     </font></a><span class="string">The echo of [[brvltt]] in the output file will be one of the following Bravais lattices:</span>
<a name="720"><font size=-1>720     </font></a><span class="string"></span>
<a name="721"><font size=-1>721     </font></a><span class="string">* 1 = Primitive with no associated translations</span>
<a name="722"><font size=-1>722     </font></a><span class="string">* 2 = Inner centered with (a/2 + b/2 + c/2) associated translation</span>
<a name="723"><font size=-1>723     </font></a><span class="string">* 3 = Face centered with (a/2 + b/2; b/2 + c/2; c/2 + a/2) associated translations</span>
<a name="724"><font size=-1>724     </font></a><span class="string">* 4 = C - centered with (a/2 + b/2) associated translation</span>
<a name="725"><font size=-1>725     </font></a><span class="string">* 5 = A - centered with (b/2 + c/2) associated translation</span>
<a name="726"><font size=-1>726     </font></a><span class="string">* 6 = B - centered with (c/2 + a/2) associated translation</span>
<a name="727"><font size=-1>727     </font></a><span class="string">* 7 = Rhombohedral lattice.</span>
<a name="728"><font size=-1>728     </font></a><span class="string"></span>
<a name="729"><font size=-1>729     </font></a><span class="string">The user might also input directly these values, although they might not be</span>
<a name="730"><font size=-1>730     </font></a><span class="string">consistent with [[spgroup]].</span>
<a name="731"><font size=-1>731     </font></a><span class="string"></span>
<a name="732"><font size=-1>732     </font></a><span class="string">The space groups 146, 148, 155, 160, 161, 166, 167, when used with</span>
<a name="733"><font size=-1>733     </font></a><span class="string">[[spgaxor]] = 1 (hexagonal axes) will have [[brvltt]] = 7 and two associated</span>
<a name="734"><font size=-1>734     </font></a><span class="string">translations: (2/3, 1/3, 1/3) and (1/3, 2/3, 2/3).</span>
<a name="735"><font size=-1>735     </font></a><span class="string">For more details see the [[help:spacegroup]].</span>
<a name="736"><font size=-1>736     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="737"><font size=-1>737     </font></a><span class="default">),</span>
<a name="738"><font size=-1>738     </font></a><span class="default"></span>
<a name="739"><font size=-1>739     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="740"><font size=-1>740     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_algorithm&quot;</span><span class="default">,</span>
<a name="741"><font size=-1>741     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="742"><font size=-1>742     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="743"><font size=-1>743     </font></a><span class="default">    topics=[</span><span class="string">'BSE_basic'</span><span class="default">],</span>
<a name="744"><font size=-1>744     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="745"><font size=-1>745     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="746"><font size=-1>746     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter ALGORITHM&quot;</span><span class="default">,</span>
<a name="747"><font size=-1>747     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="748"><font size=-1>748     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="749"><font size=-1>749     </font></a><span class="string">This input variable defines the algorithm employed to calculate the macroscopic dielectric function.</span>
<a name="750"><font size=-1>750     </font></a><span class="string">Possible values are in [1, 2, 3]:</span>
<a name="751"><font size=-1>751     </font></a><span class="string"></span>
<a name="752"><font size=-1>752     </font></a><span class="string">* 1 --&gt; The macroscopic dielectric is obtained by performing a direct diagonalization</span>
<a name="753"><font size=-1>753     </font></a><span class="string">  of the excitonic Hamiltonian. Advantages: It gives direct access to the excitonic eigenvalues</span>
<a name="754"><font size=-1>754     </font></a><span class="string">  as well as to the oscillator strengths. Drawbacks: It is a very CPU- and memory-consuming approach</span>
<a name="755"><font size=-1>755     </font></a><span class="string">  as the size of the Hamiltonian scales as $(n_k * n_c * n_v)^2$ where $n_k$ is the number of k-point</span>
<a name="756"><font size=-1>756     </font></a><span class="string">  in the **full** Brillouin zone, and $n_c$ and $n_v$ are the number of conduction and valence states, respectively.</span>
<a name="757"><font size=-1>757     </font></a><span class="string">  Pros: It can be used both for resonant-only and resonant + coupling calculations (non Tamm-Dancoff approximation).</span>
<a name="758"><font size=-1>758     </font></a><span class="string"></span>
<a name="759"><font size=-1>759     </font></a><span class="string">* 2 --&gt; Haydock iterative method. The macroscopic dielectric function is obtained by iterative applications</span>
<a name="760"><font size=-1>760     </font></a><span class="string">  of the Hamiltonian on a set of vectors in the electron-hole space.</span>
<a name="761"><font size=-1>761     </font></a><span class="string">  Advantages: It is less memory demanding and usually faster than the direct diagonalization provided</span>
<a name="762"><font size=-1>762     </font></a><span class="string">  that [[zcut]] is larger than the typical energy spacing of the eigenvalues. Drawbacks:</span>
<a name="763"><font size=-1>763     </font></a><span class="string">  It is an iterative method therefore the convergence with respect to [[bs_haydock_niter]] should be checked.</span>
<a name="764"><font size=-1>764     </font></a><span class="string">  It is not possible to have direct information on the exciton spectrum, oscillator strengths and excitonic wave functions.</span>
<a name="765"><font size=-1>765     </font></a><span class="string">  For the time being [[bs_algorithm]] = 2 cannot be used for calculations in which the coupling</span>
<a name="766"><font size=-1>766     </font></a><span class="string">  term is included (Tamm-Dancoff approximation).</span>
<a name="767"><font size=-1>767     </font></a><span class="string"></span>
<a name="768"><font size=-1>768     </font></a><span class="string">* 3 --&gt; Conjugate-gradient method. This method allows one to find the few first excitonic eigenvalues.</span>
<a name="769"><font size=-1>769     </font></a><span class="string">  Only available for resonant calculations (Tamm-Dancoff approximation).</span>
<a name="770"><font size=-1>770     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="771"><font size=-1>771     </font></a><span class="default">),</span>
<a name="772"><font size=-1>772     </font></a><span class="default"></span>
<a name="773"><font size=-1>773     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="774"><font size=-1>774     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_calctype&quot;</span><span class="default">,</span>
<a name="775"><font size=-1>775     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="776"><font size=-1>776     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="777"><font size=-1>777     </font></a><span class="default">    topics=[</span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="778"><font size=-1>778     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="779"><font size=-1>779     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="780"><font size=-1>780     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter CALCulation TYPE&quot;</span><span class="default">,</span>
<a name="781"><font size=-1>781     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="782"><font size=-1>782     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="783"><font size=-1>783     </font></a><span class="string">Possible values are in [1, 2, 3].</span>
<a name="784"><font size=-1>784     </font></a><span class="string"></span>
<a name="785"><font size=-1>785     </font></a><span class="string">* 1 --&gt; use the KS eigenvalues and wave functions stored in the WFK file to construct the transition space</span>
<a name="786"><font size=-1>786     </font></a><span class="string">* 2 --&gt; The transition space is constructed with Kohn-Sham orbitals but the energies are read from an external GW file</span>
<a name="787"><font size=-1>787     </font></a><span class="string">* 3 --&gt; QP amplitudes and energies will be read from the QPS file and used to construct H_ex.</span>
<a name="788"><font size=-1>788     </font></a><span class="string">  Not coded yet because &lt;\psi|r|\psj&gt;^QP should be calculated taking into account the non-locality</span>
<a name="789"><font size=-1>789     </font></a><span class="string">  of the self-energy in the commutator [H,r].</span>
<a name="790"><font size=-1>790     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="791"><font size=-1>791     </font></a><span class="default">),</span>
<a name="792"><font size=-1>792     </font></a><span class="default"></span>
<a name="793"><font size=-1>793     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="794"><font size=-1>794     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_coulomb_term&quot;</span><span class="default">,</span>
<a name="795"><font size=-1>795     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="796"><font size=-1>796     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="797"><font size=-1>797     </font></a><span class="default">    topics=[</span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="798"><font size=-1>798     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="799"><font size=-1>799     </font></a><span class="default">    defaultval=</span><span class="number">11</span><span class="default">,</span>
<a name="800"><font size=-1>800     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter COULOMB TERM&quot;</span><span class="default">,</span>
<a name="801"><font size=-1>801     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="802"><font size=-1>802     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="803"><font size=-1>803     </font></a><span class="string">This variable governs the choice among the different options that are</span>
<a name="804"><font size=-1>804     </font></a><span class="string">available for the treatment of Coulomb term of the Bethe-Salpeter Hamiltonian.</span>
<a name="805"><font size=-1>805     </font></a><span class="string">**bs_coulomb_term** is the concatenation of two digits, labelled (A) and (B).</span>
<a name="806"><font size=-1>806     </font></a><span class="string"></span>
<a name="807"><font size=-1>807     </font></a><span class="string">The first digit (A) can assume the values 0, 1, 2:</span>
<a name="808"><font size=-1>808     </font></a><span class="string"></span>
<a name="809"><font size=-1>809     </font></a><span class="string">  * 0 --&gt; The Coulomb term is not computed. This choice is equivalent to computing the RPA spectrum</span>
<a name="810"><font size=-1>810     </font></a><span class="string">    but using the representation in transition space instead of the more efficient approach based on the sum over states.</span>
<a name="811"><font size=-1>811     </font></a><span class="string"></span>
<a name="812"><font size=-1>812     </font></a><span class="string">  * 1 --&gt; The Coulomb term is computed using the screened interaction read</span>
<a name="813"><font size=-1>813     </font></a><span class="string">    from an external SCR file (standard excitonic calculation).</span>
<a name="814"><font size=-1>814     </font></a><span class="string"></span>
<a name="815"><font size=-1>815     </font></a><span class="string">  * 2 --&gt; The Coulomb term is computed using a model screening function</span>
<a name="816"><font size=-1>816     </font></a><span class="string">    (useful for convergence studies or for reproducing published results).</span>
<a name="817"><font size=-1>817     </font></a><span class="string"></span>
<a name="818"><font size=-1>818     </font></a><span class="string">The second digit (B) can assume the values 0,1:</span>
<a name="819"><font size=-1>819     </font></a><span class="string"></span>
<a name="820"><font size=-1>820     </font></a><span class="string">  * 0 --&gt; Use a diagonal approximation for $W_{\GG\GG'}$ (mainly used for accelerating convergence studies).</span>
<a name="821"><font size=-1>821     </font></a><span class="string"></span>
<a name="822"><font size=-1>822     </font></a><span class="string">  * 1 --&gt; The Coulomb term is correctly evaluated using the truly non-local screening $W(\rr,\rr')$.</span>
<a name="823"><font size=-1>823     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="824"><font size=-1>824     </font></a><span class="default">),</span>
<a name="825"><font size=-1>825     </font></a><span class="default"></span>
<a name="826"><font size=-1>826     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="827"><font size=-1>827     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_coupling&quot;</span><span class="default">,</span>
<a name="828"><font size=-1>828     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="829"><font size=-1>829     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="830"><font size=-1>830     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="831"><font size=-1>831     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="832"><font size=-1>832     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="833"><font size=-1>833     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter COUPLING&quot;</span><span class="default">,</span>
<a name="834"><font size=-1>834     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="835"><font size=-1>835     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="836"><font size=-1>836     </font></a><span class="string">The **bs_coupling** input variable defines the treatment of the coupling block</span>
<a name="837"><font size=-1>837     </font></a><span class="string">of the Bethe-Salpeter Hamiltonian. Possible values are 0, 1.</span>
<a name="838"><font size=-1>838     </font></a><span class="string"></span>
<a name="839"><font size=-1>839     </font></a><span class="string">  * 0 --&gt; The coupling block is neglected (the so-called Tamm-Dancoff approximation).</span>
<a name="840"><font size=-1>840     </font></a><span class="string">    The code runs faster and the Hamiltonian matrix requires less memory (factor 4).</span>
<a name="841"><font size=-1>841     </font></a><span class="string">    It is a good approximation for the absorption spectrum which only requires the knowledge of $\Im(\epsilon)$.</span>
<a name="842"><font size=-1>842     </font></a><span class="string">    The reliability of this approximation should be tested in the case of EELF calculations.</span>
<a name="843"><font size=-1>843     </font></a><span class="string"></span>
<a name="844"><font size=-1>844     </font></a><span class="string">  * 1 --&gt; The coupling term is included (non Tamm-Dancoff approximation).</span>
<a name="845"><font size=-1>845     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="846"><font size=-1>846     </font></a><span class="default">),</span>
<a name="847"><font size=-1>847     </font></a><span class="default"></span>
<a name="848"><font size=-1>848     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="849"><font size=-1>849     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_eh_cutoff&quot;</span><span class="default">,</span>
<a name="850"><font size=-1>850     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="851"><font size=-1>851     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="852"><font size=-1>852     </font></a><span class="default">    topics=[</span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="853"><font size=-1>853     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="854"><font size=-1>854     </font></a><span class="default">    defaultval=[</span><span class="string">&quot;-inf&quot;</span><span class="default">, </span><span class="string">&quot;inf&quot;</span><span class="default">],</span>
<a name="855"><font size=-1>855     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter Electron-Hole CUTOFF&quot;</span><span class="default">,</span>
<a name="856"><font size=-1>856     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="857"><font size=-1>857     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="858"><font size=-1>858     </font></a><span class="string">Used to define a cutoff in the e-h basis set. Only those transitions</span>
<a name="859"><font size=-1>859     </font></a><span class="string">whose energy is between bs_eh_cutoff(1) and bs_eh_cutoff(2) will be considered</span>
<a name="860"><font size=-1>860     </font></a><span class="string">in the construction of the e-h Hamiltonian.</span>
<a name="861"><font size=-1>861     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="862"><font size=-1>862     </font></a><span class="default">),</span>
<a name="863"><font size=-1>863     </font></a><span class="default"></span>
<a name="864"><font size=-1>864     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="865"><font size=-1>865     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_exchange_term&quot;</span><span class="default">,</span>
<a name="866"><font size=-1>866     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="867"><font size=-1>867     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="868"><font size=-1>868     </font></a><span class="default">    topics=[</span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="869"><font size=-1>869     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="870"><font size=-1>870     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="871"><font size=-1>871     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter EXCHANGE TERM&quot;</span><span class="default">,</span>
<a name="872"><font size=-1>872     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="873"><font size=-1>873     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="874"><font size=-1>874     </font></a><span class="string">* 0 --&gt; The exchange term is not calculated. This is equivalent to neglecting</span>
<a name="875"><font size=-1>875     </font></a><span class="string">  local field effects in the macroscopic dielectric function.</span>
<a name="876"><font size=-1>876     </font></a><span class="string">* 1 --&gt; The exchange term is calculated and added to the excitonic Hamiltonian.</span>
<a name="877"><font size=-1>877     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="878"><font size=-1>878     </font></a><span class="default">),</span>
<a name="879"><font size=-1>879     </font></a><span class="default"></span>
<a name="880"><font size=-1>880     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="881"><font size=-1>881     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_freq_mesh&quot;</span><span class="default">,</span>
<a name="882"><font size=-1>882     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="883"><font size=-1>883     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="884"><font size=-1>884     </font></a><span class="default">    topics=[</span><span class="string">'BSE_basic'</span><span class="default">],</span>
<a name="885"><font size=-1>885     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="886"><font size=-1>886     </font></a><span class="default">    defaultval=[</span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">, </span><span class="number">0.01</span><span class="default">],</span>
<a name="887"><font size=-1>887     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter FREQuency MESH&quot;</span><span class="default">,</span>
<a name="888"><font size=-1>888     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="889"><font size=-1>889     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="890"><font size=-1>890     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="891"><font size=-1>891     </font></a><span class="string">**bs_freq_mesh(1)** defines the first frequency for the calculation of the macroscopic dielectric function.</span>
<a name="892"><font size=-1>892     </font></a><span class="string"></span>
<a name="893"><font size=-1>893     </font></a><span class="string">**bs_freq_mesh(2)** gives the last frequency for the calculation of the</span>
<a name="894"><font size=-1>894     </font></a><span class="string">macroscopic dielectric function. If zero, **bs_freq_mesh(2)** is set automatically to MAX(resonant_energy) + 10%.</span>
<a name="895"><font size=-1>895     </font></a><span class="string"></span>
<a name="896"><font size=-1>896     </font></a><span class="string">**bs_freq_mesh(3)** gives the step of the linear mesh used for evaluating the macroscopic dielectric function.</span>
<a name="897"><font size=-1>897     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="898"><font size=-1>898     </font></a><span class="default">),</span>
<a name="899"><font size=-1>899     </font></a><span class="default"></span>
<a name="900"><font size=-1>900     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="901"><font size=-1>901     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_hayd_term&quot;</span><span class="default">,</span>
<a name="902"><font size=-1>902     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="903"><font size=-1>903     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="904"><font size=-1>904     </font></a><span class="default">    topics=[</span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="905"><font size=-1>905     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="906"><font size=-1>906     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="907"><font size=-1>907     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter HAYdock TERMinator&quot;</span><span class="default">,</span>
<a name="908"><font size=-1>908     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99 and [[bs_algorithm]] == 2&quot;</span><span class="default">,</span>
<a name="909"><font size=-1>909     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="910"><font size=-1>910     </font></a><span class="string">Defines how to terminate the continued fraction expression for the dielectric function.</span>
<a name="911"><font size=-1>911     </font></a><span class="string">The terminator reduces the number of iterations needed to converge</span>
<a name="912"><font size=-1>912     </font></a><span class="string">by smoothing the oscillation in the high energy part of the spectrum</span>
<a name="913"><font size=-1>913     </font></a><span class="string"></span>
<a name="914"><font size=-1>914     </font></a><span class="string">  * 0 --&gt; No terminator. The contribution given by the terms missing in the Lanczos chain are set to zero.</span>
<a name="915"><font size=-1>915     </font></a><span class="string">  * 1 --&gt; Use the terminator function. The particular expression depends on the type of calculation:</span>
<a name="916"><font size=-1>916     </font></a><span class="string">    In the resonant-only case, the $a_i$ and $b_i$ coefficients for $i &gt; \text{niter}$, are replaced</span>
<a name="917"><font size=-1>917     </font></a><span class="string">    by their values at $i = \text{niter}$.</span>
<a name="918"><font size=-1>918     </font></a><span class="string">    If the coupling block is included, the terminator function described in [[cite:Rocca2008]].</span>
<a name="919"><font size=-1>919     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="920"><font size=-1>920     </font></a><span class="default">),</span>
<a name="921"><font size=-1>921     </font></a><span class="default"></span>
<a name="922"><font size=-1>922     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="923"><font size=-1>923     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_haydock_niter&quot;</span><span class="default">,</span>
<a name="924"><font size=-1>924     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="925"><font size=-1>925     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="926"><font size=-1>926     </font></a><span class="default">    topics=[</span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="927"><font size=-1>927     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="928"><font size=-1>928     </font></a><span class="default">    defaultval=</span><span class="number">100</span><span class="default">,</span>
<a name="929"><font size=-1>929     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter HAYDOCK Number of ITERations&quot;</span><span class="default">,</span>
<a name="930"><font size=-1>930     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99 and [[bs_algorithm]] == 2&quot;</span><span class="default">,</span>
<a name="931"><font size=-1>931     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="932"><font size=-1>932     </font></a><span class="string">**bs_haydock_niter** defines the maximum number of iterations used to</span>
<a name="933"><font size=-1>933     </font></a><span class="string">calculate the macroscopic dielectric function.</span>
<a name="934"><font size=-1>934     </font></a><span class="string">The iterative algorithm stops when the difference between two consecutive</span>
<a name="935"><font size=-1>935     </font></a><span class="string">evaluations of the optical spectra is less than [[bs_haydock_tol]].</span>
<a name="936"><font size=-1>936     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="937"><font size=-1>937     </font></a><span class="default">),</span>
<a name="938"><font size=-1>938     </font></a><span class="default"></span>
<a name="939"><font size=-1>939     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="940"><font size=-1>940     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_haydock_tol&quot;</span><span class="default">,</span>
<a name="941"><font size=-1>941     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="942"><font size=-1>942     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="943"><font size=-1>943     </font></a><span class="default">    topics=[</span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="944"><font size=-1>944     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="945"><font size=-1>945     </font></a><span class="default">    defaultval=[</span><span class="number">0.02</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="946"><font size=-1>946     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter HAYDOCK TOLerance&quot;</span><span class="default">,</span>
<a name="947"><font size=-1>947     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99 and [[bs_algorithm]] == 2&quot;</span><span class="default">,</span>
<a name="948"><font size=-1>948     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="949"><font size=-1>949     </font></a><span class="string">Defines the convergence criterion for the Haydock iterative method.</span>
<a name="950"><font size=-1>950     </font></a><span class="string">The iterative algorithm stops when the difference between two consecutive</span>
<a name="951"><font size=-1>951     </font></a><span class="string">evaluations of the macroscopic dielectric function is less than **bs_haydock_tol(1)**.</span>
<a name="952"><font size=-1>952     </font></a><span class="string">The sign of **bs_haydock_tol(1)** defines how to estimate the convergence error.</span>
<a name="953"><font size=-1>953     </font></a><span class="string"></span>
<a name="954"><font size=-1>954     </font></a><span class="string">A negative value signals that the converge should be reached for each frequency (strict criterion), while a positive</span>
<a name="955"><font size=-1>955     </font></a><span class="string">value indicates that the converge error is estimated by averaging over the entire frequency range (mild criterion).</span>
<a name="956"><font size=-1>956     </font></a><span class="string"></span>
<a name="957"><font size=-1>957     </font></a><span class="string">**bs_haydock_tol(2)** defines the quantity that will be checked for convergence:</span>
<a name="958"><font size=-1>958     </font></a><span class="string"></span>
<a name="959"><font size=-1>959     </font></a><span class="string">  * 0 --&gt; both the real and the imaginary part must converge</span>
<a name="960"><font size=-1>960     </font></a><span class="string">  * 1 --&gt; only the real part</span>
<a name="961"><font size=-1>961     </font></a><span class="string">  * 2 --&gt; only the imaginary part</span>
<a name="962"><font size=-1>962     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="963"><font size=-1>963     </font></a><span class="default">),</span>
<a name="964"><font size=-1>964     </font></a><span class="default"></span>
<a name="965"><font size=-1>965     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="966"><font size=-1>966     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_interp_kmult&quot;</span><span class="default">,</span>
<a name="967"><font size=-1>967     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="968"><font size=-1>968     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="969"><font size=-1>969     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="970"><font size=-1>970     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="971"><font size=-1>971     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="972"><font size=-1>972     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter INTERPolation K-point MULTiplication factors&quot;</span><span class="default">,</span>
<a name="973"><font size=-1>973     </font></a><span class="default">    requires=</span><span class="string">&quot;[[bs_interp_mode]] &gt; 0 and [[bs_algorithm]] == 2 and [[bs_coupling]] == 0&quot;</span><span class="default">,</span>
<a name="974"><font size=-1>974     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="975"><font size=-1>975     </font></a><span class="string">**bs_interp_kmult** defines the number of divisions used to generate the dense mesh in the interpolation.</span>
<a name="976"><font size=-1>976     </font></a><span class="string">[[ngkpt]] of the dense mesh = **bs_interp_kmult(:)** * [[ngkpt]] of the coarse mesh.</span>
<a name="977"><font size=-1>977     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="978"><font size=-1>978     </font></a><span class="default">),</span>
<a name="979"><font size=-1>979     </font></a><span class="default"></span>
<a name="980"><font size=-1>980     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="981"><font size=-1>981     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_interp_m3_width&quot;</span><span class="default">,</span>
<a name="982"><font size=-1>982     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="983"><font size=-1>983     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="984"><font size=-1>984     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="985"><font size=-1>985     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="986"><font size=-1>986     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="987"><font size=-1>987     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter INTERPolation Method3 WIDTH&quot;</span><span class="default">,</span>
<a name="988"><font size=-1>988     </font></a><span class="default">    requires=</span><span class="string">&quot;[[bs_interp_mode]] == 3 and [[bs_algorithm]] == 2 and [[bs_coupling]] == 0&quot;</span><span class="default">,</span>
<a name="989"><font size=-1>989     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="990"><font size=-1>990     </font></a><span class="string">Defines the width of the region where divergence treatment is applied for BSE interpolation</span>
<a name="991"><font size=-1>991     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="992"><font size=-1>992     </font></a><span class="default">),</span>
<a name="993"><font size=-1>993     </font></a><span class="default"></span>
<a name="994"><font size=-1>994     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="995"><font size=-1>995     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_interp_method&quot;</span><span class="default">,</span>
<a name="996"><font size=-1>996     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="997"><font size=-1>997     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="998"><font size=-1>998     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="999"><font size=-1>999     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1000"><font size=-1>1000     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="1001"><font size=-1>1001     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter INTERPolation METHOD&quot;</span><span class="default">,</span>
<a name="1002"><font size=-1>1002     </font></a><span class="default">    requires=</span><span class="string">&quot;[[bs_interp_mode]] &gt; 0 and [[bs_algorithm]] == 2 and [[bs_coupling]] == 0&quot;</span><span class="default">,</span>
<a name="1003"><font size=-1>1003     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1004"><font size=-1>1004     </font></a><span class="string">*bs_interp_method* selects the interpolation method::</span>
<a name="1005"><font size=-1>1005     </font></a><span class="string"></span>
<a name="1006"><font size=-1>1006     </font></a><span class="string">  * 0 --&gt; Interpolate using Y. Gillet technique with 8 neighbours (see [[cite:Gillet2016]]).</span>
<a name="1007"><font size=-1>1007     </font></a><span class="string">  * 1 --&gt; Interpolation using Rohlfing &amp; Louie technique (see above-mentioned article and [[cite:Rohlfing2000]])</span>
<a name="1008"><font size=-1>1008     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1009"><font size=-1>1009     </font></a><span class="default">),</span>
<a name="1010"><font size=-1>1010     </font></a><span class="default"></span>
<a name="1011"><font size=-1>1011     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1012"><font size=-1>1012     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_interp_mode&quot;</span><span class="default">,</span>
<a name="1013"><font size=-1>1013     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="1014"><font size=-1>1014     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1015"><font size=-1>1015     </font></a><span class="default">    topics=[</span><span class="string">'BSE_basic'</span><span class="default">],</span>
<a name="1016"><font size=-1>1016     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1017"><font size=-1>1017     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1018"><font size=-1>1018     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter INTERPolation MODE&quot;</span><span class="default">,</span>
<a name="1019"><font size=-1>1019     </font></a><span class="default">    requires=</span><span class="string">&quot;[[bs_interp_mode]] &gt; 0 and [[bs_algorithm]] == 2 and [[bs_coupling]] == 0&quot;</span><span class="default">,</span>
<a name="1020"><font size=-1>1020     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1021"><font size=-1>1021     </font></a><span class="string">*bs_interp_mode* selects the mode of interpolation:</span>
<a name="1022"><font size=-1>1022     </font></a><span class="string"></span>
<a name="1023"><font size=-1>1023     </font></a><span class="string">  * 0 --&gt; No interpolation. Standard Bethe-Salpeter computation is performed</span>
<a name="1024"><font size=-1>1024     </font></a><span class="string">  * 1 --&gt; Simple interpolation</span>
<a name="1025"><font size=-1>1025     </font></a><span class="string">  * 2 --&gt; Treatment of the divergence on the whole set of dense k-points</span>
<a name="1026"><font size=-1>1026     </font></a><span class="string">  * 3 --&gt; Treatment of the divergence along the diagonal in k-space and simple interpolation elsewhere.</span>
<a name="1027"><font size=-1>1027     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1028"><font size=-1>1028     </font></a><span class="default">),</span>
<a name="1029"><font size=-1>1029     </font></a><span class="default"></span>
<a name="1030"><font size=-1>1030     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1031"><font size=-1>1031     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_interp_prep&quot;</span><span class="default">,</span>
<a name="1032"><font size=-1>1032     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="1033"><font size=-1>1033     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1034"><font size=-1>1034     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="1035"><font size=-1>1035     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1036"><font size=-1>1036     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1037"><font size=-1>1037     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter INTERPolation PREParation&quot;</span><span class="default">,</span>
<a name="1038"><font size=-1>1038     </font></a><span class="default">    requires=</span><span class="string">&quot;[[bs_interp_mode]] &gt; 0 and [[bs_algorithm]] == 2 and [[bs_coupling]] == 0&quot;</span><span class="default">,</span>
<a name="1039"><font size=-1>1039     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1040"><font size=-1>1040     </font></a><span class="string">*bs_interp_prep* allows one to trigger the preparation of the interpolation with method 2 or method 3.</span>
<a name="1041"><font size=-1>1041     </font></a><span class="string">It generates the decomposition of BSR in a, b, c coefficients used for the interpolation.</span>
<a name="1042"><font size=-1>1042     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1043"><font size=-1>1043     </font></a><span class="default">),</span>
<a name="1044"><font size=-1>1044     </font></a><span class="default"></span>
<a name="1045"><font size=-1>1045     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1046"><font size=-1>1046     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_interp_rl_nb&quot;</span><span class="default">,</span>
<a name="1047"><font size=-1>1047     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="1048"><font size=-1>1048     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1049"><font size=-1>1049     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="1050"><font size=-1>1050     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1051"><font size=-1>1051     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="1052"><font size=-1>1052     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter INTERPolation Rohlfing &amp; Louie NeighBour&quot;</span><span class="default">,</span>
<a name="1053"><font size=-1>1053     </font></a><span class="default">    requires=</span><span class="string">&quot;[[bs_interp_mode]] &gt; 0 and [[bs_algorithm]] == 2 and [[bs_interp_method]] == 1 and [[bs_coupling]] == 0&quot;</span><span class="default">,</span>
<a name="1054"><font size=-1>1054     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1055"><font size=-1>1055     </font></a><span class="string">Gives the index of the neighbour that is used in the Rohlfing and Louie method ([[cite:Rohlfing2000]])</span>
<a name="1056"><font size=-1>1056     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1057"><font size=-1>1057     </font></a><span class="default">),</span>
<a name="1058"><font size=-1>1058     </font></a><span class="default"></span>
<a name="1059"><font size=-1>1059     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1060"><font size=-1>1060     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_loband&quot;</span><span class="default">,</span>
<a name="1061"><font size=-1>1061     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="1062"><font size=-1>1062     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1063"><font size=-1>1063     </font></a><span class="default">    topics=[</span><span class="string">'BSE_compulsory'</span><span class="default">],</span>
<a name="1064"><font size=-1>1064     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nsppol]]'</span><span class="default">],</span>
<a name="1065"><font size=-1>1065     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1066"><font size=-1>1066     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter Lowest Occupied BAND&quot;</span><span class="default">,</span>
<a name="1067"><font size=-1>1067     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99&quot;</span><span class="default">,</span>
<a name="1068"><font size=-1>1068     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1069"><font size=-1>1069     </font></a><span class="string">This variable defines the index of the lowest occupied band used for the</span>
<a name="1070"><font size=-1>1070     </font></a><span class="string">construction of the electron-hole basis set. For spin polarized calculations,</span>
<a name="1071"><font size=-1>1071     </font></a><span class="string">one must provide two separated indices for spin up and spin down.</span>
<a name="1072"><font size=-1>1072     </font></a><span class="string">An additional cutoff energy can be applied by means of the [[bs_eh_cutoff]] input variable.</span>
<a name="1073"><font size=-1>1073     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1074"><font size=-1>1074     </font></a><span class="default">),</span>
<a name="1075"><font size=-1>1075     </font></a><span class="default"></span>
<a name="1076"><font size=-1>1076     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1077"><font size=-1>1077     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bs_nstates&quot;</span><span class="default">,</span>
<a name="1078"><font size=-1>1078     </font></a><span class="default">    varset=</span><span class="string">&quot;bse&quot;</span><span class="default">,</span>
<a name="1079"><font size=-1>1079     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1080"><font size=-1>1080     </font></a><span class="default">    topics=[</span><span class="string">'BSE_basic'</span><span class="default">],</span>
<a name="1081"><font size=-1>1081     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1082"><font size=-1>1082     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1083"><font size=-1>1083     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Bethe-Salpeter Number of STATES&quot;</span><span class="default">,</span>
<a name="1084"><font size=-1>1084     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99 and [[bs_algorithm]] in [2, 3]&quot;</span><span class="default">,</span>
<a name="1085"><font size=-1>1085     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1086"><font size=-1>1086     </font></a><span class="string">**bs_nstates** defines the maximum number of excitonic states calculated in</span>
<a name="1087"><font size=-1>1087     </font></a><span class="string">the direct diagonalization of the excitonic matrix or in the conjugate-gradient method.</span>
<a name="1088"><font size=-1>1088     </font></a><span class="string">The number of states should be sufficiently large for a</span>
<a name="1089"><font size=-1>1089     </font></a><span class="string">correct description of the optical properties in the frequency range of interest.</span>
<a name="1090"><font size=-1>1090     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1091"><font size=-1>1091     </font></a><span class="default">),</span>
<a name="1092"><font size=-1>1092     </font></a><span class="default"></span>
<a name="1093"><font size=-1>1093     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1094"><font size=-1>1094     </font></a><span class="default">    abivarname=</span><span class="string">&quot;builtintest&quot;</span><span class="default">,</span>
<a name="1095"><font size=-1>1095     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="1096"><font size=-1>1096     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1097"><font size=-1>1097     </font></a><span class="default">    topics=[</span><span class="string">'Control_expert'</span><span class="default">],</span>
<a name="1098"><font size=-1>1098     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1099"><font size=-1>1099     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1100"><font size=-1>1100     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BUIT-IN TEST number&quot;</span><span class="default">,</span>
<a name="1101"><font size=-1>1101     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="1102"><font size=-1>1102     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1103"><font size=-1>1103     </font></a><span class="string">When [[builtintest]] is non-zero, the input file is a special one, that runs</span>
<a name="1104"><font size=-1>1104     </font></a><span class="string">very quickly, and that is accompanied by a specific analysis by ABINIT, at the</span>
<a name="1105"><font size=-1>1105     </font></a><span class="string">end of the run, against a hard-coded value of total energy (and possibly</span>
<a name="1106"><font size=-1>1106     </font></a><span class="string">stresses, forces ...). The echo of the analysis is done in the STATUS file. In</span>
<a name="1107"><font size=-1>1107     </font></a><span class="string">particular, such built-in tests can be used to check quickly whether ABINIT</span>
<a name="1108"><font size=-1>1108     </font></a><span class="string">fallbacks have been connected or not (bigdft, etsf_io, libxc, wannier90). At</span>
<a name="1109"><font size=-1>1109     </font></a><span class="string">present, [[builtintest]] = 1... 7 are allowed. See more information in tests/built-in/README.</span>
<a name="1110"><font size=-1>1110     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1111"><font size=-1>1111     </font></a><span class="default">),</span>
<a name="1112"><font size=-1>1112     </font></a><span class="default"></span>
<a name="1113"><font size=-1>1113     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1114"><font size=-1>1114     </font></a><span class="default">    abivarname=</span><span class="string">&quot;bxctmindg&quot;</span><span class="default">,</span>
<a name="1115"><font size=-1>1115     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="1116"><font size=-1>1116     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1117"><font size=-1>1117     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="1118"><font size=-1>1118     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1119"><font size=-1>1119     </font></a><span class="default">    defaultval=</span><span class="number">2.0</span><span class="default">,</span>
<a name="1120"><font size=-1>1120     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;BoX CuT-off MINimum for the Double Grid (PAW)&quot;</span><span class="default">,</span>
<a name="1121"><font size=-1>1121     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="1122"><font size=-1>1122     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1123"><font size=-1>1123     </font></a><span class="string">The box cut-off ratio is the ratio between the wavefunction plane wave sphere</span>
<a name="1124"><font size=-1>1124     </font></a><span class="string">radius, and the radius of the sphere that can be inserted in the FFT box, in</span>
<a name="1125"><font size=-1>1125     </font></a><span class="string">reciprocal space.</span>
<a name="1126"><font size=-1>1126     </font></a><span class="string"></span>
<a name="1127"><font size=-1>1127     </font></a><span class="string">If the density was generated only from wavefunctions, this ratio should be at</span>
<a name="1128"><font size=-1>1128     </font></a><span class="string">least two in order for the density to be exact. If one uses a smaller ratio,</span>
<a name="1129"><font size=-1>1129     </font></a><span class="string">one will gain speed, at the expense of accuracy. In case of pure ground state</span>
<a name="1130"><font size=-1>1130     </font></a><span class="string">calculation (e.g. for the determination of geometries), this is sensible.</span>
<a name="1131"><font size=-1>1131     </font></a><span class="string">However, the wavefunctions that are obtained CANNOT be used for starting</span>
<a name="1132"><font size=-1>1132     </font></a><span class="string">response function calculation.</span>
<a name="1133"><font size=-1>1133     </font></a><span class="string"></span>
<a name="1134"><font size=-1>1134     </font></a><span class="string">However, some augmentation charge is always added in PAW, and even with the</span>
<a name="1135"><font size=-1>1135     </font></a><span class="string">box cut-off ratio larger than two, the density is never exact. Sometimes, this</span>
<a name="1136"><font size=-1>1136     </font></a><span class="string">ratio must be much larger than two for the computation to be converged at the</span>
<a name="1137"><font size=-1>1137     </font></a><span class="string">required level of accuracy.</span>
<a name="1138"><font size=-1>1138     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1139"><font size=-1>1139     </font></a><span class="default">),</span>
<a name="1140"><font size=-1>1140     </font></a><span class="default"></span>
<a name="1141"><font size=-1>1141     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1142"><font size=-1>1142     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cd_customnimfrqs&quot;</span><span class="default">,</span>
<a name="1143"><font size=-1>1143     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="1144"><font size=-1>1144     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1145"><font size=-1>1145     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="1146"><font size=-1>1146     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1147"><font size=-1>1147     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1148"><font size=-1>1148     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Contour Deformation CUSTOM IMaginary FReQuencieS&quot;</span><span class="default">,</span>
<a name="1149"><font size=-1>1149     </font></a><span class="default">    requires=</span><span class="string">&quot;([[optdriver]] ==3 or [[optdriver]] ==4) and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="1150"><font size=-1>1150     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1151"><font size=-1>1151     </font></a><span class="string">[[cd_customnimfrqs]] lets the user define the grid points along the imaginary</span>
<a name="1152"><font size=-1>1152     </font></a><span class="string">axis by hand. Set this to the number of frequencies you want. The frequencies</span>
<a name="1153"><font size=-1>1153     </font></a><span class="string">are specified with [[cd_imfrqs]].</span>
<a name="1154"><font size=-1>1154     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1155"><font size=-1>1155     </font></a><span class="default">),</span>
<a name="1156"><font size=-1>1156     </font></a><span class="default"></span>
<a name="1157"><font size=-1>1157     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1158"><font size=-1>1158     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cd_frqim_method&quot;</span><span class="default">,</span>
<a name="1159"><font size=-1>1159     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="1160"><font size=-1>1160     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1161"><font size=-1>1161     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="1162"><font size=-1>1162     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1163"><font size=-1>1163     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="1164"><font size=-1>1164     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Contour Deformation FReQuency integration on IMaginary axis Method&quot;</span><span class="default">,</span>
<a name="1165"><font size=-1>1165     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] ==4 and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="1166"><font size=-1>1166     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="1167"><font size=-1>1167     </font></a><span class="string">[[cd_frqim_method]] defines the choice of integration method along the</span>
<a name="1168"><font size=-1>1168     </font></a><span class="string">imaginary frequency axis for Contour Deformation calculations. The default</span>
<a name="1169"><font size=-1>1169     </font></a><span class="string">method is very robust, fast and optimal for the vast majority of cases.</span>
<a name="1170"><font size=-1>1170     </font></a><span class="string">However, for very accurate (&quot;paranoid level&quot;) convergence studies, ABINIT</span>
<a name="1171"><font size=-1>1171     </font></a><span class="string">offers the possibility of a variety of methods and grids. Note that as one</span>
<a name="1172"><font size=-1>1172     </font></a><span class="string">starts to change the defaults, one needs to carefully consider the grid used.</span>
<a name="1173"><font size=-1>1173     </font></a><span class="string">Therefore we recommend that in addition to reading the information below, the</span>
<a name="1174"><font size=-1>1174     </font></a><span class="string">user reads the description of the input variables [[freqim_alpha]],</span>
<a name="1175"><font size=-1>1175     </font></a><span class="string">[[nfreqim]], [[ppmfrq]], [[gw_frqim_inzgrid]].</span>
<a name="1176"><font size=-1>1176     </font></a><span class="string"></span>
<a name="1177"><font size=-1>1177     </font></a><span class="string">The integration to be performed for each matrix element of the self energy</span>
<a name="1178"><font size=-1>1178     </font></a><span class="string">along the imaginary axis is of the form:</span>
<a name="1179"><font size=-1>1179     </font></a><span class="string"></span>
<a name="1180"><font size=-1>1180     </font></a><span class="string">$$ \langle i|\Sigma(\omega)|j \rangle  \propto</span>
<a name="1181"><font size=-1>1181     </font></a><span class="string">   \sum_s C_s \int_0^\infty d(i\omega^\prime)</span>
<a name="1182"><font size=-1>1182     </font></a><span class="string">   \frac{(\omega - \epsilon_s)}{(\omega-\epsilon_s)^2 + i{\omega^\prime}^2}</span>
<a name="1183"><font size=-1>1183     </font></a><span class="string">   f(i\omega^\prime),</span>
<a name="1184"><font size=-1>1184     </font></a><span class="string">$$</span>
<a name="1185"><font size=-1>1185     </font></a><span class="string"></span>
<a name="1186"><font size=-1>1186     </font></a><span class="string">where  $\omega$ is the frequency point along the real axis, $\epsilon_s$ is an</span>
<a name="1187"><font size=-1>1187     </font></a><span class="string">eigenvalue, and  $i\omega^\prime$ is the variable along the imaginary axis. Thus the</span>
<a name="1188"><font size=-1>1188     </font></a><span class="string">function to be integrated is a Lorentzian weight function centred on the</span>
<a name="1189"><font size=-1>1189     </font></a><span class="string">origin (whose FWHM is decided by $|\omega-\epsilon_s|$), times a function. The</span>
<a name="1190"><font size=-1>1190     </font></a><span class="string">function is related to the inverse dielectric matrix. It might have a peaked</span>
<a name="1191"><font size=-1>1191     </font></a><span class="string">structure near the origin and is very smooth otherwise. the function decays</span>
<a name="1192"><font size=-1>1192     </font></a><span class="string">asymptotically as  $1/i\omega^\prime$, so the whole integral converges as this to</span>
<a name="1193"><font size=-1>1193     </font></a><span class="string">the third power.</span>
<a name="1194"><font size=-1>1194     </font></a><span class="string"></span>
<a name="1195"><font size=-1>1195     </font></a><span class="string">  * **cd_frqim_method = 1 - Histogram:** This is the **default** method where the function  $f(i\omega^\prime)$ is approximated by a histogram, and the Lorentzian is integrated analytically in each sub-interval. See the section on grids below for a description of the default grid. This method combined with the default grid is the fastest and optimised for the use of few points along the imaginary axis.</span>
<a name="1196"><font size=-1>1196     </font></a><span class="string">  * **cd_frqim_method = 2 - Trapezoid:** The next step up from the histogram approximation in the previous method. The integration region is transformed  $[0, \infty] \rightarrow [0,1]$ with a proper weight depending on the width of the Lorentzian. In this space  $f(i\omega^\prime)$ is approximated by a linear function between grid points (trapezoids), and the integrand is integrated analytically in each sub-interval. This method tends to slightly overestimate contributions while the default method tends to slightly underestimate them, so the results from methods 1 and 2 should bracket the converged values. The asymptotic behaviour is explicitly taken into account by a fit using the last two grid points.</span>
<a name="1197"><font size=-1>1197     </font></a><span class="string">  * **cd_frqim_method = 3, 4, 5 - Natural Spline:** The function is transformed  $[0, \infty] \rightarrow [0,1]$. In this space  $f(i\omega^\prime)$ is approximated by a natural spline function whose starting and ending sections are linear. This transform is chosen so that the function should approach a linear function asymptotically as the integration interval approaches 1, so that the asymptotic behaviour is automatically taken into account. For each Lorentzian width (determined by $|\omega-\epsilon_s|$) the integrand is appropriately scaled in the interval $[0,1]$, and a nested Gauss-Kronrod (GK) numerical integration rule is performed. The integrand is evaluated at the GK nodes by means of a spline-fit. The order of the GK rule is controlled by the index of the method:</span>
<a name="1198"><font size=-1>1198     </font></a><span class="string">    * 3 --&gt; Gauss 7 point, Kronrod 15 point rule.</span>
<a name="1199"><font size=-1>1199     </font></a><span class="string">    * 4 --&gt; Gauss 11 point, Kronrod 23 point rule.</span>
<a name="1200"><font size=-1>1200     </font></a><span class="string">    * 5 --&gt; Gauss 15 point, Kronrod 31 point rule.</span>
<a name="1201"><font size=-1>1201     </font></a><span class="string">There is rarely any difference to machine precision between these rules, and</span>
<a name="1202"><font size=-1>1202     </font></a><span class="string">the code will issue a warning if a higher-order rule is recommended.</span>
<a name="1203"><font size=-1>1203     </font></a><span class="string"></span>
<a name="1204"><font size=-1>1204     </font></a><span class="string">**Grids for the integral along the imaginary axis:**</span>
<a name="1205"><font size=-1>1205     </font></a><span class="string"></span>
<a name="1206"><font size=-1>1206     </font></a><span class="string">All the methods above should execute no matter what grid is used along the</span>
<a name="1207"><font size=-1>1207     </font></a><span class="string">imaginary axis, so this is very much under the control of the user. The only</span>
<a name="1208"><font size=-1>1208     </font></a><span class="string">requirement is that the grid be strictly increasing. The point at zero</span>
<a name="1209"><font size=-1>1209     </font></a><span class="string">frequency is assumed to lie on the real axis, so the calculation of that point</span>
<a name="1210"><font size=-1>1210     </font></a><span class="string">is controlled by [[nfreqre]] and corresponding variables. We highly recommend</span>
<a name="1211"><font size=-1>1211     </font></a><span class="string">extracting various elements of the dielectric matrix from the _SCR file using</span>
<a name="1212"><font size=-1>1212     </font></a><span class="string">the **Mrgscr** utility and plotting them for visual inspection.</span>
<a name="1213"><font size=-1>1213     </font></a><span class="string"></span>
<a name="1214"><font size=-1>1214     </font></a><span class="string">  * **Default** - The default grid is an exponentially increasing grid given by the formula:</span>
<a name="1215"><font size=-1>1215     </font></a><span class="string"></span>
<a name="1216"><font size=-1>1216     </font></a><span class="string">$$ i\omega^\prime_k = \frac{\omega_p}{\alpha-2}\left[ e^{\frac{2k}{N+1} \ln(\alpha-1)} -1 \right]. $$</span>
<a name="1217"><font size=-1>1217     </font></a><span class="string"></span>
<a name="1218"><font size=-1>1218     </font></a><span class="string">Here  $\omega_p$ is the plasma frequency (by default determined by the average</span>
<a name="1219"><font size=-1>1219     </font></a><span class="string">density of the system, but this can be overridden by setting [[ppmfrq]]).  $N$</span>
<a name="1220"><font size=-1>1220     </font></a><span class="string">is the total number of grid points (set by [[nfreqim]]). $\alpha$ is a parameter</span>
<a name="1221"><font size=-1>1221     </font></a><span class="string">which determines how far out the final grid point will lie. The final point</span>
<a name="1222"><font size=-1>1222     </font></a><span class="string">will be at  $\alpha*\omega_p$ (the default is  $\alpha = 5$, and was hard-coded in</span>
<a name="1223"><font size=-1>1223     </font></a><span class="string">older versions of ABINIT). This grid is designed so that approximately half</span>
<a name="1224"><font size=-1>1224     </font></a><span class="string">the grid points are always distributed to values lower than the plasma</span>
<a name="1225"><font size=-1>1225     </font></a><span class="string">frequency, in order to resolve any peaked structure. If one seeks to increase</span>
<a name="1226"><font size=-1>1226     </font></a><span class="string">the outermost reach by increasing [[ppmfrq]] one must simultaneously take care</span>
<a name="1227"><font size=-1>1227     </font></a><span class="string">to increase [[nfreqim]] in order to have the appropriate resolution for the</span>
<a name="1228"><font size=-1>1228     </font></a><span class="string">low-frequency region. In more recent versions of ABINIT one can also simply</span>
<a name="1229"><font size=-1>1229     </font></a><span class="string">adjust the parameter  $\alpha$ by using [[freqim_alpha]]. This grid is optimised</span>
<a name="1230"><font size=-1>1230     </font></a><span class="string">for speed and accurate results with few grid points for **cd_frqim_method = 1**.</span>
<a name="1231"><font size=-1>1231     </font></a><span class="string"></span>
<a name="1232"><font size=-1>1232     </font></a><span class="string">  * **Inverse z transform** - This grid is activated by the use of the variable [[gw_frqim_inzgrid]].</span>
<a name="1233"><font size=-1>1233     </font></a><span class="string">    This is the standard  $[0, \infty] \rightarrow [0,1]$ transform using the formula:</span>
<a name="1234"><font size=-1>1234     </font></a><span class="string"></span>
<a name="1235"><font size=-1>1235     </font></a><span class="string">$$ i\omega^\prime = \omega_p \frac{z}{1-z}. $$</span>
<a name="1236"><font size=-1>1236     </font></a><span class="string"></span>
<a name="1237"><font size=-1>1237     </font></a><span class="string">Here $\omega_p$ is the plasma frequency (default can be overridden by setting</span>
<a name="1238"><font size=-1>1238     </font></a><span class="string">[[ppmfrq]]). The grid points are then picked by an equidistant grid (number of</span>
<a name="1239"><font size=-1>1239     </font></a><span class="string">points set by [[nfreqim]]) in the interval  $z \subset [0,1]$. This grid can</span>
<a name="1240"><font size=-1>1240     </font></a><span class="string">easily be uniquely converged by just increasing [[nfreqim]]. Again the points</span>
<a name="1241"><font size=-1>1241     </font></a><span class="string">are distributed so that approximately half of them lie below the plasma</span>
<a name="1242"><font size=-1>1242     </font></a><span class="string">frequency.</span>
<a name="1243"><font size=-1>1243     </font></a><span class="string"></span>
<a name="1244"><font size=-1>1244     </font></a><span class="string">  * **User defined** - The user can also define their own grid using the variables [[cd_customnimfrqs]] and [[cd_imfrqs]].</span>
<a name="1245"><font size=-1>1245     </font></a><span class="string">    _With great power comes great responsibility!_</span>
<a name="1246"><font size=-1>1246     </font></a><span class="string"></span>
<a name="1247"><font size=-1>1247     </font></a><span class="string">The **Mrgscr** utility is handy in optimising the numerical effort expended in</span>
<a name="1248"><font size=-1>1248     </font></a><span class="string">convergence studies. By estimating the densest grid one can afford to</span>
<a name="1249"><font size=-1>1249     </font></a><span class="string">calculate in the SCR file, and successively removing frequencies from a single</span>
<a name="1250"><font size=-1>1250     </font></a><span class="string">file (using the utility), one only needs to perform the screening calculation</span>
<a name="1251"><font size=-1>1251     </font></a><span class="string">**once** on the dense mesh for a given convergence study. One can also use the</span>
<a name="1252"><font size=-1>1252     </font></a><span class="string">utility to merge independent screening calculations over q-points and</span>
<a name="1253"><font size=-1>1253     </font></a><span class="string">frequency sections.</span>
<a name="1254"><font size=-1>1254     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1255"><font size=-1>1255     </font></a><span class="default">),</span>
<a name="1256"><font size=-1>1256     </font></a><span class="default"></span>
<a name="1257"><font size=-1>1257     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1258"><font size=-1>1258     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cd_full_grid&quot;</span><span class="default">,</span>
<a name="1259"><font size=-1>1259     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="1260"><font size=-1>1260     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1261"><font size=-1>1261     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="1262"><font size=-1>1262     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1263"><font size=-1>1263     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1264"><font size=-1>1264     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Contour Deformation FULL GRID in complex plane&quot;</span><span class="default">,</span>
<a name="1265"><font size=-1>1265     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[gwcalctyp]] in [2, 9, 12, 19, 22, 29]&quot;</span><span class="default">,</span>
<a name="1266"><font size=-1>1266     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1267"><font size=-1>1267     </font></a><span class="string">[[cd_full_grid]] enables the calculation of the screening [both chi0 and</span>
<a name="1268"><font size=-1>1268     </font></a><span class="string">epsilon^(-1)] on a grid in the first quadrant of the complex plane. The grid</span>
<a name="1269"><font size=-1>1269     </font></a><span class="string">is determined by the (tensor) product of the grid in real frequency and the</span>
<a name="1270"><font size=-1>1270     </font></a><span class="string">grid in imaginary frequency. In the SUS and SCR files the grid points are</span>
<a name="1271"><font size=-1>1271     </font></a><span class="string">stored as follows:</span>
<a name="1272"><font size=-1>1272     </font></a><span class="string"></span>
<a name="1273"><font size=-1>1273     </font></a><span class="string">      **Index:**</span>
<a name="1274"><font size=-1>1274     </font></a><span class="string">      1   . . .   nfreqre   nfrqre+1 . . . nfreqre+nfreqim   nfreqre+nfreqim+1 . . . nfreqre*nfreqim</span>
<a name="1275"><font size=-1>1275     </font></a><span class="string">      **Entry:**</span>
<a name="1276"><font size=-1>1276     </font></a><span class="string">      | purely real freq.  |     purely imaginary freq.     |      gridpoints in complex plane        |</span>
<a name="1277"><font size=-1>1277     </font></a><span class="string"></span>
<a name="1278"><font size=-1>1278     </font></a><span class="string"></span>
<a name="1279"><font size=-1>1279     </font></a><span class="string">The grid in the complex plane is stored looping over the real dimension as the</span>
<a name="1280"><font size=-1>1280     </font></a><span class="string">inner loop and the imaginary as the outer loop. The contents of the generated</span>
<a name="1281"><font size=-1>1281     </font></a><span class="string">SUS and SCR files can be extracted for visualisation and further analysis with</span>
<a name="1282"><font size=-1>1282     </font></a><span class="string">the **Mrgscr** utility.</span>
<a name="1283"><font size=-1>1283     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1284"><font size=-1>1284     </font></a><span class="default">),</span>
<a name="1285"><font size=-1>1285     </font></a><span class="default"></span>
<a name="1286"><font size=-1>1286     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1287"><font size=-1>1287     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cd_halfway_freq&quot;</span><span class="default">,</span>
<a name="1288"><font size=-1>1288     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="1289"><font size=-1>1289     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1290"><font size=-1>1290     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="1291"><font size=-1>1291     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1292"><font size=-1>1292     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'eV'</span><span class="default">, value=</span><span class="number">100.0</span><span class="default">),</span>
<a name="1293"><font size=-1>1293     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Contour Deformation tangent grid HALFWAY FREQuency&quot;</span><span class="default">,</span>
<a name="1294"><font size=-1>1294     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="1295"><font size=-1>1295     </font></a><span class="default">    requires=</span><span class="string">&quot;([[optdriver]] == 3 or [[optdriver]] == 4) and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="1296"><font size=-1>1296     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1297"><font size=-1>1297     </font></a><span class="string">[[cd_halfway_freq]] determines the frequency where half of the number of</span>
<a name="1298"><font size=-1>1298     </font></a><span class="string">points defined in [[nfreqre]] are used up. The tangent transformed grid is</span>
<a name="1299"><font size=-1>1299     </font></a><span class="string">approximately linear up to this point. To be used in conjunction with [[gw_frqre_tangrid]].</span>
<a name="1300"><font size=-1>1300     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1301"><font size=-1>1301     </font></a><span class="default">),</span>
<a name="1302"><font size=-1>1302     </font></a><span class="default"></span>
<a name="1303"><font size=-1>1303     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1304"><font size=-1>1304     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cd_imfrqs&quot;</span><span class="default">,</span>
<a name="1305"><font size=-1>1305     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="1306"><font size=-1>1306     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1307"><font size=-1>1307     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="1308"><font size=-1>1308     </font></a><span class="default">    dimensions=[</span><span class="string">'[[cd_customnimfrqs]]'</span><span class="default">],</span>
<a name="1309"><font size=-1>1309     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Contour Deformation IMaginary FReQuencieS&quot;</span><span class="default">,</span>
<a name="1310"><font size=-1>1310     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[gwcalctyp]] in [2,9,12,19,22,29] and [[cd_customnimfrqs]] != 0&quot;</span><span class="default">,</span>
<a name="1311"><font size=-1>1311     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1312"><font size=-1>1312     </font></a><span class="string">[[cd_imfrqs]] specifies the grid points for the imaginary axis. The number of</span>
<a name="1313"><font size=-1>1313     </font></a><span class="string">frequencies is set by the value of [[cd_customnimfrqs]]. For example,</span>
<a name="1314"><font size=-1>1314     </font></a><span class="string"></span>
<a name="1315"><font size=-1>1315     </font></a><span class="string">    cd_customnimfrqs   5</span>
<a name="1316"><font size=-1>1316     </font></a><span class="string">    nfreqim            5</span>
<a name="1317"><font size=-1>1317     </font></a><span class="string">    cd_imfrqs          0.1  0.2  0.5  1.0  5.0</span>
<a name="1318"><font size=-1>1318     </font></a><span class="string"></span>
<a name="1319"><font size=-1>1319     </font></a><span class="string">If [[nfreqim]] is not equal to [[cd_customnimfrqs]] a warning will be issued.</span>
<a name="1320"><font size=-1>1320     </font></a><span class="string"></span>
<a name="1321"><font size=-1>1321     </font></a><span class="string">**Use at own risk!** The use of a custom grid makes it your responsibility</span>
<a name="1322"><font size=-1>1322     </font></a><span class="string">that the SUS and SCR files are valid in self-energy (i.e. [[optdriver]] = 4)</span>
<a name="1323"><font size=-1>1323     </font></a><span class="string">calculations, so caution is advised. Note that frequencies have to be strictly</span>
<a name="1324"><font size=-1>1324     </font></a><span class="string">increasing, and the point at zero frequency is **not** considered to be part</span>
<a name="1325"><font size=-1>1325     </font></a><span class="string">of the imaginary grid, but rather the grid along the real axis. The</span>
<a name="1326"><font size=-1>1326     </font></a><span class="string">calculation of that point should be controlled by [[nfreqre]] and related variables.</span>
<a name="1327"><font size=-1>1327     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1328"><font size=-1>1328     </font></a><span class="default">),</span>
<a name="1329"><font size=-1>1329     </font></a><span class="default"></span>
<a name="1330"><font size=-1>1330     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1331"><font size=-1>1331     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cd_max_freq&quot;</span><span class="default">,</span>
<a name="1332"><font size=-1>1332     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="1333"><font size=-1>1333     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1334"><font size=-1>1334     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="1335"><font size=-1>1335     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1336"><font size=-1>1336     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'eV'</span><span class="default">, value=</span><span class="number">1000.0</span><span class="default">),</span>
<a name="1337"><font size=-1>1337     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Contour Deformation grid MAXimum FREQuency&quot;</span><span class="default">,</span>
<a name="1338"><font size=-1>1338     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="1339"><font size=-1>1339     </font></a><span class="default">    requires=</span><span class="string">&quot;([[optdriver]] == 3 or [[optdriver]] == 4) and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="1340"><font size=-1>1340     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1341"><font size=-1>1341     </font></a><span class="string">[[cd_max_freq]] determines the frequency where all the points defined in</span>
<a name="1342"><font size=-1>1342     </font></a><span class="string">[[nfreqre]] are used up. To be used in conjunction with [[gw_frqre_tangrid]].</span>
<a name="1343"><font size=-1>1343     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1344"><font size=-1>1344     </font></a><span class="default">),</span>
<a name="1345"><font size=-1>1345     </font></a><span class="default"></span>
<a name="1346"><font size=-1>1346     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1347"><font size=-1>1347     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cd_subset_freq&quot;</span><span class="default">,</span>
<a name="1348"><font size=-1>1348     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="1349"><font size=-1>1349     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1350"><font size=-1>1350     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="1351"><font size=-1>1351     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="1352"><font size=-1>1352     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="string">'[[nfreqre]]'</span><span class="default">],</span>
<a name="1353"><font size=-1>1353     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Contour Deformation grid calculate SUBSET of FREQuencies&quot;</span><span class="default">,</span>
<a name="1354"><font size=-1>1354     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[gwcalctyp]] in [2,9,12,19,22,29] and  [[gw_frqre_tangrid]] == 0&quot;</span><span class="default">,</span>
<a name="1355"><font size=-1>1355     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1356"><font size=-1>1356     </font></a><span class="string">[[cd_subset_freq]] Specifies that only a subset of the frequencies defined by</span>
<a name="1357"><font size=-1>1357     </font></a><span class="string">[[nfreqre]] are to be calculated. The first index is the start and the second</span>
<a name="1358"><font size=-1>1358     </font></a><span class="string">the end, with index number 1 always being the origin. For example a</span>
<a name="1359"><font size=-1>1359     </font></a><span class="string">calculation with **[[nfreqre]] = 100** could be separated into two datasets with:</span>
<a name="1360"><font size=-1>1360     </font></a><span class="string"></span>
<a name="1361"><font size=-1>1361     </font></a><span class="string">    subset_freq1   1   50</span>
<a name="1362"><font size=-1>1362     </font></a><span class="string">    subset_freq2   51  100</span>
<a name="1363"><font size=-1>1363     </font></a><span class="string"></span>
<a name="1364"><font size=-1>1364     </font></a><span class="string">Any resulting susceptibility (_SUS) and screening (_SCR) files can then be</span>
<a name="1365"><font size=-1>1365     </font></a><span class="string">merged with the **mrgscr** utility.</span>
<a name="1366"><font size=-1>1366     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1367"><font size=-1>1367     </font></a><span class="default">),</span>
<a name="1368"><font size=-1>1368     </font></a><span class="default"></span>
<a name="1369"><font size=-1>1369     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1370"><font size=-1>1370     </font></a><span class="default">    abivarname=</span><span class="string">&quot;charge&quot;</span><span class="default">,</span>
<a name="1371"><font size=-1>1371     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="1372"><font size=-1>1372     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1373"><font size=-1>1373     </font></a><span class="default">    topics=[</span><span class="string">'Coulomb_basic'</span><span class="default">],</span>
<a name="1374"><font size=-1>1374     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1375"><font size=-1>1375     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1376"><font size=-1>1376     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CHARGE&quot;</span><span class="default">,</span>
<a name="1377"><font size=-1>1377     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1378"><font size=-1>1378     </font></a><span class="string">Used to establish charge balance between the number of electrons filling the</span>
<a name="1379"><font size=-1>1379     </font></a><span class="string">bands and the nominal [[charge]] associated with the atomic cores.</span>
<a name="1380"><font size=-1>1380     </font></a><span class="string">The code adds up the number of valence electrons provided by the</span>
<a name="1381"><font size=-1>1381     </font></a><span class="string">pseudopotentials of each type (call this &quot;zval&quot;), then add [[charge]], to get</span>
<a name="1382"><font size=-1>1382     </font></a><span class="string">the number of electrons per unit cell, [[nelect]].</span>
<a name="1383"><font size=-1>1383     </font></a><span class="string">Then, if [[iscf]] is positive, the code adds up the band occupancies (given in</span>
<a name="1384"><font size=-1>1384     </font></a><span class="string">array [[occ]]) for all bands at each k point, then multiplies by the k point</span>
<a name="1385"><font size=-1>1385     </font></a><span class="string">weight [[wtk]] at each k point. Call this sum &quot;nelect_occ&quot; (for the number of</span>
<a name="1386"><font size=-1>1386     </font></a><span class="string">electrons from occupation numbers). It is then required that: nelect_occ = [[nelect]].</span>
<a name="1387"><font size=-1>1387     </font></a><span class="string">To treat a neutral system, which is desired in nearly all cases, one must use</span>
<a name="1388"><font size=-1>1388     </font></a><span class="string">[[charge]] = 0. To treat a system missing one electron per unit cell, set [[charge]] = +1.</span>
<a name="1389"><font size=-1>1389     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1390"><font size=-1>1390     </font></a><span class="default">),</span>
<a name="1391"><font size=-1>1391     </font></a><span class="default"></span>
<a name="1392"><font size=-1>1392     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1393"><font size=-1>1393     </font></a><span class="default">    abivarname=</span><span class="string">&quot;chempot&quot;</span><span class="default">,</span>
<a name="1394"><font size=-1>1394     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="1395"><font size=-1>1395     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1396"><font size=-1>1396     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_expert'</span><span class="default">],</span>
<a name="1397"><font size=-1>1397     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nzchempot]]'</span><span class="default">, </span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="1398"><font size=-1>1398     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="1399"><font size=-1>1399     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;spatially varying CHEMical POTential&quot;</span><span class="default">,</span>
<a name="1400"><font size=-1>1400     </font></a><span class="default">    requires=</span><span class="string">&quot;[[nzchempot]] /= 0&quot;</span><span class="default">,</span>
<a name="1401"><font size=-1>1401     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1402"><font size=-1>1402     </font></a><span class="string">For each type of atoms, from 1 to [[ntypat]], specifies the spatially varying</span>
<a name="1403"><font size=-1>1403     </font></a><span class="string">chemical potential, through the specification of [[nzchempot]] triplets of</span>
<a name="1404"><font size=-1>1404     </font></a><span class="string">real numbers. They give data for [[nzchempot]] delimiting planes, all parallel</span>
<a name="1405"><font size=-1>1405     </font></a><span class="string">to each other, each determined by its z reduced coordinate.</span>
<a name="1406"><font size=-1>1406     </font></a><span class="string"></span>
<a name="1407"><font size=-1>1407     </font></a><span class="string">The first real number is the z reduced coordinate of the delimiting plane.</span>
<a name="1408"><font size=-1>1408     </font></a><span class="string">The second real number is the value of the chemical potential for this type of atom on this</span>
<a name="1409"><font size=-1>1409     </font></a><span class="string">plane. The third real number is the derivative of the chemical potential for</span>
<a name="1410"><font size=-1>1410     </font></a><span class="string">this type of atom with respect to the z reduced coordinate, evaluated on this plane.</span>
<a name="1411"><font size=-1>1411     </font></a><span class="string"></span>
<a name="1412"><font size=-1>1412     </font></a><span class="string">In the space between delimiting planes, a piecewise cubic polynomial</span>
<a name="1413"><font size=-1>1413     </font></a><span class="string">interpolation is determined: the cubic polynomial between two delimiting</span>
<a name="1414"><font size=-1>1414     </font></a><span class="string">planes will have the imposed chemical potentials and derivatives on the two</span>
<a name="1415"><font size=-1>1415     </font></a><span class="string">delimiting planes. The z reduced coordinates must be ordered in increasing</span>
<a name="1416"><font size=-1>1416     </font></a><span class="string">values, and cannot span more than 1.0. There is an automatic periodic</span>
<a name="1417"><font size=-1>1417     </font></a><span class="string">boundary condition imposed. Specifying two identical z reduced coordinates is</span>
<a name="1418"><font size=-1>1418     </font></a><span class="string">allowed, and means that the first one applies to the adjacent space with lower</span>
<a name="1419"><font size=-1>1419     </font></a><span class="string">values of z, while the second applies to the adjacent space with higher values</span>
<a name="1420"><font size=-1>1420     </font></a><span class="string">of z. When the spatial chemical potential is defined only for one type of atom</span>
<a name="1421"><font size=-1>1421     </font></a><span class="string">(and no chemical potential is present for the other atoms), simply set the</span>
<a name="1422"><font size=-1>1422     </font></a><span class="string">related values to *0.0 in the [[chempot]] array. In the present input array,</span>
<a name="1423"><font size=-1>1423     </font></a><span class="string">reduced positions, energies and derivatives of energies are mixed. Hence,</span>
<a name="1424"><font size=-1>1424     </font></a><span class="string">although the chemical potential is an energy, one cannot use the usual energy</span>
<a name="1425"><font size=-1>1425     </font></a><span class="string">definitions (i.e. the chemical potential is always to be input in Hartree atomic units).</span>
<a name="1426"><font size=-1>1426     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1427"><font size=-1>1427     </font></a><span class="default">),</span>
<a name="1428"><font size=-1>1428     </font></a><span class="default"></span>
<a name="1429"><font size=-1>1429     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1430"><font size=-1>1430     </font></a><span class="default">    abivarname=</span><span class="string">&quot;chkdilatmx&quot;</span><span class="default">,</span>
<a name="1431"><font size=-1>1431     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="1432"><font size=-1>1432     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1433"><font size=-1>1433     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="1434"><font size=-1>1434     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1435"><font size=-1>1435     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="1436"><font size=-1>1436     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CHecK DILATMX&quot;</span><span class="default">,</span>
<a name="1437"><font size=-1>1437     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1438"><font size=-1>1438     </font></a><span class="string">If 0, the code will not stop execution if the threshold of [[dilatmx]] is exceeded,</span>
<a name="1439"><font size=-1>1439     </font></a><span class="string">it will simply issue a warning. There will be no rescaling. If 1, after tentative</span>
<a name="1440"><font size=-1>1440     </font></a><span class="string">rescaling as described in [[dilatmx]], the code will stop execution.</span>
<a name="1441"><font size=-1>1441     </font></a><span class="string">Also, the use of [[chkdilatmx]] = 0 allows one to set [[dilatmx]] to a larger value than 1.15 ,</span>
<a name="1442"><font size=-1>1442     </font></a><span class="string">otherwise forbidden as being a waste of CPU and memory.</span>
<a name="1443"><font size=-1>1443     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1444"><font size=-1>1444     </font></a><span class="default">),</span>
<a name="1445"><font size=-1>1445     </font></a><span class="default"></span>
<a name="1446"><font size=-1>1446     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1447"><font size=-1>1447     </font></a><span class="default">    abivarname=</span><span class="string">&quot;chkexit&quot;</span><span class="default">,</span>
<a name="1448"><font size=-1>1448     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="1449"><font size=-1>1449     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1450"><font size=-1>1450     </font></a><span class="default">    topics=[</span><span class="string">'Control_useful'</span><span class="default">],</span>
<a name="1451"><font size=-1>1451     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1452"><font size=-1>1452     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1453"><font size=-1>1453     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CHecK whether the user want to EXIT&quot;</span><span class="default">,</span>
<a name="1454"><font size=-1>1454     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1455"><font size=-1>1455     </font></a><span class="string">If [[chkexit]] is 1 or 2, ABINIT will check whether the user wants to</span>
<a name="1456"><font size=-1>1456     </font></a><span class="string">interrupt the run (using the keyword &quot;exit&quot; on the top of the input file or</span>
<a name="1457"><font size=-1>1457     </font></a><span class="string">creating a file named &quot;abinit.exit&quot;: see the end of section 3.2</span>
<a name="1458"><font size=-1>1458     </font></a><span class="string">of the [[help:abinit#parameters]]).</span>
<a name="1459"><font size=-1>1459     </font></a><span class="string"></span>
<a name="1460"><font size=-1>1460     </font></a><span class="string">  * If [[chkexit]] = 0, the check is not performed at all</span>
<a name="1461"><font size=-1>1461     </font></a><span class="string">  * If [[chkexit]] = 1, the check is not performed frequently (after each SCF step)</span>
<a name="1462"><font size=-1>1462     </font></a><span class="string">  * If [[chkexit]] = 2, the check is performed frequently (after a few bands, at each k point)</span>
<a name="1463"><font size=-1>1463     </font></a><span class="string"></span>
<a name="1464"><font size=-1>1464     </font></a><span class="string">In all cases, the check is performed at most every 2 seconds of CPU time.</span>
<a name="1465"><font size=-1>1465     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1466"><font size=-1>1466     </font></a><span class="default">),</span>
<a name="1467"><font size=-1>1467     </font></a><span class="default"></span>
<a name="1468"><font size=-1>1468     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1469"><font size=-1>1469     </font></a><span class="default">    abivarname=</span><span class="string">&quot;chkprim&quot;</span><span class="default">,</span>
<a name="1470"><font size=-1>1470     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="1471"><font size=-1>1471     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1472"><font size=-1>1472     </font></a><span class="default">    topics=[</span><span class="string">'crystal_useful'</span><span class="default">, </span><span class="string">'UnitCell_useful'</span><span class="default">, </span><span class="string">'SmartSymm_useful'</span><span class="default">],</span>
<a name="1473"><font size=-1>1473     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1474"><font size=-1>1474     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="1475"><font size=-1>1475     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CHecK whether the cell is PRIMitive&quot;</span><span class="default">,</span>
<a name="1476"><font size=-1>1476     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1477"><font size=-1>1477     </font></a><span class="string">If the symmetry finder is used (see [[nsym]]), a non-zero value of [[chkprim]]</span>
<a name="1478"><font size=-1>1478     </font></a><span class="string">will make the code stop if a non-primitive cell is used. If [[chkprim]] = 0, a</span>
<a name="1479"><font size=-1>1479     </font></a><span class="string">warning is issued, but the run does not stop.</span>
<a name="1480"><font size=-1>1480     </font></a><span class="string"></span>
<a name="1481"><font size=-1>1481     </font></a><span class="string">If you are generating the atomic and cell geometry using [[spgroup]], you</span>
<a name="1482"><font size=-1>1482     </font></a><span class="string">might generate a PRIMITIVE cell using [[brvltt]] = -1.</span>
<a name="1483"><font size=-1>1483     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1484"><font size=-1>1484     </font></a><span class="default">),</span>
<a name="1485"><font size=-1>1485     </font></a><span class="default"></span>
<a name="1486"><font size=-1>1486     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1487"><font size=-1>1487     </font></a><span class="default">    abivarname=</span><span class="string">&quot;chksymbreak&quot;</span><span class="default">,</span>
<a name="1488"><font size=-1>1488     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="1489"><font size=-1>1489     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1490"><font size=-1>1490     </font></a><span class="default">    topics=[</span><span class="string">'k-points_basic'</span><span class="default">],</span>
<a name="1491"><font size=-1>1491     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1492"><font size=-1>1492     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="1493"><font size=-1>1493     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CHecK SYMmetry BREAKing&quot;</span><span class="default">,</span>
<a name="1494"><font size=-1>1494     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="1495"><font size=-1>1495     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1496"><font size=-1>1496     </font></a><span class="string">This variable governs the behaviour of the code when there are potential</span>
<a name="1497"><font size=-1>1497     </font></a><span class="string">source of symmetry breaking, related e.g. to the k point grid or the presence</span>
<a name="1498"><font size=-1>1498     </font></a><span class="string">of non-symmorphic translations which might not be coherent with the exchange-</span>
<a name="1499"><font size=-1>1499     </font></a><span class="string">correlation grid.</span>
<a name="1500"><font size=-1>1500     </font></a><span class="string"></span>
<a name="1501"><font size=-1>1501     </font></a><span class="string">When [[chksymbreak]] = 1, the code stops (or issue a warning) if:</span>
<a name="1502"><font size=-1>1502     </font></a><span class="string"></span>
<a name="1503"><font size=-1>1503     </font></a><span class="string">  * (1) The k point grid is non-symmetric, in case [[kptopt]] =1, 2, or 4;</span>
<a name="1504"><font size=-1>1504     </font></a><span class="string">  * (2) The non-symmorphic translation part of the symmetry operations has components that are not zero,</span>
<a name="1505"><font size=-1>1505     </font></a><span class="string">    or simple fractions, with 2, 3, 4, 6, 8 or 12 as denominators.</span>
<a name="1506"><font size=-1>1506     </font></a><span class="string"></span>
<a name="1507"><font size=-1>1507     </font></a><span class="string">When [[chksymbreak]] = 0, there is no such check.</span>
<a name="1508"><font size=-1>1508     </font></a><span class="string"></span>
<a name="1509"><font size=-1>1509     </font></a><span class="string">When [[chksymbreak]] = -1, the code stops if the condition (1) is met,</span>
<a name="1510"><font size=-1>1510     </font></a><span class="string">but in case the condition (2) is met, there will be a trial to shift the</span>
<a name="1511"><font size=-1>1511     </font></a><span class="string">atomic coordinates such as to obtain symmetry operations with the adequate non-symmorphic part.</span>
<a name="1512"><font size=-1>1512     </font></a><span class="string"></span>
<a name="1513"><font size=-1>1513     </font></a><span class="string">Explanation:</span>
<a name="1514"><font size=-1>1514     </font></a><span class="string">In the ground-state calculation, such breaking of the symmetry is usually</span>
<a name="1515"><font size=-1>1515     </font></a><span class="string">harmless. However, if the user is doing a calculation of phonons using DFPT</span>
<a name="1516"><font size=-1>1516     </font></a><span class="string">([[rfphon]] = 1), the convergence with respect to the number of k points will be</span>
<a name="1517"><font size=-1>1517     </font></a><span class="string">much worse with a non-symmetric grid than with a symmetric one. Also, if the</span>
<a name="1518"><font size=-1>1518     </font></a><span class="string">user is doing a GW calculation, the presence of non-symmorphic translations</span>
<a name="1519"><font size=-1>1519     </font></a><span class="string">that are not coherent with the FFT grid might cause problems. In the GW part,</span>
<a name="1520"><font size=-1>1520     </font></a><span class="string">indeed, one needs to reconstruct the wavefunctions in the full Brillouin zone</span>
<a name="1521"><font size=-1>1521     </font></a><span class="string">for calculating both the polarizability and the self-energy. The wavefunctions</span>
<a name="1522"><font size=-1>1522     </font></a><span class="string">in the full Brillouin zone are obtained from the irreducible wedge by applying</span>
<a name="1523"><font size=-1>1523     </font></a><span class="string">the symmetry operations of the space group of the crystal. In the present</span>
<a name="1524"><font size=-1>1524     </font></a><span class="string">implementation, the symmetrisation of the wavefunctions is done in real space</span>
<a name="1525"><font size=-1>1525     </font></a><span class="string">on the FFT mesh that, therefore, has to be coherent both with the rotational</span>
<a name="1526"><font size=-1>1526     </font></a><span class="string">part as well as with the fractional translation of each symmetry operation. If</span>
<a name="1527"><font size=-1>1527     </font></a><span class="string">the condition (2) is met, the GW code will not be able to find a symmetry</span>
<a name="1528"><font size=-1>1528     </font></a><span class="string">preserving FFT mesh.</span>
<a name="1529"><font size=-1>1529     </font></a><span class="string"></span>
<a name="1530"><font size=-1>1530     </font></a><span class="string">So, it was decided to warn the user about these possible problems already at</span>
<a name="1531"><font size=-1>1531     </font></a><span class="string">the level of the ground state calculations, although such warning might be irrelevant.</span>
<a name="1532"><font size=-1>1532     </font></a><span class="string"></span>
<a name="1533"><font size=-1>1533     </font></a><span class="string">If you encounter a problem outlined above, you have two choices: change your</span>
<a name="1534"><font size=-1>1534     </font></a><span class="string">atomic positions (translate them) such that the origin appears as the most</span>
<a name="1535"><font size=-1>1535     </font></a><span class="string">symmetric point; or ignore the problem, and set [[chksymbreak]] = 0.</span>
<a name="1536"><font size=-1>1536     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1537"><font size=-1>1537     </font></a><span class="default">),</span>
<a name="1538"><font size=-1>1538     </font></a><span class="default"></span>
<a name="1539"><font size=-1>1539     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1540"><font size=-1>1540     </font></a><span class="default">    abivarname=</span><span class="string">&quot;chneut&quot;</span><span class="default">,</span>
<a name="1541"><font size=-1>1541     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="1542"><font size=-1>1542     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1543"><font size=-1>1543     </font></a><span class="default">    topics=[</span><span class="string">'Phonons_useful'</span><span class="default">],</span>
<a name="1544"><font size=-1>1544     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1545"><font size=-1>1545     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1546"><font size=-1>1546     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CHarge NEUTrality treatment&quot;</span><span class="default">,</span>
<a name="1547"><font size=-1>1547     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1548"><font size=-1>1548     </font></a><span class="string">Set the treatment of the Charge Neutrality requirement for the effective charges.</span>
<a name="1549"><font size=-1>1549     </font></a><span class="string">Same meaning as the corresponding anaddb variable.</span>
<a name="1550"><font size=-1>1550     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1551"><font size=-1>1551     </font></a><span class="default">),</span>
<a name="1552"><font size=-1>1552     </font></a><span class="default"></span>
<a name="1553"><font size=-1>1553     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1554"><font size=-1>1554     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cineb_start&quot;</span><span class="default">,</span>
<a name="1555"><font size=-1>1555     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="1556"><font size=-1>1556     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1557"><font size=-1>1557     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_expert'</span><span class="default">],</span>
<a name="1558"><font size=-1>1558     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1559"><font size=-1>1559     </font></a><span class="default">    defaultval=</span><span class="number">7</span><span class="default">,</span>
<a name="1560"><font size=-1>1560     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Climbing-Image Nudged Elastic Band: STARTing iteration&quot;</span><span class="default">,</span>
<a name="1561"><font size=-1>1561     </font></a><span class="default">    requires=</span><span class="string">&quot;[[imgmov]] == 5 and [[neb_algo]] == 2&quot;</span><span class="default">,</span>
<a name="1562"><font size=-1>1562     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1563"><font size=-1>1563     </font></a><span class="string">Gives the index of the first CI-NEB iteration.</span>
<a name="1564"><font size=-1>1564     </font></a><span class="string">The CI-NEB method constitutes a small modification to the NEB method allowing</span>
<a name="1565"><font size=-1>1565     </font></a><span class="string">a rigorous convergence to the saddle point. As the image with the highest</span>
<a name="1566"><font size=-1>1566     </font></a><span class="string">energy has to be identified, the calculation begins with several iterations of</span>
<a name="1567"><font size=-1>1567     </font></a><span class="string">the standard NEB algorithm. The effective CI-NEB begins at the [[cineb_start]]</span>
<a name="1568"><font size=-1>1568     </font></a><span class="string">iteration. See [[cite:Henkelman2000a]] for additional details of this method.</span>
<a name="1569"><font size=-1>1569     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1570"><font size=-1>1570     </font></a><span class="default">),</span>
<a name="1571"><font size=-1>1571     </font></a><span class="default"></span>
<a name="1572"><font size=-1>1572     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1573"><font size=-1>1573     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cpuh&quot;</span><span class="default">,</span>
<a name="1574"><font size=-1>1574     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="1575"><font size=-1>1575     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1576"><font size=-1>1576     </font></a><span class="default">    topics=[</span><span class="string">'Control_useful'</span><span class="default">],</span>
<a name="1577"><font size=-1>1577     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1578"><font size=-1>1578     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="1579"><font size=-1>1579     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CPU time limit in Hours&quot;</span><span class="default">,</span>
<a name="1580"><font size=-1>1580     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">, </span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="1581"><font size=-1>1581     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[cpum]] or [[cpus]]&quot;</span><span class="default">,</span>
<a name="1582"><font size=-1>1582     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1583"><font size=-1>1583     </font></a><span class="string">Only one of the three real parameters [[cpus]], [[cpum]] and [[cpuh]] can be</span>
<a name="1584"><font size=-1>1584     </font></a><span class="string">defined in the input file to set up a CPU time limit. When the job reaches</span>
<a name="1585"><font size=-1>1585     </font></a><span class="string">that limit, it will try to end smoothly. However, note that this might still</span>
<a name="1586"><font size=-1>1586     </font></a><span class="string">take some time. If the user want a firm CPU time limit, the present parameter</span>
<a name="1587"><font size=-1>1587     </font></a><span class="string">must be reduced sufficiently. Intuition about the actual margin to be taken</span>
<a name="1588"><font size=-1>1588     </font></a><span class="string">into account should come with experience.</span>
<a name="1589"><font size=-1>1589     </font></a><span class="string">A zero value has no action of the job.</span>
<a name="1590"><font size=-1>1590     </font></a><span class="string"></span>
<a name="1591"><font size=-1>1591     </font></a><span class="string">!!! tip</span>
<a name="1592"><font size=-1>1592     </font></a><span class="string"></span>
<a name="1593"><font size=-1>1593     </font></a><span class="string">    One can pass the timelimit to abinit via the command line option:</span>
<a name="1594"><font size=-1>1594     </font></a><span class="string"></span>
<a name="1595"><font size=-1>1595     </font></a><span class="string">        abinit --timelimit hours:minutes:seconds</span>
<a name="1596"><font size=-1>1596     </font></a><span class="string"></span>
<a name="1597"><font size=-1>1597     </font></a><span class="string">    This approach is much more powerful especially when the job must be submitted</span>
<a name="1598"><font size=-1>1598     </font></a><span class="string">    to the queue via a submission script e.g. a Slurm script.</span>
<a name="1599"><font size=-1>1599     </font></a><span class="string">    In this case, indeed, one can define a shell variable for the time limit</span>
<a name="1600"><font size=-1>1600     </font></a><span class="string">    and use this variable to pass the time limit to Slurm and Abinit at the same time.</span>
<a name="1601"><font size=-1>1601     </font></a><span class="string"></span>
<a name="1602"><font size=-1>1602     </font></a><span class="string">    Use `abinit --help` for further information.</span>
<a name="1603"><font size=-1>1603     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1604"><font size=-1>1604     </font></a><span class="default">),</span>
<a name="1605"><font size=-1>1605     </font></a><span class="default"></span>
<a name="1606"><font size=-1>1606     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1607"><font size=-1>1607     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cpum&quot;</span><span class="default">,</span>
<a name="1608"><font size=-1>1608     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="1609"><font size=-1>1609     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1610"><font size=-1>1610     </font></a><span class="default">    topics=[</span><span class="string">'Control_useful'</span><span class="default">],</span>
<a name="1611"><font size=-1>1611     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1612"><font size=-1>1612     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="1613"><font size=-1>1613     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CPU time limit in Minutes&quot;</span><span class="default">,</span>
<a name="1614"><font size=-1>1614     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">, </span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="1615"><font size=-1>1615     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[cpuh]] or [[cpus]]&quot;</span><span class="default">,</span>
<a name="1616"><font size=-1>1616     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1617"><font size=-1>1617     </font></a><span class="string">Only one of the three real parameters [[cpus]], [[cpum]] and [[cpuh]] can be</span>
<a name="1618"><font size=-1>1618     </font></a><span class="string">defined in the input file to set up a CPU time limit. When the job reaches</span>
<a name="1619"><font size=-1>1619     </font></a><span class="string">that limit, it will try to end smoothly. However, note that this might still</span>
<a name="1620"><font size=-1>1620     </font></a><span class="string">take some time. If the user want a firm CPU time limit, the present parameter</span>
<a name="1621"><font size=-1>1621     </font></a><span class="string">must be reduced sufficiently. Intuition about the actual margin to be taken</span>
<a name="1622"><font size=-1>1622     </font></a><span class="string">into account should come with experience.</span>
<a name="1623"><font size=-1>1623     </font></a><span class="string">A zero value has no action of the job.</span>
<a name="1624"><font size=-1>1624     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1625"><font size=-1>1625     </font></a><span class="default">),</span>
<a name="1626"><font size=-1>1626     </font></a><span class="default"></span>
<a name="1627"><font size=-1>1627     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1628"><font size=-1>1628     </font></a><span class="default">    abivarname=</span><span class="string">&quot;cpus&quot;</span><span class="default">,</span>
<a name="1629"><font size=-1>1629     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="1630"><font size=-1>1630     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1631"><font size=-1>1631     </font></a><span class="default">    topics=[</span><span class="string">'Control_useful'</span><span class="default">],</span>
<a name="1632"><font size=-1>1632     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1633"><font size=-1>1633     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="1634"><font size=-1>1634     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;CPU time limit in seconds&quot;</span><span class="default">,</span>
<a name="1635"><font size=-1>1635     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">, </span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="1636"><font size=-1>1636     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[cpuh]] or [[cpum]]&quot;</span><span class="default">,</span>
<a name="1637"><font size=-1>1637     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1638"><font size=-1>1638     </font></a><span class="string">Only one of the three real parameters [[cpus]], [[cpum]] and [[cpuh]] can be</span>
<a name="1639"><font size=-1>1639     </font></a><span class="string">defined in the input file to set up a CPU time limit. When the job reaches</span>
<a name="1640"><font size=-1>1640     </font></a><span class="string">that limit, it will try to end smoothly. However, note that this might still</span>
<a name="1641"><font size=-1>1641     </font></a><span class="string">take some time. If the user want a firm CPU time limit, the present parameter</span>
<a name="1642"><font size=-1>1642     </font></a><span class="string">must be reduced sufficiently. Intuition about the actual margin to be taken</span>
<a name="1643"><font size=-1>1643     </font></a><span class="string">into account should come with experience...</span>
<a name="1644"><font size=-1>1644     </font></a><span class="string">A zero value has no action of the job.</span>
<a name="1645"><font size=-1>1645     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1646"><font size=-1>1646     </font></a><span class="default">),</span>
<a name="1647"><font size=-1>1647     </font></a><span class="default"></span>
<a name="1648"><font size=-1>1648     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1649"><font size=-1>1649     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert1_atpol&quot;</span><span class="default">,</span>
<a name="1650"><font size=-1>1650     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1651"><font size=-1>1651     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1652"><font size=-1>1652     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1653"><font size=-1>1653     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="1654"><font size=-1>1654     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">],</span>
<a name="1655"><font size=-1>1655     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 1: limits of ATomic POLarisations&quot;</span><span class="default">,</span>
<a name="1656"><font size=-1>1656     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1657"><font size=-1>1657     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1658"><font size=-1>1658     </font></a><span class="string">Controls the range of atoms for which displacements will be considered in non-</span>
<a name="1659"><font size=-1>1659     </font></a><span class="string">linear computations (using the 2n+1 theorem), for the 1st perturbation.</span>
<a name="1660"><font size=-1>1660     </font></a><span class="string">May take values from 1 to [[natom]], with **d3e_pert1_atpol** (1)&lt;=</span>
<a name="1661"><font size=-1>1661     </font></a><span class="string">**d3e_pert1_atpol** (2). See [[rfatpol]] for additional details.</span>
<a name="1662"><font size=-1>1662     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1663"><font size=-1>1663     </font></a><span class="default">),</span>
<a name="1664"><font size=-1>1664     </font></a><span class="default"></span>
<a name="1665"><font size=-1>1665     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1666"><font size=-1>1666     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert1_dir&quot;</span><span class="default">,</span>
<a name="1667"><font size=-1>1667     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1668"><font size=-1>1668     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1669"><font size=-1>1669     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1670"><font size=-1>1670     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="1671"><font size=-1>1671     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="1672"><font size=-1>1672     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 1: DIRections&quot;</span><span class="default">,</span>
<a name="1673"><font size=-1>1673     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1674"><font size=-1>1674     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1675"><font size=-1>1675     </font></a><span class="string">Gives the directions to be considered in non-linear computations (using the</span>
<a name="1676"><font size=-1>1676     </font></a><span class="string">2n+1 theorem), for the 1st perturbation.</span>
<a name="1677"><font size=-1>1677     </font></a><span class="string">The three elements corresponds to the three primitive vectors, either in real</span>
<a name="1678"><font size=-1>1678     </font></a><span class="string">space (atomic displacement), or in reciprocal space (electric field perturbation).</span>
<a name="1679"><font size=-1>1679     </font></a><span class="string">See [[rfdir]] for additional details.</span>
<a name="1680"><font size=-1>1680     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1681"><font size=-1>1681     </font></a><span class="default">),</span>
<a name="1682"><font size=-1>1682     </font></a><span class="default"></span>
<a name="1683"><font size=-1>1683     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1684"><font size=-1>1684     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert1_elfd&quot;</span><span class="default">,</span>
<a name="1685"><font size=-1>1685     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1686"><font size=-1>1686     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1687"><font size=-1>1687     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1688"><font size=-1>1688     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1689"><font size=-1>1689     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1690"><font size=-1>1690     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 1: ELectric FielD&quot;</span><span class="default">,</span>
<a name="1691"><font size=-1>1691     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1692"><font size=-1>1692     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1693"><font size=-1>1693     </font></a><span class="string">Turns on electric field perturbation in non-linear computation, as 1st</span>
<a name="1694"><font size=-1>1694     </font></a><span class="string">perturbation. Actually, such calculations requires first the non-self-</span>
<a name="1695"><font size=-1>1695     </font></a><span class="string">consistent calculation of derivatives with respect to k, independently of the</span>
<a name="1696"><font size=-1>1696     </font></a><span class="string">electric field perturbation itself. See [[rfelfd]] for additional details.</span>
<a name="1697"><font size=-1>1697     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1698"><font size=-1>1698     </font></a><span class="default">),</span>
<a name="1699"><font size=-1>1699     </font></a><span class="default"></span>
<a name="1700"><font size=-1>1700     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1701"><font size=-1>1701     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert1_phon&quot;</span><span class="default">,</span>
<a name="1702"><font size=-1>1702     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1703"><font size=-1>1703     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1704"><font size=-1>1704     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1705"><font size=-1>1705     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1706"><font size=-1>1706     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1707"><font size=-1>1707     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 1: PHONons&quot;</span><span class="default">,</span>
<a name="1708"><font size=-1>1708     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1709"><font size=-1>1709     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1710"><font size=-1>1710     </font></a><span class="string">Turns on atomic displacement perturbation in non-linear computation, as 1st perturbation.</span>
<a name="1711"><font size=-1>1711     </font></a><span class="string">See [[rfphon]] for additional details.</span>
<a name="1712"><font size=-1>1712     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1713"><font size=-1>1713     </font></a><span class="default">),</span>
<a name="1714"><font size=-1>1714     </font></a><span class="default"></span>
<a name="1715"><font size=-1>1715     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1716"><font size=-1>1716     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert2_atpol&quot;</span><span class="default">,</span>
<a name="1717"><font size=-1>1717     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1718"><font size=-1>1718     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1719"><font size=-1>1719     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1720"><font size=-1>1720     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="1721"><font size=-1>1721     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">],</span>
<a name="1722"><font size=-1>1722     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 2: limits of ATomic POLarisations&quot;</span><span class="default">,</span>
<a name="1723"><font size=-1>1723     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1724"><font size=-1>1724     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1725"><font size=-1>1725     </font></a><span class="string">Controls the range of atoms for which displacements will be considered in non-</span>
<a name="1726"><font size=-1>1726     </font></a><span class="string">linear computations (using the 2n+1 theorem), for the 2nd perturbation.</span>
<a name="1727"><font size=-1>1727     </font></a><span class="string">May take values from 1 to [[natom]], with **d3e_pert2_atpol** (1) &lt;= **d3e_pert2_atpol** (2).</span>
<a name="1728"><font size=-1>1728     </font></a><span class="string">See [[rfatpol]] for additional details.</span>
<a name="1729"><font size=-1>1729     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1730"><font size=-1>1730     </font></a><span class="default">),</span>
<a name="1731"><font size=-1>1731     </font></a><span class="default"></span>
<a name="1732"><font size=-1>1732     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1733"><font size=-1>1733     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert2_dir&quot;</span><span class="default">,</span>
<a name="1734"><font size=-1>1734     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1735"><font size=-1>1735     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1736"><font size=-1>1736     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1737"><font size=-1>1737     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="1738"><font size=-1>1738     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="1739"><font size=-1>1739     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 2: DIRections&quot;</span><span class="default">,</span>
<a name="1740"><font size=-1>1740     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1741"><font size=-1>1741     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1742"><font size=-1>1742     </font></a><span class="string">Gives the directions to be considered in non-linear computations (using the</span>
<a name="1743"><font size=-1>1743     </font></a><span class="string">2n+1 theorem), for the 2nd perturbation.</span>
<a name="1744"><font size=-1>1744     </font></a><span class="string">The three elements corresponds to the three primitive vectors, either in real</span>
<a name="1745"><font size=-1>1745     </font></a><span class="string">space (atomic displacement), or in reciprocal space (electric field perturbation).</span>
<a name="1746"><font size=-1>1746     </font></a><span class="string">See [[rfdir]] for additional details.</span>
<a name="1747"><font size=-1>1747     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1748"><font size=-1>1748     </font></a><span class="default">),</span>
<a name="1749"><font size=-1>1749     </font></a><span class="default"></span>
<a name="1750"><font size=-1>1750     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1751"><font size=-1>1751     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert2_elfd&quot;</span><span class="default">,</span>
<a name="1752"><font size=-1>1752     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1753"><font size=-1>1753     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1754"><font size=-1>1754     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1755"><font size=-1>1755     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1756"><font size=-1>1756     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1757"><font size=-1>1757     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 2: ELectric FielD&quot;</span><span class="default">,</span>
<a name="1758"><font size=-1>1758     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1759"><font size=-1>1759     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1760"><font size=-1>1760     </font></a><span class="string">Turns on electric field perturbation in non-linear computation, as 2nd</span>
<a name="1761"><font size=-1>1761     </font></a><span class="string">perturbation. Actually, such calculations requires first the non-self-</span>
<a name="1762"><font size=-1>1762     </font></a><span class="string">consistent calculation of derivatives with respect to k, independently of the</span>
<a name="1763"><font size=-1>1763     </font></a><span class="string">electric field perturbation itself. See [[rfelfd]] for additional details.</span>
<a name="1764"><font size=-1>1764     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1765"><font size=-1>1765     </font></a><span class="default">),</span>
<a name="1766"><font size=-1>1766     </font></a><span class="default"></span>
<a name="1767"><font size=-1>1767     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1768"><font size=-1>1768     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert2_phon&quot;</span><span class="default">,</span>
<a name="1769"><font size=-1>1769     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1770"><font size=-1>1770     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1771"><font size=-1>1771     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1772"><font size=-1>1772     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1773"><font size=-1>1773     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1774"><font size=-1>1774     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 2: PHONons&quot;</span><span class="default">,</span>
<a name="1775"><font size=-1>1775     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1776"><font size=-1>1776     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1777"><font size=-1>1777     </font></a><span class="string">Turns on atomic displacement perturbation in non-linear computation, as 2nd perturbation.</span>
<a name="1778"><font size=-1>1778     </font></a><span class="string">See [[rfphon]] for additional details.</span>
<a name="1779"><font size=-1>1779     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1780"><font size=-1>1780     </font></a><span class="default">),</span>
<a name="1781"><font size=-1>1781     </font></a><span class="default"></span>
<a name="1782"><font size=-1>1782     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1783"><font size=-1>1783     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert3_atpol&quot;</span><span class="default">,</span>
<a name="1784"><font size=-1>1784     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1785"><font size=-1>1785     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1786"><font size=-1>1786     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1787"><font size=-1>1787     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="1788"><font size=-1>1788     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">],</span>
<a name="1789"><font size=-1>1789     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 3: limits of ATomic POLarisations&quot;</span><span class="default">,</span>
<a name="1790"><font size=-1>1790     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1791"><font size=-1>1791     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1792"><font size=-1>1792     </font></a><span class="string">Controls the range of atoms for which displacements will be considered in non-</span>
<a name="1793"><font size=-1>1793     </font></a><span class="string">linear computations (using the 2n+1 theorem), for the 3rd perturbation.</span>
<a name="1794"><font size=-1>1794     </font></a><span class="string">May take values from 1 to [[natom]], with **d3e_pert3_atpol** (1)&lt;= **d3e_pert3_atpol** (2).</span>
<a name="1795"><font size=-1>1795     </font></a><span class="string">See [[rfatpol]] for additional details.</span>
<a name="1796"><font size=-1>1796     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1797"><font size=-1>1797     </font></a><span class="default">),</span>
<a name="1798"><font size=-1>1798     </font></a><span class="default"></span>
<a name="1799"><font size=-1>1799     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1800"><font size=-1>1800     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert3_dir&quot;</span><span class="default">,</span>
<a name="1801"><font size=-1>1801     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1802"><font size=-1>1802     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1803"><font size=-1>1803     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1804"><font size=-1>1804     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="1805"><font size=-1>1805     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="1806"><font size=-1>1806     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 3: DIRections&quot;</span><span class="default">,</span>
<a name="1807"><font size=-1>1807     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1808"><font size=-1>1808     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1809"><font size=-1>1809     </font></a><span class="string">Gives the directions to be considered in non-linear computations (using the</span>
<a name="1810"><font size=-1>1810     </font></a><span class="string">2n+1 theorem), for the 3rd perturbation.</span>
<a name="1811"><font size=-1>1811     </font></a><span class="string">The three elements corresponds to the three primitive vectors, either in real</span>
<a name="1812"><font size=-1>1812     </font></a><span class="string">space (atomic displacement), or in reciprocal space (electric field perturbation).</span>
<a name="1813"><font size=-1>1813     </font></a><span class="string">See [[rfdir]] for additional details.</span>
<a name="1814"><font size=-1>1814     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1815"><font size=-1>1815     </font></a><span class="default">),</span>
<a name="1816"><font size=-1>1816     </font></a><span class="default"></span>
<a name="1817"><font size=-1>1817     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1818"><font size=-1>1818     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert3_elfd&quot;</span><span class="default">,</span>
<a name="1819"><font size=-1>1819     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1820"><font size=-1>1820     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1821"><font size=-1>1821     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1822"><font size=-1>1822     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1823"><font size=-1>1823     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1824"><font size=-1>1824     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 3: ELectric FielD&quot;</span><span class="default">,</span>
<a name="1825"><font size=-1>1825     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1826"><font size=-1>1826     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1827"><font size=-1>1827     </font></a><span class="string">Turns on electric field perturbation in non-linear computation, as 3rd</span>
<a name="1828"><font size=-1>1828     </font></a><span class="string">perturbation. Actually, such calculations requires first the non-self-</span>
<a name="1829"><font size=-1>1829     </font></a><span class="string">consistent calculation of derivatives with respect to k, independently of the</span>
<a name="1830"><font size=-1>1830     </font></a><span class="string">electric field perturbation itself.</span>
<a name="1831"><font size=-1>1831     </font></a><span class="string">See [[rfelfd]] for additional details.</span>
<a name="1832"><font size=-1>1832     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1833"><font size=-1>1833     </font></a><span class="default">),</span>
<a name="1834"><font size=-1>1834     </font></a><span class="default"></span>
<a name="1835"><font size=-1>1835     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1836"><font size=-1>1836     </font></a><span class="default">    abivarname=</span><span class="string">&quot;d3e_pert3_phon&quot;</span><span class="default">,</span>
<a name="1837"><font size=-1>1837     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="1838"><font size=-1>1838     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1839"><font size=-1>1839     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_basic'</span><span class="default">],</span>
<a name="1840"><font size=-1>1840     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1841"><font size=-1>1841     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1842"><font size=-1>1842     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;3rd Derivative of Energy, mixed PERTurbation 3: PHONons&quot;</span><span class="default">,</span>
<a name="1843"><font size=-1>1843     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 5 (non-linear response computations)&quot;</span><span class="default">,</span>
<a name="1844"><font size=-1>1844     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1845"><font size=-1>1845     </font></a><span class="string">Turns on atomic displacement perturbation in non-linear computation, as 3rd perturbation.</span>
<a name="1846"><font size=-1>1846     </font></a><span class="string">See [[rfphon]] for additional details.</span>
<a name="1847"><font size=-1>1847     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1848"><font size=-1>1848     </font></a><span class="default">),</span>
<a name="1849"><font size=-1>1849     </font></a><span class="default"></span>
<a name="1850"><font size=-1>1850     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1851"><font size=-1>1851     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ddamp&quot;</span><span class="default">,</span>
<a name="1852"><font size=-1>1852     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="1853"><font size=-1>1853     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1854"><font size=-1>1854     </font></a><span class="default">    topics=[</span><span class="string">'Berry_useful'</span><span class="default">],</span>
<a name="1855"><font size=-1>1855     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1856"><font size=-1>1856     </font></a><span class="default">    defaultval=</span><span class="number">0.1</span><span class="default">,</span>
<a name="1857"><font size=-1>1857     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;electric Displacement field DAMPing parameter&quot;</span><span class="default">,</span>
<a name="1858"><font size=-1>1858     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] in [6, 16]&quot;</span><span class="default">,</span>
<a name="1859"><font size=-1>1859     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1860"><font size=-1>1860     </font></a><span class="string">In case [[berryopt]] = 6, the electric field is updated after each SCF iteration</span>
<a name="1861"><font size=-1>1861     </font></a><span class="string">according to $E_{n+1}=$[[ddamp]]$(D-4 \pi P_{n})+(1-$[[ddamp]]$)E_{n}$, where</span>
<a name="1862"><font size=-1>1862     </font></a><span class="string">$P_{n}$ and $E_{n}$ are the polarization and electric field after $n_{th}$ SCF</span>
<a name="1863"><font size=-1>1863     </font></a><span class="string">iteration. [[ddamp]] is a damping parameter used to control the convergence speed.</span>
<a name="1864"><font size=-1>1864     </font></a><span class="string">In case [[berryopt]] = 16, the electric field is updated after each SCF</span>
<a name="1865"><font size=-1>1865     </font></a><span class="string">iteration according to $e_{n+1}=$[[ddamp]]$(d-p_{n})+(1-$[[ddamp]]$)e_{n}$.</span>
<a name="1866"><font size=-1>1866     </font></a><span class="string">If you have difficulty getting convergence, try to reduce this value or reduce</span>
<a name="1867"><font size=-1>1867     </font></a><span class="string">maxestep. This parameter is used in finite electric displacement field</span>
<a name="1868"><font size=-1>1868     </font></a><span class="string">calculations (berryopt=6,16,17).</span>
<a name="1869"><font size=-1>1869     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1870"><font size=-1>1870     </font></a><span class="default">),</span>
<a name="1871"><font size=-1>1871     </font></a><span class="default"></span>
<a name="1872"><font size=-1>1872     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1873"><font size=-1>1873     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ddb_ngqpt&quot;</span><span class="default">,</span>
<a name="1874"><font size=-1>1874     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="1875"><font size=-1>1875     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1876"><font size=-1>1876     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="1877"><font size=-1>1877     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="1878"><font size=-1>1878     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="1879"><font size=-1>1879     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Derivative DataBase: Number of Grid points for Q-PoinTs&quot;</span><span class="default">,</span>
<a name="1880"><font size=-1>1880     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1881"><font size=-1>1881     </font></a><span class="string">This variable is mandatory when [[optdriver]] == 7. It defines the number of</span>
<a name="1882"><font size=-1>1882     </font></a><span class="string">divisions in the (homogeneous) q-mesh used to generate the DDB file. See also</span>
<a name="1883"><font size=-1>1883     </font></a><span class="string">the description of the [[getddb]] input variable.</span>
<a name="1884"><font size=-1>1884     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1885"><font size=-1>1885     </font></a><span class="default">),</span>
<a name="1886"><font size=-1>1886     </font></a><span class="default"></span>
<a name="1887"><font size=-1>1887     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1888"><font size=-1>1888     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ddb_shiftq&quot;</span><span class="default">,</span>
<a name="1889"><font size=-1>1889     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="1890"><font size=-1>1890     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1891"><font size=-1>1891     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="1892"><font size=-1>1892     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="1893"><font size=-1>1893     </font></a><span class="default">    defaultval=[</span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">],</span>
<a name="1894"><font size=-1>1894     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Derivative DataBase: SHIFT of the Q-points&quot;</span><span class="default">,</span>
<a name="1895"><font size=-1>1895     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1896"><font size=-1>1896     </font></a><span class="string">Only relevant when [[optdriver]] == 7. It defines the shift in the q-mesh used</span>
<a name="1897"><font size=-1>1897     </font></a><span class="string">to generate the DDB file, which is defined by the [[ddb_ngqpt]] input</span>
<a name="1898"><font size=-1>1898     </font></a><span class="string">variable. See [[shiftk]] for more information on the definition.</span>
<a name="1899"><font size=-1>1899     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1900"><font size=-1>1900     </font></a><span class="default">),</span>
<a name="1901"><font size=-1>1901     </font></a><span class="default"></span>
<a name="1902"><font size=-1>1902     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1903"><font size=-1>1903     </font></a><span class="default">    abivarname=</span><span class="string">&quot;delayperm&quot;</span><span class="default">,</span>
<a name="1904"><font size=-1>1904     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="1905"><font size=-1>1905     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1906"><font size=-1>1906     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="1907"><font size=-1>1907     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1908"><font size=-1>1908     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="1909"><font size=-1>1909     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DELAY between trials to PERMUTE atoms&quot;</span><span class="default">,</span>
<a name="1910"><font size=-1>1910     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1911"><font size=-1>1911     </font></a><span class="string">Delay (number of time steps) between trials to permute two atoms, in view of</span>
<a name="1912"><font size=-1>1912     </font></a><span class="string">accelerated search of minima. Still in development.</span>
<a name="1913"><font size=-1>1913     </font></a><span class="string"></span>
<a name="1914"><font size=-1>1914     </font></a><span class="string">See the routine moldyn.F90 and [[signperm]] for additional information.</span>
<a name="1915"><font size=-1>1915     </font></a><span class="string"></span>
<a name="1916"><font size=-1>1916     </font></a><span class="string">When [[delayperm]] is zero, there are no permutation trials.</span>
<a name="1917"><font size=-1>1917     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1918"><font size=-1>1918     </font></a><span class="default">),</span>
<a name="1919"><font size=-1>1919     </font></a><span class="default"></span>
<a name="1920"><font size=-1>1920     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1921"><font size=-1>1921     </font></a><span class="default">    abivarname=</span><span class="string">&quot;densfor_pred&quot;</span><span class="default">,</span>
<a name="1922"><font size=-1>1922     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="1923"><font size=-1>1923     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="1924"><font size=-1>1924     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_expert'</span><span class="default">, </span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="1925"><font size=-1>1925     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="1926"><font size=-1>1926     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[paral_kgb]] == 1'</span><span class="default">: </span><span class="string">'6'</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">2</span><span class="default">}),</span>
<a name="1927"><font size=-1>1927     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DENSity and FORces PREDictor&quot;</span><span class="default">,</span>
<a name="1928"><font size=-1>1928     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="1929"><font size=-1>1929     </font></a><span class="default">    requires=</span><span class="string">&quot;[[iscf]] &gt; 0&quot;</span><span class="default">,</span>
<a name="1930"><font size=-1>1930     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="1931"><font size=-1>1931     </font></a><span class="string">Used when [[iscf]] &gt; 0, to define:</span>
<a name="1932"><font size=-1>1932     </font></a><span class="string"></span>
<a name="1933"><font size=-1>1933     </font></a><span class="string">  - the way a change of density is derived from a change of atomic position,</span>
<a name="1934"><font size=-1>1934     </font></a><span class="string">  - the way forces are corrected when the SCF cycle is not converged.</span>
<a name="1935"><font size=-1>1935     </font></a><span class="string"></span>
<a name="1936"><font size=-1>1936     </font></a><span class="string">Supported values:</span>
<a name="1937"><font size=-1>1937     </font></a><span class="string"></span>
<a name="1938"><font size=-1>1938     </font></a><span class="string">  * 0 --&gt; density not changed (fixed charge), forces not corrected</span>
<a name="1939"><font size=-1>1939     </font></a><span class="string">  * 1 --&gt; density not changed, forces corrected with rigid ion hypothesis (atomic charge moved with atom)</span>
<a name="1940"><font size=-1>1940     </font></a><span class="string">  * 2 --&gt; density changed and forces corrected with rigid ion hypothesis (atomic charge moves with atom)</span>
<a name="1941"><font size=-1>1941     </font></a><span class="string">  * 3 --&gt; density changed and forces corrected with a different implementation of the rigid ion hypothesis</span>
<a name="1942"><font size=-1>1942     </font></a><span class="string">  * 4 --&gt; density not changed, forces corrected with the use of Harris functional formula (see note)</span>
<a name="1943"><font size=-1>1943     </font></a><span class="string">  * 5 --&gt; density changed using D. Alfe 2nd-order algorithm (see notes), forces not corrected</span>
<a name="1944"><font size=-1>1944     </font></a><span class="string">  * 6 --&gt; density changed using D. Alfe 2nd-order algorithm (see notes) and forces corrected with the use of Harris functional formula</span>
<a name="1945"><font size=-1>1945     </font></a><span class="string"></span>
<a name="1946"><font size=-1>1946     </font></a><span class="string">Similar negative values are also allowed (see the meaning later), for</span>
<a name="1947"><font size=-1>1947     </font></a><span class="string">development purposes only. No meaning for RF calculations.</span>
<a name="1948"><font size=-1>1948     </font></a><span class="string"></span>
<a name="1949"><font size=-1>1949     </font></a><span class="string">For the time being,</span>
<a name="1950"><font size=-1>1950     </font></a><span class="string"></span>
<a name="1951"><font size=-1>1951     </font></a><span class="string">  - [[densfor_pred]] = 3 must be used with [[ionmov]] = 4 and [[iscf]] = 5.</span>
<a name="1952"><font size=-1>1952     </font></a><span class="string">  - [[densfor_pred]] = 4, 5 or 6 must be used when band-FFT parallelism is selected.</span>
<a name="1953"><font size=-1>1953     </font></a><span class="string">  Otherwise, use [[densfor_pred]] = 2</span>
<a name="1954"><font size=-1>1954     </font></a><span class="string"></span>
<a name="1955"><font size=-1>1955     </font></a><span class="string"></span>
<a name="1956"><font size=-1>1956     </font></a><span class="string">!!! note &quot;concerning the correction of forces (use of [[densfor_pred]] = 1, 2, 3, 4 or 6)&quot;</span>
<a name="1957"><font size=-1>1957     </font></a><span class="string">    The force on the atom located at R is corrected by the addition of the following</span>
<a name="1958"><font size=-1>1958     </font></a><span class="string">    term: $F_{residual}=\int dr V_{residual} \frac{d \rho_{atomic}}{dR}$,</span>
<a name="1959"><font size=-1>1959     </font></a><span class="string">    where $\rho_{atomic}$ is an atomic (spherical) density.</span>
<a name="1960"><font size=-1>1960     </font></a><span class="string"></span>
<a name="1961"><font size=-1>1961     </font></a><span class="string">    - When such an atomic density ($\rho_{atomic}$) is found in the pseudopotential or</span>
<a name="1962"><font size=-1>1962     </font></a><span class="string">    PAW file, it is used. If not, a gaussian density (defined by [[densty]] parameter) is used.</span>
<a name="1963"><font size=-1>1963     </font></a><span class="string">    - When SCF mixing is done on the density ([[iscf]] &gt;= 10), the potential</span>
<a name="1964"><font size=-1>1964     </font></a><span class="string">    residual ($V_residual$) is obtained from the density residual with the first</span>
<a name="1965"><font size=-1>1965     </font></a><span class="string">    order formula $V_{residual}=\frac{dV}{d \rho} \rho_{residual}$</span>
<a name="1966"><font size=-1>1966     </font></a><span class="string">    and uses the exchange-correlation kernel</span>
<a name="1967"><font size=-1>1967     </font></a><span class="string">    $ \frac{dV_{xc}}{d\rho}=K_{xc}$ whose computation is time-consuming for GGA</span>
<a name="1968"><font size=-1>1968     </font></a><span class="string">    functionals. By default (positive values of [[densfor_pred]]), the local-</span>
<a name="1969"><font size=-1>1969     </font></a><span class="string">    density part of the GGA exchange-correlation kernel is used (even for GGA, for</span>
<a name="1970"><font size=-1>1970     </font></a><span class="string">    which it seems to give a reasonable accuracy). Using the full GGA exchange</span>
<a name="1971"><font size=-1>1971     </font></a><span class="string">    correlation kernel (so, including derivatives with respect to the gradient of</span>
<a name="1972"><font size=-1>1972     </font></a><span class="string">    the density) is always possible by giving a negative value to</span>
<a name="1973"><font size=-1>1973     </font></a><span class="string">    [[densfor_pred]]. In case of hybrid functionals, a similar correction term is</span>
<a name="1974"><font size=-1>1974     </font></a><span class="string">    added, although in the density mixing scheme, the related GGA kernel is used</span>
<a name="1975"><font size=-1>1975     </font></a><span class="string">    instead of the hybrid functional kernel.</span>
<a name="1976"><font size=-1>1976     </font></a><span class="string"></span>
<a name="1977"><font size=-1>1977     </font></a><span class="string">!!! note &quot;concerning the use of [[densfor_pred]] = 5 or 6 (density prediction)&quot;</span>
<a name="1978"><font size=-1>1978     </font></a><span class="string">    The algorithm is described in [[cite:Alfe1999]].</span>
<a name="1979"><font size=-1>1979     </font></a><span class="string">    It uses an atomic (spherical) density. When such an atomic density</span>
<a name="1980"><font size=-1>1980     </font></a><span class="string">    is found in the pseudopotential or PAW file, it is used. If not, a gaussian</span>
<a name="1981"><font size=-1>1981     </font></a><span class="string">    density (defined by [[densty]] parameter) is used.</span>
<a name="1982"><font size=-1>1982     </font></a><span class="string">    Also note that, to be efficient, this algorithm requires a minimum convergence</span>
<a name="1983"><font size=-1>1983     </font></a><span class="string">    of the SCF cycle; Typically, vres2 (or nres2) has to be small enough (10  -4 ...10 -5  ).</span>
<a name="1984"><font size=-1>1984     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="1985"><font size=-1>1985     </font></a><span class="default">),</span>
<a name="1986"><font size=-1>1986     </font></a><span class="default"></span>
<a name="1987"><font size=-1>1987     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="1988"><font size=-1>1988     </font></a><span class="default">    abivarname=</span><span class="string">&quot;densty&quot;</span><span class="default">,</span>
<a name="1989"><font size=-1>1989     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="1990"><font size=-1>1990     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="1991"><font size=-1>1991     </font></a><span class="default">    topics=[</span><span class="string">'xc_expert'</span><span class="default">],</span>
<a name="1992"><font size=-1>1992     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="1993"><font size=-1>1993     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="1994"><font size=-1>1994     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;initial DENSity for each TYpe of atom&quot;</span><span class="default">,</span>
<a name="1995"><font size=-1>1995     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="1996"><font size=-1>1996     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="1997"><font size=-1>1997     </font></a><span class="string">Gives a rough description of the initial GS density, for each type of atom.</span>
<a name="1998"><font size=-1>1998     </font></a><span class="string">This value is only used to create the first exchange and correlation</span>
<a name="1999"><font size=-1>1999     </font></a><span class="string">potential, and is not used anymore afterwards. For the time being, it</span>
<a name="2000"><font size=-1>2000     </font></a><span class="string">corresponds to an average radius (a.u.) of the density, and is used to</span>
<a name="2001"><font size=-1>2001     </font></a><span class="string">generate a gaussian density. If set to 0.0d0, an optimized value is used.</span>
<a name="2002"><font size=-1>2002     </font></a><span class="string">No meaning for RF calculations.</span>
<a name="2003"><font size=-1>2003     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2004"><font size=-1>2004     </font></a><span class="default">),</span>
<a name="2005"><font size=-1>2005     </font></a><span class="default"></span>
<a name="2006"><font size=-1>2006     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2007"><font size=-1>2007     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dfield&quot;</span><span class="default">,</span>
<a name="2008"><font size=-1>2008     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="2009"><font size=-1>2009     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2010"><font size=-1>2010     </font></a><span class="default">    topics=[</span><span class="string">'Berry_basic'</span><span class="default">],</span>
<a name="2011"><font size=-1>2011     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="2012"><font size=-1>2012     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="2013"><font size=-1>2013     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Displacement FIELD&quot;</span><span class="default">,</span>
<a name="2014"><font size=-1>2014     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] == 6 and [[efield]]&quot;</span><span class="default">,</span>
<a name="2015"><font size=-1>2015     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2016"><font size=-1>2016     </font></a><span class="string">In case [[berryopt]] = 6, [[dfield]] specifies the (unreduced) finite electric</span>
<a name="2017"><font size=-1>2017     </font></a><span class="string">displacement field vector, in atomic units, that is to be imposed as a</span>
<a name="2018"><font size=-1>2018     </font></a><span class="string">constraint during the calculation.</span>
<a name="2019"><font size=-1>2019     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2020"><font size=-1>2020     </font></a><span class="default">),</span>
<a name="2021"><font size=-1>2021     </font></a><span class="default"></span>
<a name="2022"><font size=-1>2022     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2023"><font size=-1>2023     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dfpt_sciss&quot;</span><span class="default">,</span>
<a name="2024"><font size=-1>2024     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="2025"><font size=-1>2025     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2026"><font size=-1>2026     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_useful'</span><span class="default">],</span>
<a name="2027"><font size=-1>2027     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2028"><font size=-1>2028     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2029"><font size=-1>2029     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DFPT SCISSor operator&quot;</span><span class="default">,</span>
<a name="2030"><font size=-1>2030     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="2031"><font size=-1>2031     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2032"><font size=-1>2032     </font></a><span class="string">It is the value of the &quot;scissors operator&quot;, the shift of conduction band</span>
<a name="2033"><font size=-1>2033     </font></a><span class="string">eigenvalues, used in response function calculations.</span>
<a name="2034"><font size=-1>2034     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[ecut]] has the</span>
<a name="2035"><font size=-1>2035     </font></a><span class="string">'[[ENERGY]]' characteristics (1 Ha=27.2113845 eV).</span>
<a name="2036"><font size=-1>2036     </font></a><span class="string">Typical use is for response to electric field ([[rfelfd]] = 3), but NOT for d/dk</span>
<a name="2037"><font size=-1>2037     </font></a><span class="string">([[rfelfd]] = 2) and phonon responses.</span>
<a name="2038"><font size=-1>2038     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2039"><font size=-1>2039     </font></a><span class="default">),</span>
<a name="2040"><font size=-1>2040     </font></a><span class="default"></span>
<a name="2041"><font size=-1>2041     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2042"><font size=-1>2042     </font></a><span class="default">    abivarname=</span><span class="string">&quot;diecut&quot;</span><span class="default">,</span>
<a name="2043"><font size=-1>2043     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2044"><font size=-1>2044     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2045"><font size=-1>2045     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_expert'</span><span class="default">],</span>
<a name="2046"><font size=-1>2046     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2047"><font size=-1>2047     </font></a><span class="default">    defaultval=</span><span class="number">2.2</span><span class="default">,</span>
<a name="2048"><font size=-1>2048     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DIElectric matrix energy CUToff&quot;</span><span class="default">,</span>
<a name="2049"><font size=-1>2049     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="2050"><font size=-1>2050     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2051"><font size=-1>2051     </font></a><span class="string">Kinetic energy cutoff that controls the number of planewaves used to represent</span>
<a name="2052"><font size=-1>2052     </font></a><span class="string">the dielectric matrix:</span>
<a name="2053"><font size=-1>2053     </font></a><span class="string">$(1/2) [ 2 \pi \GG_{diel,max}]^2$ =[[diecut]] with $\GG_{diel,max}$ being the maximum</span>
<a name="2054"><font size=-1>2054     </font></a><span class="string">length of the reciprocal space planewave wavevectors for the dielectric matrix.</span>
<a name="2055"><font size=-1>2055     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[diecut]] has</span>
<a name="2056"><font size=-1>2056     </font></a><span class="string">the '[[ENERGY]]' characteristics. (1 Ha=27.2113845 eV)</span>
<a name="2057"><font size=-1>2057     </font></a><span class="string">All planewaves inside this &quot;basis sphere&quot; centered at $\GG$=0 are included in the</span>
<a name="2058"><font size=-1>2058     </font></a><span class="string">basis. This is useful only when [[iprcel]] &gt; =21, which means that a</span>
<a name="2059"><font size=-1>2059     </font></a><span class="string">preconditioning scheme based on the dielectric matrix is used.</span>
<a name="2060"><font size=-1>2060     </font></a><span class="string"></span>
<a name="2061"><font size=-1>2061     </font></a><span class="string">NOTE: a negative [[diecut]] will define the same dielectric basis sphere as</span>
<a name="2062"><font size=-1>2062     </font></a><span class="string">the corresponding positive value, but the FFT grid will be identical to the</span>
<a name="2063"><font size=-1>2063     </font></a><span class="string">one used for the wavefunctions. The much smaller FFT grid, used when</span>
<a name="2064"><font size=-1>2064     </font></a><span class="string">[[diecut]] is positive, gives exactly the same results.\n</span>
<a name="2065"><font size=-1>2065     </font></a><span class="string">No meaning for RF calculations yet.</span>
<a name="2066"><font size=-1>2066     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2067"><font size=-1>2067     </font></a><span class="default">),</span>
<a name="2068"><font size=-1>2068     </font></a><span class="default"></span>
<a name="2069"><font size=-1>2069     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2070"><font size=-1>2070     </font></a><span class="default">    abivarname=</span><span class="string">&quot;diegap&quot;</span><span class="default">,</span>
<a name="2071"><font size=-1>2071     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2072"><font size=-1>2072     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2073"><font size=-1>2073     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_expert'</span><span class="default">],</span>
<a name="2074"><font size=-1>2074     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2075"><font size=-1>2075     </font></a><span class="default">    defaultval=</span><span class="number">0.1</span><span class="default">,</span>
<a name="2076"><font size=-1>2076     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DIElectric matrix GAP&quot;</span><span class="default">,</span>
<a name="2077"><font size=-1>2077     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="2078"><font size=-1>2078     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2079"><font size=-1>2079     </font></a><span class="string">Gives a rough estimation of the dielectric gap between the highest energy</span>
<a name="2080"><font size=-1>2080     </font></a><span class="string">level computed in the run, and the set of bands not represented. Used to</span>
<a name="2081"><font size=-1>2081     </font></a><span class="string">extrapolate dielectric matrix when [[iprcel]] &gt;= 21.</span>
<a name="2082"><font size=-1>2082     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[diegap]] has</span>
<a name="2083"><font size=-1>2083     </font></a><span class="string">the '[[ENERGY]]' characteristics. (1 Ha=27.2113845 eV).\n</span>
<a name="2084"><font size=-1>2084     </font></a><span class="string">No meaning for RF calculations yet.</span>
<a name="2085"><font size=-1>2085     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2086"><font size=-1>2086     </font></a><span class="default">),</span>
<a name="2087"><font size=-1>2087     </font></a><span class="default"></span>
<a name="2088"><font size=-1>2088     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2089"><font size=-1>2089     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dielam&quot;</span><span class="default">,</span>
<a name="2090"><font size=-1>2090     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2091"><font size=-1>2091     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2092"><font size=-1>2092     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_expert'</span><span class="default">],</span>
<a name="2093"><font size=-1>2093     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2094"><font size=-1>2094     </font></a><span class="default">    defaultval=</span><span class="number">0.5</span><span class="default">,</span>
<a name="2095"><font size=-1>2095     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DIElectric matrix LAMbda&quot;</span><span class="default">,</span>
<a name="2096"><font size=-1>2096     </font></a><span class="default">    requires=</span><span class="string">&quot;[[iprcel]] &gt;= 21&quot;</span><span class="default">,</span>
<a name="2097"><font size=-1>2097     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2098"><font size=-1>2098     </font></a><span class="string">Gives the amount of occupied states with mean energy given by the highest</span>
<a name="2099"><font size=-1>2099     </font></a><span class="string">level computed in the run, included in the extrapolation of the dielectric matrix.\n</span>
<a name="2100"><font size=-1>2100     </font></a><span class="string">No meaning for RF calculations yet.</span>
<a name="2101"><font size=-1>2101     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2102"><font size=-1>2102     </font></a><span class="default">),</span>
<a name="2103"><font size=-1>2103     </font></a><span class="default"></span>
<a name="2104"><font size=-1>2104     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2105"><font size=-1>2105     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dielng&quot;</span><span class="default">,</span>
<a name="2106"><font size=-1>2106     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2107"><font size=-1>2107     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2108"><font size=-1>2108     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_useful'</span><span class="default">],</span>
<a name="2109"><font size=-1>2109     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2110"><font size=-1>2110     </font></a><span class="default">    defaultval=</span><span class="string">&quot;1.0774841d0&quot;</span><span class="default">,</span>
<a name="2111"><font size=-1>2111     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;model DIElectric screening LeNGth&quot;</span><span class="default">,</span>
<a name="2112"><font size=-1>2112     </font></a><span class="default">    characteristics=[</span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="2113"><font size=-1>2113     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="2114"><font size=-1>2114     </font></a><span class="string">Used for screening length (in Bohr) of the model dielectric function, diagonal</span>
<a name="2115"><font size=-1>2115     </font></a><span class="string">in reciprocal space. By default, given in Bohr atomic units (1</span>
<a name="2116"><font size=-1>2116     </font></a><span class="string">Bohr=0.5291772108 Angstrom), although Angstrom can be specified, if preferred,</span>
<a name="2117"><font size=-1>2117     </font></a><span class="string">since [[dielng]] has the '[[LENGTH]]' characteristics.</span>
<a name="2118"><font size=-1>2118     </font></a><span class="string">This model dielectric function is as follows ($\kk$ being a wavevector):</span>
<a name="2119"><font size=-1>2119     </font></a><span class="string">\begin{equation}</span>
<a name="2120"><font size=-1>2120     </font></a><span class="string">diel(\kk) = \frac{ 1 + [[dielng]]^2 \kk^2 }{ \left( 1/[[diemac]] + [[dielng]]^2 \kk^2  \right) [[diemix]] } \nonumber</span>
<a name="2121"><font size=-1>2121     </font></a><span class="string">\end{equation}</span>
<a name="2122"><font size=-1>2122     </font></a><span class="string"></span>
<a name="2123"><font size=-1>2123     </font></a><span class="string">The inverse of this model dielectric function will be applied to the residual,</span>
<a name="2124"><font size=-1>2124     </font></a><span class="string">to give the preconditioned change of potential. Right at $\kk$=0, $diel(\kk)$ is imposed to be 1.</span>
<a name="2125"><font size=-1>2125     </font></a><span class="string"></span>
<a name="2126"><font size=-1>2126     </font></a><span class="string">If the preconditioning were perfect, the change of potential would lead to an</span>
<a name="2127"><font size=-1>2127     </font></a><span class="string">exceedingly fast solution of the self-consistency problem (two or three</span>
<a name="2128"><font size=-1>2128     </font></a><span class="string">steps). The present model dielectric function is excellent for rather</span>
<a name="2129"><font size=-1>2129     </font></a><span class="string">homogeneous unit cells.</span>
<a name="2130"><font size=-1>2130     </font></a><span class="string">When $\kk$-&gt;0, it tends to the macroscopic dielectric constant, eventually</span>
<a name="2131"><font size=-1>2131     </font></a><span class="string">divided by the mixing factor [[diemix]] (or [[diemixmag]]  for magnetization).</span>
<a name="2132"><font size=-1>2132     </font></a><span class="string">For metals, simply put [[diemac]] to a very large value ($10^6$ is OK)</span>
<a name="2133"><font size=-1>2133     </font></a><span class="string">The screening length [[dielng]] governs the length scale to go from the</span>
<a name="2134"><font size=-1>2134     </font></a><span class="string">macroscopic regime to the microscopic regime, where it is known that the</span>
<a name="2135"><font size=-1>2135     </font></a><span class="string">dielectric function should tend to 1. It is on the order of 1 Bohr for metals</span>
<a name="2136"><font size=-1>2136     </font></a><span class="string">with medium density of states at the Fermi level, like Molybdenum, and for</span>
<a name="2137"><font size=-1>2137     </font></a><span class="string">Silicon. For metals with a larger DOS at the Fermi level (like Iron), the</span>
<a name="2138"><font size=-1>2138     </font></a><span class="string">screening will be more effective, so that [[dielng]] has to be decreased by a factor of 2-4.</span>
<a name="2139"><font size=-1>2139     </font></a><span class="string">This works for GS and RF calculations.</span>
<a name="2140"><font size=-1>2140     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2141"><font size=-1>2141     </font></a><span class="default">),</span>
<a name="2142"><font size=-1>2142     </font></a><span class="default"></span>
<a name="2143"><font size=-1>2143     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2144"><font size=-1>2144     </font></a><span class="default">    abivarname=</span><span class="string">&quot;diemac&quot;</span><span class="default">,</span>
<a name="2145"><font size=-1>2145     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2146"><font size=-1>2146     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2147"><font size=-1>2147     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_useful'</span><span class="default">],</span>
<a name="2148"><font size=-1>2148     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2149"><font size=-1>2149     </font></a><span class="default">    defaultval=</span><span class="number">1000000.0</span><span class="default">,</span>
<a name="2150"><font size=-1>2150     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;model DIElectric MACroscopic constant&quot;</span><span class="default">,</span>
<a name="2151"><font size=-1>2151     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2152"><font size=-1>2152     </font></a><span class="string">A rough knowledge of the macroscopic dielectric constant [[diemac]] of the</span>
<a name="2153"><font size=-1>2153     </font></a><span class="string">system is a useful help to speed-up the SCF procedure: a model dielectric</span>
<a name="2154"><font size=-1>2154     </font></a><span class="string">function, see the keyword [[dielng]], is used for that purpose. It is</span>
<a name="2155"><font size=-1>2155     </font></a><span class="string">especially useful for speeding up the treatment of rather homogeneous unit cells.</span>
<a name="2156"><font size=-1>2156     </font></a><span class="string"></span>
<a name="2157"><font size=-1>2157     </font></a><span class="string">Some hint:</span>
<a name="2158"><font size=-1>2158     </font></a><span class="string">The value of [[diemac]] should usually be bigger than 1.0, on physical grounds.</span>
<a name="2159"><font size=-1>2159     </font></a><span class="string"></span>
<a name="2160"><font size=-1>2160     </font></a><span class="string">  * For metals, simply put [[diemac]] to a very large value (the default $10^6$ is OK)</span>
<a name="2161"><font size=-1>2161     </font></a><span class="string">  * For silicon, use 12.0. A similar value is likely to work well for other semiconductors</span>
<a name="2162"><font size=-1>2162     </font></a><span class="string">  * For wider gap insulators, use 2.0 ... 4.0</span>
<a name="2163"><font size=-1>2163     </font></a><span class="string">  * For molecules in an otherwise empty big box, try 1.5 ... 3.0</span>
<a name="2164"><font size=-1>2164     </font></a><span class="string"></span>
<a name="2165"><font size=-1>2165     </font></a><span class="string">Systems that combine a highly polarisable part and some vacuum are rather</span>
<a name="2166"><font size=-1>2166     </font></a><span class="string">badly treated by the model dielectric function. One has to use the</span>
<a name="2167"><font size=-1>2167     </font></a><span class="string">&quot;extrapolar&quot; technique, activated by the input variable [[iprcel]].</span>
<a name="2168"><font size=-1>2168     </font></a><span class="string">In sufficiently homogeneous systems, you might have to experiment a bit to</span>
<a name="2169"><font size=-1>2169     </font></a><span class="string">find the best [[diemac]]. If you let [[diemac]] to its default value, you</span>
<a name="2170"><font size=-1>2170     </font></a><span class="string">might even never obtain the self-consistent convergence !</span>
<a name="2171"><font size=-1>2171     </font></a><span class="string">For response function calculations, use the same values as for GS. The</span>
<a name="2172"><font size=-1>2172     </font></a><span class="string">improvement in speed can be considerable for small (but non-zero) values of the wavevector.</span>
<a name="2173"><font size=-1>2173     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2174"><font size=-1>2174     </font></a><span class="default">),</span>
<a name="2175"><font size=-1>2175     </font></a><span class="default"></span>
<a name="2176"><font size=-1>2176     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2177"><font size=-1>2177     </font></a><span class="default">    abivarname=</span><span class="string">&quot;diemix&quot;</span><span class="default">,</span>
<a name="2178"><font size=-1>2178     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2179"><font size=-1>2179     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2180"><font size=-1>2180     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_useful'</span><span class="default">],</span>
<a name="2181"><font size=-1>2181     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2182"><font size=-1>2182     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[usepaw]] == 0 or [[iprcel]] !=0'</span><span class="default">: </span><span class="number">1.0</span><span class="default">,</span>
<a name="2183"><font size=-1>2183     </font></a><span class="default"> </span><span class="string">'[[usepaw]] == 1 or [[iprcel]] == 0'</span><span class="default">: </span><span class="number">0.7</span><span class="default">,</span>
<a name="2184"><font size=-1>2184     </font></a><span class="default"> </span><span class="string">'defaultval'</span><span class="default">: </span><span class="keyword">None</span><span class="default">}),</span>
<a name="2185"><font size=-1>2185     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;model DIElectric MIXing factor&quot;</span><span class="default">,</span>
<a name="2186"><font size=-1>2186     </font></a><span class="default">    requires=</span><span class="string">&quot;[[diemix]] &gt;= 0.0 and [[diemix]] &lt;=  1.0&quot;</span><span class="default">,</span>
<a name="2187"><font size=-1>2187     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2188"><font size=-1>2188     </font></a><span class="string">Gives overall factor of the preconditioned residual density/potential to be</span>
<a name="2189"><font size=-1>2189     </font></a><span class="string">transferred in the SCF cycle.</span>
<a name="2190"><font size=-1>2190     </font></a><span class="string">It should be between 0.0 and 1.0.</span>
<a name="2191"><font size=-1>2191     </font></a><span class="string"></span>
<a name="2192"><font size=-1>2192     </font></a><span class="string">If the model dielectric function were perfect, [[diemix]] should be 1.0. By</span>
<a name="2193"><font size=-1>2193     </font></a><span class="string">contrast, if the model dielectric function does nothing (when [[diemac]] = 1.0</span>
<a name="2194"><font size=-1>2194     </font></a><span class="string">or [[dielng]] is larger than the size of the cell), [[diemix]] can be used to</span>
<a name="2195"><font size=-1>2195     </font></a><span class="string">damp the amplifying factor inherent to the SCF loop.</span>
<a name="2196"><font size=-1>2196     </font></a><span class="string">For molecules, a value on the order 0.5 or 0.33 is rather usual.</span>
<a name="2197"><font size=-1>2197     </font></a><span class="string">When mod([[iscf]],10)=3, 4,5 or 7, [[diemix]] is only important at the few</span>
<a name="2198"><font size=-1>2198     </font></a><span class="string">first iterations when anharmonic effects are important, since these schemes</span>
<a name="2199"><font size=-1>2199     </font></a><span class="string">compute their own mixing factor for self-consistency.</span>
<a name="2200"><font size=-1>2200     </font></a><span class="string">Also note that a different value of diemix can be used for the magnetization</span>
<a name="2201"><font size=-1>2201     </font></a><span class="string">(see [[diemixmag]]).</span>
<a name="2202"><font size=-1>2202     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2203"><font size=-1>2203     </font></a><span class="default">),</span>
<a name="2204"><font size=-1>2204     </font></a><span class="default"></span>
<a name="2205"><font size=-1>2205     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2206"><font size=-1>2206     </font></a><span class="default">    abivarname=</span><span class="string">&quot;diemixmag&quot;</span><span class="default">,</span>
<a name="2207"><font size=-1>2207     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2208"><font size=-1>2208     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2209"><font size=-1>2209     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_useful'</span><span class="default">],</span>
<a name="2210"><font size=-1>2210     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2211"><font size=-1>2211     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'70 &lt; [[iprcel]] and [[iprcel]] &lt; 80'</span><span class="default">: </span><span class="string">'[[diemix]]'</span><span class="default">,</span>
<a name="2212"><font size=-1>2212     </font></a><span class="default"> </span><span class="string">'[[iprcel]] == 0'</span><span class="default">: </span><span class="string">'[[diemix]]'</span><span class="default">,</span>
<a name="2213"><font size=-1>2213     </font></a><span class="default"> </span><span class="string">'[[iscf]]&lt;10'</span><span class="default">: </span><span class="string">'[[diemix]]'</span><span class="default">,</span>
<a name="2214"><font size=-1>2214     </font></a><span class="default"> </span><span class="string">'defaultval'</span><span class="default">: </span><span class="string">'-[[diemix]]'</span><span class="default">}),</span>
<a name="2215"><font size=-1>2215     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;model DIElectric MIXing factor for the MAGgnetization&quot;</span><span class="default">,</span>
<a name="2216"><font size=-1>2216     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2217"><font size=-1>2217     </font></a><span class="string">Gives overall factor of the preconditioned residual magnetization/magnetic</span>
<a name="2218"><font size=-1>2218     </font></a><span class="string">field to be transferred in the SCF cycle (see [[diemix]] for further</span>
<a name="2219"><font size=-1>2219     </font></a><span class="string">information).</span>
<a name="2220"><font size=-1>2220     </font></a><span class="string">For the time being, apply only when the SCF mixing is done on the density ([[iscf]] &gt; =10).</span>
<a name="2221"><font size=-1>2221     </font></a><span class="string"></span>
<a name="2222"><font size=-1>2222     </font></a><span class="string">A negative value of [[diemixmag]] means that magnetization is only preconditionned</span>
<a name="2223"><font size=-1>2223     </font></a><span class="string">by ABS([[diemixmag]]), without the use of any preconditionner.</span>
<a name="2224"><font size=-1>2224     </font></a><span class="string"></span>
<a name="2225"><font size=-1>2225     </font></a><span class="string">When SCF cycle has some difficulties to converge, changing the value of</span>
<a name="2226"><font size=-1>2226     </font></a><span class="string">[[diemixmag]] can have a positive effect.</span>
<a name="2227"><font size=-1>2227     </font></a><span class="string">In particular [[diemixmag]] = -4 is a good choice (i.e. [[diemixmag]] = 4, no other</span>
<a name="2228"><font size=-1>2228     </font></a><span class="string">preconditionner on magnetization).</span>
<a name="2229"><font size=-1>2229     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2230"><font size=-1>2230     </font></a><span class="default">),</span>
<a name="2231"><font size=-1>2231     </font></a><span class="default"></span>
<a name="2232"><font size=-1>2232     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2233"><font size=-1>2233     </font></a><span class="default">    abivarname=</span><span class="string">&quot;diismemory&quot;</span><span class="default">,</span>
<a name="2234"><font size=-1>2234     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="2235"><font size=-1>2235     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2236"><font size=-1>2236     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="2237"><font size=-1>2237     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2238"><font size=-1>2238     </font></a><span class="default">    defaultval=</span><span class="number">8</span><span class="default">,</span>
<a name="2239"><font size=-1>2239     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Direct Inversion in the Iterative Subspace MEMORY&quot;</span><span class="default">,</span>
<a name="2240"><font size=-1>2240     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2241"><font size=-1>2241     </font></a><span class="string">Gives the maximum number of &quot;time&quot; steps for which the forces and stresses are</span>
<a name="2242"><font size=-1>2242     </font></a><span class="string">stored, and taken into account in the DIIS algorithm ([[ionmov]] = 20) to find</span>
<a name="2243"><font size=-1>2243     </font></a><span class="string">zero-force and stress configurations.</span>
<a name="2244"><font size=-1>2244     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2245"><font size=-1>2245     </font></a><span class="default">),</span>
<a name="2246"><font size=-1>2246     </font></a><span class="default"></span>
<a name="2247"><font size=-1>2247     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2248"><font size=-1>2248     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dilatmx&quot;</span><span class="default">,</span>
<a name="2249"><font size=-1>2249     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="2250"><font size=-1>2250     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2251"><font size=-1>2251     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_basic'</span><span class="default">],</span>
<a name="2252"><font size=-1>2252     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2253"><font size=-1>2253     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="2254"><font size=-1>2254     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;lattice DILATation: MaXimal value&quot;</span><span class="default">,</span>
<a name="2255"><font size=-1>2255     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2256"><font size=-1>2256     </font></a><span class="string">[[dilatmx]] is an auxiliary variable used to book additional memory (see detailed description later) for possible</span>
<a name="2257"><font size=-1>2257     </font></a><span class="string">on-the-flight variations the plane wave basis set, due to cell optimization by ABINIT.</span>
<a name="2258"><font size=-1>2258     </font></a><span class="string">Useful only when [[ionmov]] == 2 and [[optcell]]/=0, that is, cell optimization.</span>
<a name="2259"><font size=-1>2259     </font></a><span class="string"></span>
<a name="2260"><font size=-1>2260     </font></a><span class="string">In the default mode ([[chkdilatmx]] = 1), when the [[dilatmx]] threshold is exceeded,</span>
<a name="2261"><font size=-1>2261     </font></a><span class="string">ABINIT will rescale uniformly the</span>
<a name="2262"><font size=-1>2262     </font></a><span class="string">tentative new primitive vectors to a value that leads at most to 90% of the</span>
<a name="2263"><font size=-1>2263     </font></a><span class="string">maximal allowed [[dilatmx]] deviation from 1. It will do this three times (to</span>
<a name="2264"><font size=-1>2264     </font></a><span class="string">prevent the geometry optimization algorithms to have taken a too large trial</span>
<a name="2265"><font size=-1>2265     </font></a><span class="string">step), but afterwards will exit. Setting [[chkdilatmx]] == 0 allows one to</span>
<a name="2266"><font size=-1>2266     </font></a><span class="string">book a larger planewave basis, but will not rescale the tentative new primitive vectors</span>
<a name="2267"><font size=-1>2267     </font></a><span class="string">nor lead to an exit when the [[dilatmx]] threshold is exceeded.</span>
<a name="2268"><font size=-1>2268     </font></a><span class="string">The obtained optimized primitive vectors will not be exactly the ones corresponding to the planewave basis set</span>
<a name="2269"><font size=-1>2269     </font></a><span class="string">determined using [[ecut]] at the latter primitive vectors. Still, as an intermediate step in a geometry search</span>
<a name="2270"><font size=-1>2270     </font></a><span class="string">this might be sufficiently accurate. In such case, [[dilatmx]] might even be let at its default value 1.0.</span>
<a name="2271"><font size=-1>2271     </font></a><span class="string"></span>
<a name="2272"><font size=-1>2272     </font></a><span class="string">Detailed explanation: The memory space for the planewave basis set is defined</span>
<a name="2273"><font size=-1>2273     </font></a><span class="string">by multiplying [[ecut]] by [[dilatmx]] squared (the result is an &quot;effective ecut&quot;, called</span>
<a name="2274"><font size=-1>2274     </font></a><span class="string">internally &quot;ecut_eff&quot;. Other uses of [[ecut]] are not modified when [[dilatmx]] &gt; 1.0.</span>
<a name="2275"><font size=-1>2275     </font></a><span class="string">Still, operations (like scalar products) are taking into account these fake non-used planewaves,</span>
<a name="2276"><font size=-1>2276     </font></a><span class="string">thus slowing down the ABINIT execution.</span>
<a name="2277"><font size=-1>2277     </font></a><span class="string">Using [[dilatmx]]&lt;1.0 is equivalent to changing [[ecut]] in all its uses. This</span>
<a name="2278"><font size=-1>2278     </font></a><span class="string">is allowed, although its meaning is no longer related to a maximal expected scaling.</span>
<a name="2279"><font size=-1>2279     </font></a><span class="string"></span>
<a name="2280"><font size=-1>2280     </font></a><span class="string">Setting [[dilatmx]] to a large value leads to waste of CPU time and memory.</span>
<a name="2281"><font size=-1>2281     </font></a><span class="string">By default, ABINIT will not accept that you define [[dilatmx]] bigger than 1.15.</span>
<a name="2282"><font size=-1>2282     </font></a><span class="string">This behaviour will be overcome by using [[chkdilatmx]] == 0.</span>
<a name="2283"><font size=-1>2283     </font></a><span class="string">Supposing you think that the optimized [[acell]] values might be 10% larger</span>
<a name="2284"><font size=-1>2284     </font></a><span class="string">than your input values, use simply [[dilatmx]] 1.1. This will already lead to</span>
<a name="2285"><font size=-1>2285     </font></a><span class="string">an increase of the number of planewaves by a factor (1.1)  3  =1.331, and a</span>
<a name="2286"><font size=-1>2286     </font></a><span class="string">corresponding increase in CPU time and memory.</span>
<a name="2287"><font size=-1>2287     </font></a><span class="string">It is possible to use [[dilatmx]] when [[optcell]] =0, but a value larger than</span>
<a name="2288"><font size=-1>2288     </font></a><span class="string">1.0 will be a waste.</span>
<a name="2289"><font size=-1>2289     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2290"><font size=-1>2290     </font></a><span class="default">),</span>
<a name="2291"><font size=-1>2291     </font></a><span class="default"></span>
<a name="2292"><font size=-1>2292     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2293"><font size=-1>2293     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dipdip&quot;</span><span class="default">,</span>
<a name="2294"><font size=-1>2294     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="2295"><font size=-1>2295     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2296"><font size=-1>2296     </font></a><span class="default">    topics=[</span><span class="string">'Phonons_useful'</span><span class="default">],</span>
<a name="2297"><font size=-1>2297     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2298"><font size=-1>2298     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="2299"><font size=-1>2299     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DIPole-DIPole interaction&quot;</span><span class="default">,</span>
<a name="2300"><font size=-1>2300     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2301"><font size=-1>2301     </font></a><span class="string">This variable defines the treatment of the dipole-dipole interaction. Same</span>
<a name="2302"><font size=-1>2302     </font></a><span class="string">meaning as the corresponding anaddb variable [[dipdip@anaddb]]</span>
<a name="2303"><font size=-1>2303     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2304"><font size=-1>2304     </font></a><span class="default">),</span>
<a name="2305"><font size=-1>2305     </font></a><span class="default"></span>
<a name="2306"><font size=-1>2306     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2307"><font size=-1>2307     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmatpawu&quot;</span><span class="default">,</span>
<a name="2308"><font size=-1>2308     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="2309"><font size=-1>2309     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2310"><font size=-1>2310     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_useful'</span><span class="default">, </span><span class="string">'ElecDOS_useful'</span><span class="default">],</span>
<a name="2311"><font size=-1>2311     </font></a><span class="default">    dimensions=[</span><span class="string">'2*max([[lpawu]])+1'</span><span class="default">,</span>
<a name="2312"><font size=-1>2312     </font></a><span class="default"> </span><span class="string">'2*max([[lpawu]])+1'</span><span class="default">,</span>
<a name="2313"><font size=-1>2313     </font></a><span class="default"> </span><span class="string">'max([[nsppol]], [[nspinor]])'</span><span class="default">,</span>
<a name="2314"><font size=-1>2314     </font></a><span class="default"> </span><span class="string">'[[natpawu]]'</span><span class="default">],</span>
<a name="2315"><font size=-1>2315     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=-</span><span class="number">10.0</span><span class="default">),</span>
<a name="2316"><font size=-1>2316     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;initial Density MATrix for PAW+U&quot;</span><span class="default">,</span>
<a name="2317"><font size=-1>2317     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[usepawu]] == 1 and [[usedmatpu]] != 0&quot;</span><span class="default">,</span>
<a name="2318"><font size=-1>2318     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2319"><font size=-1>2319     </font></a><span class="string">For Ground state calculations only.</span>
<a name="2320"><font size=-1>2320     </font></a><span class="string">Gives the value of an initial density matrix used in LDA+U and kept fixed</span>
<a name="2321"><font size=-1>2321     </font></a><span class="string">during the first abs([[usedmatpu]]) SCF iterations.</span>
<a name="2322"><font size=-1>2322     </font></a><span class="string">Only components corresponding to [[lpawu]] angular momentum are requested.</span>
<a name="2323"><font size=-1>2323     </font></a><span class="string">Restriction: In order to use dmatpawu, [[lpawu]] must be identical for all atom types (or -1).</span>
<a name="2324"><font size=-1>2324     </font></a><span class="string"></span>
<a name="2325"><font size=-1>2325     </font></a><span class="string">The occupation matrix is in the basis of real spherical harmonics Slm (note</span>
<a name="2326"><font size=-1>2326     </font></a><span class="string">that this differs from the choice made when [[prtdosm]] = 1, that is in the</span>
<a name="2327"><font size=-1>2327     </font></a><span class="string">basis of complex spherical harmonics). They are ordered by increasing m, and</span>
<a name="2328"><font size=-1>2328     </font></a><span class="string">are defined e.g. in [[cite:Blancoa1997]]. For the case l=2 (d states), the five</span>
<a name="2329"><font size=-1>2329     </font></a><span class="string">columns corresponds respectively to (the normalisation factor has been dropped)</span>
<a name="2330"><font size=-1>2330     </font></a><span class="string"></span>
<a name="2331"><font size=-1>2331     </font></a><span class="string">  * m=-2, $xy$</span>
<a name="2332"><font size=-1>2332     </font></a><span class="string">  * m=-1, $yz$</span>
<a name="2333"><font size=-1>2333     </font></a><span class="string">  * m=0, $3z^{2}-r^{2}$</span>
<a name="2334"><font size=-1>2334     </font></a><span class="string">  * m=1, $xz$</span>
<a name="2335"><font size=-1>2335     </font></a><span class="string">  * m=2, $x^{2}-y^{2}$</span>
<a name="2336"><font size=-1>2336     </font></a><span class="string"></span>
<a name="2337"><font size=-1>2337     </font></a><span class="string">[[dmatpawu]] must always be given as a &quot;spin-up&quot; occupation matrix (and</span>
<a name="2338"><font size=-1>2338     </font></a><span class="string">eventually a &quot;spin-down&quot; matrix). Be aware that its physical meaning depends</span>
<a name="2339"><font size=-1>2339     </font></a><span class="string">on the magnetic properties imposed to the system (with [[nsppol]],</span>
<a name="2340"><font size=-1>2340     </font></a><span class="string">[[nspinor]], [[nspden]]):</span>
<a name="2341"><font size=-1>2341     </font></a><span class="string"></span>
<a name="2342"><font size=-1>2342     </font></a><span class="string">  * **Non-magnetic system** ([[nsppol]] = 1, [[nspinor]] = 1, [[nspden]] = 1):</span>
<a name="2343"><font size=-1>2343     </font></a><span class="string">One (2lpawu+1)x(2lpawu+1) [[dmatpawu]] matrix is given for each atom on which</span>
<a name="2344"><font size=-1>2344     </font></a><span class="string">+U is applied.</span>
<a name="2345"><font size=-1>2345     </font></a><span class="string">It contains the &quot;spin-up&quot; occupations.</span>
<a name="2346"><font size=-1>2346     </font></a><span class="string"></span>
<a name="2347"><font size=-1>2347     </font></a><span class="string">  * **Ferromagnetic spin-polarized (collinear) system** ([[nsppol]] = 2, [[nspinor]] = 1, [[nspden]] = 2):</span>
<a name="2348"><font size=-1>2348     </font></a><span class="string">Two (2lpawu+1)x(2lpawu+1) [[dmatpawu]] matrices are given for each atom on</span>
<a name="2349"><font size=-1>2349     </font></a><span class="string">which +U is applied.</span>
<a name="2350"><font size=-1>2350     </font></a><span class="string">They contain the &quot;spin-up&quot; and &quot;spin-down&quot; occupations.</span>
<a name="2351"><font size=-1>2351     </font></a><span class="string"></span>
<a name="2352"><font size=-1>2352     </font></a><span class="string">  * **Anti-ferromagnetic spin-polarized (collinear) system** ([[nsppol]] = 1, [[nspinor]] = 1, [[nspden]] = 2):</span>
<a name="2353"><font size=-1>2353     </font></a><span class="string">One (2lpawu+1)x(2lpawu+1) [[dmatpawu]] matrix is given for each atom on which</span>
<a name="2354"><font size=-1>2354     </font></a><span class="string">+U is applied.</span>
<a name="2355"><font size=-1>2355     </font></a><span class="string">It contains the &quot;spin-up&quot; occupations.</span>
<a name="2356"><font size=-1>2356     </font></a><span class="string"></span>
<a name="2357"><font size=-1>2357     </font></a><span class="string">  * **Non-collinear magnetic system** ([[nsppol]] = 1, [[nspinor]] = 2, [[nspden]] = 4):</span>
<a name="2358"><font size=-1>2358     </font></a><span class="string">Two (2lpawu+1)x(2lpawu+1) [[dmatpawu]] matrices are given for each atom on</span>
<a name="2359"><font size=-1>2359     </font></a><span class="string">which +U is applied.</span>
<a name="2360"><font size=-1>2360     </font></a><span class="string">They contains the &quot;spin-up&quot; and &quot;spin-down&quot; occupations (defined as</span>
<a name="2361"><font size=-1>2361     </font></a><span class="string">n_up=(n+|m|)/2 and n_dn=(n-|m|)/2), where m is the integrated magnetization</span>
<a name="2362"><font size=-1>2362     </font></a><span class="string">vector).</span>
<a name="2363"><font size=-1>2363     </font></a><span class="string">The direction of the magnetization (which is also the direction of n_up and</span>
<a name="2364"><font size=-1>2364     </font></a><span class="string">n_dn) is given by [[spinat]].</span>
<a name="2365"><font size=-1>2365     </font></a><span class="string">_Warning: unlike collinear case, atoms having the same magnetization magnitude</span>
<a name="2366"><font size=-1>2366     </font></a><span class="string">with different directions must be given the same occupation matrix;</span>
<a name="2367"><font size=-1>2367     </font></a><span class="string">the magnetization will be oriented by the value of [[spinat]] (this is the</span>
<a name="2368"><font size=-1>2368     </font></a><span class="string">case for antiferro-magnetism). _</span>
<a name="2369"><font size=-1>2369     </font></a><span class="string"></span>
<a name="2370"><font size=-1>2370     </font></a><span class="string">  * **Non-collinear magnetic system with zero magnetization** ([[nsppol]] = 1, [[nspinor]] = 2, [[nspden]] = 1):</span>
<a name="2371"><font size=-1>2371     </font></a><span class="string">Two (2lpawu+1)x(2lpawu+1) [[dmatpawu]] matrices are given for each atom on</span>
<a name="2372"><font size=-1>2372     </font></a><span class="string">which +U is applied.</span>
<a name="2373"><font size=-1>2373     </font></a><span class="string">They contain the &quot;spin-up&quot; and &quot;spin-down&quot; occupations;</span>
<a name="2374"><font size=-1>2374     </font></a><span class="string">But, as &quot;spin-up&quot; and &quot;spin-down&quot; are constrained identical, the &quot;spin-down&quot;</span>
<a name="2375"><font size=-1>2375     </font></a><span class="string">one is ignored by the code.</span>
<a name="2376"><font size=-1>2376     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2377"><font size=-1>2377     </font></a><span class="default">),</span>
<a name="2378"><font size=-1>2378     </font></a><span class="default"></span>
<a name="2379"><font size=-1>2379     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2380"><font size=-1>2380     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmatpuopt&quot;</span><span class="default">,</span>
<a name="2381"><font size=-1>2381     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="2382"><font size=-1>2382     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2383"><font size=-1>2383     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="2384"><font size=-1>2384     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2385"><font size=-1>2385     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="2386"><font size=-1>2386     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Density MATrix for PAW+U OPTion&quot;</span><span class="default">,</span>
<a name="2387"><font size=-1>2387     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[usepawu]] == 1&quot;</span><span class="default">,</span>
<a name="2388"><font size=-1>2388     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2389"><font size=-1>2389     </font></a><span class="string">This option governs the way occupations of localized atomic levels are computed:</span>
<a name="2390"><font size=-1>2390     </font></a><span class="string"></span>
<a name="2391"><font size=-1>2391     </font></a><span class="string">  * [[dmatpuopt]] = 1: atomic occupations are projections on atomic orbitals (Eq. (6) of [[cite:Amadon2008a]]).</span>
<a name="2392"><font size=-1>2392     </font></a><span class="string"></span>
<a name="2393"><font size=-1>2393     </font></a><span class="string">  * [[dmatpuopt]] = 2: atomic occupations are integrated values in PAW spheres of angular-momentum-decomposed charge densities (Eq. (7) of [[cite:Amadon2008a]]).</span>
<a name="2394"><font size=-1>2394     </font></a><span class="string"></span>
<a name="2395"><font size=-1>2395     </font></a><span class="string">  * [[dmatpuopt]] = 3: only for tests</span>
<a name="2396"><font size=-1>2396     </font></a><span class="string"></span>
<a name="2397"><font size=-1>2397     </font></a><span class="string">  * [[dmatpuopt]] = 4: Extrapolations of occupancies outside the PAW-sphere. This Definition gives normalized operator for occupation.</span>
<a name="2398"><font size=-1>2398     </font></a><span class="string"></span>
<a name="2399"><font size=-1>2399     </font></a><span class="string">In the general case [[dmatpuopt]] = 2 is suitable. The use of [[dmatpuopt]] = 1 is</span>
<a name="2400"><font size=-1>2400     </font></a><span class="string">restricted to PAW datasets in which the first atomic wavefunction of the</span>
<a name="2401"><font size=-1>2401     </font></a><span class="string">correlated subspace is a normalized atomic eigenfunction.</span>
<a name="2402"><font size=-1>2402     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2403"><font size=-1>2403     </font></a><span class="default">),</span>
<a name="2404"><font size=-1>2404     </font></a><span class="default"></span>
<a name="2405"><font size=-1>2405     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2406"><font size=-1>2406     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmatudiag&quot;</span><span class="default">,</span>
<a name="2407"><font size=-1>2407     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="2408"><font size=-1>2408     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2409"><font size=-1>2409     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="2410"><font size=-1>2410     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2411"><font size=-1>2411     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2412"><font size=-1>2412     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Density MATrix for paw+U, DIAGonalization&quot;</span><span class="default">,</span>
<a name="2413"><font size=-1>2413     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[usepawu]] == 1 and [[nspden]] != 4&quot;</span><span class="default">,</span>
<a name="2414"><font size=-1>2414     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2415"><font size=-1>2415     </font></a><span class="string">Relevant only for Ground-State calculations.</span>
<a name="2416"><font size=-1>2416     </font></a><span class="string">This option can be used to diagonalize the occupation matrix Nocc_{m,m_prime}.</span>
<a name="2417"><font size=-1>2417     </font></a><span class="string">Relevant values are:</span>
<a name="2418"><font size=-1>2418     </font></a><span class="string"></span>
<a name="2419"><font size=-1>2419     </font></a><span class="string">  * 0: deactivated.</span>
<a name="2420"><font size=-1>2420     </font></a><span class="string">  * 1: occupation matrix is diagonalized and printed in log file at each SCF cycle</span>
<a name="2421"><font size=-1>2421     </font></a><span class="string">    (eigenvectors are also given in the log file).</span>
<a name="2422"><font size=-1>2422     </font></a><span class="string">  * 2: for testing purpose.</span>
<a name="2423"><font size=-1>2423     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2424"><font size=-1>2424     </font></a><span class="default">),</span>
<a name="2425"><font size=-1>2425     </font></a><span class="default"></span>
<a name="2426"><font size=-1>2426     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2427"><font size=-1>2427     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_dc&quot;</span><span class="default">,</span>
<a name="2428"><font size=-1>2428     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2429"><font size=-1>2429     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2430"><font size=-1>2430     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2431"><font size=-1>2431     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2432"><font size=-1>2432     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="2433"><font size=-1>2433     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Double Counting&quot;</span><span class="default">,</span>
<a name="2434"><font size=-1>2434     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2435"><font size=-1>2435     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2436"><font size=-1>2436     </font></a><span class="string"></span>
<a name="2437"><font size=-1>2437     </font></a><span class="string">Value of double counting used for DMFT. Only value 1 is activated for the</span>
<a name="2438"><font size=-1>2438     </font></a><span class="string">moment and is the FLL double counting.</span>
<a name="2439"><font size=-1>2439     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2440"><font size=-1>2440     </font></a><span class="default">),</span>
<a name="2441"><font size=-1>2441     </font></a><span class="default"></span>
<a name="2442"><font size=-1>2442     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2443"><font size=-1>2443     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_entropy&quot;</span><span class="default">,</span>
<a name="2444"><font size=-1>2444     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2445"><font size=-1>2445     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2446"><font size=-1>2446     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2447"><font size=-1>2447     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2448"><font size=-1>2448     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2449"><font size=-1>2449     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: ENTROPY&quot;</span><span class="default">,</span>
<a name="2450"><font size=-1>2450     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usedmft]] == 1 and [[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2451"><font size=-1>2451     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2452"><font size=-1>2452     </font></a><span class="string">If 1, enables the calculation of the entropy within the DMFT framework and so</span>
<a name="2453"><font size=-1>2453     </font></a><span class="string">allows one the calculation of the total energy (free energy). In the current</span>
<a name="2454"><font size=-1>2454     </font></a><span class="string">implementation, this is only possible with [[dmft_solv]] = 5 (Continuous Time</span>
<a name="2455"><font size=-1>2455     </font></a><span class="string">Quantum Monte Carlo). See also the input variable [[dmft_nlambda]].</span>
<a name="2456"><font size=-1>2456     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2457"><font size=-1>2457     </font></a><span class="default">),</span>
<a name="2458"><font size=-1>2458     </font></a><span class="default"></span>
<a name="2459"><font size=-1>2459     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2460"><font size=-1>2460     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_iter&quot;</span><span class="default">,</span>
<a name="2461"><font size=-1>2461     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2462"><font size=-1>2462     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2463"><font size=-1>2463     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2464"><font size=-1>2464     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2465"><font size=-1>2465     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2466"><font size=-1>2466     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: number of ITERation&quot;</span><span class="default">,</span>
<a name="2467"><font size=-1>2467     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2468"><font size=-1>2468     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2469"><font size=-1>2469     </font></a><span class="string">Number of iterations for the DMFT inner loop.</span>
<a name="2470"><font size=-1>2470     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2471"><font size=-1>2471     </font></a><span class="default">),</span>
<a name="2472"><font size=-1>2472     </font></a><span class="default"></span>
<a name="2473"><font size=-1>2473     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2474"><font size=-1>2474     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_mxsf&quot;</span><span class="default">,</span>
<a name="2475"><font size=-1>2475     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2476"><font size=-1>2476     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2477"><font size=-1>2477     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2478"><font size=-1>2478     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2479"><font size=-1>2479     </font></a><span class="default">    defaultval=</span><span class="number">0.3</span><span class="default">,</span>
<a name="2480"><font size=-1>2480     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: MiXing parameter for the SelF energy&quot;</span><span class="default">,</span>
<a name="2481"><font size=-1>2481     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2482"><font size=-1>2482     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2483"><font size=-1>2483     </font></a><span class="string">Mixing parameter for the simple mixing of the self-energy (should be between 0.3 and 0.8).</span>
<a name="2484"><font size=-1>2484     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2485"><font size=-1>2485     </font></a><span class="default">),</span>
<a name="2486"><font size=-1>2486     </font></a><span class="default"></span>
<a name="2487"><font size=-1>2487     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2488"><font size=-1>2488     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_nlambda&quot;</span><span class="default">,</span>
<a name="2489"><font size=-1>2489     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2490"><font size=-1>2490     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2491"><font size=-1>2491     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2492"><font size=-1>2492     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2493"><font size=-1>2493     </font></a><span class="default">    defaultval=</span><span class="number">6</span><span class="default">,</span>
<a name="2494"><font size=-1>2494     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Number of LAMBDA points&quot;</span><span class="default">,</span>
<a name="2495"><font size=-1>2495     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2496"><font size=-1>2496     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usedmft]] == 1 and [[dmft_entropy]] == 1&quot;</span><span class="default">,</span>
<a name="2497"><font size=-1>2497     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2498"><font size=-1>2498     </font></a><span class="string">[[dmft_nlambda]] gives the number of integration points for the</span>
<a name="2499"><font size=-1>2499     </font></a><span class="string">thermodynamical integration in case of free energy calculation within DMFT.</span>
<a name="2500"><font size=-1>2500     </font></a><span class="string">Its value must be greater or equal to 3.</span>
<a name="2501"><font size=-1>2501     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2502"><font size=-1>2502     </font></a><span class="default">),</span>
<a name="2503"><font size=-1>2503     </font></a><span class="default"></span>
<a name="2504"><font size=-1>2504     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2505"><font size=-1>2505     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_nwli&quot;</span><span class="default">,</span>
<a name="2506"><font size=-1>2506     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2507"><font size=-1>2507     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2508"><font size=-1>2508     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2509"><font size=-1>2509     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2510"><font size=-1>2510     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2511"><font size=-1>2511     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Number of frequency omega (W) in the LInear mesh&quot;</span><span class="default">,</span>
<a name="2512"><font size=-1>2512     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2513"><font size=-1>2513     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2514"><font size=-1>2514     </font></a><span class="string">Number of Matsubara frequencies (linear mesh)</span>
<a name="2515"><font size=-1>2515     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2516"><font size=-1>2516     </font></a><span class="default">),</span>
<a name="2517"><font size=-1>2517     </font></a><span class="default"></span>
<a name="2518"><font size=-1>2518     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2519"><font size=-1>2519     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_nwlo&quot;</span><span class="default">,</span>
<a name="2520"><font size=-1>2520     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2521"><font size=-1>2521     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2522"><font size=-1>2522     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2523"><font size=-1>2523     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2524"><font size=-1>2524     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2525"><font size=-1>2525     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Number of frequency omega (W) in the LOg mesh&quot;</span><span class="default">,</span>
<a name="2526"><font size=-1>2526     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2527"><font size=-1>2527     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2528"><font size=-1>2528     </font></a><span class="string">Number of frequencies in the log mesh.</span>
<a name="2529"><font size=-1>2529     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2530"><font size=-1>2530     </font></a><span class="default">),</span>
<a name="2531"><font size=-1>2531     </font></a><span class="default"></span>
<a name="2532"><font size=-1>2532     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2533"><font size=-1>2533     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_read_occnd&quot;</span><span class="default">,</span>
<a name="2534"><font size=-1>2534     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="2535"><font size=-1>2535     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2536"><font size=-1>2536     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2537"><font size=-1>2537     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2538"><font size=-1>2538     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2539"><font size=-1>2539     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: READ OCCupations (Non Diagonal)&quot;</span><span class="default">,</span>
<a name="2540"><font size=-1>2540     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2541"><font size=-1>2541     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2542"><font size=-1>2542     </font></a><span class="string">Flag to read/write Occupations as computed in DMFT. This flag is useful to</span>
<a name="2543"><font size=-1>2543     </font></a><span class="string">restart a DFT+DMFT calculation with self-consistency over electronic density.</span>
<a name="2544"><font size=-1>2544     </font></a><span class="string">The occupations are written each time a DMFT loop is finished. So if the</span>
<a name="2545"><font size=-1>2545     </font></a><span class="string">calculation stops because the time limit is reached, this option offers the</span>
<a name="2546"><font size=-1>2546     </font></a><span class="string">possibility to restart the self-consistent loop over density at the point</span>
<a name="2547"><font size=-1>2547     </font></a><span class="string">where it stopped (assuming a restart with the wave functions, see [[getwfk]]).</span>
<a name="2548"><font size=-1>2548     </font></a><span class="string"></span>
<a name="2549"><font size=-1>2549     </font></a><span class="string">  * 0 --&gt; Occupations are written but never read.</span>
<a name="2550"><font size=-1>2550     </font></a><span class="string">  * 1 --&gt; Occupations are read from I_DMFTOCCND, where I is the root for input files.</span>
<a name="2551"><font size=-1>2551     </font></a><span class="string">  * 2 --&gt; Occupations are read from O_DMFTOCCND, where O is the root for output files.</span>
<a name="2552"><font size=-1>2552     </font></a><span class="string"></span>
<a name="2553"><font size=-1>2553     </font></a><span class="string">An alternative and more simple way to restart a DFT+DMFT calculation is to use</span>
<a name="2554"><font size=-1>2554     </font></a><span class="string">the density file (obtained with [[prtden]] = 1 or [[prtden]] = -1) and the self-energy (see [[dmft_rslf]]).</span>
<a name="2555"><font size=-1>2555     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2556"><font size=-1>2556     </font></a><span class="default">),</span>
<a name="2557"><font size=-1>2557     </font></a><span class="default"></span>
<a name="2558"><font size=-1>2558     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2559"><font size=-1>2559     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_rslf&quot;</span><span class="default">,</span>
<a name="2560"><font size=-1>2560     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2561"><font size=-1>2561     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2562"><font size=-1>2562     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_basic'</span><span class="default">],</span>
<a name="2563"><font size=-1>2563     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2564"><font size=-1>2564     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2565"><font size=-1>2565     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Read SeLF energy&quot;</span><span class="default">,</span>
<a name="2566"><font size=-1>2566     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2567"><font size=-1>2567     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2568"><font size=-1>2568     </font></a><span class="string">Flag to read/write Self-Energy. If put to one, self-energy is written and read at each DFT iteration.</span>
<a name="2569"><font size=-1>2569     </font></a><span class="string">If self-energy file is missing, the self-energy is initialized to the double counting at the first iteration.</span>
<a name="2570"><font size=-1>2570     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2571"><font size=-1>2571     </font></a><span class="default">),</span>
<a name="2572"><font size=-1>2572     </font></a><span class="default"></span>
<a name="2573"><font size=-1>2573     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2574"><font size=-1>2574     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_solv&quot;</span><span class="default">,</span>
<a name="2575"><font size=-1>2575     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2576"><font size=-1>2576     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2577"><font size=-1>2577     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_basic'</span><span class="default">],</span>
<a name="2578"><font size=-1>2578     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2579"><font size=-1>2579     </font></a><span class="default">    defaultval=</span><span class="number">5</span><span class="default">,</span>
<a name="2580"><font size=-1>2580     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: choice of SOLVer&quot;</span><span class="default">,</span>
<a name="2581"><font size=-1>2581     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2582"><font size=-1>2582     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2583"><font size=-1>2583     </font></a><span class="string">Choice of solver for the Impurity model.</span>
<a name="2584"><font size=-1>2584     </font></a><span class="string"></span>
<a name="2585"><font size=-1>2585     </font></a><span class="string">  * 0 --&gt; No solver and U=0, J=0 (see [[upawu]] and [[jpawu]]).</span>
<a name="2586"><font size=-1>2586     </font></a><span class="string">  * 1 --&gt; LDA+U self-energy is used (for testing purpose)</span>
<a name="2587"><font size=-1>2587     </font></a><span class="string">  * 2 --&gt; Hubbard one solver. The Hubbard one solver is an approximation which gives a rough description of correlated Mott insulators. It should not be used for metals.</span>
<a name="2588"><font size=-1>2588     </font></a><span class="string">  * 5 --&gt; Use the Continuous Time Quantum Monte Carlo (CTQMC) solver CT-Hyb of ABINIT in the density density representation, CTQMC calculations are much more time consuming that Hubbard I calculations. Nevertheless, the calculation is fully parallelised.</span>
<a name="2589"><font size=-1>2589     </font></a><span class="string">  * 6 --&gt; Continuous Time Quantum Monte Carlo (CTQMC) solver CT-Hyb of TRIQS in the density density representation.</span>
<a name="2590"><font size=-1>2590     </font></a><span class="string">  * 7 --&gt; Continuous Time Quantum Monte Carlo (CTQMC) solver CT-Hyb of TRIQS with the rotationally invariant formulation.</span>
<a name="2591"><font size=-1>2591     </font></a><span class="string"></span>
<a name="2592"><font size=-1>2592     </font></a><span class="string">The CT Hyb algorithm is described in [[cite:Werner2006]]. For a</span>
<a name="2593"><font size=-1>2593     </font></a><span class="string">discussion of density-density approximation with respect with the</span>
<a name="2594"><font size=-1>2594     </font></a><span class="string">rotationnally invariant formulation, see e.g. [[cite:Antipov2012]].</span>
<a name="2595"><font size=-1>2595     </font></a><span class="string">The ABINIT/CT Hyb implementation is discussed in [[cite:Gonze2016]].</span>
<a name="2596"><font size=-1>2596     </font></a><span class="string">The TRIQS/CT Hyb implementation is described in [[cite:Seth2016]].</span>
<a name="2597"><font size=-1>2597     </font></a><span class="string">Before using it, it has to be installed following instructions available [here](https://triqs.ipht.cnrs.fr/1.x/install.html).</span>
<a name="2598"><font size=-1>2598     </font></a><span class="string">Starting from release 8.6.0, the</span>
<a name="2599"><font size=-1>2599     </font></a><span class="string">interface is valid only for TRIQS 1.4 and TRIQS/CTHYB 1.4. An example of a</span>
<a name="2600"><font size=-1>2600     </font></a><span class="string">config.ac file to compile ABINIT with TRIQS can be found in</span>
<a name="2601"><font size=-1>2601     </font></a><span class="string">~/doc/build/config-examples/ubu_gnu_4.9_triqs.ac.</span>
<a name="2602"><font size=-1>2602     </font></a><span class="string">See the useful variables for CT-QMC solver: [[dmftctqmc_basis]],</span>
<a name="2603"><font size=-1>2603     </font></a><span class="string">[[dmftctqmc_check]], [[dmftctqmc_correl]], [[dmftctqmc_gmove]],</span>
<a name="2604"><font size=-1>2604     </font></a><span class="string">[[dmftctqmc_grnns]], [[dmftctqmc_meas]], [[dmftctqmc_mrka]],</span>
<a name="2605"><font size=-1>2605     </font></a><span class="string">[[dmftctqmc_mov]], [[dmftctqmc_order]], [[dmftctqmc_triqs_nleg]],</span>
<a name="2606"><font size=-1>2606     </font></a><span class="string">[[dmftqmc_l]], [[dmftqmc_n]], [[dmftqmc_seed]], [[dmftqmc_therm]]</span>
<a name="2607"><font size=-1>2607     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2608"><font size=-1>2608     </font></a><span class="default">),</span>
<a name="2609"><font size=-1>2609     </font></a><span class="default"></span>
<a name="2610"><font size=-1>2610     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2611"><font size=-1>2611     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_t2g&quot;</span><span class="default">,</span>
<a name="2612"><font size=-1>2612     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2613"><font size=-1>2613     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2614"><font size=-1>2614     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2615"><font size=-1>2615     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2616"><font size=-1>2616     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2617"><font size=-1>2617     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: t2g orbitals&quot;</span><span class="default">,</span>
<a name="2618"><font size=-1>2618     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2619"><font size=-1>2619     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2620"><font size=-1>2620     </font></a><span class="string"></span>
<a name="2621"><font size=-1>2621     </font></a><span class="string">Can be set to 1 only if in cubic symmetry. It enables one to carry a DFT+DMFT</span>
<a name="2622"><font size=-1>2622     </font></a><span class="string">calculations only on _t&lt;sub&gt;2g&lt;/sub&gt;_ orbitals.</span>
<a name="2623"><font size=-1>2623     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2624"><font size=-1>2624     </font></a><span class="default">),</span>
<a name="2625"><font size=-1>2625     </font></a><span class="default"></span>
<a name="2626"><font size=-1>2626     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2627"><font size=-1>2627     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_tolfreq&quot;</span><span class="default">,</span>
<a name="2628"><font size=-1>2628     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2629"><font size=-1>2629     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2630"><font size=-1>2630     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2631"><font size=-1>2631     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2632"><font size=-1>2632     </font></a><span class="default">    defaultval=</span><span class="number">0.0001</span><span class="default">,</span>
<a name="2633"><font size=-1>2633     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: TOLerance on DFT correlated electron occupation matrix for the definition of the FREQuency grid&quot;</span><span class="default">,</span>
<a name="2634"><font size=-1>2634     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2635"><font size=-1>2635     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2636"><font size=-1>2636     </font></a><span class="string"></span>
<a name="2637"><font size=-1>2637     </font></a><span class="string">The LDA occupation matrix for correlated electrons can be computed directly.</span>
<a name="2638"><font size=-1>2638     </font></a><span class="string">It can be compared to the calculation of the same quantity using LDA Green's</span>
<a name="2639"><font size=-1>2639     </font></a><span class="string">function, a sum over Matsubara frequencies and a projection over correlated</span>
<a name="2640"><font size=-1>2640     </font></a><span class="string">orbitals. Because the Matsubara grid is finite, the two quantities differ. If</span>
<a name="2641"><font size=-1>2641     </font></a><span class="string">this difference is larger than dmft_tolfreq, then the code stops and an error</span>
<a name="2642"><font size=-1>2642     </font></a><span class="string">message is given.</span>
<a name="2643"><font size=-1>2643     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2644"><font size=-1>2644     </font></a><span class="default">),</span>
<a name="2645"><font size=-1>2645     </font></a><span class="default"></span>
<a name="2646"><font size=-1>2646     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2647"><font size=-1>2647     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmft_tollc&quot;</span><span class="default">,</span>
<a name="2648"><font size=-1>2648     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2649"><font size=-1>2649     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2650"><font size=-1>2650     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2651"><font size=-1>2651     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2652"><font size=-1>2652     </font></a><span class="default">    defaultval=</span><span class="number">1e-05</span><span class="default">,</span>
<a name="2653"><font size=-1>2653     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: TOLerance on Local Charge for convergence of the DMFT loop&quot;</span><span class="default">,</span>
<a name="2654"><font size=-1>2654     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2655"><font size=-1>2655     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2656"><font size=-1>2656     </font></a><span class="string">Tolerance for the variation of Local Charge during iterations of the DMFT Loop.</span>
<a name="2657"><font size=-1>2657     </font></a><span class="string">The default value is good for fast calculations. However, to obtain good</span>
<a name="2658"><font size=-1>2658     </font></a><span class="string">convergence of the DFT Loop, the DMFT Loop needs a better convergence criterion.</span>
<a name="2659"><font size=-1>2659     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2660"><font size=-1>2660     </font></a><span class="default">),</span>
<a name="2661"><font size=-1>2661     </font></a><span class="default"></span>
<a name="2662"><font size=-1>2662     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2663"><font size=-1>2663     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftbandf&quot;</span><span class="default">,</span>
<a name="2664"><font size=-1>2664     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2665"><font size=-1>2665     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2666"><font size=-1>2666     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2667"><font size=-1>2667     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2668"><font size=-1>2668     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2669"><font size=-1>2669     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: BAND: Final&quot;</span><span class="default">,</span>
<a name="2670"><font size=-1>2670     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2671"><font size=-1>2671     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2672"><font size=-1>2672     </font></a><span class="string">[[dmftbandf]] is the last band taken into account in the Projected Local</span>
<a name="2673"><font size=-1>2673     </font></a><span class="string">Orbitals scheme of DFT+DMFT. With [[dmftbandi]], they define the energy window</span>
<a name="2674"><font size=-1>2674     </font></a><span class="string">used to define Wannier Functions (see [[cite:Amadon2008]]).</span>
<a name="2675"><font size=-1>2675     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2676"><font size=-1>2676     </font></a><span class="default">),</span>
<a name="2677"><font size=-1>2677     </font></a><span class="default"></span>
<a name="2678"><font size=-1>2678     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2679"><font size=-1>2679     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftbandi&quot;</span><span class="default">,</span>
<a name="2680"><font size=-1>2680     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2681"><font size=-1>2681     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2682"><font size=-1>2682     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2683"><font size=-1>2683     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2684"><font size=-1>2684     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2685"><font size=-1>2685     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: BAND: Initial&quot;</span><span class="default">,</span>
<a name="2686"><font size=-1>2686     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2687"><font size=-1>2687     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2688"><font size=-1>2688     </font></a><span class="string">[[dmftbandi]] is the first band taken into account in the Projected Local</span>
<a name="2689"><font size=-1>2689     </font></a><span class="string">Orbitals scheme of LDA+DMFT. With [[dmftbandf]], they define the energy window</span>
<a name="2690"><font size=-1>2690     </font></a><span class="string">used to define Wannier Functions (see [[cite:Amadon2008]]).</span>
<a name="2691"><font size=-1>2691     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2692"><font size=-1>2692     </font></a><span class="default">),</span>
<a name="2693"><font size=-1>2693     </font></a><span class="default"></span>
<a name="2694"><font size=-1>2694     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2695"><font size=-1>2695     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftcheck&quot;</span><span class="default">,</span>
<a name="2696"><font size=-1>2696     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2697"><font size=-1>2697     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2698"><font size=-1>2698     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2699"><font size=-1>2699     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2700"><font size=-1>2700     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2701"><font size=-1>2701     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: CHECKs&quot;</span><span class="default">,</span>
<a name="2702"><font size=-1>2702     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2703"><font size=-1>2703     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2704"><font size=-1>2704     </font></a><span class="string">Only for developer purposes.</span>
<a name="2705"><font size=-1>2705     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2706"><font size=-1>2706     </font></a><span class="default">),</span>
<a name="2707"><font size=-1>2707     </font></a><span class="default"></span>
<a name="2708"><font size=-1>2708     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2709"><font size=-1>2709     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_basis&quot;</span><span class="default">,</span>
<a name="2710"><font size=-1>2710     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="2711"><font size=-1>2711     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2712"><font size=-1>2712     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2713"><font size=-1>2713     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2714"><font size=-1>2714     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="2715"><font size=-1>2715     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo BASIS&quot;</span><span class="default">,</span>
<a name="2716"><font size=-1>2716     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2717"><font size=-1>2717     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2718"><font size=-1>2718     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2719"><font size=-1>2719     </font></a><span class="string">Choose the basis to perform CTQMC calculation.</span>
<a name="2720"><font size=-1>2720     </font></a><span class="string"></span>
<a name="2721"><font size=-1>2721     </font></a><span class="string">  * 0 --&gt; Use the local basis in the spherical harmonics basis.</span>
<a name="2722"><font size=-1>2722     </font></a><span class="string">  Can be useful if the Hamiltonian has weak off diagonal terms and for this reason,</span>
<a name="2723"><font size=-1>2723     </font></a><span class="string">  one want to keep the original basis for simplicity and for physical insight.</span>
<a name="2724"><font size=-1>2724     </font></a><span class="string">  * 1 --&gt; Default value, diagonalize the local Hamiltonian (but only if it is not diagonal).</span>
<a name="2725"><font size=-1>2725     </font></a><span class="string">  The best choice in general.</span>
<a name="2726"><font size=-1>2726     </font></a><span class="string">  * 2 --&gt; Diagonalise the local correlated occupation matrix. Can lead to non</span>
<a name="2727"><font size=-1>2727     </font></a><span class="string">  diagonal Hamiltonian that cannot be handled by CTQMC. This option should be thus avoided.</span>
<a name="2728"><font size=-1>2728     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2729"><font size=-1>2729     </font></a><span class="default">),</span>
<a name="2730"><font size=-1>2730     </font></a><span class="default"></span>
<a name="2731"><font size=-1>2731     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2732"><font size=-1>2732     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_check&quot;</span><span class="default">,</span>
<a name="2733"><font size=-1>2733     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2734"><font size=-1>2734     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2735"><font size=-1>2735     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2736"><font size=-1>2736     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2737"><font size=-1>2737     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2738"><font size=-1>2738     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo CHECK&quot;</span><span class="default">,</span>
<a name="2739"><font size=-1>2739     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2740"><font size=-1>2740     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2741"><font size=-1>2741     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2742"><font size=-1>2742     </font></a><span class="string">Check the fast calculations during the Monte Carlo simulation with very slow</span>
<a name="2743"><font size=-1>2743     </font></a><span class="string">but robust methods. Should only be used for debugging.</span>
<a name="2744"><font size=-1>2744     </font></a><span class="string"></span>
<a name="2745"><font size=-1>2745     </font></a><span class="string">  * 0 --&gt; No check.</span>
<a name="2746"><font size=-1>2746     </font></a><span class="string">  * 1 --&gt; Check the overlap calculations (Impurity operator).</span>
<a name="2747"><font size=-1>2747     </font></a><span class="string">  * 2 --&gt; Check the update of M matrix calculation (Bath operator).</span>
<a name="2748"><font size=-1>2748     </font></a><span class="string">  * 3 --&gt; Check both.</span>
<a name="2749"><font size=-1>2749     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2750"><font size=-1>2750     </font></a><span class="default">),</span>
<a name="2751"><font size=-1>2751     </font></a><span class="default"></span>
<a name="2752"><font size=-1>2752     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2753"><font size=-1>2753     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_correl&quot;</span><span class="default">,</span>
<a name="2754"><font size=-1>2754     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2755"><font size=-1>2755     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2756"><font size=-1>2756     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2757"><font size=-1>2757     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2758"><font size=-1>2758     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2759"><font size=-1>2759     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo CORRELations&quot;</span><span class="default">,</span>
<a name="2760"><font size=-1>2760     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2761"><font size=-1>2761     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2762"><font size=-1>2762     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2763"><font size=-1>2763     </font></a><span class="string">Flag to compute statistics about segments and anti-segments during the</span>
<a name="2764"><font size=-1>2764     </font></a><span class="string">simulation. Slow down the simulation.</span>
<a name="2765"><font size=-1>2765     </font></a><span class="string"></span>
<a name="2766"><font size=-1>2766     </font></a><span class="string">  * 0 --&gt; Nothing done</span>
<a name="2767"><font size=-1>2767     </font></a><span class="string">  * 1 --&gt; Calculations performed and written in &quot;Correlation.dat&quot; file</span>
<a name="2768"><font size=-1>2768     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2769"><font size=-1>2769     </font></a><span class="default">),</span>
<a name="2770"><font size=-1>2770     </font></a><span class="default"></span>
<a name="2771"><font size=-1>2771     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2772"><font size=-1>2772     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_gmove&quot;</span><span class="default">,</span>
<a name="2773"><font size=-1>2773     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2774"><font size=-1>2774     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2775"><font size=-1>2775     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2776"><font size=-1>2776     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2777"><font size=-1>2777     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2778"><font size=-1>2778     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo Global MOVEs&quot;</span><span class="default">,</span>
<a name="2779"><font size=-1>2779     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2780"><font size=-1>2780     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2781"><font size=-1>2781     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2782"><font size=-1>2782     </font></a><span class="string">Default is no global moves. The value of this variable is the modulo used to</span>
<a name="2783"><font size=-1>2783     </font></a><span class="string">try a global move. A value of 5000 means that a global move is tried every 5000 Monte Carlo sweep.</span>
<a name="2784"><font size=-1>2784     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2785"><font size=-1>2785     </font></a><span class="default">),</span>
<a name="2786"><font size=-1>2786     </font></a><span class="default"></span>
<a name="2787"><font size=-1>2787     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2788"><font size=-1>2788     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_grnns&quot;</span><span class="default">,</span>
<a name="2789"><font size=-1>2789     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2790"><font size=-1>2790     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2791"><font size=-1>2791     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2792"><font size=-1>2792     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2793"><font size=-1>2793     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2794"><font size=-1>2794     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo GReeNs NoiSe&quot;</span><span class="default">,</span>
<a name="2795"><font size=-1>2795     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2796"><font size=-1>2796     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2797"><font size=-1>2797     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2798"><font size=-1>2798     </font></a><span class="string">Compute the statistical noise for each time slice of each green function. This</span>
<a name="2799"><font size=-1>2799     </font></a><span class="string">is a good approximation only if there is enough Monte Carlo sweeps per cpu.</span>
<a name="2800"><font size=-1>2800     </font></a><span class="string"></span>
<a name="2801"><font size=-1>2801     </font></a><span class="string">  * 0 --&gt; Nothing</span>
<a name="2802"><font size=-1>2802     </font></a><span class="string">  * 1 --&gt; Do it and write the noise in the &quot;Gtau.dat&quot; file.</span>
<a name="2803"><font size=-1>2803     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2804"><font size=-1>2804     </font></a><span class="default">),</span>
<a name="2805"><font size=-1>2805     </font></a><span class="default"></span>
<a name="2806"><font size=-1>2806     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2807"><font size=-1>2807     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_meas&quot;</span><span class="default">,</span>
<a name="2808"><font size=-1>2808     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2809"><font size=-1>2809     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2810"><font size=-1>2810     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2811"><font size=-1>2811     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2812"><font size=-1>2812     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="2813"><font size=-1>2813     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo MEASurements&quot;</span><span class="default">,</span>
<a name="2814"><font size=-1>2814     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2815"><font size=-1>2815     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2816"><font size=-1>2816     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2817"><font size=-1>2817     </font></a><span class="string">The modulo used to measure the interaction energy and the number of electrons.</span>
<a name="2818"><font size=-1>2818     </font></a><span class="string">Example: 2 means the measure is perform every two sweeps.</span>
<a name="2819"><font size=-1>2819     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2820"><font size=-1>2820     </font></a><span class="default">),</span>
<a name="2821"><font size=-1>2821     </font></a><span class="default"></span>
<a name="2822"><font size=-1>2822     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2823"><font size=-1>2823     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_mov&quot;</span><span class="default">,</span>
<a name="2824"><font size=-1>2824     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2825"><font size=-1>2825     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2826"><font size=-1>2826     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2827"><font size=-1>2827     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2828"><font size=-1>2828     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2829"><font size=-1>2829     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo MOVie&quot;</span><span class="default">,</span>
<a name="2830"><font size=-1>2830     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2831"><font size=-1>2831     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2832"><font size=-1>2832     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2833"><font size=-1>2833     </font></a><span class="string">Print a latex file per cpu displaying the full simulation. This option should</span>
<a name="2834"><font size=-1>2834     </font></a><span class="string">only be use with very small number (&lt;1000) of Monte Carlo sweeps since it</span>
<a name="2835"><font size=-1>2835     </font></a><span class="string">requires a lot of I/O band width.</span>
<a name="2836"><font size=-1>2836     </font></a><span class="string"></span>
<a name="2837"><font size=-1>2837     </font></a><span class="string">  * 0 --&gt; Nothing</span>
<a name="2838"><font size=-1>2838     </font></a><span class="string">  * 1 --&gt; Write the &quot;Movie_id.dat&quot; file where id is the MPI rank of each process</span>
<a name="2839"><font size=-1>2839     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2840"><font size=-1>2840     </font></a><span class="default">),</span>
<a name="2841"><font size=-1>2841     </font></a><span class="default"></span>
<a name="2842"><font size=-1>2842     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2843"><font size=-1>2843     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_mrka&quot;</span><span class="default">,</span>
<a name="2844"><font size=-1>2844     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2845"><font size=-1>2845     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2846"><font size=-1>2846     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2847"><font size=-1>2847     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2848"><font size=-1>2848     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2849"><font size=-1>2849     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo MARKov Analysis&quot;</span><span class="default">,</span>
<a name="2850"><font size=-1>2850     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2851"><font size=-1>2851     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2852"><font size=-1>2852     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2853"><font size=-1>2853     </font></a><span class="string">Measure the time evolution of the number of electrons for each orbital and</span>
<a name="2854"><font size=-1>2854     </font></a><span class="string">perform a fourier transform. The result can be plotted using the &quot;Markov_id.dat&quot; file</span>
<a name="2855"><font size=-1>2855     </font></a><span class="string"></span>
<a name="2856"><font size=-1>2856     </font></a><span class="string">  * 0 --&gt; Nothing</span>
<a name="2857"><font size=-1>2857     </font></a><span class="string">  * 1 --&gt; Do it and write the noise in the &quot;Markov_id.dat&quot; file where id is the rank of each MPI process.</span>
<a name="2858"><font size=-1>2858     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2859"><font size=-1>2859     </font></a><span class="default">),</span>
<a name="2860"><font size=-1>2860     </font></a><span class="default"></span>
<a name="2861"><font size=-1>2861     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2862"><font size=-1>2862     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_order&quot;</span><span class="default">,</span>
<a name="2863"><font size=-1>2863     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2864"><font size=-1>2864     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2865"><font size=-1>2865     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2866"><font size=-1>2866     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2867"><font size=-1>2867     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2868"><font size=-1>2868     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo perturbation ORDER&quot;</span><span class="default">,</span>
<a name="2869"><font size=-1>2869     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2870"><font size=-1>2870     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2871"><font size=-1>2871     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2872"><font size=-1>2872     </font></a><span class="string">Print a file containing the statistic distribution of the number of segments</span>
<a name="2873"><font size=-1>2873     </font></a><span class="string">per orbital. The maximal order taken into account [[dmftctqmc_order]]: 50</span>
<a name="2874"><font size=-1>2874     </font></a><span class="string">means that we have the statistic distribution from 0 to 50 segments. The</span>
<a name="2875"><font size=-1>2875     </font></a><span class="string">result is written in the &quot;Perturbation.dat&quot; file.</span>
<a name="2876"><font size=-1>2876     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2877"><font size=-1>2877     </font></a><span class="default">),</span>
<a name="2878"><font size=-1>2878     </font></a><span class="default"></span>
<a name="2879"><font size=-1>2879     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2880"><font size=-1>2880     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftctqmc_triqs_nleg&quot;</span><span class="default">,</span>
<a name="2881"><font size=-1>2881     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2882"><font size=-1>2882     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2883"><font size=-1>2883     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_expert'</span><span class="default">],</span>
<a name="2884"><font size=-1>2884     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2885"><font size=-1>2885     </font></a><span class="default">    defaultval=</span><span class="number">30</span><span class="default">,</span>
<a name="2886"><font size=-1>2886     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo perturbation of TRIQS, Number of LEGendre polynomials&quot;</span><span class="default">,</span>
<a name="2887"><font size=-1>2887     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2888"><font size=-1>2888     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] in [6, 7]&quot;</span><span class="default">,</span>
<a name="2889"><font size=-1>2889     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2890"><font size=-1>2890     </font></a><span class="string">Specify the number of Legendre polynomials used for the calculation of Green's</span>
<a name="2891"><font size=-1>2891     </font></a><span class="string">function in CTQMC code from the library TRIQS. Default is 30. The value of</span>
<a name="2892"><font size=-1>2892     </font></a><span class="string">coefficients are given in file whose name ending is</span>
<a name="2893"><font size=-1>2893     </font></a><span class="string">&quot;Legendre_coefficient.dat&quot; (see also [[cite:Boehnke2011]]).</span>
<a name="2894"><font size=-1>2894     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2895"><font size=-1>2895     </font></a><span class="default">),</span>
<a name="2896"><font size=-1>2896     </font></a><span class="default"></span>
<a name="2897"><font size=-1>2897     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2898"><font size=-1>2898     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftqmc_l&quot;</span><span class="default">,</span>
<a name="2899"><font size=-1>2899     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2900"><font size=-1>2900     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2901"><font size=-1>2901     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2902"><font size=-1>2902     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2903"><font size=-1>2903     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="2904"><font size=-1>2904     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Quantum Monte Carlo time sLices&quot;</span><span class="default">,</span>
<a name="2905"><font size=-1>2905     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2906"><font size=-1>2906     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] &gt;= 5&quot;</span><span class="default">,</span>
<a name="2907"><font size=-1>2907     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2908"><font size=-1>2908     </font></a><span class="string">Number of time slices used to represent the time green function. This value</span>
<a name="2909"><font size=-1>2909     </font></a><span class="string">should be carefully chosen according to Niquist frequency and the [[tsmear]] value.</span>
<a name="2910"><font size=-1>2910     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2911"><font size=-1>2911     </font></a><span class="default">),</span>
<a name="2912"><font size=-1>2912     </font></a><span class="default"></span>
<a name="2913"><font size=-1>2913     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2914"><font size=-1>2914     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftqmc_n&quot;</span><span class="default">,</span>
<a name="2915"><font size=-1>2915     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2916"><font size=-1>2916     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2917"><font size=-1>2917     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2918"><font size=-1>2918     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2919"><font size=-1>2919     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="2920"><font size=-1>2920     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Quantum Monte Carlo Number of sweeps&quot;</span><span class="default">,</span>
<a name="2921"><font size=-1>2921     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2922"><font size=-1>2922     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] &gt;= 5&quot;</span><span class="default">,</span>
<a name="2923"><font size=-1>2923     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2924"><font size=-1>2924     </font></a><span class="string">Number of Monte Carlo sweeps. Should be at least 10&lt;sup&gt;6&lt;\sup&gt;.</span>
<a name="2925"><font size=-1>2925     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2926"><font size=-1>2926     </font></a><span class="default">),</span>
<a name="2927"><font size=-1>2927     </font></a><span class="default"></span>
<a name="2928"><font size=-1>2928     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2929"><font size=-1>2929     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftqmc_seed&quot;</span><span class="default">,</span>
<a name="2930"><font size=-1>2930     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2931"><font size=-1>2931     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2932"><font size=-1>2932     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_useful'</span><span class="default">],</span>
<a name="2933"><font size=-1>2933     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2934"><font size=-1>2934     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[jdtset]]&quot;</span><span class="default">,</span>
<a name="2935"><font size=-1>2935     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Quantum Monte Carlo SEED&quot;</span><span class="default">,</span>
<a name="2936"><font size=-1>2936     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2937"><font size=-1>2937     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] &gt;= 5&quot;</span><span class="default">,</span>
<a name="2938"><font size=-1>2938     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2939"><font size=-1>2939     </font></a><span class="string">Seed to initialize the random number generator.</span>
<a name="2940"><font size=-1>2940     </font></a><span class="string">Should not be relevant except for testing purpose.</span>
<a name="2941"><font size=-1>2941     </font></a><span class="string">NOTE: If the CT-QMC ([[dmft_solv]] = 5) is used on many CPUs, each CPU</span>
<a name="2942"><font size=-1>2942     </font></a><span class="string">initializes its random number generator with dmftqmc_seed+rank where rank is</span>
<a name="2943"><font size=-1>2943     </font></a><span class="string">the rank of the cpu in the MPI communicator.</span>
<a name="2944"><font size=-1>2944     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2945"><font size=-1>2945     </font></a><span class="default">),</span>
<a name="2946"><font size=-1>2946     </font></a><span class="default"></span>
<a name="2947"><font size=-1>2947     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2948"><font size=-1>2948     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dmftqmc_therm&quot;</span><span class="default">,</span>
<a name="2949"><font size=-1>2949     </font></a><span class="default">    varset=</span><span class="string">&quot;dmft&quot;</span><span class="default">,</span>
<a name="2950"><font size=-1>2950     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="2951"><font size=-1>2951     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="2952"><font size=-1>2952     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2953"><font size=-1>2953     </font></a><span class="default">    defaultval=</span><span class="number">1000</span><span class="default">,</span>
<a name="2954"><font size=-1>2954     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Dynamical Mean Field Theory: Quantum Monte Carlo THERMalization&quot;</span><span class="default">,</span>
<a name="2955"><font size=-1>2955     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="2956"><font size=-1>2956     </font></a><span class="default">    requires=</span><span class="string">&quot;[[dmft_solv]] == 5&quot;</span><span class="default">,</span>
<a name="2957"><font size=-1>2957     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2958"><font size=-1>2958     </font></a><span class="string">Number of Monte Carlo sweeps for the thermalization</span>
<a name="2959"><font size=-1>2959     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2960"><font size=-1>2960     </font></a><span class="default">),</span>
<a name="2961"><font size=-1>2961     </font></a><span class="default"></span>
<a name="2962"><font size=-1>2962     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2963"><font size=-1>2963     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dosdeltae&quot;</span><span class="default">,</span>
<a name="2964"><font size=-1>2964     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="2965"><font size=-1>2965     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2966"><font size=-1>2966     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">, </span><span class="string">'ElecDOS_useful'</span><span class="default">],</span>
<a name="2967"><font size=-1>2967     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2968"><font size=-1>2968     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="2969"><font size=-1>2969     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;DOS DELTA in Energy&quot;</span><span class="default">,</span>
<a name="2970"><font size=-1>2970     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="2971"><font size=-1>2971     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2972"><font size=-1>2972     </font></a><span class="string">Defines the linear grid resolution (energy increment) to be used for the</span>
<a name="2973"><font size=-1>2973     </font></a><span class="string">computation of the Density-Of-States, when [[prtdos]] is non-zero.</span>
<a name="2974"><font size=-1>2974     </font></a><span class="string">If [[dosdeltae]] is set to zero (the default value), the actual increment is</span>
<a name="2975"><font size=-1>2975     </font></a><span class="string">0.001 Ha if [[prtdos]] = 1, and the much smaller value 0.00005 Ha if</span>
<a name="2976"><font size=-1>2976     </font></a><span class="string">[[prtdos]] = 2. This different default value arises because the [[prtdos]] = 1</span>
<a name="2977"><font size=-1>2977     </font></a><span class="string">case, based on a smearing technique, gives a quite smooth DOS, while the DOS</span>
<a name="2978"><font size=-1>2978     </font></a><span class="string">from the tetrahedron method, [[prtdos]] = 2, is rapidly varying.</span>
<a name="2979"><font size=-1>2979     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="2980"><font size=-1>2980     </font></a><span class="default">),</span>
<a name="2981"><font size=-1>2981     </font></a><span class="default"></span>
<a name="2982"><font size=-1>2982     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="2983"><font size=-1>2983     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dtion&quot;</span><span class="default">,</span>
<a name="2984"><font size=-1>2984     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="2985"><font size=-1>2985     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="2986"><font size=-1>2986     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_compulsory'</span><span class="default">, </span><span class="string">'MolecularDynamics_compulsory'</span><span class="default">, </span><span class="string">&quot;GeoOpt_compulsory&quot;</span><span class="default">],</span>
<a name="2987"><font size=-1>2987     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="2988"><font size=-1>2988     </font></a><span class="default">    defaultval=</span><span class="number">100</span><span class="default">,</span>
<a name="2989"><font size=-1>2989     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Delta Time for IONs&quot;</span><span class="default">,</span>
<a name="2990"><font size=-1>2990     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="2991"><font size=-1>2991     </font></a><span class="string">Used for controlling ion time steps. If [[ionmov]] is set to 1, 6, 7 and 15, then</span>
<a name="2992"><font size=-1>2992     </font></a><span class="string">molecular dynamics is  used to update atomic positions in response to forces.</span>
<a name="2993"><font size=-1>2993     </font></a><span class="string">The parameter [[dtion]] is a time step in atomic units of time. (One atomic</span>
<a name="2994"><font size=-1>2994     </font></a><span class="string">time unit is 2.418884e-17 seconds, which is the value of Planck's constant in</span>
<a name="2995"><font size=-1>2995     </font></a><span class="string">hartree*sec.) In this case the atomic masses, in amu (given in array &quot; [[amu]]</span>
<a name="2996"><font size=-1>2996     </font></a><span class="string">&quot;), are used in Newton's equation and the viscosity (for [[ionmov]] =1) and</span>
<a name="2997"><font size=-1>2997     </font></a><span class="string">number of time steps are provided to the code using input variables &quot;[[vis]]&quot;</span>
<a name="2998"><font size=-1>2998     </font></a><span class="string">and &quot;[[ntime]]&quot;. The code actually converts from masses in amu to masses in</span>
<a name="2999"><font size=-1>2999     </font></a><span class="string">atomic units (in units of electron masses) but the user enters masses in</span>
<a name="3000"><font size=-1>3000     </font></a><span class="string">[[amu]]. (The conversion from amu to atomic units (electron masses) is</span>
<a name="3001"><font size=-1>3001     </font></a><span class="string">1822.88851 electron masses/amu.)</span>
<a name="3002"><font size=-1>3002     </font></a><span class="string"></span>
<a name="3003"><font size=-1>3003     </font></a><span class="string">A typical good value for [[dtion]] is about 100. The user must try several</span>
<a name="3004"><font size=-1>3004     </font></a><span class="string">values for [[dtion]] in order to establish the stable and efficient choice for</span>
<a name="3005"><font size=-1>3005     </font></a><span class="string">the accompanying amu, atom types and positions, and [[vis]] (viscosity).</span>
<a name="3006"><font size=-1>3006     </font></a><span class="string">For quenched dynamics ([[ionmov]] = 7), a larger time step might be taken, for</span>
<a name="3007"><font size=-1>3007     </font></a><span class="string">example 200. No meaning for RF calculations.</span>
<a name="3008"><font size=-1>3008     </font></a><span class="string">It is also used in geometric relaxation calculation with the FIRE alogorithm</span>
<a name="3009"><font size=-1>3009     </font></a><span class="string">([[ionmov]]=15), where the time is virtual. A small dtion should be set, for example 0.03.</span>
<a name="3010"><font size=-1>3010     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3011"><font size=-1>3011     </font></a><span class="default">),</span>
<a name="3012"><font size=-1>3012     </font></a><span class="default"></span>
<a name="3013"><font size=-1>3013     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3014"><font size=-1>3014     </font></a><span class="default">    abivarname=</span><span class="string">&quot;dynimage&quot;</span><span class="default">,</span>
<a name="3015"><font size=-1>3015     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="3016"><font size=-1>3016     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3017"><font size=-1>3017     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_expert'</span><span class="default">, </span><span class="string">'TransPath_expert'</span><span class="default">],</span>
<a name="3018"><font size=-1>3018     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nimage]]'</span><span class="default">],</span>
<a name="3019"><font size=-1>3019     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">1</span><span class="default">),</span>
<a name="3020"><font size=-1>3020     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;list of DYNamic IMAGEs&quot;</span><span class="default">,</span>
<a name="3021"><font size=-1>3021     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;if [[imgmov]] in [2,5] (String Method, NEB), &lt;b&gt;dynimage(1)&lt;/b&gt;=0 and &lt;b&gt;dynimage([[nimage]])&lt;/b&gt;=0.&quot;</span><span class="default">,</span>
<a name="3022"><font size=-1>3022     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3023"><font size=-1>3023     </font></a><span class="string">This input variable is relevant when sets of images are activated (see</span>
<a name="3024"><font size=-1>3024     </font></a><span class="string">[[imgmov]]). Not all images might be required to evolve from one time step to</span>
<a name="3025"><font size=-1>3025     </font></a><span class="string">the other. Indeed, in the String Method or the Nudged Elastic Band, one might</span>
<a name="3026"><font size=-1>3026     </font></a><span class="string">impose that the extremal configurations of the string are fixed. In case</span>
<a name="3027"><font size=-1>3027     </font></a><span class="string">[[dynimage]](iimage)=0, the image with index &quot;iimage&quot; will be consider as</span>
<a name="3028"><font size=-1>3028     </font></a><span class="string">fixed. Thus, there is no need to compute forces and stresses for this image at</span>
<a name="3029"><font size=-1>3029     </font></a><span class="string">each time step. The purpose of defining extremal images is to make the input/output easier.</span>
<a name="3030"><font size=-1>3030     </font></a><span class="string"></span>
<a name="3031"><font size=-1>3031     </font></a><span class="string">In order to save CPU time, the computation of properties of static images</span>
<a name="3032"><font size=-1>3032     </font></a><span class="string">([[dynimage]](iimage)=0) can be avoided: see [[istatimg]] keyword.</span>
<a name="3033"><font size=-1>3033     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3034"><font size=-1>3034     </font></a><span class="default">),</span>
<a name="3035"><font size=-1>3035     </font></a><span class="default"></span>
<a name="3036"><font size=-1>3036     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3037"><font size=-1>3037     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ecut&quot;</span><span class="default">,</span>
<a name="3038"><font size=-1>3038     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="3039"><font size=-1>3039     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3040"><font size=-1>3040     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_compulsory'</span><span class="default">],</span>
<a name="3041"><font size=-1>3041     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3042"><font size=-1>3042     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Energy CUToff&quot;</span><span class="default">,</span>
<a name="3043"><font size=-1>3043     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3044"><font size=-1>3044     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3045"><font size=-1>3045     </font></a><span class="string">Used for kinetic energy cutoff which controls number of planewaves at given k point by:</span>
<a name="3046"><font size=-1>3046     </font></a><span class="string">(1/2)[(2 Pi)*(k+Gmax)]  2  =[[ecut]] for Gmax.</span>
<a name="3047"><font size=-1>3047     </font></a><span class="string"></span>
<a name="3048"><font size=-1>3048     </font></a><span class="string">All planewaves inside this &quot;basis sphere&quot; centered at k are included in the basis (except if [[dilatmx]] is defined).</span>
<a name="3049"><font size=-1>3049     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[ecut]] has the</span>
<a name="3050"><font size=-1>3050     </font></a><span class="string">'[[ENERGY]]' characteristics. (1 Ha=27.2113845 eV)</span>
<a name="3051"><font size=-1>3051     </font></a><span class="string">This is the single parameter which can have an enormous effect on the quality</span>
<a name="3052"><font size=-1>3052     </font></a><span class="string">of a calculation; basically the larger [[ecut]] is, the better converged the</span>
<a name="3053"><font size=-1>3053     </font></a><span class="string">calculation is. For fixed geometry, the total energy MUST always decrease as</span>
<a name="3054"><font size=-1>3054     </font></a><span class="string">[[ecut]] is raised because of the variational nature of the problem.</span>
<a name="3055"><font size=-1>3055     </font></a><span class="string"></span>
<a name="3056"><font size=-1>3056     </font></a><span class="string">_Usually one runs at least several calculations at various [[ecut]] to</span>
<a name="3057"><font size=-1>3057     </font></a><span class="string">investigate the convergence needed for reliable results._</span>
<a name="3058"><font size=-1>3058     </font></a><span class="string"></span>
<a name="3059"><font size=-1>3059     </font></a><span class="string">For k-points whose coordinates are build from 0 or 1/2, the implementation of</span>
<a name="3060"><font size=-1>3060     </font></a><span class="string">time-reversal symmetry that links coefficients of the wavefunctions in</span>
<a name="3061"><font size=-1>3061     </font></a><span class="string">reciprocal space has been realized. See the input variable [[istwfk]]. If</span>
<a name="3062"><font size=-1>3062     </font></a><span class="string">activated (which corresponds to the Default mode), this input variable</span>
<a name="3063"><font size=-1>3063     </font></a><span class="string">[[istwfk]] will allow to divide the number of plane wave (npw) treated</span>
<a name="3064"><font size=-1>3064     </font></a><span class="string">explicitly by a factor of two. Still, the final result should be identical</span>
<a name="3065"><font size=-1>3065     </font></a><span class="string">with the 'full' set of plane waves.</span>
<a name="3066"><font size=-1>3066     </font></a><span class="string"></span>
<a name="3067"><font size=-1>3067     </font></a><span class="string">See the input variable [[ecutsm]], for the smoothing of the kinetic energy,</span>
<a name="3068"><font size=-1>3068     </font></a><span class="string">needed to optimize unit cell parameters.</span>
<a name="3069"><font size=-1>3069     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3070"><font size=-1>3070     </font></a><span class="default">),</span>
<a name="3071"><font size=-1>3071     </font></a><span class="default"></span>
<a name="3072"><font size=-1>3072     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3073"><font size=-1>3073     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ecuteps&quot;</span><span class="default">,</span>
<a name="3074"><font size=-1>3074     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="3075"><font size=-1>3075     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3076"><font size=-1>3076     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_compulsory'</span><span class="default">, </span><span class="string">'RandStopPow_compulsory'</span><span class="default">],</span>
<a name="3077"><font size=-1>3077     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3078"><font size=-1>3078     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="3079"><font size=-1>3079     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Energy CUT-off for EPSilon (the dielectric matrix)&quot;</span><span class="default">,</span>
<a name="3080"><font size=-1>3080     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3081"><font size=-1>3081     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3, 4]&quot;</span><span class="default">,</span>
<a name="3082"><font size=-1>3082     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="3083"><font size=-1>3083     </font></a><span class="string">[[ecuteps]] determines the cut-off energy of the planewave set used to</span>
<a name="3084"><font size=-1>3084     </font></a><span class="string">represent the independent-particle susceptibility $\chi^{0}_{KS}$, the</span>
<a name="3085"><font size=-1>3085     </font></a><span class="string">dielectric matrix $\epsilon$, and its inverse.</span>
<a name="3086"><font size=-1>3086     </font></a><span class="string">It is not worth to take [[ecuteps]] bigger than four times [[ecutwfn]], this</span>
<a name="3087"><font size=-1>3087     </font></a><span class="string">latter limit corresponding to the highest Fourier components of a wavefunction</span>
<a name="3088"><font size=-1>3088     </font></a><span class="string">convoluted with itself. Usually, even twice the value of [[ecutwfn]] might</span>
<a name="3089"><font size=-1>3089     </font></a><span class="string">overkill. A value of [[ecuteps]] between 5 and 10 Hartree often (but not</span>
<a name="3090"><font size=-1>3090     </font></a><span class="string">always) leads to converged results (at the level of 0.01 eV for the energy</span>
<a name="3091"><font size=-1>3091     </font></a><span class="string">gap). In any case, a convergence study is worth.</span>
<a name="3092"><font size=-1>3092     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3093"><font size=-1>3093     </font></a><span class="default">),</span>
<a name="3094"><font size=-1>3094     </font></a><span class="default"></span>
<a name="3095"><font size=-1>3095     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3096"><font size=-1>3096     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ecutsigx&quot;</span><span class="default">,</span>
<a name="3097"><font size=-1>3097     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="3098"><font size=-1>3098     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3099"><font size=-1>3099     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_compulsory'</span><span class="default">],</span>
<a name="3100"><font size=-1>3100     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3101"><font size=-1>3101     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="3102"><font size=-1>3102     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Energy CUT-off for SIGma eXchange&quot;</span><span class="default">,</span>
<a name="3103"><font size=-1>3103     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3104"><font size=-1>3104     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="3105"><font size=-1>3105     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3106"><font size=-1>3106     </font></a><span class="string">[[ecutsigx]] determines the cut-off energy of the planewave set used to</span>
<a name="3107"><font size=-1>3107     </font></a><span class="string">generate the exchange part of the self-energy operator. For norm-conserving</span>
<a name="3108"><font size=-1>3108     </font></a><span class="string">calculations, it is pointless to have [[ecutsigx]] bigger than 4*[[ecut]],</span>
<a name="3109"><font size=-1>3109     </font></a><span class="string">while for PAW calculations, the maximal useful value is [[pawecutdg]]. Thus,</span>
<a name="3110"><font size=-1>3110     </font></a><span class="string">if you do not care about CPU time, please use these values. If you want to</span>
<a name="3111"><font size=-1>3111     </font></a><span class="string">spare some CPU time, you might try to use a value between [[ecut]] and these upper limits.</span>
<a name="3112"><font size=-1>3112     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3113"><font size=-1>3113     </font></a><span class="default">),</span>
<a name="3114"><font size=-1>3114     </font></a><span class="default"></span>
<a name="3115"><font size=-1>3115     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3116"><font size=-1>3116     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ecutsm&quot;</span><span class="default">,</span>
<a name="3117"><font size=-1>3117     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="3118"><font size=-1>3118     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3119"><font size=-1>3119     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_basic'</span><span class="default">],</span>
<a name="3120"><font size=-1>3120     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3121"><font size=-1>3121     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="3122"><font size=-1>3122     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Energy CUToff SMearing&quot;</span><span class="default">,</span>
<a name="3123"><font size=-1>3123     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3124"><font size=-1>3124     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3125"><font size=-1>3125     </font></a><span class="string">This input variable is important when performing relaxation of unit cell size</span>
<a name="3126"><font size=-1>3126     </font></a><span class="string">and shape (non-zero [[optcell]]). Using a non-zero [[ecutsm]], the total</span>
<a name="3127"><font size=-1>3127     </font></a><span class="string">energy curves as a function of [[ecut]], or [[acell]], can be smoothed,</span>
<a name="3128"><font size=-1>3128     </font></a><span class="string">keeping consistency with the stress (and automatically including the Pulay</span>
<a name="3129"><font size=-1>3129     </font></a><span class="string">stress). The recommended value is 0.5 Ha. Actually, when [[optcell]]/=0,</span>
<a name="3130"><font size=-1>3130     </font></a><span class="string">ABINIT requires [[ecutsm]] to be larger than zero. If you want to optimize</span>
<a name="3131"><font size=-1>3131     </font></a><span class="string">cell shape and size without smoothing the total energy curve (a dangerous</span>
<a name="3132"><font size=-1>3132     </font></a><span class="string">thing to do), use a very small [[ecutsm]], on the order of one microHartree.</span>
<a name="3133"><font size=-1>3133     </font></a><span class="string"></span>
<a name="3134"><font size=-1>3134     </font></a><span class="string">Technical information:</span>
<a name="3135"><font size=-1>3135     </font></a><span class="string">See [[cite:Bernasconi1995]]for a related method using constant pressure molecular dynamics.</span>
<a name="3136"><font size=-1>3136     </font></a><span class="string">[[ecutsm]] allows one to define an effective kinetic energy for plane waves, close</span>
<a name="3137"><font size=-1>3137     </font></a><span class="string">to, but lower than the maximal kinetic energy [[ecut]]. For kinetic energies</span>
<a name="3138"><font size=-1>3138     </font></a><span class="string">less than [[ecut]]-[[ecutsm]], nothing is modified, while between</span>
<a name="3139"><font size=-1>3139     </font></a><span class="string">[[ecut]]-[[ecutsm]] and [[ecut]], the kinetic energy is multiplied by:</span>
<a name="3140"><font size=-1>3140     </font></a><span class="string">1.0 / ( x  2  (3+x-6x  2  +3x  3  ))</span>
<a name="3141"><font size=-1>3141     </font></a><span class="string">where x = ([[ecut]] - kinetic_energy)/[[ecutsm]]</span>
<a name="3142"><font size=-1>3142     </font></a><span class="string">Note that x 2  ( 3+x-6x  2  +3x  3  ) is 0 at x=0, with vanishing derivative,</span>
<a name="3143"><font size=-1>3143     </font></a><span class="string">and that at x=1, it is 1, with also vanishing derivative.</span>
<a name="3144"><font size=-1>3144     </font></a><span class="string">If [[ecutsm]] is zero, the unmodified kinetic energy is used.</span>
<a name="3145"><font size=-1>3145     </font></a><span class="string">[[ecutsm]] can be specified in Ha (the default), Ry, eV or Kelvin, since</span>
<a name="3146"><font size=-1>3146     </font></a><span class="string">[[ecutsm]] has the '[[ENERGY]]' characteristics. (1 Ha=27.2113845 eV).</span>
<a name="3147"><font size=-1>3147     </font></a><span class="string">A few test for Silicon (diamond structure, 2 k-points) have shown 0.5 Ha to be</span>
<a name="3148"><font size=-1>3148     </font></a><span class="string">largely enough for [[ecut]] between 2Ha and 6Ha, to get smooth curves. It is</span>
<a name="3149"><font size=-1>3149     </font></a><span class="string">likely that this value is OK as soon as [[ecut]] is larger than 4Ha.</span>
<a name="3150"><font size=-1>3150     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3151"><font size=-1>3151     </font></a><span class="default">),</span>
<a name="3152"><font size=-1>3152     </font></a><span class="default"></span>
<a name="3153"><font size=-1>3153     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3154"><font size=-1>3154     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ecutwfn&quot;</span><span class="default">,</span>
<a name="3155"><font size=-1>3155     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="3156"><font size=-1>3156     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3157"><font size=-1>3157     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_compulsory'</span><span class="default">, </span><span class="string">'SelfEnergy_compulsory'</span><span class="default">],</span>
<a name="3158"><font size=-1>3158     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3159"><font size=-1>3159     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[optdriver]] in [3, 4]'</span><span class="default">: </span><span class="string">'[[ecut]]'</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0.0</span><span class="default">}),</span>
<a name="3160"><font size=-1>3160     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Energy CUT-off for WaveFunctioNs&quot;</span><span class="default">,</span>
<a name="3161"><font size=-1>3161     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3162"><font size=-1>3162     </font></a><span class="default">    requires=</span><span class="string">&quot; [[optdriver]] in [3, 4]&quot;</span><span class="default">,</span>
<a name="3163"><font size=-1>3163     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="3164"><font size=-1>3164     </font></a><span class="string">[[ecutwfn]] determines the cut-off energy of the planewave set used to</span>
<a name="3165"><font size=-1>3165     </font></a><span class="string">represent the wavefunctions in the formula that generates the independent-</span>
<a name="3166"><font size=-1>3166     </font></a><span class="string">particle susceptibility $\chi^{0}_{KS}$ (for [[optdriver]] = 3), or the self-</span>
<a name="3167"><font size=-1>3167     </font></a><span class="string">energy (for [[optdriver]] = 4).</span>
<a name="3168"><font size=-1>3168     </font></a><span class="string">Usually, [[ecutwfn]] is smaller than [[ecut]], so that the wavefunctions are</span>
<a name="3169"><font size=-1>3169     </font></a><span class="string">filtered, and some components are ignored. As a side effect, the wavefunctions</span>
<a name="3170"><font size=-1>3170     </font></a><span class="string">are no more normalized, and also, no more orthogonal. Also, the set of plane</span>
<a name="3171"><font size=-1>3171     </font></a><span class="string">waves can be much smaller for [[optdriver]] = 3, than for [[optdriver]] = 4,</span>
<a name="3172"><font size=-1>3172     </font></a><span class="string">although a convergence study is needed to choose correctly both values.</span>
<a name="3173"><font size=-1>3173     </font></a><span class="string"></span>
<a name="3174"><font size=-1>3174     </font></a><span class="string">The size of this set of planewaves is [[npwwfn]].</span>
<a name="3175"><font size=-1>3175     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3176"><font size=-1>3176     </font></a><span class="default">),</span>
<a name="3177"><font size=-1>3177     </font></a><span class="default"></span>
<a name="3178"><font size=-1>3178     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3179"><font size=-1>3179     </font></a><span class="default">    abivarname=</span><span class="string">&quot;effmass_free&quot;</span><span class="default">,</span>
<a name="3180"><font size=-1>3180     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3181"><font size=-1>3181     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3182"><font size=-1>3182     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_expert'</span><span class="default">],</span>
<a name="3183"><font size=-1>3183     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3184"><font size=-1>3184     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="3185"><font size=-1>3185     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFFective MASS for the FREE electron&quot;</span><span class="default">,</span>
<a name="3186"><font size=-1>3186     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="3187"><font size=-1>3187     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3188"><font size=-1>3188     </font></a><span class="string">This parameter allows one to change the free electron mass, with respect to its experimental value.</span>
<a name="3189"><font size=-1>3189     </font></a><span class="string">The electron mass is simply changed in the Schrodinger equation.</span>
<a name="3190"><font size=-1>3190     </font></a><span class="string">Only for testing purposes, of course.</span>
<a name="3191"><font size=-1>3191     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3192"><font size=-1>3192     </font></a><span class="default">),</span>
<a name="3193"><font size=-1>3193     </font></a><span class="default"></span>
<a name="3194"><font size=-1>3194     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3195"><font size=-1>3195     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efield&quot;</span><span class="default">,</span>
<a name="3196"><font size=-1>3196     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="3197"><font size=-1>3197     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3198"><font size=-1>3198     </font></a><span class="default">    topics=[</span><span class="string">'Berry_basic'</span><span class="default">],</span>
<a name="3199"><font size=-1>3199     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="3200"><font size=-1>3200     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="3201"><font size=-1>3201     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electric FIELD&quot;</span><span class="default">,</span>
<a name="3202"><font size=-1>3202     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] in [4, 6]&quot;</span><span class="default">,</span>
<a name="3203"><font size=-1>3203     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3204"><font size=-1>3204     </font></a><span class="string">In case [[berryopt]] = 4, a finite electric field calculation is performed. The</span>
<a name="3205"><font size=-1>3205     </font></a><span class="string">value of this electric field, and its direction is determined by [[efield]].</span>
<a name="3206"><font size=-1>3206     </font></a><span class="string">It must be given in atomic units (1 a.u. of electric field= 514220624373.482</span>
<a name="3207"><font size=-1>3207     </font></a><span class="string">V/m, see note below), in cartesian coordinates.</span>
<a name="3208"><font size=-1>3208     </font></a><span class="string"></span>
<a name="3209"><font size=-1>3209     </font></a><span class="string">References for the calculation under electric field (based on multi k point Berry phase):</span>
<a name="3210"><font size=-1>3210     </font></a><span class="string"></span>
<a name="3211"><font size=-1>3211     </font></a><span class="string">  * [[cite:Nunes1994]]: real-space version of the finite-field Hamiltonian</span>
<a name="3212"><font size=-1>3212     </font></a><span class="string">  * [[cite:Nunes2001]]: reciprocal-space version of the finite-field Hamiltonian (the one presently implemented), and extensive theoretical analysis</span>
<a name="3213"><font size=-1>3213     </font></a><span class="string">  * [[cite:Souza2002]]: implementation of the finite-field Hamiltonian (reciprocal-space version)</span>
<a name="3214"><font size=-1>3214     </font></a><span class="string">  * [[cite:Zwanziger2012]]: extension to PAW formalism</span>
<a name="3215"><font size=-1>3215     </font></a><span class="string"></span>
<a name="3216"><font size=-1>3216     </font></a><span class="string">See also [[cite:Umari2003]].</span>
<a name="3217"><font size=-1>3217     </font></a><span class="string"></span>
<a name="3218"><font size=-1>3218     </font></a><span class="string">!!! note</span>
<a name="3219"><font size=-1>3219     </font></a><span class="string"></span>
<a name="3220"><font size=-1>3220     </font></a><span class="string">    The atomic unit of electric field strength is: $\\frac{e_{Cb}}{4\pi\\varepsilon_0a_0^2}$, where</span>
<a name="3221"><font size=-1>3221     </font></a><span class="string">    $e_{Cb}$ is the electronic charge in Coulomb (1.60217653$^{-19}$), $\\varepsilon_0$ is the</span>
<a name="3222"><font size=-1>3222     </font></a><span class="string">    electric constant (8.854187817d-12 F/m), and $a_0$ is the Bohr radius in meter</span>
<a name="3223"><font size=-1>3223     </font></a><span class="string">    (0.5291772108$^{-10}$).</span>
<a name="3224"><font size=-1>3224     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3225"><font size=-1>3225     </font></a><span class="default">),</span>
<a name="3226"><font size=-1>3226     </font></a><span class="default"></span>
<a name="3227"><font size=-1>3227     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3228"><font size=-1>3228     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas&quot;</span><span class="default">,</span>
<a name="3229"><font size=-1>3229     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3230"><font size=-1>3230     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3231"><font size=-1>3231     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_compulsory'</span><span class="default">],</span>
<a name="3232"><font size=-1>3232     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3233"><font size=-1>3233     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3234"><font size=-1>3234     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs&quot;</span><span class="default">,</span>
<a name="3235"><font size=-1>3235     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3236"><font size=-1>3236     </font></a><span class="string">Turns on effective mass tensor calculations. Such calculations requires the</span>
<a name="3237"><font size=-1>3237     </font></a><span class="string">non-self-consistent calculation of derivatives with respect to k, in the same</span>
<a name="3238"><font size=-1>3238     </font></a><span class="string">dataset. It must therefore be used with [[rfelfd]] = 2 (or 1).</span>
<a name="3239"><font size=-1>3239     </font></a><span class="string"></span>
<a name="3240"><font size=-1>3240     </font></a><span class="string">  * 0 --&gt; no effective mass tensor calculation</span>
<a name="3241"><font size=-1>3241     </font></a><span class="string">  * 1 --&gt; effective mass tensor calculation</span>
<a name="3242"><font size=-1>3242     </font></a><span class="string">!!! note</span>
<a name="3243"><font size=-1>3243     </font></a><span class="string">    At the present time, both norm-conserving (NC) and PAW calculations are</span>
<a name="3244"><font size=-1>3244     </font></a><span class="string">    supported. Also, for PAW calculations only, [[nspinor]] == 2 and</span>
<a name="3245"><font size=-1>3245     </font></a><span class="string">    [[pawspnorb]] == 1 (i.e. spin-orbit (SO) calculations) is supported. NC SO</span>
<a name="3246"><font size=-1>3246     </font></a><span class="string">    calculations are NOT currently supported. Also, for both NC and PAW,</span>
<a name="3247"><font size=-1>3247     </font></a><span class="string">    [[nspden]]/=1 and [[nsppol]]/=1 are NOT supported.</span>
<a name="3248"><font size=-1>3248     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3249"><font size=-1>3249     </font></a><span class="default">),</span>
<a name="3250"><font size=-1>3250     </font></a><span class="default"></span>
<a name="3251"><font size=-1>3251     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3252"><font size=-1>3252     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_bands&quot;</span><span class="default">,</span>
<a name="3253"><font size=-1>3253     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3254"><font size=-1>3254     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3255"><font size=-1>3255     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_useful'</span><span class="default">],</span>
<a name="3256"><font size=-1>3256     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">, </span><span class="string">'[[nkpt]]'</span><span class="default">],</span>
<a name="3257"><font size=-1>3257     </font></a><span class="default">    defaultval=</span><span class="string">&quot;The full range of band available in the calculation for each k-point.&quot;</span><span class="default">,</span>
<a name="3258"><font size=-1>3258     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, BANDS to be treated.&quot;</span><span class="default">,</span>
<a name="3259"><font size=-1>3259     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas]] == 1&quot;</span><span class="default">,</span>
<a name="3260"><font size=-1>3260     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3261"><font size=-1>3261     </font></a><span class="string">This variable controls the range of bands for which the effective mass is to</span>
<a name="3262"><font size=-1>3262     </font></a><span class="string">be calculated. If a band is degenerate, all other bands of the degenerate</span>
<a name="3263"><font size=-1>3263     </font></a><span class="string">group will automatically be treated, even if they were not part of the user specified range.</span>
<a name="3264"><font size=-1>3264     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3265"><font size=-1>3265     </font></a><span class="default">),</span>
<a name="3266"><font size=-1>3266     </font></a><span class="default"></span>
<a name="3267"><font size=-1>3267     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3268"><font size=-1>3268     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_calc_dirs&quot;</span><span class="default">,</span>
<a name="3269"><font size=-1>3269     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3270"><font size=-1>3270     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3271"><font size=-1>3271     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_useful'</span><span class="default">],</span>
<a name="3272"><font size=-1>3272     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3273"><font size=-1>3273     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3274"><font size=-1>3274     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, CALCulate along DIRectionS&quot;</span><span class="default">,</span>
<a name="3275"><font size=-1>3275     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas]] == 1&quot;</span><span class="default">,</span>
<a name="3276"><font size=-1>3276     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3277"><font size=-1>3277     </font></a><span class="string">Allows the user to calculate the scalar effective mass of all bands specified</span>
<a name="3278"><font size=-1>3278     </font></a><span class="string">by [[efmas_bands]] along specific directions in reciprocal space. This is</span>
<a name="3279"><font size=-1>3279     </font></a><span class="string">particularly useful when considering degenerate bands, which are usually</span>
<a name="3280"><font size=-1>3280     </font></a><span class="string">warped, and thus cannot have their dispersion (hessian) and effective mass</span>
<a name="3281"><font size=-1>3281     </font></a><span class="string">expressed as a tensor. This allows the user to see the more complex angular</span>
<a name="3282"><font size=-1>3282     </font></a><span class="string">behavior of effective masses in these cases, for instance.</span>
<a name="3283"><font size=-1>3283     </font></a><span class="string"></span>
<a name="3284"><font size=-1>3284     </font></a><span class="string">When [[efmas_calc_dirs]] == 0, no directions are read from the input file (using</span>
<a name="3285"><font size=-1>3285     </font></a><span class="string">[[efmas_dirs]]) and the effective masses along the 3 cartesian directions are</span>
<a name="3286"><font size=-1>3286     </font></a><span class="string">output by default.</span>
<a name="3287"><font size=-1>3287     </font></a><span class="string"></span>
<a name="3288"><font size=-1>3288     </font></a><span class="string">When [[efmas_calc_dirs]] == 1, 2 or 3, [[efmas_n_dirs]] directions are read from</span>
<a name="3289"><font size=-1>3289     </font></a><span class="string">[[efmas_dirs]], assuming cartesian, reduced or angular ($\\theta$,$\phi$)</span>
<a name="3290"><font size=-1>3290     </font></a><span class="string">coordinates, respectively. In the case [[efmas_calc_dirs]] == 3, 2 real values</span>
<a name="3291"><font size=-1>3291     </font></a><span class="string">per directions are read, whereas 3 real values are read in the two other cases.</span>
<a name="3292"><font size=-1>3292     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3293"><font size=-1>3293     </font></a><span class="default">),</span>
<a name="3294"><font size=-1>3294     </font></a><span class="default"></span>
<a name="3295"><font size=-1>3295     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3296"><font size=-1>3296     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_deg&quot;</span><span class="default">,</span>
<a name="3297"><font size=-1>3297     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3298"><font size=-1>3298     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3299"><font size=-1>3299     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_expert'</span><span class="default">],</span>
<a name="3300"><font size=-1>3300     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3301"><font size=-1>3301     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="3302"><font size=-1>3302     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, activate DEGenerate formalism&quot;</span><span class="default">,</span>
<a name="3303"><font size=-1>3303     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas]] &gt; 0&quot;</span><span class="default">,</span>
<a name="3304"><font size=-1>3304     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3305"><font size=-1>3305     </font></a><span class="string">Activate (==1) or not (==0) the treatment of degenerate bands</span>
<a name="3306"><font size=-1>3306     </font></a><span class="string">(criterion [[efmas_deg_tol]] is used to determine whether bands are degenerate).</span>
<a name="3307"><font size=-1>3307     </font></a><span class="string">Also compute the transport equivalent effective mass (see [[cite:Mecholsky2014]]).</span>
<a name="3308"><font size=-1>3308     </font></a><span class="string"></span>
<a name="3309"><font size=-1>3309     </font></a><span class="string">[[efmas]] = 0 should only be used for testing purposes.</span>
<a name="3310"><font size=-1>3310     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3311"><font size=-1>3311     </font></a><span class="default">),</span>
<a name="3312"><font size=-1>3312     </font></a><span class="default"></span>
<a name="3313"><font size=-1>3313     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3314"><font size=-1>3314     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_deg_tol&quot;</span><span class="default">,</span>
<a name="3315"><font size=-1>3315     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3316"><font size=-1>3316     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3317"><font size=-1>3317     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_useful'</span><span class="default">],</span>
<a name="3318"><font size=-1>3318     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3319"><font size=-1>3319     </font></a><span class="default">    defaultval=</span><span class="number">1e-05</span><span class="default">,</span>
<a name="3320"><font size=-1>3320     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, DEGeneracy TOLerance&quot;</span><span class="default">,</span>
<a name="3321"><font size=-1>3321     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas_deg]] == 1&quot;</span><span class="default">,</span>
<a name="3322"><font size=-1>3322     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3323"><font size=-1>3323     </font></a><span class="string">Energy difference below which 2 bands are considered degenerate (and treated</span>
<a name="3324"><font size=-1>3324     </font></a><span class="string">using the formalism activated with [[efmas_deg]] == 1). [[efmas_deg_tol]] has</span>
<a name="3325"><font size=-1>3325     </font></a><span class="string">the '[[ENERGY]]' characteristics.</span>
<a name="3326"><font size=-1>3326     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3327"><font size=-1>3327     </font></a><span class="default">),</span>
<a name="3328"><font size=-1>3328     </font></a><span class="default"></span>
<a name="3329"><font size=-1>3329     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3330"><font size=-1>3330     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_dim&quot;</span><span class="default">,</span>
<a name="3331"><font size=-1>3331     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3332"><font size=-1>3332     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3333"><font size=-1>3333     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_useful'</span><span class="default">],</span>
<a name="3334"><font size=-1>3334     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3335"><font size=-1>3335     </font></a><span class="default">    defaultval=</span><span class="number">3</span><span class="default">,</span>
<a name="3336"><font size=-1>3336     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, DIMension of the effective mass tensor&quot;</span><span class="default">,</span>
<a name="3337"><font size=-1>3337     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas]] == 1&quot;</span><span class="default">,</span>
<a name="3338"><font size=-1>3338     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3339"><font size=-1>3339     </font></a><span class="string">For 2D or 1D systems, the band dispersion goes to 0 perpendicular to the</span>
<a name="3340"><font size=-1>3340     </font></a><span class="string">system, which causes the inverse effective mass to be singular, i.e. the</span>
<a name="3341"><font size=-1>3341     </font></a><span class="string">effective mass to be NaN. This keyword circumvents the problem by eliminating</span>
<a name="3342"><font size=-1>3342     </font></a><span class="string">the troublesome dimensions from the inverse effective mass.</span>
<a name="3343"><font size=-1>3343     </font></a><span class="string"></span>
<a name="3344"><font size=-1>3344     </font></a><span class="string">In 2D, the Z axis is ignored and, in 1D, the Z and Y axis are ignored.</span>
<a name="3345"><font size=-1>3345     </font></a><span class="string"></span>
<a name="3346"><font size=-1>3346     </font></a><span class="string">Also, note that in the 2D degenerate case, a subtlety arises: the 'transport</span>
<a name="3347"><font size=-1>3347     </font></a><span class="string">equivalent' effective mass does not determine the scale of the transport</span>
<a name="3348"><font size=-1>3348     </font></a><span class="string">tensors (conductivity and others). Therefore, for this specific case, the</span>
<a name="3349"><font size=-1>3349     </font></a><span class="string">factor by which these transport tensors should be scaled once determined from</span>
<a name="3350"><font size=-1>3350     </font></a><span class="string">the 'transport equivalent' effective mass tensor is output separately on the</span>
<a name="3351"><font size=-1>3351     </font></a><span class="string">line immediately after the effective mass.</span>
<a name="3352"><font size=-1>3352     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3353"><font size=-1>3353     </font></a><span class="default">),</span>
<a name="3354"><font size=-1>3354     </font></a><span class="default"></span>
<a name="3355"><font size=-1>3355     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3356"><font size=-1>3356     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_dirs&quot;</span><span class="default">,</span>
<a name="3357"><font size=-1>3357     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3358"><font size=-1>3358     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3359"><font size=-1>3359     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_basic'</span><span class="default">],</span>
<a name="3360"><font size=-1>3360     </font></a><span class="default">    dimensions=[</span><span class="string">'3 or 2'</span><span class="default">, </span><span class="string">'[[efmas_n_dirs]]'</span><span class="default">],</span>
<a name="3361"><font size=-1>3361     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3362"><font size=-1>3362     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, DIRectionS to be calculated&quot;</span><span class="default">,</span>
<a name="3363"><font size=-1>3363     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas_calc_dirs]] &gt; 0&quot;</span><span class="default">,</span>
<a name="3364"><font size=-1>3364     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3365"><font size=-1>3365     </font></a><span class="string">List of [[efmas_n_dirs]] directions to be considered according to the value of</span>
<a name="3366"><font size=-1>3366     </font></a><span class="string">[[efmas_calc_dirs]]. The directions are specified by 3 real values if</span>
<a name="3367"><font size=-1>3367     </font></a><span class="string">[[efmas_calc_dirs]] == 1 or 2 and by 2 real values if [[efmas_calc_dirs]] == 3.</span>
<a name="3368"><font size=-1>3368     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3369"><font size=-1>3369     </font></a><span class="default">),</span>
<a name="3370"><font size=-1>3370     </font></a><span class="default"></span>
<a name="3371"><font size=-1>3371     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3372"><font size=-1>3372     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_n_dirs&quot;</span><span class="default">,</span>
<a name="3373"><font size=-1>3373     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3374"><font size=-1>3374     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3375"><font size=-1>3375     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_basic'</span><span class="default">],</span>
<a name="3376"><font size=-1>3376     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3377"><font size=-1>3377     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3378"><font size=-1>3378     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, Number of DIRectionS&quot;</span><span class="default">,</span>
<a name="3379"><font size=-1>3379     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas_calc_dirs]] &gt; 0&quot;</span><span class="default">,</span>
<a name="3380"><font size=-1>3380     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3381"><font size=-1>3381     </font></a><span class="string">Number of directions in [[efmas_dirs]], to be considered according to [[efmas_calc_dirs]].</span>
<a name="3382"><font size=-1>3382     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3383"><font size=-1>3383     </font></a><span class="default">),</span>
<a name="3384"><font size=-1>3384     </font></a><span class="default"></span>
<a name="3385"><font size=-1>3385     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3386"><font size=-1>3386     </font></a><span class="default">    abivarname=</span><span class="string">&quot;efmas_ntheta&quot;</span><span class="default">,</span>
<a name="3387"><font size=-1>3387     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3388"><font size=-1>3388     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3389"><font size=-1>3389     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_basic'</span><span class="default">],</span>
<a name="3390"><font size=-1>3390     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3391"><font size=-1>3391     </font></a><span class="default">    defaultval=</span><span class="number">1000</span><span class="default">,</span>
<a name="3392"><font size=-1>3392     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EFfective MASs, Number of points for integration w/r to THETA&quot;</span><span class="default">,</span>
<a name="3393"><font size=-1>3393     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas]] == 1 and [[efmas_bands]] == (degenerate band index)&quot;</span><span class="default">,</span>
<a name="3394"><font size=-1>3394     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3395"><font size=-1>3395     </font></a><span class="string">When a band is degenerate, the usual definition of effective mass becomes</span>
<a name="3396"><font size=-1>3396     </font></a><span class="string">invalid. However, it is still possible to define a 'transport equivalent mass</span>
<a name="3397"><font size=-1>3397     </font></a><span class="string">tensor' that reproduces the contribution of the band to the conductivity</span>
<a name="3398"><font size=-1>3398     </font></a><span class="string">tensor. To obtain this tensor, an integration over the solid sphere is</span>
<a name="3399"><font size=-1>3399     </font></a><span class="string">required. The angular variables are sampled using [[efmas_ntheta]] points for the theta coordinate,</span>
<a name="3400"><font size=-1>3400     </font></a><span class="string">and twice [[efmas_ntheta]] points for the phi coordinate.</span>
<a name="3401"><font size=-1>3401     </font></a><span class="string">The default value gives a tensor accurate to the 4th decimal in Ge.</span>
<a name="3402"><font size=-1>3402     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3403"><font size=-1>3403     </font></a><span class="default">),</span>
<a name="3404"><font size=-1>3404     </font></a><span class="default"></span>
<a name="3405"><font size=-1>3405     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3406"><font size=-1>3406     </font></a><span class="default">    abivarname=</span><span class="string">&quot;einterp&quot;</span><span class="default">,</span>
<a name="3407"><font size=-1>3407     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="3408"><font size=-1>3408     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3409"><font size=-1>3409     </font></a><span class="default">    topics=[</span><span class="string">'ElecBandStructure_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="3410"><font size=-1>3410     </font></a><span class="default">    dimensions=[</span><span class="number">4</span><span class="default">],</span>
<a name="3411"><font size=-1>3411     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="3412"><font size=-1>3412     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron bands INTERPolation&quot;</span><span class="default">,</span>
<a name="3413"><font size=-1>3413     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3414"><font size=-1>3414     </font></a><span class="string">This variable activates the interpolation of the electronic eigenvalues. It</span>
<a name="3415"><font size=-1>3415     </font></a><span class="string">can be used to interpolate KS eigenvalues at the end of the GS run or to</span>
<a name="3416"><font size=-1>3416     </font></a><span class="string">interpolate GW energies in sigma calculations ([[optdriver]] = 4). The k-path</span>
<a name="3417"><font size=-1>3417     </font></a><span class="string">can be specified with [[kptbounds]] and [[nkpath]]. einterp consists of 4</span>
<a name="3418"><font size=-1>3418     </font></a><span class="string">entries. The first element specificies the interpolation method.</span>
<a name="3419"><font size=-1>3419     </font></a><span class="string"></span>
<a name="3420"><font size=-1>3420     </font></a><span class="string">  * 0 --&gt; No interpolation (default)</span>
<a name="3421"><font size=-1>3421     </font></a><span class="string">  * 1 --&gt; Star-function interpolation (Shankland-Koelling-Wood Fourier interpolation scheme, see [[cite:Pickett1988]]</span>
<a name="3422"><font size=-1>3422     </font></a><span class="string">  * 2 --&gt; B-spline interpolation.</span>
<a name="3423"><font size=-1>3423     </font></a><span class="string"></span>
<a name="3424"><font size=-1>3424     </font></a><span class="string">The meaning of the other entries depend on the interpolation technique</span>
<a name="3425"><font size=-1>3425     </font></a><span class="string">selected.</span>
<a name="3426"><font size=-1>3426     </font></a><span class="string">In the case of star-function interpolation:</span>
<a name="3427"><font size=-1>3427     </font></a><span class="string"></span>
<a name="3428"><font size=-1>3428     </font></a><span class="string">  * einterp(2): Number of star-functions per ab-initio k-point</span>
<a name="3429"><font size=-1>3429     </font></a><span class="string">  * einterp(3): If non-zero, activate Fourier filtering according to Eq 9 of [[cite:Uehara2000]].</span>
<a name="3430"><font size=-1>3430     </font></a><span class="string">    In this case, rcut is given by einterp(2) * Rmax where Rmax is the maximum length of</span>
<a name="3431"><font size=-1>3431     </font></a><span class="string">    the lattice vectors included in the star expansion</span>
<a name="3432"><font size=-1>3432     </font></a><span class="string">  * einterp(4): Used if einterp(2) /= 0. It defines rsigma in Eq 9</span>
<a name="3433"><font size=-1>3433     </font></a><span class="string"></span>
<a name="3434"><font size=-1>3434     </font></a><span class="string">For B-spline interpolation: einterp(2:4): Order of B-spline for the three</span>
<a name="3435"><font size=-1>3435     </font></a><span class="string">reduced directions. Cubic spline (3) is the recommended value.</span>
<a name="3436"><font size=-1>3436     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3437"><font size=-1>3437     </font></a><span class="default">),</span>
<a name="3438"><font size=-1>3438     </font></a><span class="default"></span>
<a name="3439"><font size=-1>3439     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3440"><font size=-1>3440     </font></a><span class="default">    abivarname=</span><span class="string">&quot;elph2_imagden&quot;</span><span class="default">,</span>
<a name="3441"><font size=-1>3441     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3442"><font size=-1>3442     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3443"><font size=-1>3443     </font></a><span class="default">    topics=[</span><span class="string">'TDepES_basic'</span><span class="default">],</span>
<a name="3444"><font size=-1>3444     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3445"><font size=-1>3445     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="3446"><font size=-1>3446     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ELectron-PHonon interaction at 2nd order: IMAGinary shift of the DENominator&quot;</span><span class="default">,</span>
<a name="3447"><font size=-1>3447     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3448"><font size=-1>3448     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ieig2rf]] != 0&quot;</span><span class="default">,</span>
<a name="3449"><font size=-1>3449     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3450"><font size=-1>3450     </font></a><span class="string"></span>
<a name="3451"><font size=-1>3451     </font></a><span class="string">The variable [[elph2_imagden]] determines the imaginary shift of the</span>
<a name="3452"><font size=-1>3452     </font></a><span class="string">denominator of the sum-over-states in the perturbation,</span>
<a name="3453"><font size=-1>3453     </font></a><span class="string">$(e_{nk}-e_{n'k'}+i$[[elph2_imagden]]). One should use a width comparable with</span>
<a name="3454"><font size=-1>3454     </font></a><span class="string">the Debye frequency or the maximum phonon frequency.</span>
<a name="3455"><font size=-1>3455     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[ecut]] has the</span>
<a name="3456"><font size=-1>3456     </font></a><span class="string">'[[ENERGY]]' characteristics (1 Ha=27.2113845 eV).</span>
<a name="3457"><font size=-1>3457     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3458"><font size=-1>3458     </font></a><span class="default">),</span>
<a name="3459"><font size=-1>3459     </font></a><span class="default"></span>
<a name="3460"><font size=-1>3460     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3461"><font size=-1>3461     </font></a><span class="default">    abivarname=</span><span class="string">&quot;enunit&quot;</span><span class="default">,</span>
<a name="3462"><font size=-1>3462     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="3463"><font size=-1>3463     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3464"><font size=-1>3464     </font></a><span class="default">    topics=[</span><span class="string">'Output_useful'</span><span class="default">,</span><span class="string">'ElecBandStructure_useful'</span><span class="default">],</span>
<a name="3465"><font size=-1>3465     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3466"><font size=-1>3466     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3467"><font size=-1>3467     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ENergy UNITs&quot;</span><span class="default">,</span>
<a name="3468"><font size=-1>3468     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3469"><font size=-1>3469     </font></a><span class="string">Governs the units to be used for output of eigenvalues (and eventual phonon frequencies)</span>
<a name="3470"><font size=-1>3470     </font></a><span class="string"></span>
<a name="3471"><font size=-1>3471     </font></a><span class="string">  * 0  --&gt; print eigenvalues in hartree;</span>
<a name="3472"><font size=-1>3472     </font></a><span class="string">  * 1  --&gt; print eigenvalues in eV;</span>
<a name="3473"><font size=-1>3473     </font></a><span class="string">  * 2  --&gt; print eigenvalues in both hartree and eV.</span>
<a name="3474"><font size=-1>3474     </font></a><span class="string"></span>
<a name="3475"><font size=-1>3475     </font></a><span class="string">If phonon frequencies are to be computed:</span>
<a name="3476"><font size=-1>3476     </font></a><span class="string"></span>
<a name="3477"><font size=-1>3477     </font></a><span class="string">  * 0  --&gt;  phonon frequencies in Hartree and cm-1;</span>
<a name="3478"><font size=-1>3478     </font></a><span class="string">  * 1  --&gt;  phonon frequencies in eV and THz;</span>
<a name="3479"><font size=-1>3479     </font></a><span class="string">  * 2  --&gt;  phonon frequencies in hartree, eV, cm-1, Thz and Kelvin.</span>
<a name="3480"><font size=-1>3480     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3481"><font size=-1>3481     </font></a><span class="default">),</span>
<a name="3482"><font size=-1>3482     </font></a><span class="default"></span>
<a name="3483"><font size=-1>3483     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3484"><font size=-1>3484     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_extrael&quot;</span><span class="default">,</span>
<a name="3485"><font size=-1>3485     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3486"><font size=-1>3486     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3487"><font size=-1>3487     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3488"><font size=-1>3488     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3489"><font size=-1>3489     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="3490"><font size=-1>3490     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: EXTRA ELectrons&quot;</span><span class="default">,</span>
<a name="3491"><font size=-1>3491     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3492"><font size=-1>3492     </font></a><span class="string">Number of electrons per unit cell to be added to the initial value computed</span>
<a name="3493"><font size=-1>3493     </font></a><span class="string">from the pseudopotentials and unit cell.</span>
<a name="3494"><font size=-1>3494     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3495"><font size=-1>3495     </font></a><span class="default">),</span>
<a name="3496"><font size=-1>3496     </font></a><span class="default"></span>
<a name="3497"><font size=-1>3497     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3498"><font size=-1>3498     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_fermie&quot;</span><span class="default">,</span>
<a name="3499"><font size=-1>3499     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3500"><font size=-1>3500     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3501"><font size=-1>3501     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3502"><font size=-1>3502     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3503"><font size=-1>3503     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="3504"><font size=-1>3504     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: FERMI Energy&quot;</span><span class="default">,</span>
<a name="3505"><font size=-1>3505     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3506"><font size=-1>3506     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3507"><font size=-1>3507     </font></a><span class="string">This variable can be used to change the value of the Fermi level when</span>
<a name="3508"><font size=-1>3508     </font></a><span class="string">performing electron-phonon calculations with [[optdriver]] == 7. This variable</span>
<a name="3509"><font size=-1>3509     </font></a><span class="string">has effect only if set to a non-zero value. See also [[eph_extrael]].</span>
<a name="3510"><font size=-1>3510     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3511"><font size=-1>3511     </font></a><span class="default">),</span>
<a name="3512"><font size=-1>3512     </font></a><span class="default"></span>
<a name="3513"><font size=-1>3513     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3514"><font size=-1>3514     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_frohlichm&quot;</span><span class="default">,</span>
<a name="3515"><font size=-1>3515     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3516"><font size=-1>3516     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3517"><font size=-1>3517     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_useful'</span><span class="default">],</span>
<a name="3518"><font size=-1>3518     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3519"><font size=-1>3519     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3520"><font size=-1>3520     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: FROHLICH Model&quot;</span><span class="default">,</span>
<a name="3521"><font size=-1>3521     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3522"><font size=-1>3522     </font></a><span class="string">If set to 1, use the dynamical matrix at Gamma, the Born effective charges, the dielectric tensor, as well as</span>
<a name="3523"><font size=-1>3523     </font></a><span class="string">the effective masses (must give a _EFMAS file as input, see [[prtefmas]]), as the parameters of a Frohlich Hamiltonian.</span>
<a name="3524"><font size=-1>3524     </font></a><span class="string">Then use it to compute the</span>
<a name="3525"><font size=-1>3525     </font></a><span class="string">change of electronic eigenvalues due to electron-phonon interaction,</span>
<a name="3526"><font size=-1>3526     </font></a><span class="string">using second-order time-dependent perturbation theory. Can deliver (approximate) zero-point renormalisation</span>
<a name="3527"><font size=-1>3527     </font></a><span class="string">as well as temperature dependence.</span>
<a name="3528"><font size=-1>3528     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3529"><font size=-1>3529     </font></a><span class="default">),</span>
<a name="3530"><font size=-1>3530     </font></a><span class="default"></span>
<a name="3531"><font size=-1>3531     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3532"><font size=-1>3532     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_fsewin&quot;</span><span class="default">,</span>
<a name="3533"><font size=-1>3533     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3534"><font size=-1>3534     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3535"><font size=-1>3535     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3536"><font size=-1>3536     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3537"><font size=-1>3537     </font></a><span class="default">    defaultval=</span><span class="string">&quot;0.01 Hartree&quot;</span><span class="default">,</span>
<a name="3538"><font size=-1>3538     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-Phonon: Fermi Surface Energy WINdow&quot;</span><span class="default">,</span>
<a name="3539"><font size=-1>3539     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3540"><font size=-1>3540     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3541"><font size=-1>3541     </font></a><span class="string">This variable defines the energy window around the Fermi level used for e-ph</span>
<a name="3542"><font size=-1>3542     </font></a><span class="string">calculations ([[optdriver]] = 7). Only the states located in the energy range</span>
<a name="3543"><font size=-1>3543     </font></a><span class="string">[efermi - eph_fsewin, efermi + eph_fsewin] are included in the e-ph calculation.</span>
<a name="3544"><font size=-1>3544     </font></a><span class="string"></span>
<a name="3545"><font size=-1>3545     </font></a><span class="string">Related input variables: [[eph_intmeth]], [[eph_fsmear]], [[eph_extrael]] and [[eph_fermie]].</span>
<a name="3546"><font size=-1>3546     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3547"><font size=-1>3547     </font></a><span class="default">),</span>
<a name="3548"><font size=-1>3548     </font></a><span class="default"></span>
<a name="3549"><font size=-1>3549     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3550"><font size=-1>3550     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_fsmear&quot;</span><span class="default">,</span>
<a name="3551"><font size=-1>3551     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3552"><font size=-1>3552     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3553"><font size=-1>3553     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3554"><font size=-1>3554     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3555"><font size=-1>3555     </font></a><span class="default">    defaultval=</span><span class="string">&quot;0.01 Hartree&quot;</span><span class="default">,</span>
<a name="3556"><font size=-1>3556     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: Fermi surface SMEARing&quot;</span><span class="default">,</span>
<a name="3557"><font size=-1>3557     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3558"><font size=-1>3558     </font></a><span class="default">    requires=</span><span class="string">&quot;[[eph_intmeth]] == 1&quot;</span><span class="default">,</span>
<a name="3559"><font size=-1>3559     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3560"><font size=-1>3560     </font></a><span class="string">This variable defines the gaussian broadening used for the integration over</span>
<a name="3561"><font size=-1>3561     </font></a><span class="string">the Fermi surface when [[eph_intmeth]] == 1.</span>
<a name="3562"><font size=-1>3562     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3563"><font size=-1>3563     </font></a><span class="default">),</span>
<a name="3564"><font size=-1>3564     </font></a><span class="default"></span>
<a name="3565"><font size=-1>3565     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3566"><font size=-1>3566     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_intmeth&quot;</span><span class="default">,</span>
<a name="3567"><font size=-1>3567     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3568"><font size=-1>3568     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3569"><font size=-1>3569     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3570"><font size=-1>3570     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3571"><font size=-1>3571     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="3572"><font size=-1>3572     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-Phonon: INTegration METHod&quot;</span><span class="default">,</span>
<a name="3573"><font size=-1>3573     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3574"><font size=-1>3574     </font></a><span class="string">This variable defines the technique for the integration on the Fermi surface</span>
<a name="3575"><font size=-1>3575     </font></a><span class="string">of electron-phonon quantities.</span>
<a name="3576"><font size=-1>3576     </font></a><span class="string"></span>
<a name="3577"><font size=-1>3577     </font></a><span class="string">* 1 --&gt; Gaussian technique with broadening factor [[eph_fsmear]].</span>
<a name="3578"><font size=-1>3578     </font></a><span class="string">* 2 --&gt; Tetrahedron method.</span>
<a name="3579"><font size=-1>3579     </font></a><span class="string"></span>
<a name="3580"><font size=-1>3580     </font></a><span class="string">See also [[eph_fsewin]], [[eph_extrael]] and [[eph_fermie]].</span>
<a name="3581"><font size=-1>3581     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3582"><font size=-1>3582     </font></a><span class="default">),</span>
<a name="3583"><font size=-1>3583     </font></a><span class="default"></span>
<a name="3584"><font size=-1>3584     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3585"><font size=-1>3585     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_mustar&quot;</span><span class="default">,</span>
<a name="3586"><font size=-1>3586     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3587"><font size=-1>3587     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3588"><font size=-1>3588     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3589"><font size=-1>3589     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3590"><font size=-1>3590     </font></a><span class="default">    defaultval=</span><span class="number">0.1</span><span class="default">,</span>
<a name="3591"><font size=-1>3591     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: MU STAR (electron-electron interaction strength)&quot;</span><span class="default">,</span>
<a name="3592"><font size=-1>3592     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3593"><font size=-1>3593     </font></a><span class="string">Average electron-electron interaction strength, for the computation of the</span>
<a name="3594"><font size=-1>3594     </font></a><span class="string">superconducting Tc using Mc-Millan's formula.</span>
<a name="3595"><font size=-1>3595     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3596"><font size=-1>3596     </font></a><span class="default">),</span>
<a name="3597"><font size=-1>3597     </font></a><span class="default"></span>
<a name="3598"><font size=-1>3598     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3599"><font size=-1>3599     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_ngqpt_fine&quot;</span><span class="default">,</span>
<a name="3600"><font size=-1>3600     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3601"><font size=-1>3601     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3602"><font size=-1>3602     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3603"><font size=-1>3603     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="3604"><font size=-1>3604     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="3605"><font size=-1>3605     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: Number of Grid Q-PoinTs in FINE grid.&quot;</span><span class="default">,</span>
<a name="3606"><font size=-1>3606     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="3607"><font size=-1>3607     </font></a><span class="string">This variable activates the **interpolation** of the first-order variation of the</span>
<a name="3608"><font size=-1>3608     </font></a><span class="string">self-consistent potential in the electron-phonon code ([[optdriver]] == 7).</span>
<a name="3609"><font size=-1>3609     </font></a><span class="string"></span>
<a name="3610"><font size=-1>3610     </font></a><span class="string">If eph_nqgpt_fine differs from [0, 0, 0], the code will use the Fourier transform to interpolate</span>
<a name="3611"><font size=-1>3611     </font></a><span class="string">the DFPT potentials on this fine q-mesh starting from the irreducible set of</span>
<a name="3612"><font size=-1>3612     </font></a><span class="string">q-points read from the DVDB file. This approach is similar to the one used to</span>
<a name="3613"><font size=-1>3613     </font></a><span class="string">interpolate the interatomic force constants in q-space. If **eph_ngqpt_fine** is</span>
<a name="3614"><font size=-1>3614     </font></a><span class="string">not given, the EPH code uses the list of irreducible q-points reported in the</span>
<a name="3615"><font size=-1>3615     </font></a><span class="string">DDB file i.e. [[ddb_ngqpt]] (default behavior).</span>
<a name="3616"><font size=-1>3616     </font></a><span class="string"></span>
<a name="3617"><font size=-1>3617     </font></a><span class="string">!!! important</span>
<a name="3618"><font size=-1>3618     </font></a><span class="string"></span>
<a name="3619"><font size=-1>3619     </font></a><span class="string">    The computation of the electron-phonon matrix elements requires the knowledge of $\psi_{\bf k}$</span>
<a name="3620"><font size=-1>3620     </font></a><span class="string">    and $\psi_{\bf k + q}$. This means that the k-mesh for electrons found in the WFK must be</span>
<a name="3621"><font size=-1>3621     </font></a><span class="string">    compatible with the one given in *eph_ngqpt_fine*.</span>
<a name="3622"><font size=-1>3622     </font></a><span class="string">    The code can interpolate DFPT potentials but won't try to interpolate KS wavefunctions.</span>
<a name="3623"><font size=-1>3623     </font></a><span class="string">    and will stop if ${\bf k + q}$ is not found in the WFK file.</span>
<a name="3624"><font size=-1>3624     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3625"><font size=-1>3625     </font></a><span class="default">),</span>
<a name="3626"><font size=-1>3626     </font></a><span class="default"></span>
<a name="3627"><font size=-1>3627     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3628"><font size=-1>3628     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_task&quot;</span><span class="default">,</span>
<a name="3629"><font size=-1>3629     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3630"><font size=-1>3630     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3631"><font size=-1>3631     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3632"><font size=-1>3632     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3633"><font size=-1>3633     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="3634"><font size=-1>3634     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: Task&quot;</span><span class="default">,</span>
<a name="3635"><font size=-1>3635     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3636"><font size=-1>3636     </font></a><span class="string">When [[optdriver]] == 7, select the task to be performed.</span>
<a name="3637"><font size=-1>3637     </font></a><span class="string">The choice is among:</span>
<a name="3638"><font size=-1>3638     </font></a><span class="string"></span>
<a name="3639"><font size=-1>3639     </font></a><span class="string"> * 0 --&gt; No computation (mainly used to access the post-processing tools)</span>
<a name="3640"><font size=-1>3640     </font></a><span class="string"> * 1 --&gt; Compute phonon linewidths in metals.</span>
<a name="3641"><font size=-1>3641     </font></a><span class="string"> * 2 --&gt; Compute electron-phonon matrix elements.</span>
<a name="3642"><font size=-1>3642     </font></a><span class="string"> * 3 --&gt; Compute phonon self-energy.</span>
<a name="3643"><font size=-1>3643     </font></a><span class="string"> * 4 --&gt; Compute EPH self-energy (Fan-Migdal + Debye-Waller).</span>
<a name="3644"><font size=-1>3644     </font></a><span class="string"> * 5 --&gt; Interpolate DFPT potentials.</span>
<a name="3645"><font size=-1>3645     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3646"><font size=-1>3646     </font></a><span class="default">),</span>
<a name="3647"><font size=-1>3647     </font></a><span class="default"></span>
<a name="3648"><font size=-1>3648     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3649"><font size=-1>3649     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eph_transport&quot;</span><span class="default">,</span>
<a name="3650"><font size=-1>3650     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="3651"><font size=-1>3651     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3652"><font size=-1>3652     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="3653"><font size=-1>3653     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3654"><font size=-1>3654     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3655"><font size=-1>3655     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Electron-PHonon: TRANSPORT flag&quot;</span><span class="default">,</span>
<a name="3656"><font size=-1>3656     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3657"><font size=-1>3657     </font></a><span class="string">NB - this does not work yet. This variable can be used to turn on the</span>
<a name="3658"><font size=-1>3658     </font></a><span class="string">calculation of transport quantities in the eph module of abinit. Value of 1</span>
<a name="3659"><font size=-1>3659     </font></a><span class="string">corresponds to elastic LOVA as in the PRB by [[cite:Savrasov1996]].</span>
<a name="3660"><font size=-1>3660     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3661"><font size=-1>3661     </font></a><span class="default">),</span>
<a name="3662"><font size=-1>3662     </font></a><span class="default"></span>
<a name="3663"><font size=-1>3663     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3664"><font size=-1>3664     </font></a><span class="default">    abivarname=</span><span class="string">&quot;eshift&quot;</span><span class="default">,</span>
<a name="3665"><font size=-1>3665     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3666"><font size=-1>3666     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3667"><font size=-1>3667     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_expert'</span><span class="default">],</span>
<a name="3668"><font size=-1>3668     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3669"><font size=-1>3669     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3670"><font size=-1>3670     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Energy SHIFT&quot;</span><span class="default">,</span>
<a name="3671"><font size=-1>3671     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">, </span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3672"><font size=-1>3672     </font></a><span class="default">    requires=</span><span class="string">&quot;[[wfoptalg]] == 3&quot;</span><span class="default">,</span>
<a name="3673"><font size=-1>3673     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3674"><font size=-1>3674     </font></a><span class="string">[[eshift]] gives the shift of the energy used in the shifted Hamiltonian</span>
<a name="3675"><font size=-1>3675     </font></a><span class="string">squared. The algorithm will determine eigenvalues and eigenvectors centered on [[eshift]].</span>
<a name="3676"><font size=-1>3676     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[eshift]] has the</span>
<a name="3677"><font size=-1>3677     </font></a><span class="string">'[[ENERGY]]' characteristics. (1 Ha=27.2113845 eV)</span>
<a name="3678"><font size=-1>3678     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3679"><font size=-1>3679     </font></a><span class="default">),</span>
<a name="3680"><font size=-1>3680     </font></a><span class="default"></span>
<a name="3681"><font size=-1>3681     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3682"><font size=-1>3682     </font></a><span class="default">    abivarname=</span><span class="string">&quot;esmear&quot;</span><span class="default">,</span>
<a name="3683"><font size=-1>3683     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="3684"><font size=-1>3684     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3685"><font size=-1>3685     </font></a><span class="default">    topics=[</span><span class="string">'TDepES_useful'</span><span class="default">],</span>
<a name="3686"><font size=-1>3686     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3687"><font size=-1>3687     </font></a><span class="default">    defaultval=</span><span class="number">0.01</span><span class="default">,</span>
<a name="3688"><font size=-1>3688     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Eigenvalue SMEARing&quot;</span><span class="default">,</span>
<a name="3689"><font size=-1>3689     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="3690"><font size=-1>3690     </font></a><span class="default">    requires=</span><span class="string">&quot;[[smdelta]] != 0&quot;</span><span class="default">,</span>
<a name="3691"><font size=-1>3691     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="3692"><font size=-1>3692     </font></a><span class="string">The variable [[esmear]] determines the width of the functions approximating</span>
<a name="3693"><font size=-1>3693     </font></a><span class="string">the delta function, $\delta(e_{nk}-e_{n'k'})$, present in the expression of the</span>
<a name="3694"><font size=-1>3694     </font></a><span class="string">lifetimes. One should use a width comparable with the Debye frequency or the</span>
<a name="3695"><font size=-1>3695     </font></a><span class="string">maximum phonon frequency.</span>
<a name="3696"><font size=-1>3696     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[ecut]] has the</span>
<a name="3697"><font size=-1>3697     </font></a><span class="string">'[[ENERGY]]' characteristics (1 Ha=27.2113845 eV).</span>
<a name="3698"><font size=-1>3698     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3699"><font size=-1>3699     </font></a><span class="default">),</span>
<a name="3700"><font size=-1>3700     </font></a><span class="default"></span>
<a name="3701"><font size=-1>3701     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3702"><font size=-1>3702     </font></a><span class="default">    abivarname=</span><span class="string">&quot;exchmix&quot;</span><span class="default">,</span>
<a name="3703"><font size=-1>3703     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3704"><font size=-1>3704     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3705"><font size=-1>3705     </font></a><span class="default">    topics=[</span><span class="string">'xc_useful'</span><span class="default">],</span>
<a name="3706"><font size=-1>3706     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3707"><font size=-1>3707     </font></a><span class="default">    defaultval=</span><span class="number">0.25</span><span class="default">,</span>
<a name="3708"><font size=-1>3708     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EXCHange MIXing&quot;</span><span class="default">,</span>
<a name="3709"><font size=-1>3709     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="3710"><font size=-1>3710     </font></a><span class="default">    requires=</span><span class="string">&quot;[[useexexch]] == 1&quot;</span><span class="default">,</span>
<a name="3711"><font size=-1>3711     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3712"><font size=-1>3712     </font></a><span class="string">[[exchmix]] allows one to tune the ratio of exact exchange when [[useexexch]] is</span>
<a name="3713"><font size=-1>3713     </font></a><span class="string">used. The default value of 0.25 corresponds to PBE0.</span>
<a name="3714"><font size=-1>3714     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3715"><font size=-1>3715     </font></a><span class="default">),</span>
<a name="3716"><font size=-1>3716     </font></a><span class="default"></span>
<a name="3717"><font size=-1>3717     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3718"><font size=-1>3718     </font></a><span class="default">    abivarname=</span><span class="string">&quot;exchn2n3d&quot;</span><span class="default">,</span>
<a name="3719"><font size=-1>3719     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3720"><font size=-1>3720     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3721"><font size=-1>3721     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="3722"><font size=-1>3722     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3723"><font size=-1>3723     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3724"><font size=-1>3724     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;EXCHange N2 and N3 Dimensions&quot;</span><span class="default">,</span>
<a name="3725"><font size=-1>3725     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="3726"><font size=-1>3726     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3727"><font size=-1>3727     </font></a><span class="string">If [[exchn2n3d]] is 1, the internal representation of the FFT arrays in</span>
<a name="3728"><font size=-1>3728     </font></a><span class="string">reciprocal space will be array(n1,n3,n2), where the second and third</span>
<a name="3729"><font size=-1>3729     </font></a><span class="string">dimensions have been switched. This is to allow to be coherent with the</span>
<a name="3730"><font size=-1>3730     </font></a><span class="string">[[exchn2n3d]] = 4xx FFT treatment.</span>
<a name="3731"><font size=-1>3731     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3732"><font size=-1>3732     </font></a><span class="default">),</span>
<a name="3733"><font size=-1>3733     </font></a><span class="default"></span>
<a name="3734"><font size=-1>3734     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3735"><font size=-1>3735     </font></a><span class="default">    abivarname=</span><span class="string">&quot;extrapwf&quot;</span><span class="default">,</span>
<a name="3736"><font size=-1>3736     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3737"><font size=-1>3737     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3738"><font size=-1>3738     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">, </span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="3739"><font size=-1>3739     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3740"><font size=-1>3740     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3741"><font size=-1>3741     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;flag - EXTRAPolation of the Wave-Functions&quot;</span><span class="default">,</span>
<a name="3742"><font size=-1>3742     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="3743"><font size=-1>3743     </font></a><span class="default">    requires=</span><span class="string">&quot;[[densfor_pred]] in [5, 6]&quot;</span><span class="default">,</span>
<a name="3744"><font size=-1>3744     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3745"><font size=-1>3745     </font></a><span class="string">This flag activates the extrapolation of wave-functions from one Molecular</span>
<a name="3746"><font size=-1>3746     </font></a><span class="string">Dynamics (or Structural Relaxation) step to another. The wave functions are</span>
<a name="3747"><font size=-1>3747     </font></a><span class="string">extrapolated using 2nd-order algorithm of [[cite:Arias1992]].</span>
<a name="3748"><font size=-1>3748     </font></a><span class="string">Note that, when activated, this extrapolation requires non-negligible</span>
<a name="3749"><font size=-1>3749     </font></a><span class="string">additional memory resources as the wave functions are stored for the two</span>
<a name="3750"><font size=-1>3750     </font></a><span class="string">previous time steps. Also, it can only be activated if a consistent density</span>
<a name="3751"><font size=-1>3751     </font></a><span class="string">extrapolation is activated (see [[densfor_pred]]).</span>
<a name="3752"><font size=-1>3752     </font></a><span class="string">ABINIT 7.10: this option is **under development** and might give wrong results.</span>
<a name="3753"><font size=-1>3753     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3754"><font size=-1>3754     </font></a><span class="default">),</span>
<a name="3755"><font size=-1>3755     </font></a><span class="default"></span>
<a name="3756"><font size=-1>3756     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3757"><font size=-1>3757     </font></a><span class="default">    abivarname=</span><span class="string">&quot;f4of2_sla&quot;</span><span class="default">,</span>
<a name="3758"><font size=-1>3758     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="3759"><font size=-1>3759     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3760"><font size=-1>3760     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="3761"><font size=-1>3761     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3762"><font size=-1>3762     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'d electrons'</span><span class="default">: </span><span class="number">0.625</span><span class="default">,</span>
<a name="3763"><font size=-1>3763     </font></a><span class="default"> </span><span class="string">'f electrons'</span><span class="default">: </span><span class="number">0.6681</span><span class="default">,</span>
<a name="3764"><font size=-1>3764     </font></a><span class="default"> </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="3765"><font size=-1>3765     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;F4 Over F2 ratio of Slater integrals&quot;</span><span class="default">,</span>
<a name="3766"><font size=-1>3766     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and ([[usepawu]] == 1 or [[usedmft]] == 1)&quot;</span><span class="default">,</span>
<a name="3767"><font size=-1>3767     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3768"><font size=-1>3768     </font></a><span class="string">This gives the ratio of Slater Integrals F4 and F2. It is used in DFT+U or</span>
<a name="3769"><font size=-1>3769     </font></a><span class="string">DFT+DMFT for the calculation of the orbital dependent screened coulomb interaction.</span>
<a name="3770"><font size=-1>3770     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3771"><font size=-1>3771     </font></a><span class="default">),</span>
<a name="3772"><font size=-1>3772     </font></a><span class="default"></span>
<a name="3773"><font size=-1>3773     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3774"><font size=-1>3774     </font></a><span class="default">    abivarname=</span><span class="string">&quot;f6of2_sla&quot;</span><span class="default">,</span>
<a name="3775"><font size=-1>3775     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="3776"><font size=-1>3776     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3777"><font size=-1>3777     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="3778"><font size=-1>3778     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3779"><font size=-1>3779     </font></a><span class="default">    defaultval=</span><span class="number">0.4943</span><span class="default">,</span>
<a name="3780"><font size=-1>3780     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;F6 Over F2 ratio of Slater integrals&quot;</span><span class="default">,</span>
<a name="3781"><font size=-1>3781     </font></a><span class="default">    requires=</span><span class="string">&quot;([[usepawu]] == 1 or [[usedmft]] == 1) and [[lpawu]] == 3&quot;</span><span class="default">,</span>
<a name="3782"><font size=-1>3782     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3783"><font size=-1>3783     </font></a><span class="string">Gives the ratio of Slater Integrals F6 and F2. It is used with</span>
<a name="3784"><font size=-1>3784     </font></a><span class="string">[[f4of2_sla]] == 3 in DFT+U or DFT+DMFT for the calculation of the orbital</span>
<a name="3785"><font size=-1>3785     </font></a><span class="string">dependent screened coulomb interaction.</span>
<a name="3786"><font size=-1>3786     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3787"><font size=-1>3787     </font></a><span class="default">),</span>
<a name="3788"><font size=-1>3788     </font></a><span class="default"></span>
<a name="3789"><font size=-1>3789     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3790"><font size=-1>3790     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fband&quot;</span><span class="default">,</span>
<a name="3791"><font size=-1>3791     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="3792"><font size=-1>3792     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3793"><font size=-1>3793     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_useful'</span><span class="default">],</span>
<a name="3794"><font size=-1>3794     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3795"><font size=-1>3795     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[occopt]] == 1'</span><span class="default">: </span><span class="number">0.125</span><span class="default">,</span>
<a name="3796"><font size=-1>3796     </font></a><span class="default"> </span><span class="string">'[[occopt]] &gt; 2'</span><span class="default">: </span><span class="number">0.5</span><span class="default">,</span>
<a name="3797"><font size=-1>3797     </font></a><span class="default"> </span><span class="string">'[[usewvl]] == 1'</span><span class="default">: </span><span class="number">0.0</span><span class="default">,</span>
<a name="3798"><font size=-1>3798     </font></a><span class="default"> </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0.0</span><span class="default">}),</span>
<a name="3799"><font size=-1>3799     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Factor for the number of BANDs&quot;</span><span class="default">,</span>
<a name="3800"><font size=-1>3800     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="3801"><font size=-1>3801     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3802"><font size=-1>3802     </font></a><span class="string">Governs the number of bands to be used in the code in the case the parameter</span>
<a name="3803"><font size=-1>3803     </font></a><span class="string">[[nband]] is not defined in the input file (which means that [[occopt]] is not</span>
<a name="3804"><font size=-1>3804     </font></a><span class="string">equal to 0 or 2).</span>
<a name="3805"><font size=-1>3805     </font></a><span class="string"></span>
<a name="3806"><font size=-1>3806     </font></a><span class="string">In case [[fband]] is 0.0, the code computes from the pseudopotential files</span>
<a name="3807"><font size=-1>3807     </font></a><span class="string">and the geometry data contained in the input file, the number of electrons</span>
<a name="3808"><font size=-1>3808     </font></a><span class="string">present in the system. Then, it computes the minimum number of bands that can</span>
<a name="3809"><font size=-1>3809     </font></a><span class="string">accommodate them, and use that value for [[nband]].</span>
<a name="3810"><font size=-1>3810     </font></a><span class="string"></span>
<a name="3811"><font size=-1>3811     </font></a><span class="string">In case [[fband]] differs from zero, other bands will be added, just larger</span>
<a name="3812"><font size=-1>3812     </font></a><span class="string">than [[fband]] times the number of atoms. This parameter is not echoed in the</span>
<a name="3813"><font size=-1>3813     </font></a><span class="string">top of the main output file, but only the parameter [[nband]] that it allowed</span>
<a name="3814"><font size=-1>3814     </font></a><span class="string">to compute. It is also not present in the dtset array (no internal).</span>
<a name="3815"><font size=-1>3815     </font></a><span class="string">The default values are chosen such as to give naturally some conduction bands.</span>
<a name="3816"><font size=-1>3816     </font></a><span class="string">This improves the robustness of the code, since this allows one to identify lack</span>
<a name="3817"><font size=-1>3817     </font></a><span class="string">of convergence coming from (near-)degeneracies at the Fermi level. In the</span>
<a name="3818"><font size=-1>3818     </font></a><span class="string">metallic case, the number of bands generated might be too small if the</span>
<a name="3819"><font size=-1>3819     </font></a><span class="string">smearing factor is large. The occupation numbers of the higher bands should be</span>
<a name="3820"><font size=-1>3820     </font></a><span class="string">small enough such as to neglect higher bands. It is difficult to automate</span>
<a name="3821"><font size=-1>3821     </font></a><span class="string">this, so a fixed default value has been chosen.</span>
<a name="3822"><font size=-1>3822     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3823"><font size=-1>3823     </font></a><span class="default">),</span>
<a name="3824"><font size=-1>3824     </font></a><span class="default"></span>
<a name="3825"><font size=-1>3825     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3826"><font size=-1>3826     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fermie_nest&quot;</span><span class="default">,</span>
<a name="3827"><font size=-1>3827     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3828"><font size=-1>3828     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="3829"><font size=-1>3829     </font></a><span class="default">    topics=[</span><span class="string">'printing_prfermi'</span><span class="default">],</span>
<a name="3830"><font size=-1>3830     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3831"><font size=-1>3831     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="3832"><font size=-1>3832     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FERMI Energy for printing the NESTing function&quot;</span><span class="default">,</span>
<a name="3833"><font size=-1>3833     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3834"><font size=-1>3834     </font></a><span class="string">This input variable is only effective when [[prtnest]] = 1.</span>
<a name="3835"><font size=-1>3835     </font></a><span class="string">The energy is relative to the calculated Fermi energy.</span>
<a name="3836"><font size=-1>3836     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3837"><font size=-1>3837     </font></a><span class="default">),</span>
<a name="3838"><font size=-1>3838     </font></a><span class="default"></span>
<a name="3839"><font size=-1>3839     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3840"><font size=-1>3840     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fftalg&quot;</span><span class="default">,</span>
<a name="3841"><font size=-1>3841     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3842"><font size=-1>3842     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3843"><font size=-1>3843     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_useful'</span><span class="default">],</span>
<a name="3844"><font size=-1>3844     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3845"><font size=-1>3845     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[FFTW3]] and [[usedmft]] == 0'</span><span class="default">: </span><span class="number">312</span><span class="default">,</span>
<a name="3846"><font size=-1>3846     </font></a><span class="default"> </span><span class="string">'[[paral_kgb]] == 1'</span><span class="default">: </span><span class="number">401</span><span class="default">,</span>
<a name="3847"><font size=-1>3847     </font></a><span class="default"> </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">112</span><span class="default">}),</span>
<a name="3848"><font size=-1>3848     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Fast Fourier Transform ALGorithm&quot;</span><span class="default">,</span>
<a name="3849"><font size=-1>3849     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="3850"><font size=-1>3850     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3851"><font size=-1>3851     </font></a><span class="string">This keyword is **irrelevant** when Fast Fourier Transforms are done using</span>
<a name="3852"><font size=-1>3852     </font></a><span class="string">**Graphics Processing Units** (GPU), i.e. when [[use_gpu_cuda]] = 1</span>
<a name="3853"><font size=-1>3853     </font></a><span class="string">(in that case, it is ignored).</span>
<a name="3854"><font size=-1>3854     </font></a><span class="string"></span>
<a name="3855"><font size=-1>3855     </font></a><span class="string">Allows to choose the algorithm for Fast Fourier Transforms. These have to be</span>
<a name="3856"><font size=-1>3856     </font></a><span class="string">used when applied to wavefunctions (routine `src/53_ffts/fourwf.F90`), as well as when</span>
<a name="3857"><font size=-1>3857     </font></a><span class="string">applied to densities and potentials (routine `src/53_ffts/fourdp.F90`). Presently, it is the</span>
<a name="3858"><font size=-1>3858     </font></a><span class="string">concatenation of three digits, labelled (A), (B) and (C).</span>
<a name="3859"><font size=-1>3859     </font></a><span class="string"></span>
<a name="3860"><font size=-1>3860     </font></a><span class="string">The first digit (A) is to be chosen among 1, 2, 3, 4 or 5:</span>
<a name="3861"><font size=-1>3861     </font></a><span class="string"></span>
<a name="3862"><font size=-1>3862     </font></a><span class="string">  * 1 --&gt; use FFT routines written by S. Goedecker.</span>
<a name="3863"><font size=-1>3863     </font></a><span class="string">  * 2 --&gt;  not available anymore</span>
<a name="3864"><font size=-1>3864     </font></a><span class="string">  * 3 --&gt;  use serial or multi-threaded FFTW3 fortran routines ([http://www.fftw.org ](http://www.fftw.org) ).</span>
<a name="3865"><font size=-1>3865     </font></a><span class="string">    Currently implemented with [[fftalg]] = 312.</span>
<a name="3866"><font size=-1>3866     </font></a><span class="string">  * 4 --&gt;  use FFT routines written by S. Goedecker, 2002 version, that will be suited for MPI and OpenMP parallelism.</span>
<a name="3867"><font size=-1>3867     </font></a><span class="string">  * 5 --&gt;  use serial or multi-threaded MKL routines Currently implemented with [[fftalg]] = 512.</span>
<a name="3868"><font size=-1>3868     </font></a><span class="string"></span>
<a name="3869"><font size=-1>3869     </font></a><span class="string">The second digit (B) is related to `src/53_ffts/fourdp.F90`:</span>
<a name="3870"><font size=-1>3870     </font></a><span class="string"></span>
<a name="3871"><font size=-1>3871     </font></a><span class="string">  * 0 --&gt;  only use Complex-to-complex FFT</span>
<a name="3872"><font size=-1>3872     </font></a><span class="string">  * 1 --&gt;  real-to-complex is also allowed (only coded for A==1, A==3 and A==5)</span>
<a name="3873"><font size=-1>3873     </font></a><span class="string"></span>
<a name="3874"><font size=-1>3874     </font></a><span class="string">The third digit (C) is related to `src/53_ffts/fourwf.F90`:</span>
<a name="3875"><font size=-1>3875     </font></a><span class="string"></span>
<a name="3876"><font size=-1>3876     </font></a><span class="string">  * 0 --&gt; no use of zero padding</span>
<a name="3877"><font size=-1>3877     </font></a><span class="string">  * 1 --&gt; use of zero padding (only coded for A==1, A==4)</span>
<a name="3878"><font size=-1>3878     </font></a><span class="string">  * 2 --&gt; use of zero padding, and also combines actual FFT operations (using 2 routines from S. Goedecker)</span>
<a name="3879"><font size=-1>3879     </font></a><span class="string">    with important pre- and post-processing operations, in order to maximize cache data reuse.</span>
<a name="3880"><font size=-1>3880     </font></a><span class="string">    This is very efficient for cache architectures. (coded for A==1 and A==4, but A==4 is not yet sufficiently tested)</span>
<a name="3881"><font size=-1>3881     </font></a><span class="string"></span>
<a name="3882"><font size=-1>3882     </font></a><span class="string">Internal representation as [[ngfft]](7).</span>
<a name="3883"><font size=-1>3883     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3884"><font size=-1>3884     </font></a><span class="default">),</span>
<a name="3885"><font size=-1>3885     </font></a><span class="default"></span>
<a name="3886"><font size=-1>3886     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3887"><font size=-1>3887     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fftcache&quot;</span><span class="default">,</span>
<a name="3888"><font size=-1>3888     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="3889"><font size=-1>3889     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3890"><font size=-1>3890     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="3891"><font size=-1>3891     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3892"><font size=-1>3892     </font></a><span class="default">    defaultval=</span><span class="number">16</span><span class="default">,</span>
<a name="3893"><font size=-1>3893     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Fast Fourier Transform CACHE size&quot;</span><span class="default">,</span>
<a name="3894"><font size=-1>3894     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="3895"><font size=-1>3895     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;todo: Not yet machine-dependent&quot;</span><span class="default">,</span>
<a name="3896"><font size=-1>3896     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3897"><font size=-1>3897     </font></a><span class="string">Gives the cache size of the current machine, in Kbytes.</span>
<a name="3898"><font size=-1>3898     </font></a><span class="string">Internal representation as [[ngfft]](8).</span>
<a name="3899"><font size=-1>3899     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3900"><font size=-1>3900     </font></a><span class="default">),</span>
<a name="3901"><font size=-1>3901     </font></a><span class="default"></span>
<a name="3902"><font size=-1>3902     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3903"><font size=-1>3903     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fftgw&quot;</span><span class="default">,</span>
<a name="3904"><font size=-1>3904     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="3905"><font size=-1>3905     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3906"><font size=-1>3906     </font></a><span class="default">    topics=[</span><span class="string">'GW_expert'</span><span class="default">, </span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="3907"><font size=-1>3907     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="3908"><font size=-1>3908     </font></a><span class="default">    defaultval=</span><span class="number">21</span><span class="default">,</span>
<a name="3909"><font size=-1>3909     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FFT for GW calculation&quot;</span><span class="default">,</span>
<a name="3910"><font size=-1>3910     </font></a><span class="default">    requires=</span><span class="string">&quot; [[optdriver]] in [3, 4]&quot;</span><span class="default">,</span>
<a name="3911"><font size=-1>3911     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3912"><font size=-1>3912     </font></a><span class="string">The basic ingredients needed to perform both a screening and a sigma</span>
<a name="3913"><font size=-1>3913     </font></a><span class="string">calculation are the so-called oscillator matrix elements defined as</span>
<a name="3914"><font size=-1>3914     </font></a><span class="string"></span>
<a name="3915"><font size=-1>3915     </font></a><span class="string">$$ \langle \mathbf{k-q},b_1 | e^{-i (\mathbf{q+G)} \mathbf{r}} | \mathbf{k}, b_2 \\rangle $$</span>
<a name="3916"><font size=-1>3916     </font></a><span class="string"></span>
<a name="3917"><font size=-1>3917     </font></a><span class="string">In reciprocal space, this expression is evaluated by a convolution in which</span>
<a name="3918"><font size=-1>3918     </font></a><span class="string">the number of reciprocal lattice vectors employed to describe the</span>
<a name="3919"><font size=-1>3919     </font></a><span class="string">wavefunctions is given by [[ecutwfn]]. In the case of screening calculations,</span>
<a name="3920"><font size=-1>3920     </font></a><span class="string">the number of **G** vectors in the above expression is defined by [[ecuteps]],</span>
<a name="3921"><font size=-1>3921     </font></a><span class="string">while [[ecutsigx]] defined the number of **G** used in sigma calculations. To</span>
<a name="3922"><font size=-1>3922     </font></a><span class="string">improve the efficiency of the code, the oscillator matrix elements are</span>
<a name="3923"><font size=-1>3923     </font></a><span class="string">evaluated in real space through FFT techniques, and the [[fftgw]] input</span>
<a name="3924"><font size=-1>3924     </font></a><span class="string">variable is used to select the FFT mesh to be used.</span>
<a name="3925"><font size=-1>3925     </font></a><span class="string"></span>
<a name="3926"><font size=-1>3926     </font></a><span class="string">[[fftgw]] is the concatenation of two digits, labelled (A) and (B) whose value</span>
<a name="3927"><font size=-1>3927     </font></a><span class="string">is internally used to define the value of [[ngfft]](1:3) (see the setmesh.F90 routine).</span>
<a name="3928"><font size=-1>3928     </font></a><span class="string"></span>
<a name="3929"><font size=-1>3929     </font></a><span class="string">The first digit (A) defines the augmentation of the FFT grid. Possible values</span>
<a name="3930"><font size=-1>3930     </font></a><span class="string">are 1, 2 and 3.</span>
<a name="3931"><font size=-1>3931     </font></a><span class="string"></span>
<a name="3932"><font size=-1>3932     </font></a><span class="string">  * 0 --&gt; Use the FFT grid specified by the user through [[ngfft]](1:3)</span>
<a name="3933"><font size=-1>3933     </font></a><span class="string">  * 1 --&gt; Use a coarse FFT grid which encloses a sphere in reciprocal space whose radius</span>
<a name="3934"><font size=-1>3934     </font></a><span class="string">    depends on the largest value between [[ecutwfn]] and [[ecuteps]]</span>
<a name="3935"><font size=-1>3935     </font></a><span class="string">  * 2 --&gt; Use a slightly augmented FFT which is sufficient for the correct treatment of the convolution</span>
<a name="3936"><font size=-1>3936     </font></a><span class="string">  * 3 --&gt; Doubled FFT grid (same mesh as that used for GS calculations).</span>
<a name="3937"><font size=-1>3937     </font></a><span class="string"></span>
<a name="3938"><font size=-1>3938     </font></a><span class="string">The second digit (B) can be chosen between 0 and 1. It defines whether a FFT</span>
<a name="3939"><font size=-1>3939     </font></a><span class="string">grid compatible with all the symmetries of the space group must be enforced or not:</span>
<a name="3940"><font size=-1>3940     </font></a><span class="string"></span>
<a name="3941"><font size=-1>3941     </font></a><span class="string">  * 0 --&gt; Use the smallest FFT mesh which is compatible with the FFT library (faster, save memory but is less accurate)</span>
<a name="3942"><font size=-1>3942     </font></a><span class="string">  * 1 --&gt; Enforce a FFT grid which is compatible with all the symmetry operations of the space group.</span>
<a name="3943"><font size=-1>3943     </font></a><span class="string">    This method leads to an increase both of CPU time and memory, but the matrix elements are more accurate</span>
<a name="3944"><font size=-1>3944     </font></a><span class="string">    since the symmetry properties of the system are preserved.</span>
<a name="3945"><font size=-1>3945     </font></a><span class="string"></span>
<a name="3946"><font size=-1>3946     </font></a><span class="string">The behaviour of ABINIT before v5.5 corresponds to the default value 11.</span>
<a name="3947"><font size=-1>3947     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3948"><font size=-1>3948     </font></a><span class="default">),</span>
<a name="3949"><font size=-1>3949     </font></a><span class="default"></span>
<a name="3950"><font size=-1>3950     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3951"><font size=-1>3951     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fockdownsampling&quot;</span><span class="default">,</span>
<a name="3952"><font size=-1>3952     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="3953"><font size=-1>3953     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3954"><font size=-1>3954     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_useful'</span><span class="default">],</span>
<a name="3955"><font size=-1>3955     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="3956"><font size=-1>3956     </font></a><span class="default">    defaultval=</span><span class="string">&quot;3*1&quot;</span><span class="default">,</span>
<a name="3957"><font size=-1>3957     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FOCK operator, k-grid DOWNSAMPLING&quot;</span><span class="default">,</span>
<a name="3958"><font size=-1>3958     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usefock]] == 1&quot;</span><span class="default">,</span>
<a name="3959"><font size=-1>3959     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="3960"><font size=-1>3960     </font></a><span class="string">The k wavevector grid used to compute the Fock operator in the full Brillouin</span>
<a name="3961"><font size=-1>3961     </font></a><span class="string">Zone might be a subset of the full Brillouin Zone of the k point grid used for</span>
<a name="3962"><font size=-1>3962     </font></a><span class="string">the wavefunctions (see [[kptopt]] for its definition). [[fockdownsampling]]</span>
<a name="3963"><font size=-1>3963     </font></a><span class="string">allows one to define such a reduced set of k wavevectors, yielding a</span>
<a name="3964"><font size=-1>3964     </font></a><span class="string">significant speed up at the expense (possibly) of accuracy. The final grid has</span>
<a name="3965"><font size=-1>3965     </font></a><span class="string">[[nkpthf]] k points, with coordinates [[kptns_hf]].</span>
<a name="3966"><font size=-1>3966     </font></a><span class="string"></span>
<a name="3967"><font size=-1>3967     </font></a><span class="string">In the simplest case, the three values of [[fockdownsampling]] are equal, and</span>
<a name="3968"><font size=-1>3968     </font></a><span class="string">simply gives the factor by which the initial k point grid will be downsampled</span>
<a name="3969"><font size=-1>3969     </font></a><span class="string">along every direction. If [[fockdownsampling]] is 3*1, the sampling for the</span>
<a name="3970"><font size=-1>3970     </font></a><span class="string">Fock operator is the same as the sampling for the wavefunctions. If</span>
<a name="3971"><font size=-1>3971     </font></a><span class="string">[[fockdownsampling]] is 3*2 the sampling will have 8 times less k points.</span>
<a name="3972"><font size=-1>3972     </font></a><span class="string">Conventionally, if [[fockdownsampling]] is 3*0, then the Fock operator is</span>
<a name="3973"><font size=-1>3973     </font></a><span class="string">obtained solely from the Gamma point. Also, as soon as [[fockdownsampling]] is</span>
<a name="3974"><font size=-1>3974     </font></a><span class="string">not 3*1 or 3*0, the k point grid from which a subset will be taken is obtained</span>
<a name="3975"><font size=-1>3975     </font></a><span class="string">by imposing [[nshiftk]] = 1.</span>
<a name="3976"><font size=-1>3976     </font></a><span class="string"></span>
<a name="3977"><font size=-1>3977     </font></a><span class="string">A more accurate description is now given, as one can achieve a better control</span>
<a name="3978"><font size=-1>3978     </font></a><span class="string">than described above, with differing values of [[fockdownsampling]] and also</span>
<a name="3979"><font size=-1>3979     </font></a><span class="string">with negative numbers. One starts from the k point grid defined by</span>
<a name="3980"><font size=-1>3980     </font></a><span class="string">[[kptrlatt]], with [[nshiftk]] = 1. The absolute value of each of the three</span>
<a name="3981"><font size=-1>3981     </font></a><span class="string">numbers of [[fockdownsampling]] is used to sample the corresponding axis (in</span>
<a name="3982"><font size=-1>3982     </font></a><span class="string">reduced coordinate), as described above. Moreover, the obtained k grid might</span>
<a name="3983"><font size=-1>3983     </font></a><span class="string">even be further downsampled by specifying negative numbers: if all three are</span>
<a name="3984"><font size=-1>3984     </font></a><span class="string">negative, one further downsamples each 2x2x2 subset of k points by taking its</span>
<a name="3985"><font size=-1>3985     </font></a><span class="string">FCC subset (so, 4 points instead of 8); if two are negative, one downsamples</span>
<a name="3986"><font size=-1>3986     </font></a><span class="string">each 2x2x2 subset of k points by taking its BCC subset (so, 2 points instead</span>
<a name="3987"><font size=-1>3987     </font></a><span class="string">of 8); is only one is negative, then the two other axes are sampled using a</span>
<a name="3988"><font size=-1>3988     </font></a><span class="string">face-centered sampling. Finally, some of the values might be taken as 0, in</span>
<a name="3989"><font size=-1>3989     </font></a><span class="string">which case the corresponding direction is sampled by only one layer of points</span>
<a name="3990"><font size=-1>3990     </font></a><span class="string">(if two are zero, a line of points is obtained).</span>
<a name="3991"><font size=-1>3991     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="3992"><font size=-1>3992     </font></a><span class="default">),</span>
<a name="3993"><font size=-1>3993     </font></a><span class="default"></span>
<a name="3994"><font size=-1>3994     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="3995"><font size=-1>3995     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fockoptmix&quot;</span><span class="default">,</span>
<a name="3996"><font size=-1>3996     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="3997"><font size=-1>3997     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="3998"><font size=-1>3998     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_basic'</span><span class="default">],</span>
<a name="3999"><font size=-1>3999     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4000"><font size=-1>4000     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4001"><font size=-1>4001     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FOCK operator: OPTions for MIXing&quot;</span><span class="default">,</span>
<a name="4002"><font size=-1>4002     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usefock]] == 1&quot;</span><span class="default">,</span>
<a name="4003"><font size=-1>4003     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4004"><font size=-1>4004     </font></a><span class="string">Governs the mixing algorithm at the level of the Fock operator, i.e. how to</span>
<a name="4005"><font size=-1>4005     </font></a><span class="string">mix it, and how the underlying SCF calculation is to be performed. It is the</span>
<a name="4006"><font size=-1>4006     </font></a><span class="string">most relevant when the Fock operator is not updated at each SCF step ([[nnsclohf]]/=0).</span>
<a name="4007"><font size=-1>4007     </font></a><span class="string"></span>
<a name="4008"><font size=-1>4008     </font></a><span class="string">The last digit of [[fockoptmix]] governs what happens at the level of the SCF</span>
<a name="4009"><font size=-1>4009     </font></a><span class="string">algorithm, when the Fock operator is updated.</span>
<a name="4010"><font size=-1>4010     </font></a><span class="string"></span>
<a name="4011"><font size=-1>4011     </font></a><span class="string">  1. If [[fockoptmix]] == 0: the SCF algorithm is not restarted</span>
<a name="4012"><font size=-1>4012     </font></a><span class="string">  (it continues to use the previous potential/density pairs without worrying).</span>
<a name="4013"><font size=-1>4013     </font></a><span class="string">  2. If [[fockoptmix]] == 1: the SCF algorithm is restarted (the previous potential/density pairs are discarted).</span>
<a name="4014"><font size=-1>4014     </font></a><span class="string"></span>
<a name="4015"><font size=-1>4015     </font></a><span class="string">The second-to-last (dozen) digit governs the possible modification of the XC</span>
<a name="4016"><font size=-1>4016     </font></a><span class="string">functional inside the SCF loop to take into account the lack of update of the</span>
<a name="4017"><font size=-1>4017     </font></a><span class="string">Fock operator. Irrelevant when the unit digit is 0. If the value 1 is used</span>
<a name="4018"><font size=-1>4018     </font></a><span class="string">(so, e.g. [[fockoptmix]] == 11), an auxiliary xc functional is used inside the</span>
<a name="4019"><font size=-1>4019     </font></a><span class="string">SCF loop, for a frozen ACE Fock operator. This auxiliary functional is</span>
<a name="4020"><font size=-1>4020     </font></a><span class="string">specified thanks to [[auxc_ixc]] and [[auxc_scal]].</span>
<a name="4021"><font size=-1>4021     </font></a><span class="string"></span>
<a name="4022"><font size=-1>4022     </font></a><span class="string">The third-to-last (hundreds) digit governs the mixing of the Fock operator</span>
<a name="4023"><font size=-1>4023     </font></a><span class="string">itself with its previous occurrences. Irrelevant when the unit digit is 0.</span>
<a name="4024"><font size=-1>4024     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4025"><font size=-1>4025     </font></a><span class="default">),</span>
<a name="4026"><font size=-1>4026     </font></a><span class="default"></span>
<a name="4027"><font size=-1>4027     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4028"><font size=-1>4028     </font></a><span class="default">    abivarname=</span><span class="string">&quot;freqim_alpha&quot;</span><span class="default">,</span>
<a name="4029"><font size=-1>4029     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="4030"><font size=-1>4030     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4031"><font size=-1>4031     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="4032"><font size=-1>4032     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4033"><font size=-1>4033     </font></a><span class="default">    defaultval=</span><span class="number">5.0</span><span class="default">,</span>
<a name="4034"><font size=-1>4034     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FREQuencies along the IMaginary axis ALPHA parameter&quot;</span><span class="default">,</span>
<a name="4035"><font size=-1>4035     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="4036"><font size=-1>4036     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4037"><font size=-1>4037     </font></a><span class="string">[[freqim_alpha]] is used only for numerical integration of the GW self-energy</span>
<a name="4038"><font size=-1>4038     </font></a><span class="string">([[gwcalctyp]] =  2, 12, 22, 9, 19, 29).</span>
<a name="4039"><font size=-1>4039     </font></a><span class="string">[[freqim_alpha]] determines the location of the maximum frequency point along</span>
<a name="4040"><font size=-1>4040     </font></a><span class="string">the imaginary axis if the default grid is used in Contour Deformation</span>
<a name="4041"><font size=-1>4041     </font></a><span class="string">(numerical integration) calculations. It is set as  $\alpha*\omega_p$, where $\omega_p$</span>
<a name="4042"><font size=-1>4042     </font></a><span class="string">is the plasma frequency determined by the average density of the system</span>
<a name="4043"><font size=-1>4043     </font></a><span class="string">(this can be set by hand by using the variable [[ppmfrq]]). See the section on</span>
<a name="4044"><font size=-1>4044     </font></a><span class="string">grids in the descriptive text for [[cd_frqim_method]] for a detailed</span>
<a name="4045"><font size=-1>4045     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4046"><font size=-1>4046     </font></a><span class="default">),</span>
<a name="4047"><font size=-1>4047     </font></a><span class="default"></span>
<a name="4048"><font size=-1>4048     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4049"><font size=-1>4049     </font></a><span class="default">    abivarname=</span><span class="string">&quot;freqremax&quot;</span><span class="default">,</span>
<a name="4050"><font size=-1>4050     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="4051"><font size=-1>4051     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4052"><font size=-1>4052     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_basic'</span><span class="default">],</span>
<a name="4053"><font size=-1>4053     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4054"><font size=-1>4054     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="4055"><font size=-1>4055     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FREQuencies along the Real axis MAXimum&quot;</span><span class="default">,</span>
<a name="4056"><font size=-1>4056     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="4057"><font size=-1>4057     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3&quot;</span><span class="default">,</span>
<a name="4058"><font size=-1>4058     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4059"><font size=-1>4059     </font></a><span class="string">[[freqremax]] is used only for numerical integration of the GW self-energy</span>
<a name="4060"><font size=-1>4060     </font></a><span class="string">([[gwcalctyp]] =  2, 12, 22, 9, 19, 29).</span>
<a name="4061"><font size=-1>4061     </font></a><span class="string">[[freqremax]] sets the maximum real frequency used to calculate the dielectric</span>
<a name="4062"><font size=-1>4062     </font></a><span class="string">matrix in order to perform the numerical integration of the GW self-energy.</span>
<a name="4063"><font size=-1>4063     </font></a><span class="string">[[freqremax]], [[freqremin]] and [[nfreqre]] define the spacing of the</span>
<a name="4064"><font size=-1>4064     </font></a><span class="string">frequency mesh along the real axis.</span>
<a name="4065"><font size=-1>4065     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4066"><font size=-1>4066     </font></a><span class="default">),</span>
<a name="4067"><font size=-1>4067     </font></a><span class="default"></span>
<a name="4068"><font size=-1>4068     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4069"><font size=-1>4069     </font></a><span class="default">    abivarname=</span><span class="string">&quot;freqremin&quot;</span><span class="default">,</span>
<a name="4070"><font size=-1>4070     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="4071"><font size=-1>4071     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4072"><font size=-1>4072     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_basic'</span><span class="default">],</span>
<a name="4073"><font size=-1>4073     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4074"><font size=-1>4074     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="4075"><font size=-1>4075     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FREQuencies along the Real axis MINimum&quot;</span><span class="default">,</span>
<a name="4076"><font size=-1>4076     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="4077"><font size=-1>4077     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3&quot;</span><span class="default">,</span>
<a name="4078"><font size=-1>4078     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4079"><font size=-1>4079     </font></a><span class="string">[[freqremin]] is used only for numerical integration of the GW self-energy</span>
<a name="4080"><font size=-1>4080     </font></a><span class="string">([[gwcalctyp]] =  2, 12, 22, 9, 19, 29).</span>
<a name="4081"><font size=-1>4081     </font></a><span class="string">[[freqremin]] sets the minimum real frequency used to calculate the dielectric</span>
<a name="4082"><font size=-1>4082     </font></a><span class="string">matrix in order to perform the numerical integration of the GW self-energy.</span>
<a name="4083"><font size=-1>4083     </font></a><span class="string">[[freqremin]] can be used to split a wide frequency interval into smaller</span>
<a name="4084"><font size=-1>4084     </font></a><span class="string">subintervals that can be calculated independently. The different subintervals</span>
<a name="4085"><font size=-1>4085     </font></a><span class="string">can then be merged together with the **Mrgscr** utility thus obtaining a</span>
<a name="4086"><font size=-1>4086     </font></a><span class="string">single screening file that can used for self-energy calculations. Note that</span>
<a name="4087"><font size=-1>4087     </font></a><span class="string">[[freqremax]], [[freqremin]] and [[nfreqre]] define the spacing of the</span>
<a name="4088"><font size=-1>4088     </font></a><span class="string">frequency mesh along the real axis.</span>
<a name="4089"><font size=-1>4089     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4090"><font size=-1>4090     </font></a><span class="default">),</span>
<a name="4091"><font size=-1>4091     </font></a><span class="default"></span>
<a name="4092"><font size=-1>4092     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4093"><font size=-1>4093     </font></a><span class="default">    abivarname=</span><span class="string">&quot;freqspmax&quot;</span><span class="default">,</span>
<a name="4094"><font size=-1>4094     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="4095"><font size=-1>4095     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4096"><font size=-1>4096     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="4097"><font size=-1>4097     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4098"><font size=-1>4098     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="4099"><font size=-1>4099     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FREQuencies for the SPectral function MAXimum&quot;</span><span class="default">,</span>
<a name="4100"><font size=-1>4100     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="4101"><font size=-1>4101     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="4102"><font size=-1>4102     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4103"><font size=-1>4103     </font></a><span class="string">[[freqspmax]] sets the maximum real frequency used to calculate the spectral</span>
<a name="4104"><font size=-1>4104     </font></a><span class="string">function from the GW Green's function. [[freqspmin]], [[freqspmax]] and</span>
<a name="4105"><font size=-1>4105     </font></a><span class="string">[[nfreqsp]] define the spacing of an equidistant frequency mesh along the real</span>
<a name="4106"><font size=-1>4106     </font></a><span class="string">axis. Alternatively, the variables [[gw_customnfreqsp]] and [[gw_freqsp]] can</span>
<a name="4107"><font size=-1>4107     </font></a><span class="string">be used to make a user-defined grid.</span>
<a name="4108"><font size=-1>4108     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4109"><font size=-1>4109     </font></a><span class="default">),</span>
<a name="4110"><font size=-1>4110     </font></a><span class="default"></span>
<a name="4111"><font size=-1>4111     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4112"><font size=-1>4112     </font></a><span class="default">    abivarname=</span><span class="string">&quot;freqspmin&quot;</span><span class="default">,</span>
<a name="4113"><font size=-1>4113     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="4114"><font size=-1>4114     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4115"><font size=-1>4115     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="4116"><font size=-1>4116     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4117"><font size=-1>4117     </font></a><span class="default">    defaultval=</span><span class="string">&quot;-[[freqspmax]]&quot;</span><span class="default">,</span>
<a name="4118"><font size=-1>4118     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FREQuencies for the SPectral function MINimum&quot;</span><span class="default">,</span>
<a name="4119"><font size=-1>4119     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="4120"><font size=-1>4120     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="4121"><font size=-1>4121     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4122"><font size=-1>4122     </font></a><span class="string">[[freqspmin]] sets the minimum real frequency used to calculate the spectral</span>
<a name="4123"><font size=-1>4123     </font></a><span class="string">function from the GW Green's function. [[freqspmin]] is set to -[[freqspmax]]</span>
<a name="4124"><font size=-1>4124     </font></a><span class="string">if left undefined. [[freqspmin]], [[freqspmax]], and [[nfreqsp]] define the</span>
<a name="4125"><font size=-1>4125     </font></a><span class="string">spacing of an equidistant frequency mesh along the real axis. Alternatively,</span>
<a name="4126"><font size=-1>4126     </font></a><span class="string">the variables [[gw_customnfreqsp]] and [[gw_freqsp]] can be used to make a user-defined grid.</span>
<a name="4127"><font size=-1>4127     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4128"><font size=-1>4128     </font></a><span class="default">),</span>
<a name="4129"><font size=-1>4129     </font></a><span class="default"></span>
<a name="4130"><font size=-1>4130     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4131"><font size=-1>4131     </font></a><span class="default">    abivarname=</span><span class="string">&quot;friction&quot;</span><span class="default">,</span>
<a name="4132"><font size=-1>4132     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4133"><font size=-1>4133     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4134"><font size=-1>4134     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_useful'</span><span class="default">],</span>
<a name="4135"><font size=-1>4135     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4136"><font size=-1>4136     </font></a><span class="default">    defaultval=</span><span class="number">0.001</span><span class="default">,</span>
<a name="4137"><font size=-1>4137     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;internal FRICTION coefficient&quot;</span><span class="default">,</span>
<a name="4138"><font size=-1>4138     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4139"><font size=-1>4139     </font></a><span class="string">Gives the internal friction coefficient (atomic units) for Langevin dynamics</span>
<a name="4140"><font size=-1>4140     </font></a><span class="string">(when [[ionmov]] = 9): fixed temperature simulations with random forces.</span>
<a name="4141"><font size=-1>4141     </font></a><span class="string"></span>
<a name="4142"><font size=-1>4142     </font></a><span class="string">The equation of motion is:</span>
<a name="4143"><font size=-1>4143     </font></a><span class="string"></span>
<a name="4144"><font size=-1>4144     </font></a><span class="string">    M  I  d  2  R  I  /dt  2  = F  I  - [[friction]] M  I  dR  I  /dt - F_random I</span>
<a name="4145"><font size=-1>4145     </font></a><span class="string"></span>
<a name="4146"><font size=-1>4146     </font></a><span class="string">where F_random  I  is a Gaussian random force with average zero, and variance 2 [[friction]] M  I  kT.</span>
<a name="4147"><font size=-1>4147     </font></a><span class="string">The atomic unit of friction is hartrees*electronic mass*(atomic time</span>
<a name="4148"><font size=-1>4148     </font></a><span class="string">units)/Bohr  2. See [[cite:Chelikowsky2000]] for additional information.</span>
<a name="4149"><font size=-1>4149     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4150"><font size=-1>4150     </font></a><span class="default">),</span>
<a name="4151"><font size=-1>4151     </font></a><span class="default"></span>
<a name="4152"><font size=-1>4152     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4153"><font size=-1>4153     </font></a><span class="default">    abivarname=</span><span class="string">&quot;frzfermi&quot;</span><span class="default">,</span>
<a name="4154"><font size=-1>4154     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="4155"><font size=-1>4155     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4156"><font size=-1>4156     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="4157"><font size=-1>4157     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4158"><font size=-1>4158     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4159"><font size=-1>4159     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;FReeZe FERMI energy&quot;</span><span class="default">,</span>
<a name="4160"><font size=-1>4160     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4161"><font size=-1>4161     </font></a><span class="string">Can be used to suppress artificially the first-order change of Fermi energy,</span>
<a name="4162"><font size=-1>4162     </font></a><span class="string">in case of Response Function calculation for metals at Q=0. If the input variable</span>
<a name="4163"><font size=-1>4163     </font></a><span class="string">[[frzfermi]] is set to 1, this contribution is suppressed, even though this is incorrect.</span>
<a name="4164"><font size=-1>4164     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4165"><font size=-1>4165     </font></a><span class="default">),</span>
<a name="4166"><font size=-1>4166     </font></a><span class="default"></span>
<a name="4167"><font size=-1>4167     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4168"><font size=-1>4168     </font></a><span class="default">    abivarname=</span><span class="string">&quot;fxcartfactor&quot;</span><span class="default">,</span>
<a name="4169"><font size=-1>4169     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4170"><font size=-1>4170     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4171"><font size=-1>4171     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_expert'</span><span class="default">, </span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="4172"><font size=-1>4172     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4173"><font size=-1>4173     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'(Bohr^2)/Hartree'</span><span class="default">, value=</span><span class="number">1</span><span class="default">),</span>
<a name="4174"><font size=-1>4174     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Forces to (X) CARTesian coordinates FACTOR&quot;</span><span class="default">,</span>
<a name="4175"><font size=-1>4175     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4176"><font size=-1>4176     </font></a><span class="string">The forces multiplied by [[fxcartfactor]] will be treated like difference in</span>
<a name="4177"><font size=-1>4177     </font></a><span class="string">cartesian coordinates in the process of optimization. This is a simple preconditioner.</span>
<a name="4178"><font size=-1>4178     </font></a><span class="string">TO BE UPDATED See ([[ionmov]] = 2, non-zero [[optcell]]). For example, the</span>
<a name="4179"><font size=-1>4179     </font></a><span class="string">stopping criterion defined by [[tolmxf]] relates to these scaled stresses.</span>
<a name="4180"><font size=-1>4180     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4181"><font size=-1>4181     </font></a><span class="default">),</span>
<a name="4182"><font size=-1>4182     </font></a><span class="default"></span>
<a name="4183"><font size=-1>4183     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4184"><font size=-1>4184     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ga_algor&quot;</span><span class="default">,</span>
<a name="4185"><font size=-1>4185     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4186"><font size=-1>4186     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4187"><font size=-1>4187     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="4188"><font size=-1>4188     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4189"><font size=-1>4189     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="4190"><font size=-1>4190     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Genetic Algorithm - ALGOrithm selection&quot;</span><span class="default">,</span>
<a name="4191"><font size=-1>4191     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4192"><font size=-1>4192     </font></a><span class="string">Choosing method to make the structure selection. Only the enthalpy is used now</span>
<a name="4193"><font size=-1>4193     </font></a><span class="string">but we plan to include, energy, electronic band gap and alchemical potentials.</span>
<a name="4194"><font size=-1>4194     </font></a><span class="string">Right now only value of 1 (enthalpy) works.</span>
<a name="4195"><font size=-1>4195     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4196"><font size=-1>4196     </font></a><span class="default">),</span>
<a name="4197"><font size=-1>4197     </font></a><span class="default"></span>
<a name="4198"><font size=-1>4198     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4199"><font size=-1>4199     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ga_fitness&quot;</span><span class="default">,</span>
<a name="4200"><font size=-1>4200     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4201"><font size=-1>4201     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4202"><font size=-1>4202     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="4203"><font size=-1>4203     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4204"><font size=-1>4204     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="4205"><font size=-1>4205     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Genetic Algorithm FITNESS function selection&quot;</span><span class="default">,</span>
<a name="4206"><font size=-1>4206     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4207"><font size=-1>4207     </font></a><span class="string">Different methodologies to perform the roulette-wheel selection of parents.</span>
<a name="4208"><font size=-1>4208     </font></a><span class="string">Even though, the objective function is the crystalline enthalpy (H_i), the</span>
<a name="4209"><font size=-1>4209     </font></a><span class="string">weight of the population elements to be chosen from in a roulette-wheel</span>
<a name="4210"><font size=-1>4210     </font></a><span class="string">selection can be given through different functions. We consider the following cases.</span>
<a name="4211"><font size=-1>4211     </font></a><span class="string"></span>
<a name="4212"><font size=-1>4212     </font></a><span class="string">1. F = H_i / Sum H_i</span>
<a name="4213"><font size=-1>4213     </font></a><span class="string">2. F = exp(-(H_i-H_min)) / Sum exp(-(H_i-H_min))</span>
<a name="4214"><font size=-1>4214     </font></a><span class="string">3. F = (1/n_i) / Sum (1/n_i). Where n_i is the position in the ordered list of enthalpies</span>
<a name="4215"><font size=-1>4215     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4216"><font size=-1>4216     </font></a><span class="default">),</span>
<a name="4217"><font size=-1>4217     </font></a><span class="default"></span>
<a name="4218"><font size=-1>4218     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4219"><font size=-1>4219     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ga_n_rules&quot;</span><span class="default">,</span>
<a name="4220"><font size=-1>4220     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4221"><font size=-1>4221     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4222"><font size=-1>4222     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="4223"><font size=-1>4223     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4224"><font size=-1>4224     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="4225"><font size=-1>4225     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Genetic Algorithm Number of RULES&quot;</span><span class="default">,</span>
<a name="4226"><font size=-1>4226     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4227"><font size=-1>4227     </font></a><span class="string">Different genetic rules have been implemented and the user has the change to</span>
<a name="4228"><font size=-1>4228     </font></a><span class="string">choose between any of them. Right now we have 4 rules. See [[ga_rules]]</span>
<a name="4229"><font size=-1>4229     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4230"><font size=-1>4230     </font></a><span class="default">),</span>
<a name="4231"><font size=-1>4231     </font></a><span class="default"></span>
<a name="4232"><font size=-1>4232     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4233"><font size=-1>4233     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ga_opt_percent&quot;</span><span class="default">,</span>
<a name="4234"><font size=-1>4234     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4235"><font size=-1>4235     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4236"><font size=-1>4236     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="4237"><font size=-1>4237     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4238"><font size=-1>4238     </font></a><span class="default">    defaultval=</span><span class="number">0.2</span><span class="default">,</span>
<a name="4239"><font size=-1>4239     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Genetic Algorithm OPTimal PERCENT&quot;</span><span class="default">,</span>
<a name="4240"><font size=-1>4240     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4241"><font size=-1>4241     </font></a><span class="string">Percentage of the population that according to the fitness function passes to</span>
<a name="4242"><font size=-1>4242     </font></a><span class="string">the following iteration.</span>
<a name="4243"><font size=-1>4243     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4244"><font size=-1>4244     </font></a><span class="default">),</span>
<a name="4245"><font size=-1>4245     </font></a><span class="default"></span>
<a name="4246"><font size=-1>4246     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4247"><font size=-1>4247     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ga_rules&quot;</span><span class="default">,</span>
<a name="4248"><font size=-1>4248     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4249"><font size=-1>4249     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4250"><font size=-1>4250     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="4251"><font size=-1>4251     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4252"><font size=-1>4252     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="4253"><font size=-1>4253     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Genetic Algorithm RULES&quot;</span><span class="default">,</span>
<a name="4254"><font size=-1>4254     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4255"><font size=-1>4255     </font></a><span class="string">Different genetic rules have been implemented and the user has the change to</span>
<a name="4256"><font size=-1>4256     </font></a><span class="string">choose between any of them. The chosen number of rules have been defined in [[ga_n_rules]]</span>
<a name="4257"><font size=-1>4257     </font></a><span class="string"></span>
<a name="4258"><font size=-1>4258     </font></a><span class="string">Implemented rules are</span>
<a name="4259"><font size=-1>4259     </font></a><span class="string">1) crossover. Two parents are randomly chosen and two springs are mixed from</span>
<a name="4260"><font size=-1>4260     </font></a><span class="string">the two by (a) choosing randomly (through Fitness function) two parents and</span>
<a name="4261"><font size=-1>4261     </font></a><span class="string">then randomly rotating and shifting the coordinates withing that particular</span>
<a name="4262"><font size=-1>4262     </font></a><span class="string">cell. (b) Slice every one of the unit cell of the parents along a random</span>
<a name="4263"><font size=-1>4263     </font></a><span class="string">direction and creating the spring offs from the pieces of the two parents.</span>
<a name="4264"><font size=-1>4264     </font></a><span class="string">2) Vector flip mutation. From the coordinates from a given parent, a piece of</span>
<a name="4265"><font size=-1>4265     </font></a><span class="string">it is inverted.</span>
<a name="4266"><font size=-1>4266     </font></a><span class="string">3) Random strain. A random anisotropic deformation is given to the unit cell.</span>
<a name="4267"><font size=-1>4267     </font></a><span class="string">4) Coordinates mutation of 1/4 of the whole coordinates.</span>
<a name="4268"><font size=-1>4268     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4269"><font size=-1>4269     </font></a><span class="default">),</span>
<a name="4270"><font size=-1>4270     </font></a><span class="default"></span>
<a name="4271"><font size=-1>4271     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4272"><font size=-1>4272     </font></a><span class="default">    abivarname=</span><span class="string">&quot;genafm&quot;</span><span class="default">,</span>
<a name="4273"><font size=-1>4273     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="4274"><font size=-1>4274     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="4275"><font size=-1>4275     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_useful'</span><span class="default">, </span><span class="string">'SmartSymm_useful'</span><span class="default">],</span>
<a name="4276"><font size=-1>4276     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="4277"><font size=-1>4277     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="4278"><font size=-1>4278     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GENerator of the translation for Anti-FerroMagnetic space group&quot;</span><span class="default">,</span>
<a name="4279"><font size=-1>4279     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4280"><font size=-1>4280     </font></a><span class="string">This input variable might be used to define a Shubnikov type IV magnetic space</span>
<a name="4281"><font size=-1>4281     </font></a><span class="string">group (anti-ferromagnetic space group). The user is advised to consult [[cite:Bradley1972]]</span>
<a name="4282"><font size=-1>4282     </font></a><span class="string">A Shubnikov type IV magnetic space group might be defined by its Fedorov space</span>
<a name="4283"><font size=-1>4283     </font></a><span class="string">group (set of spatial symmetries, that do not change the magnetization), and</span>
<a name="4284"><font size=-1>4284     </font></a><span class="string">one translation associated with a change of magnetization. [[genafm]] is</span>
<a name="4285"><font size=-1>4285     </font></a><span class="string">precisely this translation, in reduced coordinates (like [[xred]])</span>
<a name="4286"><font size=-1>4286     </font></a><span class="string">Thus, one way to specify a Shubnikov IV magnetic space group, is to define</span>
<a name="4287"><font size=-1>4287     </font></a><span class="string">both [[spgroup]] and [[genafm]]. Alternatively, one might define [[spgroup]]</span>
<a name="4288"><font size=-1>4288     </font></a><span class="string">and [[spgroupma]], or define by hand the set of symmetries, using [[symrel]],</span>
<a name="4289"><font size=-1>4289     </font></a><span class="string">[[tnons]] and [[symafm]]</span>
<a name="4290"><font size=-1>4290     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4291"><font size=-1>4291     </font></a><span class="default">),</span>
<a name="4292"><font size=-1>4292     </font></a><span class="default"></span>
<a name="4293"><font size=-1>4293     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4294"><font size=-1>4294     </font></a><span class="default">    abivarname=</span><span class="string">&quot;get1den&quot;</span><span class="default">,</span>
<a name="4295"><font size=-1>4295     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4296"><font size=-1>4296     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4297"><font size=-1>4297     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_useful'</span><span class="default">, </span><span class="string">'ElPhonInt_useful'</span><span class="default">],</span>
<a name="4298"><font size=-1>4298     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4299"><font size=-1>4299     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4300"><font size=-1>4300     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the first-order density from _1DEN file&quot;</span><span class="default">,</span>
<a name="4301"><font size=-1>4301     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4302"><font size=-1>4302     </font></a><span class="string">Relevant only for non self consistent RF calculations (e.g. to get electron</span>
<a name="4303"><font size=-1>4303     </font></a><span class="string">phonon matrix elements) or for non linear RF calculations (to get mixed higher</span>
<a name="4304"><font size=-1>4304     </font></a><span class="string">order derivatives you need several perturbed densities and wave functions).</span>
<a name="4305"><font size=-1>4305     </font></a><span class="string">Indicate the files from which first-order densities must be obtained, in</span>
<a name="4306"><font size=-1>4306     </font></a><span class="string">multi-dataset mode (in single dataset mode, use [[ird1den]]).</span>
<a name="4307"><font size=-1>4307     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4308"><font size=-1>4308     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4309"><font size=-1>4309     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4310"><font size=-1>4310     </font></a><span class="string"></span>
<a name="4311"><font size=-1>4311     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4312"><font size=-1>4312     </font></a><span class="string"></span>
<a name="4313"><font size=-1>4313     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4314"><font size=-1>4314     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4315"><font size=-1>4315     </font></a><span class="default">),</span>
<a name="4316"><font size=-1>4316     </font></a><span class="default"></span>
<a name="4317"><font size=-1>4317     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4318"><font size=-1>4318     </font></a><span class="default">    abivarname=</span><span class="string">&quot;get1wf&quot;</span><span class="default">,</span>
<a name="4319"><font size=-1>4319     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4320"><font size=-1>4320     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4321"><font size=-1>4321     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4322"><font size=-1>4322     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4323"><font size=-1>4323     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4324"><font size=-1>4324     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the first-order wavefunctions from _1WF file&quot;</span><span class="default">,</span>
<a name="4325"><font size=-1>4325     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4326"><font size=-1>4326     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (in the multi-dataset mode), to indicate</span>
<a name="4327"><font size=-1>4327     </font></a><span class="string">starting wavefunctions, as an alternative to [[irdwfk]], [[irdwfq]],</span>
<a name="4328"><font size=-1>4328     </font></a><span class="string">[[ird1wf]], [[irdddk]]. One should first read the explanations given for these</span>
<a name="4329"><font size=-1>4329     </font></a><span class="string">latter variables.</span>
<a name="4330"><font size=-1>4330     </font></a><span class="string">The **getwfk**, **getwfq**, [[get1wf]] and **getddk** variables are</span>
<a name="4331"><font size=-1>4331     </font></a><span class="string">typically used to chain the calculations in the multi-dataset mode, since they</span>
<a name="4332"><font size=-1>4332     </font></a><span class="string">describe from which dataset the OUTPUT wavefunctions are to be taken, as INPUT</span>
<a name="4333"><font size=-1>4333     </font></a><span class="string">wavefunctions of the present dataset.</span>
<a name="4334"><font size=-1>4334     </font></a><span class="string"></span>
<a name="4335"><font size=-1>4335     </font></a><span class="string">We now focus on the **getwfk** input variable (the only one used in ground-</span>
<a name="4336"><font size=-1>4336     </font></a><span class="string">state calculations), but the rules for **getwfq** and [[get1wf]] are similar,</span>
<a name="4337"><font size=-1>4337     </font></a><span class="string">with _WFK replaced by _WFQ or _1WF.</span>
<a name="4338"><font size=-1>4338     </font></a><span class="string">If **getwfk** ==0, no use of previously computed output wavefunction file</span>
<a name="4339"><font size=-1>4339     </font></a><span class="string">appended with _DSx_WFK is done.</span>
<a name="4340"><font size=-1>4340     </font></a><span class="string">If **getwfk** is positive, its value gives the index of the dataset for which</span>
<a name="4341"><font size=-1>4341     </font></a><span class="string">the output wavefunction file appended with _WFK must be used.</span>
<a name="4342"><font size=-1>4342     </font></a><span class="string">If **getwfk** is -1, the output wf file with _WFK of the previous dataset must</span>
<a name="4343"><font size=-1>4343     </font></a><span class="string">be taken, which is a frequently occurring case.</span>
<a name="4344"><font size=-1>4344     </font></a><span class="string">If **getwfk** is a negative number, it indicates the number of datasets to go</span>
<a name="4345"><font size=-1>4345     </font></a><span class="string">backward to find the needed wavefunction file. In this case, if one refers to</span>
<a name="4346"><font size=-1>4346     </font></a><span class="string">a non existent data set (prior to the first), the wavefunctions are not</span>
<a name="4347"><font size=-1>4347     </font></a><span class="string">initialised from a disk file, so that it is as if **getwfk** =0 for that</span>
<a name="4348"><font size=-1>4348     </font></a><span class="string">initialisation. Thanks to this rule, the use of **getwfk** -1 is rather</span>
<a name="4349"><font size=-1>4349     </font></a><span class="string">straightforward: except for the first wavefunctions, that are not initialized</span>
<a name="4350"><font size=-1>4350     </font></a><span class="string">by reading a disk file, the output wavefunction of one dataset is input of the</span>
<a name="4351"><font size=-1>4351     </font></a><span class="string">next one.</span>
<a name="4352"><font size=-1>4352     </font></a><span class="string">In the case of a ddk calculation in a multi dataset run, in order to compute</span>
<a name="4353"><font size=-1>4353     </font></a><span class="string">correctly the localisation tensor, it is mandatory to give [[getddk]] the</span>
<a name="4354"><font size=-1>4354     </font></a><span class="string">value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and</span>
<a name="4355"><font size=-1>4355     </font></a><span class="string">should be changed in the future.</span>
<a name="4356"><font size=-1>4356     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4357"><font size=-1>4357     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4358"><font size=-1>4358     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4359"><font size=-1>4359     </font></a><span class="string"></span>
<a name="4360"><font size=-1>4360     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4361"><font size=-1>4361     </font></a><span class="string"></span>
<a name="4362"><font size=-1>4362     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4363"><font size=-1>4363     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4364"><font size=-1>4364     </font></a><span class="default">),</span>
<a name="4365"><font size=-1>4365     </font></a><span class="default"></span>
<a name="4366"><font size=-1>4366     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4367"><font size=-1>4367     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getbscoup&quot;</span><span class="default">,</span>
<a name="4368"><font size=-1>4368     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4369"><font size=-1>4369     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4370"><font size=-1>4370     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4371"><font size=-1>4371     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4372"><font size=-1>4372     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4373"><font size=-1>4373     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the Bethe-Salpeter COUPling block from...&quot;</span><span class="default">,</span>
<a name="4374"><font size=-1>4374     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4375"><font size=-1>4375     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (multi-dataset mode) and, in the case of a</span>
<a name="4376"><font size=-1>4376     </font></a><span class="string">Bethe-Salpeter calculation to indicate that the starting coupling block of the</span>
<a name="4377"><font size=-1>4377     </font></a><span class="string">excitonic Hamiltonian will be taken from the output of a previous dataset. It</span>
<a name="4378"><font size=-1>4378     </font></a><span class="string">is used to chain the calculations, since it describes from which dataset the</span>
<a name="4379"><font size=-1>4379     </font></a><span class="string">OUTPUT coupling block is to be taken, as INPUT of the present dataset.</span>
<a name="4380"><font size=-1>4380     </font></a><span class="string">If [[getbscoup]] == 0, no such use of previously computed coupling block file is done.</span>
<a name="4381"><font size=-1>4381     </font></a><span class="string">If [[getbscoup]] is positive, its value gives the index of the dataset to be</span>
<a name="4382"><font size=-1>4382     </font></a><span class="string">used as input.</span>
<a name="4383"><font size=-1>4383     </font></a><span class="string">If [[getbscoup]] is -1, the output of the previous dataset must be taken,</span>
<a name="4384"><font size=-1>4384     </font></a><span class="string">which is a frequently occurring case.</span>
<a name="4385"><font size=-1>4385     </font></a><span class="string">If [[getbscoup]] is a negative number, it indicates the number of datasets to</span>
<a name="4386"><font size=-1>4386     </font></a><span class="string">go backward to find the needed file. In this case, if one refers to a non</span>
<a name="4387"><font size=-1>4387     </font></a><span class="string">existent data set (prior to the first), the coupling block is not initialised</span>
<a name="4388"><font size=-1>4388     </font></a><span class="string">from a disk file, so that it is as if [[getbscoup]] = 0 for that initialisation.</span>
<a name="4389"><font size=-1>4389     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4390"><font size=-1>4390     </font></a><span class="default">),</span>
<a name="4391"><font size=-1>4391     </font></a><span class="default"></span>
<a name="4392"><font size=-1>4392     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4393"><font size=-1>4393     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getbseig&quot;</span><span class="default">,</span>
<a name="4394"><font size=-1>4394     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4395"><font size=-1>4395     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4396"><font size=-1>4396     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4397"><font size=-1>4397     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4398"><font size=-1>4398     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4399"><font size=-1>4399     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the Bethe-Salpeter EIGenstates from...&quot;</span><span class="default">,</span>
<a name="4400"><font size=-1>4400     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4401"><font size=-1>4401     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (multi-dataset mode) and, in the case of a</span>
<a name="4402"><font size=-1>4402     </font></a><span class="string">Bethe-Salpeter calculation to indicate that the starting excitonic eigenstates</span>
<a name="4403"><font size=-1>4403     </font></a><span class="string">are to be taken from the output of a previous dataset. It is used to chain the</span>
<a name="4404"><font size=-1>4404     </font></a><span class="string">calculations, since it describes from which dataset the OUTPUT eigenstates are</span>
<a name="4405"><font size=-1>4405     </font></a><span class="string">to be taken, as INPUT eigenstates of the present dataset.</span>
<a name="4406"><font size=-1>4406     </font></a><span class="string">If [[getbseig]] == 0, no such use of previously computed output eigenstates file is done.</span>
<a name="4407"><font size=-1>4407     </font></a><span class="string">If [[getbseig]] is positive, its value gives the index of the dataset from</span>
<a name="4408"><font size=-1>4408     </font></a><span class="string">which the output states is to be used as input.</span>
<a name="4409"><font size=-1>4409     </font></a><span class="string">If [[getbseig]] is -1, the output eigenstates of the previous dataset must be</span>
<a name="4410"><font size=-1>4410     </font></a><span class="string">taken, which is a frequently occurring case.</span>
<a name="4411"><font size=-1>4411     </font></a><span class="string">If [[getbseig]] is a negative number, it indicates the number of datasets to</span>
<a name="4412"><font size=-1>4412     </font></a><span class="string">go backward to find the needed file. In this case, if one refers to a non</span>
<a name="4413"><font size=-1>4413     </font></a><span class="string">existent data set (prior to the first), the eigenstates are not initialised</span>
<a name="4414"><font size=-1>4414     </font></a><span class="string">from a disk file, so that it is as if [[getbseig]] = 0 for that initialisation.</span>
<a name="4415"><font size=-1>4415     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4416"><font size=-1>4416     </font></a><span class="default">),</span>
<a name="4417"><font size=-1>4417     </font></a><span class="default"></span>
<a name="4418"><font size=-1>4418     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4419"><font size=-1>4419     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getbsreso&quot;</span><span class="default">,</span>
<a name="4420"><font size=-1>4420     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4421"><font size=-1>4421     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4422"><font size=-1>4422     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4423"><font size=-1>4423     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4424"><font size=-1>4424     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4425"><font size=-1>4425     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the Bethe-Salpeter RESOnant block from...&quot;</span><span class="default">,</span>
<a name="4426"><font size=-1>4426     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4427"><font size=-1>4427     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (multi-dataset mode) and, in the case of a</span>
<a name="4428"><font size=-1>4428     </font></a><span class="string">Bethe-Salpeter calculation to indicate that the starting resonant block of the</span>
<a name="4429"><font size=-1>4429     </font></a><span class="string">excitonic Hamiltonian will be taken from the output of a previous dataset. It</span>
<a name="4430"><font size=-1>4430     </font></a><span class="string">is used to chain the calculations, since it describes from which dataset the</span>
<a name="4431"><font size=-1>4431     </font></a><span class="string">OUTPUT resonant block is to be taken, as INPUT of the present dataset.</span>
<a name="4432"><font size=-1>4432     </font></a><span class="string">If [[getbsreso]] == 0, no such use of previously computed resonant block file is done.</span>
<a name="4433"><font size=-1>4433     </font></a><span class="string">If [[getbsreso]] is positive, its value gives the index of the dataset to be used as input.</span>
<a name="4434"><font size=-1>4434     </font></a><span class="string">If [[getbsreso]] is -1, the output of the previous dataset must be taken,</span>
<a name="4435"><font size=-1>4435     </font></a><span class="string">which is a frequently occurring case.</span>
<a name="4436"><font size=-1>4436     </font></a><span class="string">If [[getbsreso]] is a negative number, it indicates the number of datasets to</span>
<a name="4437"><font size=-1>4437     </font></a><span class="string">go backward to find the needed file. In this case, if one refers to a non</span>
<a name="4438"><font size=-1>4438     </font></a><span class="string">existent data set (prior to the first), the resonant block is not initialised</span>
<a name="4439"><font size=-1>4439     </font></a><span class="string">from a disk file, so that it is as if [[getbsreso]] = 0 for that initialisation.</span>
<a name="4440"><font size=-1>4440     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4441"><font size=-1>4441     </font></a><span class="default">),</span>
<a name="4442"><font size=-1>4442     </font></a><span class="default"></span>
<a name="4443"><font size=-1>4443     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4444"><font size=-1>4444     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getcell&quot;</span><span class="default">,</span>
<a name="4445"><font size=-1>4445     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4446"><font size=-1>4446     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4447"><font size=-1>4447     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4448"><font size=-1>4448     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4449"><font size=-1>4449     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4450"><font size=-1>4450     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET CELL parameters from...&quot;</span><span class="default">,</span>
<a name="4451"><font size=-1>4451     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4452"><font size=-1>4452     </font></a><span class="string">This variable is typically used to chain the calculations, in the multi-</span>
<a name="4453"><font size=-1>4453     </font></a><span class="string">dataset mode ([[ndtset]] &gt; 0), since it describes from which dataset [[acell]]</span>
<a name="4454"><font size=-1>4454     </font></a><span class="string">and [[rprim]] are to be taken, as input of the present dataset. The cell</span>
<a name="4455"><font size=-1>4455     </font></a><span class="string">parameters are [[EVOLVING]] variables, for which such a chain of calculations is useful.</span>
<a name="4456"><font size=-1>4456     </font></a><span class="string">If 0, no previously computed values are used.</span>
<a name="4457"><font size=-1>4457     </font></a><span class="string">If &gt;0, the value must be the index of the dataset from which the</span>
<a name="4458"><font size=-1>4458     </font></a><span class="string">cell data is to be used as input data. It must be the index of a dataset already</span>
<a name="4459"><font size=-1>4459     </font></a><span class="string">computed in the SAME run.</span>
<a name="4460"><font size=-1>4460     </font></a><span class="string">If equal to -1, the output data of the previous dataset must be taken, which</span>
<a name="4461"><font size=-1>4461     </font></a><span class="string">is a frequently occurring case. However, if the first dataset is treated, -1</span>
<a name="4462"><font size=-1>4462     </font></a><span class="string">is equivalent to 0, since no dataset has been computed in the same run.</span>
<a name="4463"><font size=-1>4463     </font></a><span class="string">If another negative number, it indicates the number of datasets to go backward</span>
<a name="4464"><font size=-1>4464     </font></a><span class="string">to find the needed data (once again, going back beyond the first dataset is</span>
<a name="4465"><font size=-1>4465     </font></a><span class="string">equivalent to using a null get variable).</span>
<a name="4466"><font size=-1>4466     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4467"><font size=-1>4467     </font></a><span class="default">),</span>
<a name="4468"><font size=-1>4468     </font></a><span class="default"></span>
<a name="4469"><font size=-1>4469     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4470"><font size=-1>4470     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getddb&quot;</span><span class="default">,</span>
<a name="4471"><font size=-1>4471     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4472"><font size=-1>4472     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4473"><font size=-1>4473     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_expert'</span><span class="default">, </span><span class="string">'TDepES_useful'</span><span class="default">],</span>
<a name="4474"><font size=-1>4474     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4475"><font size=-1>4475     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4476"><font size=-1>4476     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the DDB from...&quot;</span><span class="default">,</span>
<a name="4477"><font size=-1>4477     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4478"><font size=-1>4478     </font></a><span class="string">This variable should be used when performing electron-phonon or temperature-</span>
<a name="4479"><font size=-1>4479     </font></a><span class="string">dependence calculations. The Born effective charge as well as the dielectric</span>
<a name="4480"><font size=-1>4480     </font></a><span class="string">tensor will be read from a previous DFPT calculations of the electric field at</span>
<a name="4481"><font size=-1>4481     </font></a><span class="string">q=Gamma. The use of this variable will trigger the cancellation of a residual</span>
<a name="4482"><font size=-1>4482     </font></a><span class="string">dipole that leads to an unphysical divergence of the GKK with vanishing</span>
<a name="4483"><font size=-1>4483     </font></a><span class="string">q-points. The use of this variable greatly improves the k-point convergence</span>
<a name="4484"><font size=-1>4484     </font></a><span class="string">speed as the density of the k-point grid required to obtain the fulfillment of</span>
<a name="4485"><font size=-1>4485     </font></a><span class="string">the charge neutrality sum rule is usually prohibitively large.</span>
<a name="4486"><font size=-1>4486     </font></a><span class="string">If [[getddb]] == 0, no such use of previously computed Born effective charge and</span>
<a name="4487"><font size=-1>4487     </font></a><span class="string">dielectric tensor is done.</span>
<a name="4488"><font size=-1>4488     </font></a><span class="string">If [[getddb]] is positive, its value gives the index of the dataset from which</span>
<a name="4489"><font size=-1>4489     </font></a><span class="string">the output density is to be used as input.</span>
<a name="4490"><font size=-1>4490     </font></a><span class="string">If [[getddb]] is -1, the output density of the previous dataset must be taken,</span>
<a name="4491"><font size=-1>4491     </font></a><span class="string">which is a frequently occurring case.</span>
<a name="4492"><font size=-1>4492     </font></a><span class="string">If [[getddb]] is a negative number, it indicates the number of datasets to go</span>
<a name="4493"><font size=-1>4493     </font></a><span class="string">backward to find the needed file.</span>
<a name="4494"><font size=-1>4494     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4495"><font size=-1>4495     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4496"><font size=-1>4496     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4497"><font size=-1>4497     </font></a><span class="string"></span>
<a name="4498"><font size=-1>4498     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4499"><font size=-1>4499     </font></a><span class="string"></span>
<a name="4500"><font size=-1>4500     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4501"><font size=-1>4501     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4502"><font size=-1>4502     </font></a><span class="default">),</span>
<a name="4503"><font size=-1>4503     </font></a><span class="default"></span>
<a name="4504"><font size=-1>4504     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4505"><font size=-1>4505     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getddk&quot;</span><span class="default">,</span>
<a name="4506"><font size=-1>4506     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4507"><font size=-1>4507     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4508"><font size=-1>4508     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4509"><font size=-1>4509     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4510"><font size=-1>4510     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4511"><font size=-1>4511     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the DDK wavefunctions from _1WF file&quot;</span><span class="default">,</span>
<a name="4512"><font size=-1>4512     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4513"><font size=-1>4513     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (in the multi-dataset mode), to indicate</span>
<a name="4514"><font size=-1>4514     </font></a><span class="string">starting wavefunctions, as an alternative to</span>
<a name="4515"><font size=-1>4515     </font></a><span class="string">[[irdwfk]],[[irdwfq]],[[ird1wf]],[[irdddk]]. One should first read the</span>
<a name="4516"><font size=-1>4516     </font></a><span class="string">explanations given for these latter variables.</span>
<a name="4517"><font size=-1>4517     </font></a><span class="string">The **getwfk**, **getwfq**, **get1wf** and [[getddk]] variables are</span>
<a name="4518"><font size=-1>4518     </font></a><span class="string">typically used to chain the calculations in the multi-dataset mode, since they</span>
<a name="4519"><font size=-1>4519     </font></a><span class="string">describe from which dataset the OUTPUT wavefunctions are to be taken, as INPUT</span>
<a name="4520"><font size=-1>4520     </font></a><span class="string">wavefunctions of the present dataset.</span>
<a name="4521"><font size=-1>4521     </font></a><span class="string"></span>
<a name="4522"><font size=-1>4522     </font></a><span class="string">We now focus on the **getwfk** input variable (the only one used in ground-</span>
<a name="4523"><font size=-1>4523     </font></a><span class="string">state calculations), but the rules for **getwfq** and **get1wf** are similar,</span>
<a name="4524"><font size=-1>4524     </font></a><span class="string">with _WFK replaced by _WFQ or _1WF.</span>
<a name="4525"><font size=-1>4525     </font></a><span class="string">If **getwfk** ==0, no use of previously computed output wavefunction file</span>
<a name="4526"><font size=-1>4526     </font></a><span class="string">appended with _DSx_WFK is done.</span>
<a name="4527"><font size=-1>4527     </font></a><span class="string">If **getwfk** is positive, its value gives the index of the dataset for which</span>
<a name="4528"><font size=-1>4528     </font></a><span class="string">the output wavefunction file appended with _WFK must be used.</span>
<a name="4529"><font size=-1>4529     </font></a><span class="string">If **getwfk** is -1, the output wf file with _WFK of the previous dataset must</span>
<a name="4530"><font size=-1>4530     </font></a><span class="string">be taken, which is a frequently occurring case.</span>
<a name="4531"><font size=-1>4531     </font></a><span class="string">If **getwfk** is a negative number, it indicates the number of datasets to go</span>
<a name="4532"><font size=-1>4532     </font></a><span class="string">backward to find the needed wavefunction file. In this case, if one refers to</span>
<a name="4533"><font size=-1>4533     </font></a><span class="string">a non existent data set (prior to the first), the wavefunctions are not</span>
<a name="4534"><font size=-1>4534     </font></a><span class="string">initialised from a disk file, so that it is as if **getwfk** =0 for that</span>
<a name="4535"><font size=-1>4535     </font></a><span class="string">initialisation. Thanks to this rule, the use of **getwfk** -1 is rather</span>
<a name="4536"><font size=-1>4536     </font></a><span class="string">straightforward: except for the first wavefunctions, that are not initialized</span>
<a name="4537"><font size=-1>4537     </font></a><span class="string">by reading a disk file, the output wavefunction of one dataset is input of the</span>
<a name="4538"><font size=-1>4538     </font></a><span class="string">next one.</span>
<a name="4539"><font size=-1>4539     </font></a><span class="string">In the case of a ddk calculation in a multi dataset run, in order to compute</span>
<a name="4540"><font size=-1>4540     </font></a><span class="string">correctly the localisation tensor, it is mandatory to declare give getddk the</span>
<a name="4541"><font size=-1>4541     </font></a><span class="string">value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and</span>
<a name="4542"><font size=-1>4542     </font></a><span class="string">should be changed in the future.</span>
<a name="4543"><font size=-1>4543     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4544"><font size=-1>4544     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4545"><font size=-1>4545     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4546"><font size=-1>4546     </font></a><span class="string"></span>
<a name="4547"><font size=-1>4547     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4548"><font size=-1>4548     </font></a><span class="string"></span>
<a name="4549"><font size=-1>4549     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4550"><font size=-1>4550     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4551"><font size=-1>4551     </font></a><span class="default">),</span>
<a name="4552"><font size=-1>4552     </font></a><span class="default"></span>
<a name="4553"><font size=-1>4553     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4554"><font size=-1>4554     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getden&quot;</span><span class="default">,</span>
<a name="4555"><font size=-1>4555     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4556"><font size=-1>4556     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4557"><font size=-1>4557     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4558"><font size=-1>4558     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4559"><font size=-1>4559     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4560"><font size=-1>4560     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the DENsity from...&quot;</span><span class="default">,</span>
<a name="4561"><font size=-1>4561     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4562"><font size=-1>4562     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (multi-dataset mode) and, in the case of a</span>
<a name="4563"><font size=-1>4563     </font></a><span class="string">ground-state calculation, if [[iscf]]&lt;0 (non-SCF calculation), to indicate</span>
<a name="4564"><font size=-1>4564     </font></a><span class="string">that the starting density is to be taken from the output of a previous</span>
<a name="4565"><font size=-1>4565     </font></a><span class="string">dataset. It is used to chain the calculations, since it describes from which</span>
<a name="4566"><font size=-1>4566     </font></a><span class="string">dataset the OUTPUT density are to be taken, as INPUT density of the present dataset.</span>
<a name="4567"><font size=-1>4567     </font></a><span class="string"></span>
<a name="4568"><font size=-1>4568     </font></a><span class="string">If [[getden]] == 0, no such use of previously computed output density file is done.</span>
<a name="4569"><font size=-1>4569     </font></a><span class="string"></span>
<a name="4570"><font size=-1>4570     </font></a><span class="string">If [[getden]] is positive, its value gives the index of the dataset from which</span>
<a name="4571"><font size=-1>4571     </font></a><span class="string">the output density is to be used as input.</span>
<a name="4572"><font size=-1>4572     </font></a><span class="string"></span>
<a name="4573"><font size=-1>4573     </font></a><span class="string">If [[getden]] is -1, the output density of the previous dataset must be taken,</span>
<a name="4574"><font size=-1>4574     </font></a><span class="string">which is a frequently occurring case.</span>
<a name="4575"><font size=-1>4575     </font></a><span class="string"></span>
<a name="4576"><font size=-1>4576     </font></a><span class="string">If [[getden]] is a negative number, it indicates the number of datasets to go</span>
<a name="4577"><font size=-1>4577     </font></a><span class="string">backward to find the needed file. In this case, if one refers to a non</span>
<a name="4578"><font size=-1>4578     </font></a><span class="string">existent data set (prior to the first), the density is not initialised from a</span>
<a name="4579"><font size=-1>4579     </font></a><span class="string">disk file, so that it is as if [[getden]] = 0 for that initialisation. Thanks to</span>
<a name="4580"><font size=-1>4580     </font></a><span class="string">this rule, the use of [[getden]] -1 is rather straightforward: except for the</span>
<a name="4581"><font size=-1>4581     </font></a><span class="string">first density, that is not initialized by reading a disk file, the output</span>
<a name="4582"><font size=-1>4582     </font></a><span class="string">density of one dataset is input of the next one.</span>
<a name="4583"><font size=-1>4583     </font></a><span class="string">Be careful: the output density file of a run with non-zero [[ionmov]] does</span>
<a name="4584"><font size=-1>4584     </font></a><span class="string">not have the proper name (it has a &quot;TIM&quot; indication) for use as an input of an</span>
<a name="4585"><font size=-1>4585     </font></a><span class="string">[[iscf]]&lt;0 calculation.</span>
<a name="4586"><font size=-1>4586     </font></a><span class="string">One should use the output density of a [[ionmov]] == 0 run.</span>
<a name="4587"><font size=-1>4587     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4588"><font size=-1>4588     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4589"><font size=-1>4589     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4590"><font size=-1>4590     </font></a><span class="string"></span>
<a name="4591"><font size=-1>4591     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4592"><font size=-1>4592     </font></a><span class="string"></span>
<a name="4593"><font size=-1>4593     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4594"><font size=-1>4594     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4595"><font size=-1>4595     </font></a><span class="default">),</span>
<a name="4596"><font size=-1>4596     </font></a><span class="default"></span>
<a name="4597"><font size=-1>4597     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4598"><font size=-1>4598     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getgam_eig2nkq&quot;</span><span class="default">,</span>
<a name="4599"><font size=-1>4599     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="4600"><font size=-1>4600     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4601"><font size=-1>4601     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'TDepES_useful'</span><span class="default">],</span>
<a name="4602"><font size=-1>4602     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4603"><font size=-1>4603     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4604"><font size=-1>4604     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the GAMma phonon data EIG2NKQ from dataset&quot;</span><span class="default">,</span>
<a name="4605"><font size=-1>4605     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ieig2rf]] != 0 and [[qpt]] != (0.0, 0.0, 0.0)&quot;</span><span class="default">,</span>
<a name="4606"><font size=-1>4606     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4607"><font size=-1>4607     </font></a><span class="string">Relevant for second-order eigenvalue calculations using response-functions</span>
<a name="4608"><font size=-1>4608     </font></a><span class="string">([[ieig2rf]] != 0), and only for non-zero wavevectors [[qpt]].</span>
<a name="4609"><font size=-1>4609     </font></a><span class="string">From the electron-phonon matrix elements at some wavevector only, it is not</span>
<a name="4610"><font size=-1>4610     </font></a><span class="string">possible to determine the Debye-Waller contribution: one has to know also the</span>
<a name="4611"><font size=-1>4611     </font></a><span class="string">q=Gamma electron-phonon matrix elements.</span>
<a name="4612"><font size=-1>4612     </font></a><span class="string">The variable [[getgam_eig2nkq]] allows one to transmit the information about the</span>
<a name="4613"><font size=-1>4613     </font></a><span class="string">second-order derivatives of the eigenvalues for q=Gamma from the dataset where</span>
<a name="4614"><font size=-1>4614     </font></a><span class="string">the calculation at Gamma was done, to the datasets for other wavevectors.</span>
<a name="4615"><font size=-1>4615     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4616"><font size=-1>4616     </font></a><span class="default">),</span>
<a name="4617"><font size=-1>4617     </font></a><span class="default"></span>
<a name="4618"><font size=-1>4618     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4619"><font size=-1>4619     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gethaydock&quot;</span><span class="default">,</span>
<a name="4620"><font size=-1>4620     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4621"><font size=-1>4621     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4622"><font size=-1>4622     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4623"><font size=-1>4623     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4624"><font size=-1>4624     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4625"><font size=-1>4625     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the HAYDOCK restart file from...&quot;</span><span class="default">,</span>
<a name="4626"><font size=-1>4626     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4627"><font size=-1>4627     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (multi-dataset mode) and, in the case of a</span>
<a name="4628"><font size=-1>4628     </font></a><span class="string">Bethe-Salpeter calculation to indicate that the Haydock iterative technique</span>
<a name="4629"><font size=-1>4629     </font></a><span class="string">will be restarted from the output of a previous dataset.</span>
<a name="4630"><font size=-1>4630     </font></a><span class="string">If [[gethaydock]] == 0, no such use of previously computed coupling block file is done.</span>
<a name="4631"><font size=-1>4631     </font></a><span class="string">If [[gethaydock]] is positive, its value gives the index of the dataset to be used as input.</span>
<a name="4632"><font size=-1>4632     </font></a><span class="string">If [[gethaydock]] is -1, the output of the previous dataset must be taken,</span>
<a name="4633"><font size=-1>4633     </font></a><span class="string">which is a frequently occurring case.</span>
<a name="4634"><font size=-1>4634     </font></a><span class="string">If [[gethaydock]] is a negative number, it indicates the number of datasets to</span>
<a name="4635"><font size=-1>4635     </font></a><span class="string">go backward to find the needed file. In this case, if one refers to a non</span>
<a name="4636"><font size=-1>4636     </font></a><span class="string">existent data set (prior to the first), the coupling block is not initialised</span>
<a name="4637"><font size=-1>4637     </font></a><span class="string">from a disk file, so that it is as if [[gethaydock]] = 0 for that initialisation.</span>
<a name="4638"><font size=-1>4638     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4639"><font size=-1>4639     </font></a><span class="default">),</span>
<a name="4640"><font size=-1>4640     </font></a><span class="default"></span>
<a name="4641"><font size=-1>4641     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4642"><font size=-1>4642     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getocc&quot;</span><span class="default">,</span>
<a name="4643"><font size=-1>4643     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4644"><font size=-1>4644     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4645"><font size=-1>4645     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4646"><font size=-1>4646     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4647"><font size=-1>4647     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4648"><font size=-1>4648     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET OCC parameters from...&quot;</span><span class="default">,</span>
<a name="4649"><font size=-1>4649     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4650"><font size=-1>4650     </font></a><span class="string">This variable is typically used to chain the calculations, in the multi-</span>
<a name="4651"><font size=-1>4651     </font></a><span class="string">dataset mode ([[ndtset]] &gt; 0), since it describes from which dataset the array</span>
<a name="4652"><font size=-1>4652     </font></a><span class="string">[[occ]] is to be taken, as input of the present dataset. The occupation</span>
<a name="4653"><font size=-1>4653     </font></a><span class="string">numbers are [[EVOLVING]] variables, for which such a chain of calculations is useful.</span>
<a name="4654"><font size=-1>4654     </font></a><span class="string">If [[getocc]] == 0, no such use of previously computed output occupations is done.</span>
<a name="4655"><font size=-1>4655     </font></a><span class="string">If [[getocc]] is positive, its value gives the index of the dataset from which</span>
<a name="4656"><font size=-1>4656     </font></a><span class="string">the data are to be used as input data. It must be the index of a dataset</span>
<a name="4657"><font size=-1>4657     </font></a><span class="string">already computed in the SAME run.</span>
<a name="4658"><font size=-1>4658     </font></a><span class="string">If [[getocc]] is -1, the output data of the previous dataset must be taken,</span>
<a name="4659"><font size=-1>4659     </font></a><span class="string">which is a frequently occurring case.</span>
<a name="4660"><font size=-1>4660     </font></a><span class="string">If [[getocc]] is a negative number, it indicates the number of datasets to go</span>
<a name="4661"><font size=-1>4661     </font></a><span class="string">backward to find the needed data. In this case, if one refers to a non</span>
<a name="4662"><font size=-1>4662     </font></a><span class="string">existent data set (prior to the first), the date is not initialised from a</span>
<a name="4663"><font size=-1>4663     </font></a><span class="string">disk file, so that it is as if [[getocc]] == 0 for that initialisation.</span>
<a name="4664"><font size=-1>4664     </font></a><span class="string">NOTE that a non-zero [[getocc]] MUST be used with [[occopt]] == 2, so that the</span>
<a name="4665"><font size=-1>4665     </font></a><span class="string">number of bands has to be initialized for each k point. Of course, these</span>
<a name="4666"><font size=-1>4666     </font></a><span class="string">numbers of bands must be identical to the numbers of bands of the dataset from</span>
<a name="4667"><font size=-1>4667     </font></a><span class="string">which [[occ]] will be copied. The same is true for the number of k points.</span>
<a name="4668"><font size=-1>4668     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4669"><font size=-1>4669     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4670"><font size=-1>4670     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4671"><font size=-1>4671     </font></a><span class="string"></span>
<a name="4672"><font size=-1>4672     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4673"><font size=-1>4673     </font></a><span class="string"></span>
<a name="4674"><font size=-1>4674     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4675"><font size=-1>4675     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4676"><font size=-1>4676     </font></a><span class="default">),</span>
<a name="4677"><font size=-1>4677     </font></a><span class="default"></span>
<a name="4678"><font size=-1>4678     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4679"><font size=-1>4679     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getqps&quot;</span><span class="default">,</span>
<a name="4680"><font size=-1>4680     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4681"><font size=-1>4681     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4682"><font size=-1>4682     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'Susceptibility_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="4683"><font size=-1>4683     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4684"><font size=-1>4684     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4685"><font size=-1>4685     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET QuasiParticle Structure&quot;</span><span class="default">,</span>
<a name="4686"><font size=-1>4686     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4687"><font size=-1>4687     </font></a><span class="string">Used when [[ndtset]] &gt; 0 (multi-dataset mode) and [[optdriver]] = 3, or 4</span>
<a name="4688"><font size=-1>4688     </font></a><span class="string">(screening or sigma step of a GW calculation), to indicate that the</span>
<a name="4689"><font size=-1>4689     </font></a><span class="string">eigenvalues and possibly the wavefunctions have to be taken from a previous</span>
<a name="4690"><font size=-1>4690     </font></a><span class="string">quasiparticle calculation (instead of the usual LDA starting point). This is</span>
<a name="4691"><font size=-1>4691     </font></a><span class="string">to achieve quasiparticle self-consistency. See also [[irdqps]]</span>
<a name="4692"><font size=-1>4692     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4693"><font size=-1>4693     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4694"><font size=-1>4694     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4695"><font size=-1>4695     </font></a><span class="string"></span>
<a name="4696"><font size=-1>4696     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4697"><font size=-1>4697     </font></a><span class="string"></span>
<a name="4698"><font size=-1>4698     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4699"><font size=-1>4699     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4700"><font size=-1>4700     </font></a><span class="default">),</span>
<a name="4701"><font size=-1>4701     </font></a><span class="default"></span>
<a name="4702"><font size=-1>4702     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4703"><font size=-1>4703     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getscr&quot;</span><span class="default">,</span>
<a name="4704"><font size=-1>4704     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4705"><font size=-1>4705     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4706"><font size=-1>4706     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="4707"><font size=-1>4707     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4708"><font size=-1>4708     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4709"><font size=-1>4709     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET SCReening (the inverse dielectric matrix) from...&quot;</span><span class="default">,</span>
<a name="4710"><font size=-1>4710     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4711"><font size=-1>4711     </font></a><span class="string">Used when [[ndtset]] &gt; 0 (multi-dataset mode) and [[optdriver]] = 4 (sigma step of</span>
<a name="4712"><font size=-1>4712     </font></a><span class="string">a GW calculation), to indicate that the dielectric matrix (_SCR file) is to be</span>
<a name="4713"><font size=-1>4713     </font></a><span class="string">taken from the output of a previous dataset. It is used to chain the</span>
<a name="4714"><font size=-1>4714     </font></a><span class="string">calculations, since it describes from which dataset the OUTPUT dielectric</span>
<a name="4715"><font size=-1>4715     </font></a><span class="string">matrix is to be taken, as INPUT of the present dataset.</span>
<a name="4716"><font size=-1>4716     </font></a><span class="string">If [[getscr]] == 0, no such use of previously computed output _SCR file is done.</span>
<a name="4717"><font size=-1>4717     </font></a><span class="string">If [[getscr]] is positive, its value gives the index of the dataset from which</span>
<a name="4718"><font size=-1>4718     </font></a><span class="string">the output _SCR file is to be used as input.</span>
<a name="4719"><font size=-1>4719     </font></a><span class="string">If [[getscr]] is -1, the output _SCR file of the previous dataset must be</span>
<a name="4720"><font size=-1>4720     </font></a><span class="string">taken, which is a frequently occurring case.</span>
<a name="4721"><font size=-1>4721     </font></a><span class="string">If [[getscr]] is a negative number, it indicates the number of datasets to go</span>
<a name="4722"><font size=-1>4722     </font></a><span class="string">backward to find the needed file. In this case, if one refers to a non</span>
<a name="4723"><font size=-1>4723     </font></a><span class="string">existent data set (prior to the first), the _SCR file is not initialised from</span>
<a name="4724"><font size=-1>4724     </font></a><span class="string">a disk file, so that it is as if [[getscr]] = 0 for that initialisation.</span>
<a name="4725"><font size=-1>4725     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4726"><font size=-1>4726     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4727"><font size=-1>4727     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4728"><font size=-1>4728     </font></a><span class="string"></span>
<a name="4729"><font size=-1>4729     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4730"><font size=-1>4730     </font></a><span class="string"></span>
<a name="4731"><font size=-1>4731     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4732"><font size=-1>4732     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4733"><font size=-1>4733     </font></a><span class="default">),</span>
<a name="4734"><font size=-1>4734     </font></a><span class="default"></span>
<a name="4735"><font size=-1>4735     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4736"><font size=-1>4736     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getsuscep&quot;</span><span class="default">,</span>
<a name="4737"><font size=-1>4737     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4738"><font size=-1>4738     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4739"><font size=-1>4739     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="4740"><font size=-1>4740     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4741"><font size=-1>4741     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4742"><font size=-1>4742     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET SUSCEPtibility (the irreducible polarizability) from...&quot;</span><span class="default">,</span>
<a name="4743"><font size=-1>4743     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4744"><font size=-1>4744     </font></a><span class="string">Used when [[ndtset]] &gt; 0 (multi-dataset mode) and [[optdriver]] = 4 (sigma step of</span>
<a name="4745"><font size=-1>4745     </font></a><span class="string">a GW calculation), to indicate that the irreducible polarizability (_SUSC</span>
<a name="4746"><font size=-1>4746     </font></a><span class="string">file) is to be taken from the output of a previous dataset. It is used to</span>
<a name="4747"><font size=-1>4747     </font></a><span class="string">chain the calculations, since it describes from which dataset the OUTPUT</span>
<a name="4748"><font size=-1>4748     </font></a><span class="string">susceptibility is to be taken, as INPUT of the present dataset. Performing a</span>
<a name="4749"><font size=-1>4749     </font></a><span class="string">GW calculations starting from the _SUSC file instead of the _SCR file presents</span>
<a name="4750"><font size=-1>4750     </font></a><span class="string">the advantage that starting from the irreducible polarizability, one can</span>
<a name="4751"><font size=-1>4751     </font></a><span class="string">calculate the screened interaction using different expressions without having</span>
<a name="4752"><font size=-1>4752     </font></a><span class="string">to perform a screening calculation from scratch. For example, it is possible</span>
<a name="4753"><font size=-1>4753     </font></a><span class="string">to apply a cutoff to the Coulomb interaction in order to facilitate the</span>
<a name="4754"><font size=-1>4754     </font></a><span class="string">convergence of the GW correction with respect to the size of the supercell</span>
<a name="4755"><font size=-1>4755     </font></a><span class="string">(see [[vcutgeo]] and [[icutcoul]])</span>
<a name="4756"><font size=-1>4756     </font></a><span class="string">If [[getsuscep]] == 0, no such use of previously computed output _SUSC file is done.</span>
<a name="4757"><font size=-1>4757     </font></a><span class="string">If [[getsuscep]] is positive, its value gives the index of the dataset from</span>
<a name="4758"><font size=-1>4758     </font></a><span class="string">which the output _SUSC file is to be used as input.</span>
<a name="4759"><font size=-1>4759     </font></a><span class="string">If [[getsuscep]] is -1, the output _SUSC file of the previous dataset must be</span>
<a name="4760"><font size=-1>4760     </font></a><span class="string">taken, which is a frequently occurring case.</span>
<a name="4761"><font size=-1>4761     </font></a><span class="string">If [[getsuscep]] is a negative number, it indicates the number of datasets to</span>
<a name="4762"><font size=-1>4762     </font></a><span class="string">go backward to find the needed file. In this case, if one refers to a non</span>
<a name="4763"><font size=-1>4763     </font></a><span class="string">existent data set (prior to the first), the _SUSC file is not initialised from</span>
<a name="4764"><font size=-1>4764     </font></a><span class="string">a disk file, so that it is as if [[getsuscep]] = 0 for that initialisation.</span>
<a name="4765"><font size=-1>4765     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4766"><font size=-1>4766     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4767"><font size=-1>4767     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4768"><font size=-1>4768     </font></a><span class="string"></span>
<a name="4769"><font size=-1>4769     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4770"><font size=-1>4770     </font></a><span class="string"></span>
<a name="4771"><font size=-1>4771     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4772"><font size=-1>4772     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4773"><font size=-1>4773     </font></a><span class="default">),</span>
<a name="4774"><font size=-1>4774     </font></a><span class="default"></span>
<a name="4775"><font size=-1>4775     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4776"><font size=-1>4776     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getvel&quot;</span><span class="default">,</span>
<a name="4777"><font size=-1>4777     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4778"><font size=-1>4778     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4779"><font size=-1>4779     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4780"><font size=-1>4780     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4781"><font size=-1>4781     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4782"><font size=-1>4782     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET VEL from...&quot;</span><span class="default">,</span>
<a name="4783"><font size=-1>4783     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4784"><font size=-1>4784     </font></a><span class="string">These variables are typically used to chain the calculations, in the multi-</span>
<a name="4785"><font size=-1>4785     </font></a><span class="string">dataset mode ([[ndtset]] &gt; 0) since they describe from which dataset the</span>
<a name="4786"><font size=-1>4786     </font></a><span class="string">corresponding output variables are to be taken, as input of the present</span>
<a name="4787"><font size=-1>4787     </font></a><span class="string">dataset. The atomic positions and velocities are [[EVOLVING]] variables, for</span>
<a name="4788"><font size=-1>4788     </font></a><span class="string">which such a chain of calculation is useful.</span>
<a name="4789"><font size=-1>4789     </font></a><span class="string">Note that the use of [[getxcart]] and [[getxred]] differs when [[acell]] and</span>
<a name="4790"><font size=-1>4790     </font></a><span class="string">[[rprim]] are different from one dataset to the other.</span>
<a name="4791"><font size=-1>4791     </font></a><span class="string">If 0, no previously computed values are used.</span>
<a name="4792"><font size=-1>4792     </font></a><span class="string">If &gt;0, the integer should correspond to the index of the dataset from which the VEL data should be used. It must be the index of a dataset already computed in the SAME run.</span>
<a name="4793"><font size=-1>4793     </font></a><span class="string">If equal to -1, the output data of the previous dataset is taken, which</span>
<a name="4794"><font size=-1>4794     </font></a><span class="string">is a frequently occurring case. However, if the first dataset is treated, -1</span>
<a name="4795"><font size=-1>4795     </font></a><span class="string">is equivalent to 0, since no dataset has yet been computed in the same run.</span>
<a name="4796"><font size=-1>4796     </font></a><span class="string">If another negative number, it indicates the number of datasets to go backward</span>
<a name="4797"><font size=-1>4797     </font></a><span class="string">to find the needed data (once again, going back beyond the first dataset is</span>
<a name="4798"><font size=-1>4798     </font></a><span class="string">equivalent to using a null get variable).</span>
<a name="4799"><font size=-1>4799     </font></a><span class="string">Note: [[getxred]] and [[getxcart]] cannot be simultaneously non-zero for the</span>
<a name="4800"><font size=-1>4800     </font></a><span class="string">same dataset. On the other hand the use of [[getvel]] with [[getxred]] is</span>
<a name="4801"><font size=-1>4801     </font></a><span class="string">allowed, despite the different coordinate system.</span>
<a name="4802"><font size=-1>4802     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4803"><font size=-1>4803     </font></a><span class="default">),</span>
<a name="4804"><font size=-1>4804     </font></a><span class="default"></span>
<a name="4805"><font size=-1>4805     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4806"><font size=-1>4806     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getwfk&quot;</span><span class="default">,</span>
<a name="4807"><font size=-1>4807     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4808"><font size=-1>4808     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4809"><font size=-1>4809     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4810"><font size=-1>4810     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4811"><font size=-1>4811     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4812"><font size=-1>4812     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the wavefunctions from _WFK file&quot;</span><span class="default">,</span>
<a name="4813"><font size=-1>4813     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4814"><font size=-1>4814     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (in the multi-dataset mode), to indicate</span>
<a name="4815"><font size=-1>4815     </font></a><span class="string">starting wavefunctions, as an alternative to [[irdwfk]],[[irdwfq]],[[ird1wf]],</span>
<a name="4816"><font size=-1>4816     </font></a><span class="string">or [[irdddk]]. One should first read the explanations given for these latter variables.</span>
<a name="4817"><font size=-1>4817     </font></a><span class="string">The [[getwfk]], **getwfq**, **get1wf** and **getddk** variables are typically</span>
<a name="4818"><font size=-1>4818     </font></a><span class="string">used to chain the calculations in the multi-dataset mode, since they describe</span>
<a name="4819"><font size=-1>4819     </font></a><span class="string">from which dataset the OUTPUT wavefunctions are to be taken, as INPUT</span>
<a name="4820"><font size=-1>4820     </font></a><span class="string">wavefunctions of the present dataset.</span>
<a name="4821"><font size=-1>4821     </font></a><span class="string"></span>
<a name="4822"><font size=-1>4822     </font></a><span class="string">We now focus on the [[getwfk]] input variable (the only one used in ground-</span>
<a name="4823"><font size=-1>4823     </font></a><span class="string">state calculations), but the rules for **getwfq** and **get1wf** are similar,</span>
<a name="4824"><font size=-1>4824     </font></a><span class="string">with _WFK replaced by _WFQ or _1WF.</span>
<a name="4825"><font size=-1>4825     </font></a><span class="string">If [[getwfk]] == 0, no use of previously computed output wavefunction file</span>
<a name="4826"><font size=-1>4826     </font></a><span class="string">appended with _DSx_WFK is done.</span>
<a name="4827"><font size=-1>4827     </font></a><span class="string">If [[getwfk]] is positive, its value gives the index of the dataset for which</span>
<a name="4828"><font size=-1>4828     </font></a><span class="string">the output wavefunction file appended with _WFK must be used.</span>
<a name="4829"><font size=-1>4829     </font></a><span class="string">If [[getwfk]] is -1, the output wf file with _WFK of the previous dataset must</span>
<a name="4830"><font size=-1>4830     </font></a><span class="string">be taken, which is a frequently occurring case.</span>
<a name="4831"><font size=-1>4831     </font></a><span class="string">If [[getwfk]] is a negative number, it indicates the number of datasets to go</span>
<a name="4832"><font size=-1>4832     </font></a><span class="string">backward to find the needed wavefunction file. In this case, if one refers to</span>
<a name="4833"><font size=-1>4833     </font></a><span class="string">a non existent data set (prior to the first), the wavefunctions are not</span>
<a name="4834"><font size=-1>4834     </font></a><span class="string">initialised from a disk file, so that it is as if [[getwfk]] = 0 for that</span>
<a name="4835"><font size=-1>4835     </font></a><span class="string">initialisation. Thanks to this rule, the use of [[getwfk]] -1 is rather</span>
<a name="4836"><font size=-1>4836     </font></a><span class="string">straightforward: except for the first wavefunctions, that are not initialized</span>
<a name="4837"><font size=-1>4837     </font></a><span class="string">by reading a disk file, the output wavefunction of one dataset is input of the</span>
<a name="4838"><font size=-1>4838     </font></a><span class="string">next one.</span>
<a name="4839"><font size=-1>4839     </font></a><span class="string">In the case of a ddk calculation in a multi dataset run, in order to compute</span>
<a name="4840"><font size=-1>4840     </font></a><span class="string">correctly the localisation tensor, it is mandatory to declare give getddk the</span>
<a name="4841"><font size=-1>4841     </font></a><span class="string">value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and</span>
<a name="4842"><font size=-1>4842     </font></a><span class="string">should be changed in the future.</span>
<a name="4843"><font size=-1>4843     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4844"><font size=-1>4844     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4845"><font size=-1>4845     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4846"><font size=-1>4846     </font></a><span class="string"></span>
<a name="4847"><font size=-1>4847     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4848"><font size=-1>4848     </font></a><span class="string"></span>
<a name="4849"><font size=-1>4849     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4850"><font size=-1>4850     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4851"><font size=-1>4851     </font></a><span class="default">),</span>
<a name="4852"><font size=-1>4852     </font></a><span class="default"></span>
<a name="4853"><font size=-1>4853     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4854"><font size=-1>4854     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getwfkfine&quot;</span><span class="default">,</span>
<a name="4855"><font size=-1>4855     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="4856"><font size=-1>4856     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4857"><font size=-1>4857     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'DFPT_useful'</span><span class="default">, </span><span class="string">'TDepES_useful'</span><span class="default">],</span>
<a name="4858"><font size=-1>4858     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4859"><font size=-1>4859     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4860"><font size=-1>4860     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the fine grid wavefunctions from _WFK file&quot;</span><span class="default">,</span>
<a name="4861"><font size=-1>4861     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4862"><font size=-1>4862     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (in the multi-dataset mode), to indicate</span>
<a name="4863"><font size=-1>4863     </font></a><span class="string">starting wavefunctions, as an alternative to [[irdwfkfine]]. One should first</span>
<a name="4864"><font size=-1>4864     </font></a><span class="string">read the explanations given for these latter variables.</span>
<a name="4865"><font size=-1>4865     </font></a><span class="string">The [[getwfkfine]] variables is typically used to chain the calculations in</span>
<a name="4866"><font size=-1>4866     </font></a><span class="string">the multi-dataset mode, since they describe from which dataset the OUTPUT</span>
<a name="4867"><font size=-1>4867     </font></a><span class="string">wavefunctions are to be taken, as INPUT wavefunctions of the present dataset.</span>
<a name="4868"><font size=-1>4868     </font></a><span class="string">If [[getwfkfine]] == 0, no use of previously computed output wavefunction file</span>
<a name="4869"><font size=-1>4869     </font></a><span class="string">appended with _DSx_WFK is done.</span>
<a name="4870"><font size=-1>4870     </font></a><span class="string">If [[getwfkfine]] is positive, its value gives the index of the dataset for</span>
<a name="4871"><font size=-1>4871     </font></a><span class="string">which the output wavefunction file appended with _WFK must be used.</span>
<a name="4872"><font size=-1>4872     </font></a><span class="string">If [[getwfkfine]] is -1, the output wf file with _WFK of the previous dataset</span>
<a name="4873"><font size=-1>4873     </font></a><span class="string">must be taken, which is a frequently occurring case.</span>
<a name="4874"><font size=-1>4874     </font></a><span class="string">If [[getwfkfine]] is a negative number, it indicates the number of datasets to</span>
<a name="4875"><font size=-1>4875     </font></a><span class="string">go backward to find the needed wavefunction file. In this case, if one refers</span>
<a name="4876"><font size=-1>4876     </font></a><span class="string">to a non existent data set (prior to the first), the wavefunctions are not</span>
<a name="4877"><font size=-1>4877     </font></a><span class="string">initialised from a disk file, so that it is as if [[getwfkfine]] = 0 for that</span>
<a name="4878"><font size=-1>4878     </font></a><span class="string">initialisation. Thanks to this rule, the use of [[getwfkfine]] -1 is rather</span>
<a name="4879"><font size=-1>4879     </font></a><span class="string">straightforward: except for the first wavefunctions, that are not initialized</span>
<a name="4880"><font size=-1>4880     </font></a><span class="string">by reading a disk file, the output wavefunction of one dataset is input of the</span>
<a name="4881"><font size=-1>4881     </font></a><span class="string">next one.</span>
<a name="4882"><font size=-1>4882     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4883"><font size=-1>4883     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4884"><font size=-1>4884     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4885"><font size=-1>4885     </font></a><span class="string"></span>
<a name="4886"><font size=-1>4886     </font></a><span class="string">     ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4887"><font size=-1>4887     </font></a><span class="string"></span>
<a name="4888"><font size=-1>4888     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized. Response-function calculation:</span>
<a name="4889"><font size=-1>4889     </font></a><span class="string"></span>
<a name="4890"><font size=-1>4890     </font></a><span class="string">  * one and only one of [[getwfkfine]] or [[irdwfkfine]] MUST be non-zero</span>
<a name="4891"><font size=-1>4891     </font></a><span class="string">  * if [[getwfkfine]] = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="4892"><font size=-1>4892     </font></a><span class="string">    produced in a previous ground state calculation.</span>
<a name="4893"><font size=-1>4893     </font></a><span class="string">  * Reading the fine grid wavefunction will trigger the k-points interpolation</span>
<a name="4894"><font size=-1>4894     </font></a><span class="string">  technique of the temperature dependent calculations.</span>
<a name="4895"><font size=-1>4895     </font></a><span class="string"></span>
<a name="4896"><font size=-1>4896     </font></a><span class="string">Bethe-Salpeter calculation:</span>
<a name="4897"><font size=-1>4897     </font></a><span class="string"></span>
<a name="4898"><font size=-1>4898     </font></a><span class="string">  * one and only one of [[getwfkfine]] or [[irdwfkfine]] MUST be non-zero</span>
<a name="4899"><font size=-1>4899     </font></a><span class="string">  * if [[getwfkfine]] = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="4900"><font size=-1>4900     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="4901"><font size=-1>4901     </font></a><span class="string">  * This variable or [[irdwfkfine]] is mandatory when [[bs_interp_mode]] == 1</span>
<a name="4902"><font size=-1>4902     </font></a><span class="string"></span>
<a name="4903"><font size=-1>4903     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="4904"><font size=-1>4904     </font></a><span class="string"></span>
<a name="4905"><font size=-1>4905     </font></a><span class="string">**This variable is experimental. In development.**</span>
<a name="4906"><font size=-1>4906     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4907"><font size=-1>4907     </font></a><span class="default">),</span>
<a name="4908"><font size=-1>4908     </font></a><span class="default"></span>
<a name="4909"><font size=-1>4909     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4910"><font size=-1>4910     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getwfq&quot;</span><span class="default">,</span>
<a name="4911"><font size=-1>4911     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="4912"><font size=-1>4912     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4913"><font size=-1>4913     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4914"><font size=-1>4914     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4915"><font size=-1>4915     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4916"><font size=-1>4916     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET the wavefunctions from _WFQ file&quot;</span><span class="default">,</span>
<a name="4917"><font size=-1>4917     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4918"><font size=-1>4918     </font></a><span class="string">Eventually used when [[ndtset]] &gt; 0 (in the multi-dataset mode), to indicate</span>
<a name="4919"><font size=-1>4919     </font></a><span class="string">starting wavefunctions, as an alternative to [[irdwfk]],[[irdwfq]],[[ird1wf]]</span>
<a name="4920"><font size=-1>4920     </font></a><span class="string">or [[irdddk]]. One should first read the explanations given for these latter</span>
<a name="4921"><font size=-1>4921     </font></a><span class="string">variables.</span>
<a name="4922"><font size=-1>4922     </font></a><span class="string">The **getwfk**, [[getwfq]], **get1wf** and **getddk** variables are typically</span>
<a name="4923"><font size=-1>4923     </font></a><span class="string">used to chain the calculations in the multi-dataset mode, since they describe</span>
<a name="4924"><font size=-1>4924     </font></a><span class="string">from which dataset the OUTPUT wavefunctions are to be taken, as INPUT</span>
<a name="4925"><font size=-1>4925     </font></a><span class="string">wavefunctions of the present dataset.</span>
<a name="4926"><font size=-1>4926     </font></a><span class="string"></span>
<a name="4927"><font size=-1>4927     </font></a><span class="string">We now focus on the **getwfk** input variable (the only one used in ground-</span>
<a name="4928"><font size=-1>4928     </font></a><span class="string">state calculations), but the rules for [[getwfq]] and **get1wf** are similar,</span>
<a name="4929"><font size=-1>4929     </font></a><span class="string">with _WFK replaced by _WFQ or _1WF.</span>
<a name="4930"><font size=-1>4930     </font></a><span class="string">If **getwfk** ==0, no use of previously computed output wavefunction file</span>
<a name="4931"><font size=-1>4931     </font></a><span class="string">appended with _DSx_WFK is done.</span>
<a name="4932"><font size=-1>4932     </font></a><span class="string">If **getwfk** is positive, its value gives the index of the dataset for which</span>
<a name="4933"><font size=-1>4933     </font></a><span class="string">the output wavefunction file appended with _WFK must be used.</span>
<a name="4934"><font size=-1>4934     </font></a><span class="string">If **getwfk** is -1, the output wf file with _WFK of the previous dataset must</span>
<a name="4935"><font size=-1>4935     </font></a><span class="string">be taken, which is a frequently occurring case.</span>
<a name="4936"><font size=-1>4936     </font></a><span class="string">If **getwfk** is a negative number, it indicates the number of datasets to go</span>
<a name="4937"><font size=-1>4937     </font></a><span class="string">backward to find the needed wavefunction file. In this case, if one refers to</span>
<a name="4938"><font size=-1>4938     </font></a><span class="string">a non existent data set (prior to the first), the wavefunctions are not</span>
<a name="4939"><font size=-1>4939     </font></a><span class="string">initialised from a disk file, so that it is as if **getwfk** =0 for that</span>
<a name="4940"><font size=-1>4940     </font></a><span class="string">initialisation. Thanks to this rule, the use of **getwfk** -1 is rather</span>
<a name="4941"><font size=-1>4941     </font></a><span class="string">straightforward: except for the first wavefunctions, that are not initialized</span>
<a name="4942"><font size=-1>4942     </font></a><span class="string">by reading a disk file, the output wavefunction of one dataset is input of the</span>
<a name="4943"><font size=-1>4943     </font></a><span class="string">next one.</span>
<a name="4944"><font size=-1>4944     </font></a><span class="string">In the case of a ddk calculation in a multi dataset run, in order to compute</span>
<a name="4945"><font size=-1>4945     </font></a><span class="string">correctly the localisation tensor, it is mandatory to declare give getddk the</span>
<a name="4946"><font size=-1>4946     </font></a><span class="string">value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and</span>
<a name="4947"><font size=-1>4947     </font></a><span class="string">should be changed in the future.</span>
<a name="4948"><font size=-1>4948     </font></a><span class="string">NOTE: a negative value of a &quot;get&quot; variable indicates the number of datasets</span>
<a name="4949"><font size=-1>4949     </font></a><span class="string">to go backwards; it is not the number to be subtracted from the current</span>
<a name="4950"><font size=-1>4950     </font></a><span class="string">dataset to find the proper dataset. As an example:</span>
<a name="4951"><font size=-1>4951     </font></a><span class="string"></span>
<a name="4952"><font size=-1>4952     </font></a><span class="string">      ndtset 3   jdtset 1 2 4  getXXX -1</span>
<a name="4953"><font size=-1>4953     </font></a><span class="string"></span>
<a name="4954"><font size=-1>4954     </font></a><span class="string">refers to dataset 2 when dataset 4 is initialized.</span>
<a name="4955"><font size=-1>4955     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4956"><font size=-1>4956     </font></a><span class="default">),</span>
<a name="4957"><font size=-1>4957     </font></a><span class="default"></span>
<a name="4958"><font size=-1>4958     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4959"><font size=-1>4959     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getxcart&quot;</span><span class="default">,</span>
<a name="4960"><font size=-1>4960     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4961"><font size=-1>4961     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4962"><font size=-1>4962     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4963"><font size=-1>4963     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4964"><font size=-1>4964     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4965"><font size=-1>4965     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET XCART from...&quot;</span><span class="default">,</span>
<a name="4966"><font size=-1>4966     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4967"><font size=-1>4967     </font></a><span class="string">These variables are typically used to chain the calculations, in the multi-</span>
<a name="4968"><font size=-1>4968     </font></a><span class="string">dataset mode ([[ndtset]] &gt; 0) since they describe from which dataset the</span>
<a name="4969"><font size=-1>4969     </font></a><span class="string">corresponding output variables are to be taken, as input of the present</span>
<a name="4970"><font size=-1>4970     </font></a><span class="string">dataset. The atomic positions and velocities are [[EVOLVING]] variables, for</span>
<a name="4971"><font size=-1>4971     </font></a><span class="string">which such a chain of calculation is useful.</span>
<a name="4972"><font size=-1>4972     </font></a><span class="string">Note that the use of [[getxcart]] and [[getxred]] differs when [[acell]] and</span>
<a name="4973"><font size=-1>4973     </font></a><span class="string">[[rprim]] are different from one dataset to the other.</span>
<a name="4974"><font size=-1>4974     </font></a><span class="string">If 0, no previously computed values are used.</span>
<a name="4975"><font size=-1>4975     </font></a><span class="string">If &gt;0, the integer must correspond to the index of the dataset from which the</span>
<a name="4976"><font size=-1>4976     </font></a><span class="string">data are to be used as input data. It must be the index of a dataset already</span>
<a name="4977"><font size=-1>4977     </font></a><span class="string">computed in the SAME run.</span>
<a name="4978"><font size=-1>4978     </font></a><span class="string">If equal to -1, the output data of the previous dataset must be taken, which</span>
<a name="4979"><font size=-1>4979     </font></a><span class="string">is a frequently occurring case. However, if the first dataset is treated, -1</span>
<a name="4980"><font size=-1>4980     </font></a><span class="string">is equivalent to 0, since no dataset has yet been computed in the same run.</span>
<a name="4981"><font size=-1>4981     </font></a><span class="string">If another negative number, it indicates the number of datasets to go backward</span>
<a name="4982"><font size=-1>4982     </font></a><span class="string">to find the needed data (once again, going back beyond the first dataset is</span>
<a name="4983"><font size=-1>4983     </font></a><span class="string">equivalent to using a null get variable).</span>
<a name="4984"><font size=-1>4984     </font></a><span class="string">Note: [[getxred]] and [[getxcart]] cannot be simultaneously non-zero for the</span>
<a name="4985"><font size=-1>4985     </font></a><span class="string">same dataset. On the other hand the use of [[getvel]] with [[getxred]] is</span>
<a name="4986"><font size=-1>4986     </font></a><span class="string">allowed, despite the different coordinate system.</span>
<a name="4987"><font size=-1>4987     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="4988"><font size=-1>4988     </font></a><span class="default">),</span>
<a name="4989"><font size=-1>4989     </font></a><span class="default"></span>
<a name="4990"><font size=-1>4990     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="4991"><font size=-1>4991     </font></a><span class="default">    abivarname=</span><span class="string">&quot;getxred&quot;</span><span class="default">,</span>
<a name="4992"><font size=-1>4992     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="4993"><font size=-1>4993     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="4994"><font size=-1>4994     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="4995"><font size=-1>4995     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="4996"><font size=-1>4996     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="4997"><font size=-1>4997     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GET XRED from...&quot;</span><span class="default">,</span>
<a name="4998"><font size=-1>4998     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="4999"><font size=-1>4999     </font></a><span class="string">These variables are typically used to chain the calculations, in the multi-</span>
<a name="5000"><font size=-1>5000     </font></a><span class="string">dataset mode ([[ndtset]] &gt; 0) since they describe from which dataset the</span>
<a name="5001"><font size=-1>5001     </font></a><span class="string">corresponding output variables are to be taken, as input of the present</span>
<a name="5002"><font size=-1>5002     </font></a><span class="string">dataset. The atomic positions and velocities are [[EVOLVING]] variables, for</span>
<a name="5003"><font size=-1>5003     </font></a><span class="string">which such a chain of calculation is useful.</span>
<a name="5004"><font size=-1>5004     </font></a><span class="string">Note that the use of [[getxcart]] and [[getxred]] differs when [[acell]] and</span>
<a name="5005"><font size=-1>5005     </font></a><span class="string">[[rprim]] are different from one dataset to the other.</span>
<a name="5006"><font size=-1>5006     </font></a><span class="string">If 0, no use of previously computed values must occur.</span>
<a name="5007"><font size=-1>5007     </font></a><span class="string">If &gt;0, the integer must correspond to the index of the dataset from which the</span>
<a name="5008"><font size=-1>5008     </font></a><span class="string">data are to be used as input data. It must be the index of a dataset already</span>
<a name="5009"><font size=-1>5009     </font></a><span class="string">computed in the SAME run.</span>
<a name="5010"><font size=-1>5010     </font></a><span class="string">If equal to -1, the output data of the previous dataset must be taken, which</span>
<a name="5011"><font size=-1>5011     </font></a><span class="string">is a frequently occurring case. However, if the first dataset is treated, -1</span>
<a name="5012"><font size=-1>5012     </font></a><span class="string">is equivalent to 0, since no dataset has yet been computed in the same run.</span>
<a name="5013"><font size=-1>5013     </font></a><span class="string">If another negative number, it indicates the number of datasets to go backward</span>
<a name="5014"><font size=-1>5014     </font></a><span class="string">to find the needed data (once again, going back beyond the first dataset is</span>
<a name="5015"><font size=-1>5015     </font></a><span class="string">equivalent to using a null get variable).</span>
<a name="5016"><font size=-1>5016     </font></a><span class="string">Note: [[getxred]] and [[getxcart]] cannot be simultaneously non-zero for the</span>
<a name="5017"><font size=-1>5017     </font></a><span class="string">same dataset. On the other hand the use of [[getvel]] with [[getxred]] is</span>
<a name="5018"><font size=-1>5018     </font></a><span class="string">allowed, despite the different coordinate system.</span>
<a name="5019"><font size=-1>5019     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5020"><font size=-1>5020     </font></a><span class="default">),</span>
<a name="5021"><font size=-1>5021     </font></a><span class="default"></span>
<a name="5022"><font size=-1>5022     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5023"><font size=-1>5023     </font></a><span class="default">    abivarname=</span><span class="string">&quot;goprecon&quot;</span><span class="default">,</span>
<a name="5024"><font size=-1>5024     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="5025"><font size=-1>5025     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5026"><font size=-1>5026     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="5027"><font size=-1>5027     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5028"><font size=-1>5028     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5029"><font size=-1>5029     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Geometry Optimization PRECONditioner equations&quot;</span><span class="default">,</span>
<a name="5030"><font size=-1>5030     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5031"><font size=-1>5031     </font></a><span class="string">Set the kind of preconditioner to be used for Geometry Optimization</span>
<a name="5032"><font size=-1>5032     </font></a><span class="string">(Note: Under development now (2011.05.20))</span>
<a name="5033"><font size=-1>5033     </font></a><span class="string"></span>
<a name="5034"><font size=-1>5034     </font></a><span class="string">  * [[goprecon]] = 0: No preconditioner</span>
<a name="5035"><font size=-1>5035     </font></a><span class="string">  * [[goprecon]] = [1-9]: Linear preconditioner</span>
<a name="5036"><font size=-1>5036     </font></a><span class="string">  * [[goprecon]] = [11-19]: Non-linear preconditioner</span>
<a name="5037"><font size=-1>5037     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5038"><font size=-1>5038     </font></a><span class="default">),</span>
<a name="5039"><font size=-1>5039     </font></a><span class="default"></span>
<a name="5040"><font size=-1>5040     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5041"><font size=-1>5041     </font></a><span class="default">    abivarname=</span><span class="string">&quot;goprecprm&quot;</span><span class="default">,</span>
<a name="5042"><font size=-1>5042     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="5043"><font size=-1>5043     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5044"><font size=-1>5044     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="5045"><font size=-1>5045     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="5046"><font size=-1>5046     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5047"><font size=-1>5047     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Geometry Optimization PREconditioner PaRaMeters equations&quot;</span><span class="default">,</span>
<a name="5048"><font size=-1>5048     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5049"><font size=-1>5049     </font></a><span class="string">Set the parameters use by the preconditioner to be used for Geometry</span>
<a name="5050"><font size=-1>5050     </font></a><span class="string">Optimization</span>
<a name="5051"><font size=-1>5051     </font></a><span class="string">(Note: Under development now (2011.06.06))</span>
<a name="5052"><font size=-1>5052     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5053"><font size=-1>5053     </font></a><span class="default">),</span>
<a name="5054"><font size=-1>5054     </font></a><span class="default"></span>
<a name="5055"><font size=-1>5055     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5056"><font size=-1>5056     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gpu_devices&quot;</span><span class="default">,</span>
<a name="5057"><font size=-1>5057     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="5058"><font size=-1>5058     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5059"><font size=-1>5059     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="5060"><font size=-1>5060     </font></a><span class="default">    dimensions=[</span><span class="number">5</span><span class="default">],</span>
<a name="5061"><font size=-1>5061     </font></a><span class="default">    defaultval=[-</span><span class="number">1</span><span class="default">, -</span><span class="number">1</span><span class="default">, -</span><span class="number">1</span><span class="default">, -</span><span class="number">1</span><span class="default">, -</span><span class="number">1</span><span class="default">],</span>
<a name="5062"><font size=-1>5062     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GPU: choice of DEVICES on one node&quot;</span><span class="default">,</span>
<a name="5063"><font size=-1>5063     </font></a><span class="default">    requires=</span><span class="string">&quot;[[use_gpu_cuda]] == 1 (CUDA functionality)&quot;</span><span class="default">,</span>
<a name="5064"><font size=-1>5064     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5065"><font size=-1>5065     </font></a><span class="string">To be used when several GPU devices are present on each node, assuming the</span>
<a name="5066"><font size=-1>5066     </font></a><span class="string">same number of devices on all nodes.</span>
<a name="5067"><font size=-1>5067     </font></a><span class="string">Allows to choose in which order the GPU devices are chosen and distributed</span>
<a name="5068"><font size=-1>5068     </font></a><span class="string">among MPI processes (see examples below). When the default value (-1) is set,</span>
<a name="5069"><font size=-1>5069     </font></a><span class="string">the GPU devices are chosen by order of performance (FLOPS, memory).</span>
<a name="5070"><font size=-1>5070     </font></a><span class="string"></span>
<a name="5071"><font size=-1>5071     </font></a><span class="string">Examples:</span>
<a name="5072"><font size=-1>5072     </font></a><span class="string"></span>
<a name="5073"><font size=-1>5073     </font></a><span class="string">  * 2 GPU devices per node, 4 MPI processes per node, **gpu_device** =[-1,-1,-1,-1,-1] (default):</span>
<a name="5074"><font size=-1>5074     </font></a><span class="string">MPI processes 0 and 2 use the best GPU card, MPI processes 1 and 3 use the</span>
<a name="5075"><font size=-1>5075     </font></a><span class="string">slowest GPU card.</span>
<a name="5076"><font size=-1>5076     </font></a><span class="string"></span>
<a name="5077"><font size=-1>5077     </font></a><span class="string">  * 3 GPU devices per node, 5 MPI processes per node, **gpu_device** =[1,0,2,-1,-1]:</span>
<a name="5078"><font size=-1>5078     </font></a><span class="string">MPI processes 0 and 3 use GPU card 1, MPI processes 1 and 4 use GPU card 0,</span>
<a name="5079"><font size=-1>5079     </font></a><span class="string">MPI process 2 uses GPU card 2.</span>
<a name="5080"><font size=-1>5080     </font></a><span class="string"></span>
<a name="5081"><font size=-1>5081     </font></a><span class="string">  * 3 GPU devices per node, 5 MPI processes per node, **gpu_device** =[0,1,-1,-1,-1]:</span>
<a name="5082"><font size=-1>5082     </font></a><span class="string">MPI processes 0, 2 and 4 use GPU card 0, MPI processes 1 and 3 use GPU card 1;</span>
<a name="5083"><font size=-1>5083     </font></a><span class="string">the 3rd GPU card is not used.</span>
<a name="5084"><font size=-1>5084     </font></a><span class="string"></span>
<a name="5085"><font size=-1>5085     </font></a><span class="string">GPU card are numbered starting from 0; to get the GPU devices list, type</span>
<a name="5086"><font size=-1>5086     </font></a><span class="string">&quot;nvidia-smi&quot; or &quot;lspci | grep -i nvidia&quot;.</span>
<a name="5087"><font size=-1>5087     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5088"><font size=-1>5088     </font></a><span class="default">),</span>
<a name="5089"><font size=-1>5089     </font></a><span class="default"></span>
<a name="5090"><font size=-1>5090     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5091"><font size=-1>5091     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gpu_linalg_limit&quot;</span><span class="default">,</span>
<a name="5092"><font size=-1>5092     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="5093"><font size=-1>5093     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5094"><font size=-1>5094     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="5095"><font size=-1>5095     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5096"><font size=-1>5096     </font></a><span class="default">    defaultval=</span><span class="number">2000000</span><span class="default">,</span>
<a name="5097"><font size=-1>5097     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GPU (Cuda): LINear ALGebra LIMIT&quot;</span><span class="default">,</span>
<a name="5098"><font size=-1>5098     </font></a><span class="default">    requires=</span><span class="string">&quot;[[use_gpu_cuda]] == 1 (CUDA functionality)&quot;</span><span class="default">,</span>
<a name="5099"><font size=-1>5099     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5100"><font size=-1>5100     </font></a><span class="string">Use of linear algebra and matrix algebra on GPU is only efficient if the size</span>
<a name="5101"><font size=-1>5101     </font></a><span class="string">of the involved matrices is large enough. The [[gpu_linalg_limit]] parameter</span>
<a name="5102"><font size=-1>5102     </font></a><span class="string">defines the threshold above which linear (and matrix) algebra operations are</span>
<a name="5103"><font size=-1>5103     </font></a><span class="string">done on the Graphics Processing Unit.</span>
<a name="5104"><font size=-1>5104     </font></a><span class="string">The considered matrix size is equal to:</span>
<a name="5105"><font size=-1>5105     </font></a><span class="string"></span>
<a name="5106"><font size=-1>5106     </font></a><span class="string">* SIZE=([[mpw]] $\\times$ [[nspinor]] / [[npspinor]]) $\\times$ ([[npband]] $\\times$ [[bandpp]]) $^2$</span>
<a name="5107"><font size=-1>5107     </font></a><span class="string"></span>
<a name="5108"><font size=-1>5108     </font></a><span class="string">When SIZE&gt;=[[gpu_linalg_limit]], [[wfoptalg]] parameter is automatically set</span>
<a name="5109"><font size=-1>5109     </font></a><span class="string">to 14 which corresponds to the use of LOBPCG algorithm for the calculation of</span>
<a name="5110"><font size=-1>5110     </font></a><span class="string">the eigenstates.</span>
<a name="5111"><font size=-1>5111     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5112"><font size=-1>5112     </font></a><span class="default">),</span>
<a name="5113"><font size=-1>5113     </font></a><span class="default"></span>
<a name="5114"><font size=-1>5114     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5115"><font size=-1>5115     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_customnfreqsp&quot;</span><span class="default">,</span>
<a name="5116"><font size=-1>5116     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5117"><font size=-1>5117     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5118"><font size=-1>5118     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="5119"><font size=-1>5119     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5120"><font size=-1>5120     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5121"><font size=-1>5121     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW CUSTOM FREQuencies for SPectral function&quot;</span><span class="default">,</span>
<a name="5122"><font size=-1>5122     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4 and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="5123"><font size=-1>5123     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5124"><font size=-1>5124     </font></a><span class="string">[[gw_customnfreqsp]] lets the user define the grid points along the real</span>
<a name="5125"><font size=-1>5125     </font></a><span class="string">frequency axis by hand for the calculation of the self-energy along the real</span>
<a name="5126"><font size=-1>5126     </font></a><span class="string">axis. Set this to the number of frequencies you want. The frequencies are</span>
<a name="5127"><font size=-1>5127     </font></a><span class="string">specified with [[gw_freqsp]].</span>
<a name="5128"><font size=-1>5128     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5129"><font size=-1>5129     </font></a><span class="default">),</span>
<a name="5130"><font size=-1>5130     </font></a><span class="default"></span>
<a name="5131"><font size=-1>5131     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5132"><font size=-1>5132     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_freqsp&quot;</span><span class="default">,</span>
<a name="5133"><font size=-1>5133     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5134"><font size=-1>5134     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5135"><font size=-1>5135     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="5136"><font size=-1>5136     </font></a><span class="default">    dimensions=[</span><span class="string">'[[gw_customnfreqsp]]'</span><span class="default">],</span>
<a name="5137"><font size=-1>5137     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#7747">Range</a>({</span><span class="string">'start'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'stop'</span><span class="default">: </span><span class="string">'[[gw_customnfreqsp]]'</span><span class="default">}),</span>
<a name="5138"><font size=-1>5138     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW SPectral FREQuencies&quot;</span><span class="default">,</span>
<a name="5139"><font size=-1>5139     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4 and [[gw_customnfreqsp]] &gt; 0&quot;</span><span class="default">,</span>
<a name="5140"><font size=-1>5140     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5141"><font size=-1>5141     </font></a><span class="string">[[gw_freqsp]] specifies the grid points for the real frequency axis when the</span>
<a name="5142"><font size=-1>5142     </font></a><span class="string">real and imaginary (spectral function) parts of sigma are calculated explicitly</span>
<a name="5143"><font size=-1>5143     </font></a><span class="string">for post-processing or plotting. Only activated if [[gw_customnfreqsp]] is not</span>
<a name="5144"><font size=-1>5144     </font></a><span class="string">equal to 0. The number of frequencies is set by the value of</span>
<a name="5145"><font size=-1>5145     </font></a><span class="string">[[gw_customnfreqsp]]. Example:</span>
<a name="5146"><font size=-1>5146     </font></a><span class="string"></span>
<a name="5147"><font size=-1>5147     </font></a><span class="string">    gw_customnfreqsp   5</span>
<a name="5148"><font size=-1>5148     </font></a><span class="string">    nfreqsp            5</span>
<a name="5149"><font size=-1>5149     </font></a><span class="string">    gw_freqsp         -0.5  -0.1  0.0  1.0  10.0 eV</span>
<a name="5150"><font size=-1>5150     </font></a><span class="string"></span>
<a name="5151"><font size=-1>5151     </font></a><span class="string">If [[nfreqsp]] is not equal to [[gw_customnfreqsp]] a warning will be issued.</span>
<a name="5152"><font size=-1>5152     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5153"><font size=-1>5153     </font></a><span class="default">),</span>
<a name="5154"><font size=-1>5154     </font></a><span class="default"></span>
<a name="5155"><font size=-1>5155     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5156"><font size=-1>5156     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_frqim_inzgrid&quot;</span><span class="default">,</span>
<a name="5157"><font size=-1>5157     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5158"><font size=-1>5158     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5159"><font size=-1>5159     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="5160"><font size=-1>5160     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5161"><font size=-1>5161     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5162"><font size=-1>5162     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW Contour Deformation FReQuencies on IMaginary axis Inverse Z Grid&quot;</span><span class="default">,</span>
<a name="5163"><font size=-1>5163     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4] and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="5164"><font size=-1>5164     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5165"><font size=-1>5165     </font></a><span class="string">[[gw_frqim_inzgrid]] creates grid points along the **imaginary** frequency axis</span>
<a name="5166"><font size=-1>5166     </font></a><span class="string">by using an equidistant grid in the variable  $z \subset [0,1]$ where the transform</span>
<a name="5167"><font size=-1>5167     </font></a><span class="string">is:</span>
<a name="5168"><font size=-1>5168     </font></a><span class="string"></span>
<a name="5169"><font size=-1>5169     </font></a><span class="string">$$ i\omega^\prime = w_p \\frac{z}{1-z}. $$</span>
<a name="5170"><font size=-1>5170     </font></a><span class="string"></span>
<a name="5171"><font size=-1>5171     </font></a><span class="string">Here  $\omega_p$ is the plasma frequency (default can be overridden by setting</span>
<a name="5172"><font size=-1>5172     </font></a><span class="string">[[ppmfrq]]). The equidistant grid in z is determined uniquely by [[nfreqim]])</span>
<a name="5173"><font size=-1>5173     </font></a><span class="string">and the points are distributed so that half of them lie below the plasma frequency.</span>
<a name="5174"><font size=-1>5174     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5175"><font size=-1>5175     </font></a><span class="default">),</span>
<a name="5176"><font size=-1>5176     </font></a><span class="default"></span>
<a name="5177"><font size=-1>5177     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5178"><font size=-1>5178     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_frqre_inzgrid&quot;</span><span class="default">,</span>
<a name="5179"><font size=-1>5179     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5180"><font size=-1>5180     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5181"><font size=-1>5181     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="5182"><font size=-1>5182     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5183"><font size=-1>5183     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5184"><font size=-1>5184     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW Contour Deformation FReQuencies on REal axis Inverse Z Grid&quot;</span><span class="default">,</span>
<a name="5185"><font size=-1>5185     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4] and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="5186"><font size=-1>5186     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5187"><font size=-1>5187     </font></a><span class="string">[[gw_frqre_inzgrid]] creates grid points along the **real** frequency axis by</span>
<a name="5188"><font size=-1>5188     </font></a><span class="string">using an equidistant grid in the variable  $z \subset [0,1]$ where the transform</span>
<a name="5189"><font size=-1>5189     </font></a><span class="string">is:</span>
<a name="5190"><font size=-1>5190     </font></a><span class="string"></span>
<a name="5191"><font size=-1>5191     </font></a><span class="string">$$ \omega = \omega_p \\frac{z}{1-z}. $$</span>
<a name="5192"><font size=-1>5192     </font></a><span class="string"></span>
<a name="5193"><font size=-1>5193     </font></a><span class="string">Here $\omega_p$ is the plasma frequency (default can be overridden by setting</span>
<a name="5194"><font size=-1>5194     </font></a><span class="string">[[ppmfrq]]). The equidistant grid in z is determined uniquely by [[nfreqre]] )</span>
<a name="5195"><font size=-1>5195     </font></a><span class="string">and the points are distributed so that half of them lie below the plasma</span>
<a name="5196"><font size=-1>5196     </font></a><span class="string">frequency. This is useful in conjunction with [[gw_frqim_inzgrid]] if one needs</span>
<a name="5197"><font size=-1>5197     </font></a><span class="string">to use a grid which maps $[0, \infty] \\rightarrow [0,1]$. Note that typically _many_ more</span>
<a name="5198"><font size=-1>5198     </font></a><span class="string">points are needed along the real axis in order to properly resolve peak</span>
<a name="5199"><font size=-1>5199     </font></a><span class="string">structures. In contrast, both the screening and self-energy are very smooth</span>
<a name="5200"><font size=-1>5200     </font></a><span class="string">along the imaginary axis. Also, please note that this is **not** an efficient</span>
<a name="5201"><font size=-1>5201     </font></a><span class="string">grid for **standard** Contour Deformation calculations, where typically only a</span>
<a name="5202"><font size=-1>5202     </font></a><span class="string">smaller range of frequencies near the origin is required. The maximum value</span>
<a name="5203"><font size=-1>5203     </font></a><span class="string">needed along the real frequency axis is output in the logfile during Contour</span>
<a name="5204"><font size=-1>5204     </font></a><span class="string">Deformation sigma calculations.</span>
<a name="5205"><font size=-1>5205     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5206"><font size=-1>5206     </font></a><span class="default">),</span>
<a name="5207"><font size=-1>5207     </font></a><span class="default"></span>
<a name="5208"><font size=-1>5208     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5209"><font size=-1>5209     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_frqre_tangrid&quot;</span><span class="default">,</span>
<a name="5210"><font size=-1>5210     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5211"><font size=-1>5211     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5212"><font size=-1>5212     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_expert'</span><span class="default">],</span>
<a name="5213"><font size=-1>5213     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5214"><font size=-1>5214     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5215"><font size=-1>5215     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW Contour Deformation FReQencies on REal axis - Use Tangent Grid&quot;</span><span class="default">,</span>
<a name="5216"><font size=-1>5216     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4] and [[gwcalctyp]] in [2,9,12,19,22,29]&quot;</span><span class="default">,</span>
<a name="5217"><font size=-1>5217     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5218"><font size=-1>5218     </font></a><span class="string">[[gw_frqre_tangrid]] defines a nonuniform grid to be used in frequency, with</span>
<a name="5219"><font size=-1>5219     </font></a><span class="string">stepsize increasing proportional to $\\tan(x)$. This makes the grid approximately</span>
<a name="5220"><font size=-1>5220     </font></a><span class="string">linear to start with, with a rapid increase towards the end. Also, this is the</span>
<a name="5221"><font size=-1>5221     </font></a><span class="string">grid which gives equal importance to each point used in the integration of a</span>
<a name="5222"><font size=-1>5222     </font></a><span class="string">function which decays as $1/x^2$. To be used in conjunction with [[nfreqre]],</span>
<a name="5223"><font size=-1>5223     </font></a><span class="string">[[cd_max_freq]] and [[cd_halfway_freq]] which determine the parameters of the</span>
<a name="5224"><font size=-1>5224     </font></a><span class="string">transformed grid.</span>
<a name="5225"><font size=-1>5225     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5226"><font size=-1>5226     </font></a><span class="default">),</span>
<a name="5227"><font size=-1>5227     </font></a><span class="default"></span>
<a name="5228"><font size=-1>5228     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5229"><font size=-1>5229     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_invalid_freq&quot;</span><span class="default">,</span>
<a name="5230"><font size=-1>5230     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5231"><font size=-1>5231     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5232"><font size=-1>5232     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="5233"><font size=-1>5233     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5234"><font size=-1>5234     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5235"><font size=-1>5235     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW treatment of INVALID FREQuency for Hybertsen-Louie PPM&quot;</span><span class="default">,</span>
<a name="5236"><font size=-1>5236     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4] and [[ppmodel]] in [2]&quot;</span><span class="default">,</span>
<a name="5237"><font size=-1>5237     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5238"><font size=-1>5238     </font></a><span class="string">[[gw_invalid_freq]] sets the procedure to follow when a PPM frequency is</span>
<a name="5239"><font size=-1>5239     </font></a><span class="string">invalid (negative or imaginary).</span>
<a name="5240"><font size=-1>5240     </font></a><span class="string"></span>
<a name="5241"><font size=-1>5241     </font></a><span class="string">  * [[gw_invalid_freq]] = 0: Drop them as proposed in Appendix B of [[cite:Hybertsen1986]].</span>
<a name="5242"><font size=-1>5242     </font></a><span class="string">  * [[gw_invalid_freq]] = 1: Set them to 1 hartree, as done for the PPM of Godby-Needs [[cite:Godby1989]].</span>
<a name="5243"><font size=-1>5243     </font></a><span class="string">  * [[gw_invalid_freq]] = 2: Set them to infinity.</span>
<a name="5244"><font size=-1>5244     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5245"><font size=-1>5245     </font></a><span class="default">),</span>
<a name="5246"><font size=-1>5246     </font></a><span class="default"></span>
<a name="5247"><font size=-1>5247     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5248"><font size=-1>5248     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_nqlwl&quot;</span><span class="default">,</span>
<a name="5249"><font size=-1>5249     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5250"><font size=-1>5250     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5251"><font size=-1>5251     </font></a><span class="default">    topics=[</span><span class="string">'GW_expert'</span><span class="default">, </span><span class="string">'BSE_expert'</span><span class="default">, </span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="5252"><font size=-1>5252     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5253"><font size=-1>5253     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="5254"><font size=-1>5254     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW, Number of Q-points for the Long Wave-Length Limit&quot;</span><span class="default">,</span>
<a name="5255"><font size=-1>5255     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4,99]&quot;</span><span class="default">,</span>
<a name="5256"><font size=-1>5256     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5257"><font size=-1>5257     </font></a><span class="string">Only relevant if [[optdriver]] = 3,4,99 that is, screening, sigma or Bethe-</span>
<a name="5258"><font size=-1>5258     </font></a><span class="string">Salpeter calculations, although the actual meaning of the variable depends on</span>
<a name="5259"><font size=-1>5259     </font></a><span class="string">the particular run-level (see discussion below).</span>
<a name="5260"><font size=-1>5260     </font></a><span class="string"></span>
<a name="5261"><font size=-1>5261     </font></a><span class="string">[[gw_nqlwl]] defines the number of directions in reciprocal space used to</span>
<a name="5262"><font size=-1>5262     </font></a><span class="string">describe the non-analytical behaviour of the heads ($G = G'=0$) and the wings</span>
<a name="5263"><font size=-1>5263     </font></a><span class="string">($G=0$ or $G'=0$) of the dielectric matrix in the optical limit (i.e. for $q$</span>
<a name="5264"><font size=-1>5264     </font></a><span class="string">tending to zero). The number of directions is specified by the additional</span>
<a name="5265"><font size=-1>5265     </font></a><span class="string">variable [[gw_qlwl]].</span>
<a name="5266"><font size=-1>5266     </font></a><span class="string"></span>
<a name="5267"><font size=-1>5267     </font></a><span class="string">When [[optdriver]] = 3, [[gw_nqlwl]] and **gw_qlwl** define the set of &quot;small&quot; $q$</span>
<a name="5268"><font size=-1>5268     </font></a><span class="string">that will be calculated and stored in the final SCR file. Therefore, the two</span>
<a name="5269"><font size=-1>5269     </font></a><span class="string">variables can be used to analyze how the optical spectra depend on the</span>
<a name="5270"><font size=-1>5270     </font></a><span class="string">direction of the incident phonon (useful especially in anisotropic systems).</span>
<a name="5271"><font size=-1>5271     </font></a><span class="string"></span>
<a name="5272"><font size=-1>5272     </font></a><span class="string">When [[optdriver]] = 4, [[gw_nqlwl]] and **gw_qlwl** can be used to specify the</span>
<a name="5273"><font size=-1>5273     </font></a><span class="string">heads and the wings to be used to perform the quadrature of the correlated</span>
<a name="5274"><font size=-1>5274     </font></a><span class="string">part of the self-energy in the small region around the origin. (NB: not yet</span>
<a name="5275"><font size=-1>5275     </font></a><span class="string">available, at present the quadrature is performed using a single direction in</span>
<a name="5276"><font size=-1>5276     </font></a><span class="string">q-space)</span>
<a name="5277"><font size=-1>5277     </font></a><span class="string"></span>
<a name="5278"><font size=-1>5278     </font></a><span class="string">When [[optdriver]] = 99, [[gw_nqlwl]] and **gw_qlwl** define the set of</span>
<a name="5279"><font size=-1>5279     </font></a><span class="string">directions in q-space along which the macroscopic dielectric function is</span>
<a name="5280"><font size=-1>5280     </font></a><span class="string">evaluated. By default the Bethe-Salpeter code calculates the macroscopic</span>
<a name="5281"><font size=-1>5281     </font></a><span class="string">dielectric function using six different directions in q-space (the three basis</span>
<a name="5282"><font size=-1>5282     </font></a><span class="string">vectors of the reciprocal lattice and the three Cartesian axis).</span>
<a name="5283"><font size=-1>5283     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5284"><font size=-1>5284     </font></a><span class="default">),</span>
<a name="5285"><font size=-1>5285     </font></a><span class="default"></span>
<a name="5286"><font size=-1>5286     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5287"><font size=-1>5287     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_nstep&quot;</span><span class="default">,</span>
<a name="5288"><font size=-1>5288     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5289"><font size=-1>5289     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5290"><font size=-1>5290     </font></a><span class="default">    topics=[</span><span class="string">'GW_basic'</span><span class="default">],</span>
<a name="5291"><font size=-1>5291     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5292"><font size=-1>5292     </font></a><span class="default">    defaultval=</span><span class="number">30</span><span class="default">,</span>
<a name="5293"><font size=-1>5293     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW Number of self-consistent STEPs&quot;</span><span class="default">,</span>
<a name="5294"><font size=-1>5294     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 8&quot;</span><span class="default">,</span>
<a name="5295"><font size=-1>5295     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5296"><font size=-1>5296     </font></a><span class="string">Gives the maximum number of self-consistent GW cycles (or &quot;iterations&quot;). in</span>
<a name="5297"><font size=-1>5297     </font></a><span class="string">which G and/or W will be updated until the quasi-particle energies are</span>
<a name="5298"><font size=-1>5298     </font></a><span class="string">converged within [[gw_toldfeig]]. [[gwcalctyp]] and [[gw_sctype]] are used to</span>
<a name="5299"><font size=-1>5299     </font></a><span class="string">define the type of self-consistency.</span>
<a name="5300"><font size=-1>5300     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5301"><font size=-1>5301     </font></a><span class="default">),</span>
<a name="5302"><font size=-1>5302     </font></a><span class="default"></span>
<a name="5303"><font size=-1>5303     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5304"><font size=-1>5304     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_qlwl&quot;</span><span class="default">,</span>
<a name="5305"><font size=-1>5305     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5306"><font size=-1>5306     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5307"><font size=-1>5307     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">, </span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="5308"><font size=-1>5308     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[gw_nqlwl]]'</span><span class="default">],</span>
<a name="5309"><font size=-1>5309     </font></a><span class="default">    defaultval=[</span><span class="number">1e-05</span><span class="default">, </span><span class="number">2e-05</span><span class="default">, </span><span class="number">3e-05</span><span class="default">],</span>
<a name="5310"><font size=-1>5310     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW, Q-points for the Long Wave-Length limit&quot;</span><span class="default">,</span>
<a name="5311"><font size=-1>5311     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4,99]&quot;</span><span class="default">,</span>
<a name="5312"><font size=-1>5312     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5313"><font size=-1>5313     </font></a><span class="string">When [[optdriver]] = 3, [[gw_qlwl]] defines the set of q-points around Gamma</span>
<a name="5314"><font size=-1>5314     </font></a><span class="string">that are considered during the evaluation of the non-analytical behaviour of</span>
<a name="5315"><font size=-1>5315     </font></a><span class="string">the dielectric matrix. Optical spectra (with and without non-local field</span>
<a name="5316"><font size=-1>5316     </font></a><span class="string">effects) are evaluated for each direction specified by [[gw_qlwl]].</span>
<a name="5317"><font size=-1>5317     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5318"><font size=-1>5318     </font></a><span class="default">),</span>
<a name="5319"><font size=-1>5319     </font></a><span class="default"></span>
<a name="5320"><font size=-1>5320     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5321"><font size=-1>5321     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_qprange&quot;</span><span class="default">,</span>
<a name="5322"><font size=-1>5322     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5323"><font size=-1>5323     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5324"><font size=-1>5324     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="5325"><font size=-1>5325     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5326"><font size=-1>5326     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5327"><font size=-1>5327     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW QuasiParticle RANGE policy&quot;</span><span class="default">,</span>
<a name="5328"><font size=-1>5328     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="5329"><font size=-1>5329     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5330"><font size=-1>5330     </font></a><span class="string">[[gw_qprange]] is active only when [[nkptgw]] is equal to zero (default</span>
<a name="5331"><font size=-1>5331     </font></a><span class="string">value). This variable simplifies the specification of the list of kpoints and</span>
<a name="5332"><font size=-1>5332     </font></a><span class="string">of the bands to be used for the computation of the quasi-particle corrections.</span>
<a name="5333"><font size=-1>5333     </font></a><span class="string">The possible values are:</span>
<a name="5334"><font size=-1>5334     </font></a><span class="string"></span>
<a name="5335"><font size=-1>5335     </font></a><span class="string">  * 0 --&gt; Compute the QP corrections only for the fundamental and the optical gap</span>
<a name="5336"><font size=-1>5336     </font></a><span class="string">  * +num --&gt; Compute the QP corrections for all the k-points in the irreducible zone,</span>
<a name="5337"><font size=-1>5337     </font></a><span class="string">     and include `num` bands above and below the Fermi level.</span>
<a name="5338"><font size=-1>5338     </font></a><span class="string">  * -num --&gt; Compute the QP corrections for all the k-points in the irreducible zone.</span>
<a name="5339"><font size=-1>5339     </font></a><span class="string">     Include all occupied states and `num` empty states.</span>
<a name="5340"><font size=-1>5340     </font></a><span class="string"></span>
<a name="5341"><font size=-1>5341     </font></a><span class="string">The default value is 0 and is very handy for one-shot calculations. It is</span>
<a name="5342"><font size=-1>5342     </font></a><span class="string">important to stress, however, that the position of the optical/fundamental</span>
<a name="5343"><font size=-1>5343     </font></a><span class="string">gaps is deduced from the energies computed on the k-mesh used for the WFK</span>
<a name="5344"><font size=-1>5344     </font></a><span class="string">file. Therefore the computed gaps might differ from the correct ones that can</span>
<a name="5345"><font size=-1>5345     </font></a><span class="string">only be obtained with an appropriate sampling of the irreducible zone.</span>
<a name="5346"><font size=-1>5346     </font></a><span class="string">Positive values are useful if we do not know the position of the GW HOMO, LOMO</span>
<a name="5347"><font size=-1>5347     </font></a><span class="string">and we want to investigate the effect of the GW corrections on the states</span>
<a name="5348"><font size=-1>5348     </font></a><span class="string">close to the gap Negative values are usually used for self-consistent</span>
<a name="5349"><font size=-1>5349     </font></a><span class="string">calculations Note that, in the case of self-consistency or [[symsigma]] == 1, the</span>
<a name="5350"><font size=-1>5350     </font></a><span class="string">code might change the bands range so that all the degenerate states are</span>
<a name="5351"><font size=-1>5351     </font></a><span class="string">included. Note also that [[kptgw]], and [[bdgw]] are ignored when this options</span>
<a name="5352"><font size=-1>5352     </font></a><span class="string">is used. If you want to select manually the list of k-points and bands, you</span>
<a name="5353"><font size=-1>5353     </font></a><span class="string">have to provide the three variables [[nkptgw]], [[kptgw]], and [[bdgw]].</span>
<a name="5354"><font size=-1>5354     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5355"><font size=-1>5355     </font></a><span class="default">),</span>
<a name="5356"><font size=-1>5356     </font></a><span class="default"></span>
<a name="5357"><font size=-1>5357     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5358"><font size=-1>5358     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_sctype&quot;</span><span class="default">,</span>
<a name="5359"><font size=-1>5359     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5360"><font size=-1>5360     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5361"><font size=-1>5361     </font></a><span class="default">    topics=[</span><span class="string">'GW_basic'</span><span class="default">],</span>
<a name="5362"><font size=-1>5362     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5363"><font size=-1>5363     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="5364"><font size=-1>5364     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW, Self-Consistency TYPE&quot;</span><span class="default">,</span>
<a name="5365"><font size=-1>5365     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="5366"><font size=-1>5366     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5367"><font size=-1>5367     </font></a><span class="string">This variable is used to partially define the kind of self-consistency for GW</span>
<a name="5368"><font size=-1>5368     </font></a><span class="string">calculations. The other piece of information is given by [[gwcalctyp]] that</span>
<a name="5369"><font size=-1>5369     </font></a><span class="string">defines the particular approximation for the self-energy operator as well as</span>
<a name="5370"><font size=-1>5370     </font></a><span class="string">whether the wavefunctions have to replaced by quasi-particle amplitudes.</span>
<a name="5371"><font size=-1>5371     </font></a><span class="string"></span>
<a name="5372"><font size=-1>5372     </font></a><span class="string">If [[gw_sctype]] is specified in the input file, the code will perform an</span>
<a name="5373"><font size=-1>5373     </font></a><span class="string">iterative update of the quantities entering the GW equations until the quasi-</span>
<a name="5374"><font size=-1>5374     </font></a><span class="string">particle energies are converged within [[gw_toldfeig]]. The maximum number of</span>
<a name="5375"><font size=-1>5375     </font></a><span class="string">iterations is specified by [[gw_nstep]]. Possible values are:</span>
<a name="5376"><font size=-1>5376     </font></a><span class="string"></span>
<a name="5377"><font size=-1>5377     </font></a><span class="string">  * 1 --&gt; standard one-shot method (one screening calculation followed by a single sigma run)</span>
<a name="5378"><font size=-1>5378     </font></a><span class="string">  * 2 --&gt; self-consistency only on W (iterative update of W followed by a sigma run in which G is approximated with the Kohn-Sham independent-particle Green's function G0)</span>
<a name="5379"><font size=-1>5379     </font></a><span class="string">  * 3 --&gt; self-consistency only of G (a single screening calculation to obtain the Kohn-Sham polarizability followed by an iterative update of the Green's functions in the self-energy)</span>
<a name="5380"><font size=-1>5380     </font></a><span class="string">  * 4 --&gt; fully self-consistent algorithm (iterative update of both G and W)</span>
<a name="5381"><font size=-1>5381     </font></a><span class="string"></span>
<a name="5382"><font size=-1>5382     </font></a><span class="string">It is possible to initialize the self-consistent procedure by reading a</span>
<a name="5383"><font size=-1>5383     </font></a><span class="string">previously calculated SCR or SUSC file via the variables [[getscr]] or</span>
<a name="5384"><font size=-1>5384     </font></a><span class="string">[[getsuscep]], respectively. [[getqps]] can be used to read a previous QPS</span>
<a name="5385"><font size=-1>5385     </font></a><span class="string">file thus initializing the Green functions to be used in the first self-</span>
<a name="5386"><font size=-1>5386     </font></a><span class="string">consistent iteration.</span>
<a name="5387"><font size=-1>5387     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5388"><font size=-1>5388     </font></a><span class="default">),</span>
<a name="5389"><font size=-1>5389     </font></a><span class="default"></span>
<a name="5390"><font size=-1>5390     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5391"><font size=-1>5391     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_sigxcore&quot;</span><span class="default">,</span>
<a name="5392"><font size=-1>5392     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5393"><font size=-1>5393     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5394"><font size=-1>5394     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="5395"><font size=-1>5395     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5396"><font size=-1>5396     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5397"><font size=-1>5397     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW, SIGma (self-energy) for the CORE contribution&quot;</span><span class="default">,</span>
<a name="5398"><font size=-1>5398     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4 and [[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="5399"><font size=-1>5399     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5400"><font size=-1>5400     </font></a><span class="string">Only available for PAW and relevant if [[optdriver]] = 4 that is, sigma</span>
<a name="5401"><font size=-1>5401     </font></a><span class="string">calculations.</span>
<a name="5402"><font size=-1>5402     </font></a><span class="string"></span>
<a name="5403"><font size=-1>5403     </font></a><span class="string">Theoretical introduction: GW calculations performed on top of electronic</span>
<a name="5404"><font size=-1>5404     </font></a><span class="string">calculations relying when the frozen-core approximation is used to separate</span>
<a name="5405"><font size=-1>5405     </font></a><span class="string">inner-core electrons from valence electrons, only the contribution to the</span>
<a name="5406"><font size=-1>5406     </font></a><span class="string">self-energy arising from valence electrons is explicitly accounted for. In the</span>
<a name="5407"><font size=-1>5407     </font></a><span class="string">standard approach based on pseudopotentials the contribution to the self-</span>
<a name="5408"><font size=-1>5408     </font></a><span class="string">energy due to core electrons is approximated by means of the KS exchange-</span>
<a name="5409"><font size=-1>5409     </font></a><span class="string">correlation potential generated by the core density. In the case of GW</span>
<a name="5410"><font size=-1>5410     </font></a><span class="string">calculations employing the PAW method, the core contribution to the self-</span>
<a name="5411"><font size=-1>5411     </font></a><span class="string">energy can be more accurately estimated in terms of the Fock operator</span>
<a name="5412"><font size=-1>5412     </font></a><span class="string">generated by the core wavefunctions. In the simplest approach, the only</span>
<a name="5413"><font size=-1>5413     </font></a><span class="string">ingredients required for this more refined treatment are the wave functions of</span>
<a name="5414"><font size=-1>5414     </font></a><span class="string">the core electrons in the reference atomic configuration that are calculated</span>
<a name="5415"><font size=-1>5415     </font></a><span class="string">during the generation of the PAW setup. This is a good approximation provided</span>
<a name="5416"><font size=-1>5416     </font></a><span class="string">that the core wave functions are strictly localized inside the PAW spheres.</span>
<a name="5417"><font size=-1>5417     </font></a><span class="string"></span>
<a name="5418"><font size=-1>5418     </font></a><span class="string">[[gw_sigxcore]] defines the approximation used to evaluate the core</span>
<a name="5419"><font size=-1>5419     </font></a><span class="string">contribution to sigma.</span>
<a name="5420"><font size=-1>5420     </font></a><span class="string"></span>
<a name="5421"><font size=-1>5421     </font></a><span class="string">  * [[gw_sigxcore]] = 0, standard approach, the core contribution is approximated with vxc.</span>
<a name="5422"><font size=-1>5422     </font></a><span class="string">  * [[gw_sigxcore]] = 1, the core term is approximated with the Fock operator inside the PAW spheres.</span>
<a name="5423"><font size=-1>5423     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5424"><font size=-1>5424     </font></a><span class="default">),</span>
<a name="5425"><font size=-1>5425     </font></a><span class="default"></span>
<a name="5426"><font size=-1>5426     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5427"><font size=-1>5427     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gw_toldfeig&quot;</span><span class="default">,</span>
<a name="5428"><font size=-1>5428     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5429"><font size=-1>5429     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5430"><font size=-1>5430     </font></a><span class="default">    topics=[</span><span class="string">'GW_basic'</span><span class="default">],</span>
<a name="5431"><font size=-1>5431     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5432"><font size=-1>5432     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'eV'</span><span class="default">, value=</span><span class="number">0.1</span><span class="default">),</span>
<a name="5433"><font size=-1>5433     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW TOLerance on the DiFference of the EIGenvalues&quot;</span><span class="default">,</span>
<a name="5434"><font size=-1>5434     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="5435"><font size=-1>5435     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 8&quot;</span><span class="default">,</span>
<a name="5436"><font size=-1>5436     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5437"><font size=-1>5437     </font></a><span class="string">Sets a tolerance for absolute differences of QP energies that will cause one</span>
<a name="5438"><font size=-1>5438     </font></a><span class="string">self-consistent GW cycle to stop.</span>
<a name="5439"><font size=-1>5439     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since **toldfe** has</span>
<a name="5440"><font size=-1>5440     </font></a><span class="string">the '[[ENERGY]]' characteristics (1 Ha=27.2113845 eV)</span>
<a name="5441"><font size=-1>5441     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5442"><font size=-1>5442     </font></a><span class="default">),</span>
<a name="5443"><font size=-1>5443     </font></a><span class="default"></span>
<a name="5444"><font size=-1>5444     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5445"><font size=-1>5445     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwcalctyp&quot;</span><span class="default">,</span>
<a name="5446"><font size=-1>5446     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5447"><font size=-1>5447     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5448"><font size=-1>5448     </font></a><span class="default">    topics=[</span><span class="string">'GW_basic'</span><span class="default">, </span><span class="string">'SelfEnergy_basic'</span><span class="default">, </span><span class="string">'RPACorrEn_compulsory'</span><span class="default">],</span>
<a name="5449"><font size=-1>5449     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5450"><font size=-1>5450     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5451"><font size=-1>5451     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW CALCulation TYPe&quot;</span><span class="default">,</span>
<a name="5452"><font size=-1>5452     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="5453"><font size=-1>5453     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5454"><font size=-1>5454     </font></a><span class="string">[[gwcalctyp]] governs the choice between the different capabilities of the GW</span>
<a name="5455"><font size=-1>5455     </font></a><span class="string">code.</span>
<a name="5456"><font size=-1>5456     </font></a><span class="string"></span>
<a name="5457"><font size=-1>5457     </font></a><span class="string">  * 0 &lt;= [[gwcalctyp]] &lt;= 9: standard &quot;1 shot&quot; quasiparticle method.</span>
<a name="5458"><font size=-1>5458     </font></a><span class="string">  * 10 &lt;= [[gwcalctyp]] &lt;= 19: self-consistent quasiparticle method on energies only.</span>
<a name="5459"><font size=-1>5459     </font></a><span class="string">  * 20 &lt;= [[gwcalctyp]] &lt;= 29: self-consistent quasiparticle method on energies and wavefunctions.</span>
<a name="5460"><font size=-1>5460     </font></a><span class="string"></span>
<a name="5461"><font size=-1>5461     </font></a><span class="string">  * [[gwcalctyp]] = 0, 10, or 20: standard Plasmon-Pole model GW calculation.</span>
<a name="5462"><font size=-1>5462     </font></a><span class="string">  * [[gwcalctyp]] = 1: GW calculation where the self-energy along the real axis is obtained by performing the analytic continuation from the imaginary axis to the full complex plane via the Pade approximant. Only available for standard &quot;1 shot&quot; quasiparticle method.</span>
<a name="5463"><font size=-1>5463     </font></a><span class="string">  * [[gwcalctyp]] = 2, 12, or 22: GW calculation using numerical integration (contour deformation method, see e.g. [[cite:Lebegue2003]]).</span>
<a name="5464"><font size=-1>5464     </font></a><span class="string">  * [[gwcalctyp]] = 5, 15, or 25: Hybrid functional or Hartree-Fock calculation, with the identifier of the functional given by [[ixc_sigma]]. See the latter for the definition of other related variables.</span>
<a name="5465"><font size=-1>5465     </font></a><span class="string">  * [[gwcalctyp]] = 6, 16, or 26: Screened Exchange calculation.</span>
<a name="5466"><font size=-1>5466     </font></a><span class="string">  * [[gwcalctyp]] = 7, 17, or 27: COHSEX calculation.</span>
<a name="5467"><font size=-1>5467     </font></a><span class="string">  * [[gwcalctyp]] = 8, 18, or 28: model GW calculation following [[cite:Faleev2004]] using a Plasmon-Pole model.</span>
<a name="5468"><font size=-1>5468     </font></a><span class="string">  * [[gwcalctyp]] = 9, 19, or 29: model GW calculation following [[cite:Faleev2004]] using numerical integration (contour deformation method).</span>
<a name="5469"><font size=-1>5469     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5470"><font size=-1>5470     </font></a><span class="default">),</span>
<a name="5471"><font size=-1>5471     </font></a><span class="default"></span>
<a name="5472"><font size=-1>5472     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5473"><font size=-1>5473     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwcomp&quot;</span><span class="default">,</span>
<a name="5474"><font size=-1>5474     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5475"><font size=-1>5475     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5476"><font size=-1>5476     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="5477"><font size=-1>5477     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5478"><font size=-1>5478     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5479"><font size=-1>5479     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW COMPleteness&quot;</span><span class="default">,</span>
<a name="5480"><font size=-1>5480     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="5481"><font size=-1>5481     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5482"><font size=-1>5482     </font></a><span class="string">[[gwcomp]] governs the use of an extrapolar approximation. If [[gwcomp]] == 1,</span>
<a name="5483"><font size=-1>5483     </font></a><span class="string">one improves the completeness in a truncated sum over states. In practice,</span>
<a name="5484"><font size=-1>5484     </font></a><span class="string">this permits one to reduce quite much the number of bands required in the</span>
<a name="5485"><font size=-1>5485     </font></a><span class="string">calculation of the screening or of the self-energy. The energy parameter</span>
<a name="5486"><font size=-1>5486     </font></a><span class="string">needed in the extrapolar approximation is set by [[gwencomp]]. See</span>
<a name="5487"><font size=-1>5487     </font></a><span class="string">[[cite:Bruneval2008]] for a description of the methodology.</span>
<a name="5488"><font size=-1>5488     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5489"><font size=-1>5489     </font></a><span class="default">),</span>
<a name="5490"><font size=-1>5490     </font></a><span class="default"></span>
<a name="5491"><font size=-1>5491     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5492"><font size=-1>5492     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwencomp&quot;</span><span class="default">,</span>
<a name="5493"><font size=-1>5493     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5494"><font size=-1>5494     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5495"><font size=-1>5495     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_useful'</span><span class="default">, </span><span class="string">'Susceptibility_useful'</span><span class="default">],</span>
<a name="5496"><font size=-1>5496     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5497"><font size=-1>5497     </font></a><span class="default">    defaultval=</span><span class="number">2.0</span><span class="default">,</span>
<a name="5498"><font size=-1>5498     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW ENergy for COMPleteness&quot;</span><span class="default">,</span>
<a name="5499"><font size=-1>5499     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4] and [[gwcomp]] == 1&quot;</span><span class="default">,</span>
<a name="5500"><font size=-1>5500     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5501"><font size=-1>5501     </font></a><span class="string">[[gwencomp]] sets the energy parameter used in the extrapolar approximation</span>
<a name="5502"><font size=-1>5502     </font></a><span class="string">used to improve completeness and make the convergence against the number of</span>
<a name="5503"><font size=-1>5503     </font></a><span class="string">bands much faster.</span>
<a name="5504"><font size=-1>5504     </font></a><span class="string"></span>
<a name="5505"><font size=-1>5505     </font></a><span class="string">See [[cite:Bruneval2008]] for a description of the methodology.</span>
<a name="5506"><font size=-1>5506     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5507"><font size=-1>5507     </font></a><span class="default">),</span>
<a name="5508"><font size=-1>5508     </font></a><span class="default"></span>
<a name="5509"><font size=-1>5509     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5510"><font size=-1>5510     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwgamma&quot;</span><span class="default">,</span>
<a name="5511"><font size=-1>5511     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5512"><font size=-1>5512     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5513"><font size=-1>5513     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="5514"><font size=-1>5514     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5515"><font size=-1>5515     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5516"><font size=-1>5516     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW GAMMA&quot;</span><span class="default">,</span>
<a name="5517"><font size=-1>5517     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] = 3 or 4 (Sigma calculations)&quot;</span><span class="default">,</span>
<a name="5518"><font size=-1>5518     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5519"><font size=-1>5519     </font></a><span class="string">If [[gwgamma]] is 1, the vertex correction will be included leading to what is</span>
<a name="5520"><font size=-1>5520     </font></a><span class="string">known as &quot;GW-Gamma&quot; approximation. see R. Del Sole, L. Reining, and R. W.</span>
<a name="5521"><font size=-1>5521     </font></a><span class="string">Godby, Phys. Rev. B 49, 8024 (1994). Note that, in order to include the vertex</span>
<a name="5522"><font size=-1>5522     </font></a><span class="string">correction in W, one has to start the sigma calculation from the</span>
<a name="5523"><font size=-1>5523     </font></a><span class="string">susceptibility file_SUSC instead of the _SCR file (see [[getsuscep]]   and</span>
<a name="5524"><font size=-1>5524     </font></a><span class="string">[[irdsuscep]]  ) Not available for PAW calculations.</span>
<a name="5525"><font size=-1>5525     </font></a><span class="string"></span>
<a name="5526"><font size=-1>5526     </font></a><span class="string">[[gwgamma]] = -4 activates the bootstrap kernel of Sharma et al. [[cite:Sharma2011]]</span>
<a name="5527"><font size=-1>5527     </font></a><span class="string">in the test-charge-test-charge dielectric function [[cite:Chen2015]].</span>
<a name="5528"><font size=-1>5528     </font></a><span class="string"></span>
<a name="5529"><font size=-1>5529     </font></a><span class="string">[[gwgamma]] = -6 uses the same bootstrap kernel as with [[gwgamma]] = -4</span>
<a name="5530"><font size=-1>5530     </font></a><span class="string">but with only the head of the kernel. As such, the self-consistent iteration in the kernel</span>
<a name="5531"><font size=-1>5531     </font></a><span class="string">can be disregarded [[cite:Chen2016]].</span>
<a name="5532"><font size=-1>5532     </font></a><span class="string"></span>
<a name="5533"><font size=-1>5533     </font></a><span class="string">[[gwgamma]] = -8 activates the RPA bootstrap-like kernel (one-shot) (see [[cite:Berger2015]]</span>
<a name="5534"><font size=-1>5534     </font></a><span class="string">and [[cite:Rigamonti2015]]).</span>
<a name="5535"><font size=-1>5535     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5536"><font size=-1>5536     </font></a><span class="default">),</span>
<a name="5537"><font size=-1>5537     </font></a><span class="default"></span>
<a name="5538"><font size=-1>5538     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5539"><font size=-1>5539     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_band_index&quot;</span><span class="default">,</span>
<a name="5540"><font size=-1>5540     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5541"><font size=-1>5541     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5542"><font size=-1>5542     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5543"><font size=-1>5543     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5544"><font size=-1>5544     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="5545"><font size=-1>5545     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS BAND INDEX&quot;</span><span class="default">,</span>
<a name="5546"><font size=-1>5546     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5547"><font size=-1>5547     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5548"><font size=-1>5548     </font></a><span class="string">Governs the DFT eigenstate $|e\\rangle$ in which the self-energy will be evaluated, as</span>
<a name="5549"><font size=-1>5549     </font></a><span class="string">shown in Eq. (7) of [[cite:Laflamme2015]]. That is, it is the state</span>
<a name="5550"><font size=-1>5550     </font></a><span class="string">to be corrected in the G0W0 scheme.</span>
<a name="5551"><font size=-1>5551     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5552"><font size=-1>5552     </font></a><span class="default">),</span>
<a name="5553"><font size=-1>5553     </font></a><span class="default"></span>
<a name="5554"><font size=-1>5554     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5555"><font size=-1>5555     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_correlation&quot;</span><span class="default">,</span>
<a name="5556"><font size=-1>5556     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5557"><font size=-1>5557     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5558"><font size=-1>5558     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5559"><font size=-1>5559     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5560"><font size=-1>5560     </font></a><span class="default">    defaultval=</span><span class="number">3</span><span class="default">,</span>
<a name="5561"><font size=-1>5561     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS CORRELATION&quot;</span><span class="default">,</span>
<a name="5562"><font size=-1>5562     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5563"><font size=-1>5563     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5564"><font size=-1>5564     </font></a><span class="string">Governs the use of a dielectric model (as explained in Sec. V of</span>
<a name="5565"><font size=-1>5565     </font></a><span class="string">[[cite:Laflamme2015]] and the use of the Lanczos scheme to solve Eqs. (30) and</span>
<a name="5566"><font size=-1>5566     </font></a><span class="string">(35) of the same reference at all external [[gw_freqsp]] and integration (as</span>
<a name="5567"><font size=-1>5567     </font></a><span class="string">generated from [[gwls_npt_gauss_quad]]) frequencies. The different choices</span>
<a name="5568"><font size=-1>5568     </font></a><span class="string">are:</span>
<a name="5569"><font size=-1>5569     </font></a><span class="string"></span>
<a name="5570"><font size=-1>5570     </font></a><span class="string">  * [[gwls_correlation]] == 1: GWLS calculation **with** the dielectric model and **without** the shift Lanczos technique,</span>
<a name="5571"><font size=-1>5571     </font></a><span class="string">  * [[gwls_correlation]] == 2: GWLS calculation **without** the dielectric model and **without** the shift Lanczos technique,</span>
<a name="5572"><font size=-1>5572     </font></a><span class="string">  * [[gwls_correlation]] == 3: GWLS calculation **with** the dielectric model and **with** the shift Lanczos technique,</span>
<a name="5573"><font size=-1>5573     </font></a><span class="string">  * [[gwls_correlation]] == 4: GWLS calculation **without** the dielectric model and **with** the shift Lanczos technique,</span>
<a name="5574"><font size=-1>5574     </font></a><span class="string">  * [[gwls_correlation]] == 5: Not a GWLS calculation; just calculate and print the eigenvalues of the (static) dielectric matrix (for debugging purposes).</span>
<a name="5575"><font size=-1>5575     </font></a><span class="string"></span>
<a name="5576"><font size=-1>5576     </font></a><span class="string">The default, ([[gwls_correlation]] == 3), is the most performant option and</span>
<a name="5577"><font size=-1>5577     </font></a><span class="string">should be kept by the user. Option 1, 2 and 5 are deprecated and will be</span>
<a name="5578"><font size=-1>5578     </font></a><span class="string">removed.</span>
<a name="5579"><font size=-1>5579     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5580"><font size=-1>5580     </font></a><span class="default">),</span>
<a name="5581"><font size=-1>5581     </font></a><span class="default"></span>
<a name="5582"><font size=-1>5582     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5583"><font size=-1>5583     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_diel_model&quot;</span><span class="default">,</span>
<a name="5584"><font size=-1>5584     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5585"><font size=-1>5585     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5586"><font size=-1>5586     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5587"><font size=-1>5587     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5588"><font size=-1>5588     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="5589"><font size=-1>5589     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS dielectric model&quot;</span><span class="default">,</span>
<a name="5590"><font size=-1>5590     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5591"><font size=-1>5591     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5592"><font size=-1>5592     </font></a><span class="string">Not used yet.</span>
<a name="5593"><font size=-1>5593     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5594"><font size=-1>5594     </font></a><span class="default">),</span>
<a name="5595"><font size=-1>5595     </font></a><span class="default"></span>
<a name="5596"><font size=-1>5596     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5597"><font size=-1>5597     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_exchange&quot;</span><span class="default">,</span>
<a name="5598"><font size=-1>5598     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5599"><font size=-1>5599     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5600"><font size=-1>5600     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5601"><font size=-1>5601     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5602"><font size=-1>5602     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="5603"><font size=-1>5603     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS exact EXCHANGE&quot;</span><span class="default">,</span>
<a name="5604"><font size=-1>5604     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5605"><font size=-1>5605     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5606"><font size=-1>5606     </font></a><span class="string">Governs whether the exact exchange for the state to be corrected</span>
<a name="5607"><font size=-1>5607     </font></a><span class="string">([[gwls_band_index]]) is calculated ([[gwls_exchange]] == 1) or not</span>
<a name="5608"><font size=-1>5608     </font></a><span class="string">([[gwls_exchange]] = =0).</span>
<a name="5609"><font size=-1>5609     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5610"><font size=-1>5610     </font></a><span class="default">),</span>
<a name="5611"><font size=-1>5611     </font></a><span class="default"></span>
<a name="5612"><font size=-1>5612     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5613"><font size=-1>5613     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_first_seed&quot;</span><span class="default">,</span>
<a name="5614"><font size=-1>5614     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5615"><font size=-1>5615     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5616"><font size=-1>5616     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5617"><font size=-1>5617     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5618"><font size=-1>5618     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[gwls_band_index]]&quot;</span><span class="default">,</span>
<a name="5619"><font size=-1>5619     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS FIRST SEED vector&quot;</span><span class="default">,</span>
<a name="5620"><font size=-1>5620     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5621"><font size=-1>5621     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5622"><font size=-1>5622     </font></a><span class="string">This variable sets the band index to be used to generate the first seed vector</span>
<a name="5623"><font size=-1>5623     </font></a><span class="string">to be used in the construction of the Lanczos basis for the (static)</span>
<a name="5624"><font size=-1>5624     </font></a><span class="string">dielectric matrix in a GWLS calculation. See Sec. IV of [[cite:Laflamme2015]].</span>
<a name="5625"><font size=-1>5625     </font></a><span class="string">Together with [[gwls_nseeds]], this defines the seeds for the</span>
<a name="5626"><font size=-1>5626     </font></a><span class="string">Lanczos procedure. That is, the states associated to band index</span>
<a name="5627"><font size=-1>5627     </font></a><span class="string">[[gwls_first_seed]] to [[gwls_first_seed]]+[[gwls_nseeds]]-1 are used to</span>
<a name="5628"><font size=-1>5628     </font></a><span class="string">generate the seed vectors.</span>
<a name="5629"><font size=-1>5629     </font></a><span class="string"></span>
<a name="5630"><font size=-1>5630     </font></a><span class="string">The default [[gwls_first_seed]] == [[gwls_band_index]] and [[gwls_nseeds]] == 1</span>
<a name="5631"><font size=-1>5631     </font></a><span class="string">has been thoroughly tested and seems to be the most performant. Users should</span>
<a name="5632"><font size=-1>5632     </font></a><span class="string">therefore keep the default value.</span>
<a name="5633"><font size=-1>5633     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5634"><font size=-1>5634     </font></a><span class="default">),</span>
<a name="5635"><font size=-1>5635     </font></a><span class="default"></span>
<a name="5636"><font size=-1>5636     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5637"><font size=-1>5637     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_kmax_analytic&quot;</span><span class="default">,</span>
<a name="5638"><font size=-1>5638     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5639"><font size=-1>5639     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5640"><font size=-1>5640     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5641"><font size=-1>5641     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5642"><font size=-1>5642     </font></a><span class="default">    defaultval=</span><span class="number">8</span><span class="default">,</span>
<a name="5643"><font size=-1>5643     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS KMAX for the ANALYTIC term&quot;</span><span class="default">,</span>
<a name="5644"><font size=-1>5644     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5645"><font size=-1>5645     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5646"><font size=-1>5646     </font></a><span class="string">Governs the number of iterations to be done in the shift Lanczos solution of</span>
<a name="5647"><font size=-1>5647     </font></a><span class="string">Eq. (35) of [[cite:Laflamme2015]] to solve it at all external</span>
<a name="5648"><font size=-1>5648     </font></a><span class="string">frequencies requested by the user ([[gw_freqsp]]). The default value is</span>
<a name="5649"><font size=-1>5649     </font></a><span class="string">converged to a few 10s of meV for all molecules studied so far.</span>
<a name="5650"><font size=-1>5650     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5651"><font size=-1>5651     </font></a><span class="default">),</span>
<a name="5652"><font size=-1>5652     </font></a><span class="default"></span>
<a name="5653"><font size=-1>5653     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5654"><font size=-1>5654     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_kmax_complement&quot;</span><span class="default">,</span>
<a name="5655"><font size=-1>5655     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5656"><font size=-1>5656     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5657"><font size=-1>5657     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5658"><font size=-1>5658     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5659"><font size=-1>5659     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="5660"><font size=-1>5660     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS KMAX for the COMPLEMENT space.&quot;</span><span class="default">,</span>
<a name="5661"><font size=-1>5661     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5662"><font size=-1>5662     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5663"><font size=-1>5663     </font></a><span class="string">The G0W0 formalism involves the calculation of a summation conceptually linked</span>
<a name="5664"><font size=-1>5664     </font></a><span class="string">to the trace of the dielectric matrix [see Eq. (38) of [[cite:Laflamme2015]]\].</span>
<a name="5665"><font size=-1>5665     </font></a><span class="string">Since the eigenvalues spectrum of the dielectric matrix of formed by a</span>
<a name="5666"><font size=-1>5666     </font></a><span class="string">few large discrete eigenvalues and an integrable divergence in the density of</span>
<a name="5667"><font size=-1>5667     </font></a><span class="string">eigenvalues around 0, it is expensive to sample accurately this divergence</span>
<a name="5668"><font size=-1>5668     </font></a><span class="string">using the exact dielectric operator. It this becomes interesting to calculate</span>
<a name="5669"><font size=-1>5669     </font></a><span class="string">the 'trace' of the 'exact - model' dielectric matrix in a small basis and add</span>
<a name="5670"><font size=-1>5670     </font></a><span class="string">it to the 'trace' of the 'model' dielectric matrix obtained in a large basis.</span>
<a name="5671"><font size=-1>5671     </font></a><span class="string">In the context where the model dielectric matrix is used in the calculations,</span>
<a name="5672"><font size=-1>5672     </font></a><span class="string">[[gwls_stern_kmax]] determines the size of the 'small' basis and</span>
<a name="5673"><font size=-1>5673     </font></a><span class="string">[[gwls_kmax_complement]] determines the size of the 'large' basis.</span>
<a name="5674"><font size=-1>5674     </font></a><span class="string"></span>
<a name="5675"><font size=-1>5675     </font></a><span class="string">For more information on the exact role of these bases and on the model</span>
<a name="5676"><font size=-1>5676     </font></a><span class="string">dielectric operator used, see Sec. V of [[cite:Laflamme2015]].</span>
<a name="5677"><font size=-1>5677     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5678"><font size=-1>5678     </font></a><span class="default">),</span>
<a name="5679"><font size=-1>5679     </font></a><span class="default"></span>
<a name="5680"><font size=-1>5680     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5681"><font size=-1>5681     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_kmax_numeric&quot;</span><span class="default">,</span>
<a name="5682"><font size=-1>5682     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5683"><font size=-1>5683     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5684"><font size=-1>5684     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5685"><font size=-1>5685     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5686"><font size=-1>5686     </font></a><span class="default">    defaultval=</span><span class="number">16</span><span class="default">,</span>
<a name="5687"><font size=-1>5687     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS KMAX for the NUMERIC term&quot;</span><span class="default">,</span>
<a name="5688"><font size=-1>5688     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5689"><font size=-1>5689     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5690"><font size=-1>5690     </font></a><span class="string">Governs the number of iterations to be done in the shift Lanczos solution of</span>
<a name="5691"><font size=-1>5691     </font></a><span class="string">Eq. (30) of [[cite:Laflamme2015]] to solve it simultaneously at all</span>
<a name="5692"><font size=-1>5692     </font></a><span class="string">integration frequencies (generated automatically by the number of points</span>
<a name="5693"><font size=-1>5693     </font></a><span class="string">[[gwls_npt_gauss_quad]] to use in the gaussian quadrature) and all external</span>
<a name="5694"><font size=-1>5694     </font></a><span class="string">frequencies requested by the user ([[gw_freqsp]]). The default value is</span>
<a name="5695"><font size=-1>5695     </font></a><span class="string">converged to a few 10s of meV for all molecules studied so far.</span>
<a name="5696"><font size=-1>5696     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5697"><font size=-1>5697     </font></a><span class="default">),</span>
<a name="5698"><font size=-1>5698     </font></a><span class="default"></span>
<a name="5699"><font size=-1>5699     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5700"><font size=-1>5700     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_kmax_poles&quot;</span><span class="default">,</span>
<a name="5701"><font size=-1>5701     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5702"><font size=-1>5702     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5703"><font size=-1>5703     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5704"><font size=-1>5704     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5705"><font size=-1>5705     </font></a><span class="default">    defaultval=</span><span class="number">4</span><span class="default">,</span>
<a name="5706"><font size=-1>5706     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS KMAX for the calculation of the POLES residue&quot;</span><span class="default">,</span>
<a name="5707"><font size=-1>5707     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5708"><font size=-1>5708     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5709"><font size=-1>5709     </font></a><span class="string">The contour deformation technique, in the G0W0 context, will involve the</span>
<a name="5710"><font size=-1>5710     </font></a><span class="string">calculation of pole residues associated to states lying between the one</span>
<a name="5711"><font size=-1>5711     </font></a><span class="string">corrected ([[gwls_band_index]]) and the Fermi level. These residues take the</span>
<a name="5712"><font size=-1>5712     </font></a><span class="string">form of a matrix element of the inverse dielectric matrix at a real frequency</span>
<a name="5713"><font size=-1>5713     </font></a><span class="string">[see Eq. (11) of [[cite:Laflamme2015]]\]. Therefore, the dielectric</span>
<a name="5714"><font size=-1>5714     </font></a><span class="string">matrix must be constructed in some basis at these frequencies and inverted to</span>
<a name="5715"><font size=-1>5715     </font></a><span class="string">calculate the matrix element. The present input variable sets the size of the</span>
<a name="5716"><font size=-1>5716     </font></a><span class="string">Lanczos basis to be constructed for this purpose. The default value has proven</span>
<a name="5717"><font size=-1>5717     </font></a><span class="string">to be very robust for many molecular systems and should therefore be left to</span>
<a name="5718"><font size=-1>5718     </font></a><span class="string">the default value by the user.</span>
<a name="5719"><font size=-1>5719     </font></a><span class="string"></span>
<a name="5720"><font size=-1>5720     </font></a><span class="string">For more information on the Lanczos basis constructed for the calculation of</span>
<a name="5721"><font size=-1>5721     </font></a><span class="string">the residues, see Sec. IV of [[cite:Laflamme2015]].</span>
<a name="5722"><font size=-1>5722     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5723"><font size=-1>5723     </font></a><span class="default">),</span>
<a name="5724"><font size=-1>5724     </font></a><span class="default"></span>
<a name="5725"><font size=-1>5725     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5726"><font size=-1>5726     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_list_proj_freq&quot;</span><span class="default">,</span>
<a name="5727"><font size=-1>5727     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5728"><font size=-1>5728     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5729"><font size=-1>5729     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5730"><font size=-1>5730     </font></a><span class="default">    dimensions=[</span><span class="string">'[[gwls_n_proj_freq]]'</span><span class="default">],</span>
<a name="5731"><font size=-1>5731     </font></a><span class="default">    defaultval=</span><span class="string">&quot;*0.0&quot;</span><span class="default">,</span>
<a name="5732"><font size=-1>5732     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS LIST of the PROJection FREQuencies&quot;</span><span class="default">,</span>
<a name="5733"><font size=-1>5733     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5734"><font size=-1>5734     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="5735"><font size=-1>5735     </font></a><span class="string">This variable sets the frequencies to be used to construct the basis in which</span>
<a name="5736"><font size=-1>5736     </font></a><span class="string">the Hamiltonian is projected to accelerate the solution of the Sternheimer</span>
<a name="5737"><font size=-1>5737     </font></a><span class="string">equations involved by the construction of the dielectric matrix at finite</span>
<a name="5738"><font size=-1>5738     </font></a><span class="string">frequencies. See Sec. VI of [[cite:Laflamme2015]]. For most cases,</span>
<a name="5739"><font size=-1>5739     </font></a><span class="string">since the frequencies $\infty$ and 0.0 (if [[gwls_recycle]] &gt; 0) are used at no</span>
<a name="5740"><font size=-1>5740     </font></a><span class="string">computational cost, [[gwls_n_proj_freq]] == 0 (which means no ADDITIONAL</span>
<a name="5741"><font size=-1>5741     </font></a><span class="string">frequency is to be used) is fine and no frequencies need to be picked up.</span>
<a name="5742"><font size=-1>5742     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5743"><font size=-1>5743     </font></a><span class="default">),</span>
<a name="5744"><font size=-1>5744     </font></a><span class="default"></span>
<a name="5745"><font size=-1>5745     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5746"><font size=-1>5746     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_model_parameter&quot;</span><span class="default">,</span>
<a name="5747"><font size=-1>5747     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5748"><font size=-1>5748     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5749"><font size=-1>5749     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5750"><font size=-1>5750     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5751"><font size=-1>5751     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="5752"><font size=-1>5752     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS MODEL PARAMETER&quot;</span><span class="default">,</span>
<a name="5753"><font size=-1>5753     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="5754"><font size=-1>5754     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5755"><font size=-1>5755     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="5756"><font size=-1>5756     </font></a><span class="string">This is the width of the lorentzian, in Ha, used to model the frequency</span>
<a name="5757"><font size=-1>5757     </font></a><span class="string">dependence of the dielectric matrix in the GWLS calculation [see Eqs. (12-16)</span>
<a name="5758"><font size=-1>5758     </font></a><span class="string">and (34) of [[cite:Laflamme2015]]\]. More</span>
<a name="5759"><font size=-1>5759     </font></a><span class="string">precisely, this parameter is the value of $\alpha$ used in Eq. (34). This model</span>
<a name="5760"><font size=-1>5760     </font></a><span class="string">is then used to separate the integration over frequencies into a 'model' part</span>
<a name="5761"><font size=-1>5761     </font></a><span class="string">[second term of Eq. (12)] and an 'exact - model' part [first term of Eq. (12)].</span>
<a name="5762"><font size=-1>5762     </font></a><span class="string">Since the 'model' part can be integrated analytically [see Eqs. (15), (16) and</span>
<a name="5763"><font size=-1>5763     </font></a><span class="string">(34)], only the 'exact - model' part needs to be integrated numerically.</span>
<a name="5764"><font size=-1>5764     </font></a><span class="string"></span>
<a name="5765"><font size=-1>5765     </font></a><span class="string">The only effect of this model is therefore to alleviate the numerical cost of</span>
<a name="5766"><font size=-1>5766     </font></a><span class="string">the integration over frequencies in the G0W0 calculation. The value of the</span>
<a name="5767"><font size=-1>5767     </font></a><span class="string">associated parameter has thus an impact on the convergence rate of the GWLS</span>
<a name="5768"><font size=-1>5768     </font></a><span class="string">calculation with respect to the number of frequencies of integration</span>
<a name="5769"><font size=-1>5769     </font></a><span class="string">([[gwls_npt_gauss_quad]]), but no impact on the converged result of the GWLS</span>
<a name="5770"><font size=-1>5770     </font></a><span class="string">calculation. Typically, the default ([[gwls_model_parameter]] == 1.0) is optimal.</span>
<a name="5771"><font size=-1>5771     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5772"><font size=-1>5772     </font></a><span class="default">),</span>
<a name="5773"><font size=-1>5773     </font></a><span class="default"></span>
<a name="5774"><font size=-1>5774     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5775"><font size=-1>5775     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_n_proj_freq&quot;</span><span class="default">,</span>
<a name="5776"><font size=-1>5776     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5777"><font size=-1>5777     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5778"><font size=-1>5778     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5779"><font size=-1>5779     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5780"><font size=-1>5780     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5781"><font size=-1>5781     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS Number of PROJection FREQuencies&quot;</span><span class="default">,</span>
<a name="5782"><font size=-1>5782     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5783"><font size=-1>5783     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="5784"><font size=-1>5784     </font></a><span class="string">This variable sets the number of frequencies, on top of $\infty$ and 0.0 (if</span>
<a name="5785"><font size=-1>5785     </font></a><span class="string">[[gwls_recycle]] &gt; 0), to be used for the construction of the basis in which</span>
<a name="5786"><font size=-1>5786     </font></a><span class="string">the Hamiltonian is projected to accelerate the solution of the Sternheimer</span>
<a name="5787"><font size=-1>5787     </font></a><span class="string">equations involved in the construction of the dielectric matrix at finite</span>
<a name="5788"><font size=-1>5788     </font></a><span class="string">frequencies. See Sec. VI of [[cite:Laflamme2015]]. For most cases,</span>
<a name="5789"><font size=-1>5789     </font></a><span class="string">the default ([[gwls_n_proj_freq]] == 0) is fine.</span>
<a name="5790"><font size=-1>5790     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5791"><font size=-1>5791     </font></a><span class="default">),</span>
<a name="5792"><font size=-1>5792     </font></a><span class="default"></span>
<a name="5793"><font size=-1>5793     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5794"><font size=-1>5794     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_npt_gauss_quad&quot;</span><span class="default">,</span>
<a name="5795"><font size=-1>5795     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5796"><font size=-1>5796     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5797"><font size=-1>5797     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5798"><font size=-1>5798     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5799"><font size=-1>5799     </font></a><span class="default">    defaultval=</span><span class="number">10</span><span class="default">,</span>
<a name="5800"><font size=-1>5800     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS Number of PoinTs to use for the GAUSSian QUADrature&quot;</span><span class="default">,</span>
<a name="5801"><font size=-1>5801     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5802"><font size=-1>5802     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5803"><font size=-1>5803     </font></a><span class="string">This variable defines the number of points used for the numerical integration</span>
<a name="5804"><font size=-1>5804     </font></a><span class="string">of the self-energy over frequencies in GWLS computations [see Eq. (12) of</span>
<a name="5805"><font size=-1>5805     </font></a><span class="string">[[cite:Laflamme2015]]\]. The default is fine for most cases.</span>
<a name="5806"><font size=-1>5806     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5807"><font size=-1>5807     </font></a><span class="default">),</span>
<a name="5808"><font size=-1>5808     </font></a><span class="default"></span>
<a name="5809"><font size=-1>5809     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5810"><font size=-1>5810     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_nseeds&quot;</span><span class="default">,</span>
<a name="5811"><font size=-1>5811     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5812"><font size=-1>5812     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5813"><font size=-1>5813     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5814"><font size=-1>5814     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5815"><font size=-1>5815     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="5816"><font size=-1>5816     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS Number of SEED vectorS&quot;</span><span class="default">,</span>
<a name="5817"><font size=-1>5817     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5818"><font size=-1>5818     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5819"><font size=-1>5819     </font></a><span class="string">This variable sets the number of seed vectors to be used in the construction</span>
<a name="5820"><font size=-1>5820     </font></a><span class="string">of the Lanczos basis for the (static) dielectric matrix in a GWLS calculation.</span>
<a name="5821"><font size=-1>5821     </font></a><span class="string">See Sec. IV of [[cite:Laflamme2015]]. Only [[gwls_nseeds]] == 1 has</span>
<a name="5822"><font size=-1>5822     </font></a><span class="string">been tested for now and users should keep this value.</span>
<a name="5823"><font size=-1>5823     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5824"><font size=-1>5824     </font></a><span class="default">),</span>
<a name="5825"><font size=-1>5825     </font></a><span class="default"></span>
<a name="5826"><font size=-1>5826     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5827"><font size=-1>5827     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_print_debug&quot;</span><span class="default">,</span>
<a name="5828"><font size=-1>5828     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5829"><font size=-1>5829     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5830"><font size=-1>5830     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5831"><font size=-1>5831     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5832"><font size=-1>5832     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5833"><font size=-1>5833     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS PRINT level for DEBUGging&quot;</span><span class="default">,</span>
<a name="5834"><font size=-1>5834     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5835"><font size=-1>5835     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5836"><font size=-1>5836     </font></a><span class="string">Influences the level of verbosity for debugging purposes in a GWLS</span>
<a name="5837"><font size=-1>5837     </font></a><span class="string">calculation. Users should keep its value at the default.</span>
<a name="5838"><font size=-1>5838     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5839"><font size=-1>5839     </font></a><span class="default">),</span>
<a name="5840"><font size=-1>5840     </font></a><span class="default"></span>
<a name="5841"><font size=-1>5841     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5842"><font size=-1>5842     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_recycle&quot;</span><span class="default">,</span>
<a name="5843"><font size=-1>5843     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5844"><font size=-1>5844     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5845"><font size=-1>5845     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5846"><font size=-1>5846     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5847"><font size=-1>5847     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="5848"><font size=-1>5848     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS RECYCLE&quot;</span><span class="default">,</span>
<a name="5849"><font size=-1>5849     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5850"><font size=-1>5850     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="5851"><font size=-1>5851     </font></a><span class="string">This variable let the user choose if and how he wants to recycle the solutions</span>
<a name="5852"><font size=-1>5852     </font></a><span class="string">of the Sternheimer equations involved in the construction of the static dielectric matrix.</span>
<a name="5853"><font size=-1>5853     </font></a><span class="string"></span>
<a name="5854"><font size=-1>5854     </font></a><span class="string">  * [[gwls_recycle]] = 0: No recycling of the solutions.</span>
<a name="5855"><font size=-1>5855     </font></a><span class="string">  * [[gwls_recycle]] = 1: Recycle the solutions. To do so, store them in RAM.</span>
<a name="5856"><font size=-1>5856     </font></a><span class="string">  * [[gwls_recycle]] = 2: Recycle the solutions. To do so, store them on disk.</span>
<a name="5857"><font size=-1>5857     </font></a><span class="string"></span>
<a name="5858"><font size=-1>5858     </font></a><span class="string">If the user choose to recycle the solutions, they are used to construct the</span>
<a name="5859"><font size=-1>5859     </font></a><span class="string">basis in which the Hamiltonian is projected for the solution of the</span>
<a name="5860"><font size=-1>5860     </font></a><span class="string">Sternheimer equations involved by the calculation of the dielectric matrix at</span>
<a name="5861"><font size=-1>5861     </font></a><span class="string">finite frequencies. The other solutions used will be those at $\omega \to \infty$</span>
<a name="5862"><font size=-1>5862     </font></a><span class="string">(always used) and those at $\omega=$[[gwls_list_proj_freq]]. For more</span>
<a name="5863"><font size=-1>5863     </font></a><span class="string">information of the basis constructed, see Sec. IV of [[cite:Laflamme2015]].</span>
<a name="5864"><font size=-1>5864     </font></a><span class="string"></span>
<a name="5865"><font size=-1>5865     </font></a><span class="string">It is important to note that the solutions rapidly take much space to store.</span>
<a name="5866"><font size=-1>5866     </font></a><span class="string">Therefore, it is often not possible to store them in RAM in production</span>
<a name="5867"><font size=-1>5867     </font></a><span class="string">calculations, yet still desirable to retain them. This is when it becomes</span>
<a name="5868"><font size=-1>5868     </font></a><span class="string">interesting to store them on disk. It is particularly efficient to choose the</span>
<a name="5869"><font size=-1>5869     </font></a><span class="string">path of the file to be on disk space local to the processor in large MPI</span>
<a name="5870"><font size=-1>5870     </font></a><span class="string">calculations, since each processor need only his own solutions in the</span>
<a name="5871"><font size=-1>5871     </font></a><span class="string">construction of the basis.</span>
<a name="5872"><font size=-1>5872     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5873"><font size=-1>5873     </font></a><span class="default">),</span>
<a name="5874"><font size=-1>5874     </font></a><span class="default"></span>
<a name="5875"><font size=-1>5875     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5876"><font size=-1>5876     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwls_stern_kmax&quot;</span><span class="default">,</span>
<a name="5877"><font size=-1>5877     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5878"><font size=-1>5878     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5879"><font size=-1>5879     </font></a><span class="default">    topics=[</span><span class="string">'GWls_expert'</span><span class="default">],</span>
<a name="5880"><font size=-1>5880     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5881"><font size=-1>5881     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="5882"><font size=-1>5882     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GWLS Kmax&quot;</span><span class="default">,</span>
<a name="5883"><font size=-1>5883     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 66&quot;</span><span class="default">,</span>
<a name="5884"><font size=-1>5884     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5885"><font size=-1>5885     </font></a><span class="string">This variable sets the dimension of the dielectric matrix used in a GWLS</span>
<a name="5886"><font size=-1>5886     </font></a><span class="string">calculation [see Sec. IV of [[cite:Laflamme2015]]\]. Typically</span>
<a name="5887"><font size=-1>5887     </font></a><span class="string">converged at a value of a few hundreds to a few thousands for a convergence</span>
<a name="5888"><font size=-1>5888     </font></a><span class="string">criterion of 50 meV on the eigenenergies.</span>
<a name="5889"><font size=-1>5889     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5890"><font size=-1>5890     </font></a><span class="default">),</span>
<a name="5891"><font size=-1>5891     </font></a><span class="default"></span>
<a name="5892"><font size=-1>5892     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5893"><font size=-1>5893     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwmem&quot;</span><span class="default">,</span>
<a name="5894"><font size=-1>5894     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5895"><font size=-1>5895     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5896"><font size=-1>5896     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="5897"><font size=-1>5897     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5898"><font size=-1>5898     </font></a><span class="default">    defaultval=</span><span class="number">11</span><span class="default">,</span>
<a name="5899"><font size=-1>5899     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW MEMory&quot;</span><span class="default">,</span>
<a name="5900"><font size=-1>5900     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="5901"><font size=-1>5901     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5902"><font size=-1>5902     </font></a><span class="string">[[gwmem]] governs the memory strategy during a screening and/or a sigma run.</span>
<a name="5903"><font size=-1>5903     </font></a><span class="string"></span>
<a name="5904"><font size=-1>5904     </font></a><span class="string">  * [[gwmem]] = 1x, the screening matrix are read for all q-vectors and stored in the memory.</span>
<a name="5905"><font size=-1>5905     </font></a><span class="string">  * [[gwmem]] = 0x, the screening matrix are read just a q-vector after another.</span>
<a name="5906"><font size=-1>5906     </font></a><span class="string"></span>
<a name="5907"><font size=-1>5907     </font></a><span class="string">  * [[gwmem]] = x1, the real-space wavefunctions are stored in the memory.</span>
<a name="5908"><font size=-1>5908     </font></a><span class="string">  * [[gwmem]] = x0, the real-space wavefunctions are not stored, but rather recalculated on-fly each abinit needs them using FFTs.</span>
<a name="5909"><font size=-1>5909     </font></a><span class="string"></span>
<a name="5910"><font size=-1>5910     </font></a><span class="string">The default is [[gwmem]] = 11, which is the fastest, but also the most memory</span>
<a name="5911"><font size=-1>5911     </font></a><span class="string">consuming. When experiencing memory shortage, one should try [[gwmem]] = 0.</span>
<a name="5912"><font size=-1>5912     </font></a><span class="string">The first digit is only meaningful when performing sigma calculations.</span>
<a name="5913"><font size=-1>5913     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5914"><font size=-1>5914     </font></a><span class="default">),</span>
<a name="5915"><font size=-1>5915     </font></a><span class="default"></span>
<a name="5916"><font size=-1>5916     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5917"><font size=-1>5917     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwpara&quot;</span><span class="default">,</span>
<a name="5918"><font size=-1>5918     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="5919"><font size=-1>5919     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5920"><font size=-1>5920     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">, </span><span class="string">'GW_basic'</span><span class="default">, </span><span class="string">'Susceptibility_basic'</span><span class="default">, </span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="5921"><font size=-1>5921     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5922"><font size=-1>5922     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="5923"><font size=-1>5923     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW PARAllelization level&quot;</span><span class="default">,</span>
<a name="5924"><font size=-1>5924     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;The default value has been changed in v8. From 1 to 2&quot;</span><span class="default">,</span>
<a name="5925"><font size=-1>5925     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="5926"><font size=-1>5926     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5927"><font size=-1>5927     </font></a><span class="string">gwpara is used to choose between the two different parallelization levels</span>
<a name="5928"><font size=-1>5928     </font></a><span class="string">available in the GW code. The available options are:</span>
<a name="5929"><font size=-1>5929     </font></a><span class="string"></span>
<a name="5930"><font size=-1>5930     </font></a><span class="string">  * 1 --&gt; parallelisation on k points.</span>
<a name="5931"><font size=-1>5931     </font></a><span class="string">  * 2 --&gt; parallelisation on bands.</span>
<a name="5932"><font size=-1>5932     </font></a><span class="string"></span>
<a name="5933"><font size=-1>5933     </font></a><span class="string">In the present status of the code, only the parallelization over bands</span>
<a name="5934"><font size=-1>5934     </font></a><span class="string">([[gwpara]] = 2) allows one to reduce the memory allocated by each processor.</span>
<a name="5935"><font size=-1>5935     </font></a><span class="string">Using [[gwpara]] = 1, indeed, requires the same amount of memory as a sequential</span>
<a name="5936"><font size=-1>5936     </font></a><span class="string">run, irrespectively of the number of CPUs used.</span>
<a name="5937"><font size=-1>5937     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5938"><font size=-1>5938     </font></a><span class="default">),</span>
<a name="5939"><font size=-1>5939     </font></a><span class="default"></span>
<a name="5940"><font size=-1>5940     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5941"><font size=-1>5941     </font></a><span class="default">    abivarname=</span><span class="string">&quot;gwrpacorr&quot;</span><span class="default">,</span>
<a name="5942"><font size=-1>5942     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="5943"><font size=-1>5943     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5944"><font size=-1>5944     </font></a><span class="default">    topics=[</span><span class="string">'RPACorrEn_compulsory'</span><span class="default">],</span>
<a name="5945"><font size=-1>5945     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5946"><font size=-1>5946     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5947"><font size=-1>5947     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;GW RPA CORRelation energy&quot;</span><span class="default">,</span>
<a name="5948"><font size=-1>5948     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[gwcalctyp]] in [1,11,21]&quot;</span><span class="default">,</span>
<a name="5949"><font size=-1>5949     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5950"><font size=-1>5950     </font></a><span class="string">[[gwrpacorr]] governs the calculation of the RPA correlation energy.</span>
<a name="5951"><font size=-1>5951     </font></a><span class="string"></span>
<a name="5952"><font size=-1>5952     </font></a><span class="string">  * [[gwrpacorr]] = 0, no RPA correlation energy is calculated.</span>
<a name="5953"><font size=-1>5953     </font></a><span class="string">  * [[gwrpacorr]] = 1, the RPA correlation energy is calculated using an exact integration</span>
<a name="5954"><font size=-1>5954     </font></a><span class="string">    over the coupling constant: it requires one diagonalization of the polarizability matrix.</span>
<a name="5955"><font size=-1>5955     </font></a><span class="string">  * [[gwrpacorr]] = $n$ &gt; 1, the RPA correlation energy is calculated using $n$ values</span>
<a name="5956"><font size=-1>5956     </font></a><span class="string">    for the coupling constant: it requires $n$ inversions of the polarizability matrix.</span>
<a name="5957"><font size=-1>5957     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5958"><font size=-1>5958     </font></a><span class="default">),</span>
<a name="5959"><font size=-1>5959     </font></a><span class="default"></span>
<a name="5960"><font size=-1>5960     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5961"><font size=-1>5961     </font></a><span class="default">    abivarname=</span><span class="string">&quot;hmctt&quot;</span><span class="default">,</span>
<a name="5962"><font size=-1>5962     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="5963"><font size=-1>5963     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5964"><font size=-1>5964     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="5965"><font size=-1>5965     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5966"><font size=-1>5966     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5967"><font size=-1>5967     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Hybrid Monte Carlo Trial Trajectory&quot;</span><span class="default">,</span>
<a name="5968"><font size=-1>5968     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ionmov]] == 25&quot;</span><span class="default">,</span>
<a name="5969"><font size=-1>5969     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5970"><font size=-1>5970     </font></a><span class="string">Number of steps per MC trial trajectory, for the Hybrid Monte Carlo algorithm [[ionmov]]=25.</span>
<a name="5971"><font size=-1>5971     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5972"><font size=-1>5972     </font></a><span class="default">),</span>
<a name="5973"><font size=-1>5973     </font></a><span class="default"></span>
<a name="5974"><font size=-1>5974     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5975"><font size=-1>5975     </font></a><span class="default">    abivarname=</span><span class="string">&quot;hmcsst&quot;</span><span class="default">,</span>
<a name="5976"><font size=-1>5976     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="5977"><font size=-1>5977     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="5978"><font size=-1>5978     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="5979"><font size=-1>5979     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5980"><font size=-1>5980     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="5981"><font size=-1>5981     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Hybrid Monte Carlo Strain Step Trajectory&quot;</span><span class="default">,</span>
<a name="5982"><font size=-1>5982     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ionmov]] == 25&quot;</span><span class="default">,</span>
<a name="5983"><font size=-1>5983     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5984"><font size=-1>5984     </font></a><span class="string">Number of strain teps per MC trial trajectory, for the Hybrid Monte Carlo algorithm [[ionmov]]=25.</span>
<a name="5985"><font size=-1>5985     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="5986"><font size=-1>5986     </font></a><span class="default">),</span>
<a name="5987"><font size=-1>5987     </font></a><span class="default"></span>
<a name="5988"><font size=-1>5988     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="5989"><font size=-1>5989     </font></a><span class="default">    abivarname=</span><span class="string">&quot;hyb_mixing&quot;</span><span class="default">,</span>
<a name="5990"><font size=-1>5990     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="5991"><font size=-1>5991     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="5992"><font size=-1>5992     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_expert'</span><span class="default">],</span>
<a name="5993"><font size=-1>5993     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="5994"><font size=-1>5994     </font></a><span class="default">    defaultval=</span><span class="string">&quot;-999.0d0&quot;</span><span class="default">,</span>
<a name="5995"><font size=-1>5995     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;HYBrid MIXING coefficient for unscreened fock operator&quot;</span><span class="default">,</span>
<a name="5996"><font size=-1>5996     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;With the default, [[hyb_mixing]] is initialized from [[ixc]].&quot;</span><span class="default">,</span>
<a name="5997"><font size=-1>5997     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usefock]] &gt; 0&quot;</span><span class="default">,</span>
<a name="5998"><font size=-1>5998     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="5999"><font size=-1>5999     </font></a><span class="string">Mixing coefficient for the unscreened Fock operator in case of hybrid</span>
<a name="6000"><font size=-1>6000     </font></a><span class="string">functionals. Hartree-Fock corresponds to 1.0, PBE0 to 0.25.</span>
<a name="6001"><font size=-1>6001     </font></a><span class="string"></span>
<a name="6002"><font size=-1>6002     </font></a><span class="string">ABINIT knows the correct value from [[ixc]]. Experts might nevertheless tune this mixing coefficient.</span>
<a name="6003"><font size=-1>6003     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6004"><font size=-1>6004     </font></a><span class="default">),</span>
<a name="6005"><font size=-1>6005     </font></a><span class="default"></span>
<a name="6006"><font size=-1>6006     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6007"><font size=-1>6007     </font></a><span class="default">    abivarname=</span><span class="string">&quot;hyb_mixing_sr&quot;</span><span class="default">,</span>
<a name="6008"><font size=-1>6008     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="6009"><font size=-1>6009     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="6010"><font size=-1>6010     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_expert'</span><span class="default">],</span>
<a name="6011"><font size=-1>6011     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6012"><font size=-1>6012     </font></a><span class="default">    defaultval=</span><span class="string">&quot;-999.0d0&quot;</span><span class="default">,</span>
<a name="6013"><font size=-1>6013     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;HYBrid MIXING coefficient for Short-Range screened fock operator&quot;</span><span class="default">,</span>
<a name="6014"><font size=-1>6014     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;With the default, [[hyb_mixing_sr]] is initialized from [[ixc]].&quot;</span><span class="default">,</span>
<a name="6015"><font size=-1>6015     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usefock]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6016"><font size=-1>6016     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6017"><font size=-1>6017     </font></a><span class="string">Mixing coefficient for the screened Fock operator in case of hybrid</span>
<a name="6018"><font size=-1>6018     </font></a><span class="string">functionals. HSE has 0.25, B3LYP has 0.2.</span>
<a name="6019"><font size=-1>6019     </font></a><span class="string"></span>
<a name="6020"><font size=-1>6020     </font></a><span class="string">ABINIT knows the correct value from [[ixc]]. Experts might nevertheless tune</span>
<a name="6021"><font size=-1>6021     </font></a><span class="string">this mixing coefficient.</span>
<a name="6022"><font size=-1>6022     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6023"><font size=-1>6023     </font></a><span class="default">),</span>
<a name="6024"><font size=-1>6024     </font></a><span class="default"></span>
<a name="6025"><font size=-1>6025     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6026"><font size=-1>6026     </font></a><span class="default">    abivarname=</span><span class="string">&quot;hyb_range_dft&quot;</span><span class="default">,</span>
<a name="6027"><font size=-1>6027     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="6028"><font size=-1>6028     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="6029"><font size=-1>6029     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_expert'</span><span class="default">],</span>
<a name="6030"><font size=-1>6030     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6031"><font size=-1>6031     </font></a><span class="default">    defaultval=</span><span class="string">&quot;-999.0d0 or [[hyb_range_fock]] if it is defined by the user&quot;</span><span class="default">,</span>
<a name="6032"><font size=-1>6032     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;HYBrid RANGE for the DFT leftover from the screened fock operator&quot;</span><span class="default">,</span>
<a name="6033"><font size=-1>6033     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;With the default=-999.0d0, [[hyb_range_dft]] is initialized from [[ixc]].&quot;</span><span class="default">,</span>
<a name="6034"><font size=-1>6034     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usefock]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6035"><font size=-1>6035     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6036"><font size=-1>6036     </font></a><span class="string">Range of the DFT leftover from the screened Fock operator in case of hybrid</span>
<a name="6037"><font size=-1>6037     </font></a><span class="string">functionals (actually, coefficient of the distance appearing in the erf</span>
<a name="6038"><font size=-1>6038     </font></a><span class="string">function, thus it has the dimension of an inverse distance).</span>
<a name="6039"><font size=-1>6039     </font></a><span class="string"></span>
<a name="6040"><font size=-1>6040     </font></a><span class="string">As described in the LibXC sources (and copied in the ABINIT doc, see</span>
<a name="6041"><font size=-1>6041     </font></a><span class="string">[[ixc]] = -428), there is a mess due to an error in the original publication.</span>
<a name="6042"><font size=-1>6042     </font></a><span class="string">ABINIT knows the LibXC value from [[ixc]], that might not agree with the</span>
<a name="6043"><font size=-1>6043     </font></a><span class="string">definitions from other codes. Usually, [[hyb_range_dft]] is the same as</span>
<a name="6044"><font size=-1>6044     </font></a><span class="string">[[hyb_range_fock]], see the latter for the different values. However, there is</span>
<a name="6045"><font size=-1>6045     </font></a><span class="string">a noticeable exception, the HSE03 from the original paper (not the HSE03 from VASP),</span>
<a name="6046"><font size=-1>6046     </font></a><span class="string">for which [[hyb_range_dft]] = 0.188988 while [[hyb_range_fock]] = 0.106066.</span>
<a name="6047"><font size=-1>6047     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6048"><font size=-1>6048     </font></a><span class="default">),</span>
<a name="6049"><font size=-1>6049     </font></a><span class="default"></span>
<a name="6050"><font size=-1>6050     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6051"><font size=-1>6051     </font></a><span class="default">    abivarname=</span><span class="string">&quot;hyb_range_fock&quot;</span><span class="default">,</span>
<a name="6052"><font size=-1>6052     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="6053"><font size=-1>6053     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="6054"><font size=-1>6054     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_expert'</span><span class="default">],</span>
<a name="6055"><font size=-1>6055     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6056"><font size=-1>6056     </font></a><span class="default">    defaultval=</span><span class="string">&quot;-999.0d0 or [[hyb_range_dft]] if it is defined by the user&quot;</span><span class="default">,</span>
<a name="6057"><font size=-1>6057     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;HYBrid RANGE for the screened FOCK operator&quot;</span><span class="default">,</span>
<a name="6058"><font size=-1>6058     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;With the default=-999.0d0, [[hyb_range_fock]] is initialized from [[ixc]].&quot;</span><span class="default">,</span>
<a name="6059"><font size=-1>6059     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usefock]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6060"><font size=-1>6060     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6061"><font size=-1>6061     </font></a><span class="string">Range of the screened Fock operator in case of hybrid functionals (actually,</span>
<a name="6062"><font size=-1>6062     </font></a><span class="string">coefficient of the distance appearing in the erf function, thus it has the</span>
<a name="6063"><font size=-1>6063     </font></a><span class="string">dimension of an inverse distance).</span>
<a name="6064"><font size=-1>6064     </font></a><span class="string"></span>
<a name="6065"><font size=-1>6065     </font></a><span class="string">As described in the LibXC sources (and copied in the ABINIT doc, see</span>
<a name="6066"><font size=-1>6066     </font></a><span class="string">[[ixc]] = -428), there is a mess due to an error in the original publication.</span>
<a name="6067"><font size=-1>6067     </font></a><span class="string">ABINIT knows the LibXC value from [[ixc]], that might not agree with the</span>
<a name="6068"><font size=-1>6068     </font></a><span class="string">definitions from other codes. Usually, [[hyb_range_dft]] is the same as</span>
<a name="6069"><font size=-1>6069     </font></a><span class="string">[[hyb_range_fock]], with one exception explained in [[hyb_range_dft]].</span>
<a name="6070"><font size=-1>6070     </font></a><span class="string">The HSE06 value from LibCX is 0.11, the one of Quantum Espresso is 0.106, the one of</span>
<a name="6071"><font size=-1>6071     </font></a><span class="string">VASP is 0.105835 (=0.2 $\AA^{-1}$).</span>
<a name="6072"><font size=-1>6072     </font></a><span class="string">The HSE03 value from LibCX is 0.106066 ($=0.15/\sqrt{2})$), the one of VASP is</span>
<a name="6073"><font size=-1>6073     </font></a><span class="string">0.1587531 (=0.3 $\AA^{-1}$).</span>
<a name="6074"><font size=-1>6074     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6075"><font size=-1>6075     </font></a><span class="default">),</span>
<a name="6076"><font size=-1>6076     </font></a><span class="default"></span>
<a name="6077"><font size=-1>6077     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6078"><font size=-1>6078     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iatcon&quot;</span><span class="default">,</span>
<a name="6079"><font size=-1>6079     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6080"><font size=-1>6080     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6081"><font size=-1>6081     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_useful'</span><span class="default">],</span>
<a name="6082"><font size=-1>6082     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natcon]]'</span><span class="default">, </span><span class="string">'[[nconeq]]'</span><span class="default">],</span>
<a name="6083"><font size=-1>6083     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6084"><font size=-1>6084     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Indices of AToms in CONstraint equations&quot;</span><span class="default">,</span>
<a name="6085"><font size=-1>6085     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">, </span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="6086"><font size=-1>6086     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6087"><font size=-1>6087     </font></a><span class="string">Gives the indices of the atoms appearing in each of the [[nconeq]] independent</span>
<a name="6088"><font size=-1>6088     </font></a><span class="string">equations constraining the motion of atoms during structural optimization or</span>
<a name="6089"><font size=-1>6089     </font></a><span class="string">molecular dynamics (see [[nconeq]], [[natcon]], and [[wtatcon]]).</span>
<a name="6090"><font size=-1>6090     </font></a><span class="string">(Note: combined with [[wtatcon]] to give internal representation of the latter)</span>
<a name="6091"><font size=-1>6091     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6092"><font size=-1>6092     </font></a><span class="default">),</span>
<a name="6093"><font size=-1>6093     </font></a><span class="default"></span>
<a name="6094"><font size=-1>6094     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6095"><font size=-1>6095     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iatfix&quot;</span><span class="default">,</span>
<a name="6096"><font size=-1>6096     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6097"><font size=-1>6097     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6098"><font size=-1>6098     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="6099"><font size=-1>6099     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natfix]]'</span><span class="default">],</span>
<a name="6100"><font size=-1>6100     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Indices of AToms that are FIXed&quot;</span><span class="default">,</span>
<a name="6101"><font size=-1>6101     </font></a><span class="default">    requires=</span><span class="string">&quot;[[natfix]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6102"><font size=-1>6102     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6103"><font size=-1>6103     </font></a><span class="string">Give the index (in the range 1 to [[natom]] ) of each atom which is to be held</span>
<a name="6104"><font size=-1>6104     </font></a><span class="string">fixed for structural optimization or molecular dynamics. The variable</span>
<a name="6105"><font size=-1>6105     </font></a><span class="string">[[iatfix]] lists those fixed in the three directions, while the variables</span>
<a name="6106"><font size=-1>6106     </font></a><span class="string">[[iatfixx]], [[iatfixy]], and [[iatfixz]], allow to fix some atoms along x, y</span>
<a name="6107"><font size=-1>6107     </font></a><span class="string">or z directions, or a combination of these.</span>
<a name="6108"><font size=-1>6108     </font></a><span class="string"></span>
<a name="6109"><font size=-1>6109     </font></a><span class="string">WARNING: The implementation is inconsistent !! For [[ionmov]] ==1, the fixing</span>
<a name="6110"><font size=-1>6110     </font></a><span class="string">of directions was done in cartesian coordinates, while for the other values of</span>
<a name="6111"><font size=-1>6111     </font></a><span class="string">[[ionmov]], it was done in reduced coordinates. Sorry for this.</span>
<a name="6112"><font size=-1>6112     </font></a><span class="string"></span>
<a name="6113"><font size=-1>6113     </font></a><span class="string">There is no harm in fixing one atom in the three directions using [[iatfix]],</span>
<a name="6114"><font size=-1>6114     </font></a><span class="string">then fixing it again in other directions by mentioning it in **iatfixx**,</span>
<a name="6115"><font size=-1>6115     </font></a><span class="string">**iatfixy** or **iatfixz**.</span>
<a name="6116"><font size=-1>6116     </font></a><span class="string">The internal representation of these input data is done by the mean of one</span>
<a name="6117"><font size=-1>6117     </font></a><span class="string">variable [[iatfix]](3,[[natom]]), defined for each direction and each atom,</span>
<a name="6118"><font size=-1>6118     </font></a><span class="string">being 0 if the atom is not fixed along the direction, and 1 if the atom is</span>
<a name="6119"><font size=-1>6119     </font></a><span class="string">fixed along the direction. When some atoms are fixed along 1 or 2 directions,</span>
<a name="6120"><font size=-1>6120     </font></a><span class="string">the use of symmetries is restricted to symmetry operations whose (3x3)</span>
<a name="6121"><font size=-1>6121     </font></a><span class="string">matrices [[symrel]] are diagonal.</span>
<a name="6122"><font size=-1>6122     </font></a><span class="string">If the atom manipulator is used, [[iatfix]] will be related to the</span>
<a name="6123"><font size=-1>6123     </font></a><span class="string">preprocessed set of atoms, generated by the atom manipulator. The user must</span>
<a name="6124"><font size=-1>6124     </font></a><span class="string">thus foresee the effect of this atom manipulator (see [[objarf]]).</span>
<a name="6125"><font size=-1>6125     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6126"><font size=-1>6126     </font></a><span class="default">),</span>
<a name="6127"><font size=-1>6127     </font></a><span class="default"></span>
<a name="6128"><font size=-1>6128     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6129"><font size=-1>6129     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iatfixx&quot;</span><span class="default">,</span>
<a name="6130"><font size=-1>6130     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6131"><font size=-1>6131     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6132"><font size=-1>6132     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="6133"><font size=-1>6133     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natfixx]]'</span><span class="default">],</span>
<a name="6134"><font size=-1>6134     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Indices of AToms that are FIXed along the X direction&quot;</span><span class="default">,</span>
<a name="6135"><font size=-1>6135     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="6136"><font size=-1>6136     </font></a><span class="default">    requires=</span><span class="string">&quot;[[natfixx]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6137"><font size=-1>6137     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6138"><font size=-1>6138     </font></a><span class="string">Give the index (in the range 1 to [[natom]] ) of each atom which is to be held</span>
<a name="6139"><font size=-1>6139     </font></a><span class="string">fixed ALONG THE X direction for structural optimization or molecular dynamics.</span>
<a name="6140"><font size=-1>6140     </font></a><span class="string">The variable [[iatfix]] lists those fixed in the three directions, while the</span>
<a name="6141"><font size=-1>6141     </font></a><span class="string">variables [[iatfixx]], [[iatfixy]], and [[iatfixz]], allow to fix some atoms</span>
<a name="6142"><font size=-1>6142     </font></a><span class="string">along x, y or z directions, or a combination of these. See the variable</span>
<a name="6143"><font size=-1>6143     </font></a><span class="string">[[iatfix]] for more information.</span>
<a name="6144"><font size=-1>6144     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6145"><font size=-1>6145     </font></a><span class="default">),</span>
<a name="6146"><font size=-1>6146     </font></a><span class="default"></span>
<a name="6147"><font size=-1>6147     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6148"><font size=-1>6148     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iatfixy&quot;</span><span class="default">,</span>
<a name="6149"><font size=-1>6149     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6150"><font size=-1>6150     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6151"><font size=-1>6151     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="6152"><font size=-1>6152     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natfixy]]'</span><span class="default">],</span>
<a name="6153"><font size=-1>6153     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Indices of AToms that are FIXed along the Y direction&quot;</span><span class="default">,</span>
<a name="6154"><font size=-1>6154     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="6155"><font size=-1>6155     </font></a><span class="default">    requires=</span><span class="string">&quot;[[natfixy]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6156"><font size=-1>6156     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6157"><font size=-1>6157     </font></a><span class="string">Give the index (in the range 1 to [[natom]] ) of each atom which is to be held</span>
<a name="6158"><font size=-1>6158     </font></a><span class="string">fixed ALONG THE Y direction for structural optimization or molecular dynamics.</span>
<a name="6159"><font size=-1>6159     </font></a><span class="string">The variable [[iatfix]] lists those fixed in the three directions, while the</span>
<a name="6160"><font size=-1>6160     </font></a><span class="string">variables [[iatfixx]], [[iatfixy]], and [[iatfixz]], allow to fix some atoms</span>
<a name="6161"><font size=-1>6161     </font></a><span class="string">along x, y or z directions, or a combination of these.</span>
<a name="6162"><font size=-1>6162     </font></a><span class="string">See the variable [[iatfix]] for more information.</span>
<a name="6163"><font size=-1>6163     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6164"><font size=-1>6164     </font></a><span class="default">),</span>
<a name="6165"><font size=-1>6165     </font></a><span class="default"></span>
<a name="6166"><font size=-1>6166     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6167"><font size=-1>6167     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iatfixz&quot;</span><span class="default">,</span>
<a name="6168"><font size=-1>6168     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6169"><font size=-1>6169     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6170"><font size=-1>6170     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="6171"><font size=-1>6171     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natfixz]]'</span><span class="default">],</span>
<a name="6172"><font size=-1>6172     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Indices of AToms that are FIXed along the Z direction&quot;</span><span class="default">,</span>
<a name="6173"><font size=-1>6173     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="6174"><font size=-1>6174     </font></a><span class="default">    requires=</span><span class="string">&quot;[[natfixz]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6175"><font size=-1>6175     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6176"><font size=-1>6176     </font></a><span class="string">Give the index (in the range 1 to [[natom]] ) of each atom which is to be held</span>
<a name="6177"><font size=-1>6177     </font></a><span class="string">fixed ALONG THE Z direction for structural optimization or molecular dynamics.</span>
<a name="6178"><font size=-1>6178     </font></a><span class="string">The variable [[iatfix]] lists those fixed in the three directions, while the</span>
<a name="6179"><font size=-1>6179     </font></a><span class="string">variables [[iatfixx]], [[iatfixy]], and [[iatfixz]], allow to fix some atoms</span>
<a name="6180"><font size=-1>6180     </font></a><span class="string">along x, y or z directions, or a combination of these. See the variable</span>
<a name="6181"><font size=-1>6181     </font></a><span class="string">[[iatfix]] for more information.</span>
<a name="6182"><font size=-1>6182     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6183"><font size=-1>6183     </font></a><span class="default">),</span>
<a name="6184"><font size=-1>6184     </font></a><span class="default"></span>
<a name="6185"><font size=-1>6185     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6186"><font size=-1>6186     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iatsph&quot;</span><span class="default">,</span>
<a name="6187"><font size=-1>6187     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="6188"><font size=-1>6188     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6189"><font size=-1>6189     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">, </span><span class="string">'ElecBandStructure_useful'</span><span class="default">, </span><span class="string">'ElecDOS_useful'</span><span class="default">],</span>
<a name="6190"><font size=-1>6190     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natsph]]'</span><span class="default">],</span>
<a name="6191"><font size=-1>6191     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#7747">Range</a>(start=</span><span class="number">1</span><span class="default">, stop=</span><span class="string">'[[natsph]]'</span><span class="default">),</span>
<a name="6192"><font size=-1>6192     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Index for the ATomic SPHeres of the atom-projected density-of-states&quot;</span><span class="default">,</span>
<a name="6193"><font size=-1>6193     </font></a><span class="default">    requires=</span><span class="string">&quot;[[prtdos]] == 3 or [[pawfatbnd]] in [1,2]&quot;</span><span class="default">,</span>
<a name="6194"><font size=-1>6194     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6195"><font size=-1>6195     </font></a><span class="string">[[iatsph]] gives the number of the [[natsph]] atoms around which the sphere</span>
<a name="6196"><font size=-1>6196     </font></a><span class="string">for atom-projected density-of-states will be build, in the [[prtdos]] = 3 case.</span>
<a name="6197"><font size=-1>6197     </font></a><span class="string">The radius of these spheres is given by [[ratsph]].</span>
<a name="6198"><font size=-1>6198     </font></a><span class="string">If [[pawfatbnd]] = 1 or 2, it gives the number of the [[natsph]] atoms around</span>
<a name="6199"><font size=-1>6199     </font></a><span class="string">which atom-projected band structure will be built.</span>
<a name="6200"><font size=-1>6200     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6201"><font size=-1>6201     </font></a><span class="default">),</span>
<a name="6202"><font size=-1>6202     </font></a><span class="default"></span>
<a name="6203"><font size=-1>6203     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6204"><font size=-1>6204     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iboxcut&quot;</span><span class="default">,</span>
<a name="6205"><font size=-1>6205     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="6206"><font size=-1>6206     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6207"><font size=-1>6207     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="6208"><font size=-1>6208     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6209"><font size=-1>6209     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6210"><font size=-1>6210     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer governing the internal use of BOXCUT - not a very good choice of variable name&quot;</span><span class="default">,</span>
<a name="6211"><font size=-1>6211     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6212"><font size=-1>6212     </font></a><span class="string">Concern all summations in the reciprocal space and is allowed in PAW and norm-conserving.</span>
<a name="6213"><font size=-1>6213     </font></a><span class="string"></span>
<a name="6214"><font size=-1>6214     </font></a><span class="string">  * if set to 0 all reciprocal space summations are done in a sphere contained in the FFT box.</span>
<a name="6215"><font size=-1>6215     </font></a><span class="string">  * if set to 1 all reciprocal space summations are done in the whole FFT box (useful for tests).</span>
<a name="6216"><font size=-1>6216     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6217"><font size=-1>6217     </font></a><span class="default">),</span>
<a name="6218"><font size=-1>6218     </font></a><span class="default"></span>
<a name="6219"><font size=-1>6219     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6220"><font size=-1>6220     </font></a><span class="default">    abivarname=</span><span class="string">&quot;icoulomb&quot;</span><span class="default">,</span>
<a name="6221"><font size=-1>6221     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="6222"><font size=-1>6222     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6223"><font size=-1>6223     </font></a><span class="default">    topics=[</span><span class="string">'Coulomb_useful'</span><span class="default">],</span>
<a name="6224"><font size=-1>6224     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6225"><font size=-1>6225     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6226"><font size=-1>6226     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Index for the COULOMB treatment&quot;</span><span class="default">,</span>
<a name="6227"><font size=-1>6227     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6228"><font size=-1>6228     </font></a><span class="string">Defines the type of computation used for Hartree potential, local part of</span>
<a name="6229"><font size=-1>6229     </font></a><span class="string">pseudo-potential and ion-ion interaction:</span>
<a name="6230"><font size=-1>6230     </font></a><span class="string"></span>
<a name="6231"><font size=-1>6231     </font></a><span class="string">  * [[icoulomb]] = 0: usual reciprocal space computation, using $1/\GG^2$ for the Hartree potential and using Ewald correction.</span>
<a name="6232"><font size=-1>6232     </font></a><span class="string">  * [[icoulomb]] = 1: free boundary conditions are used when the Hartree potential is computed,</span>
<a name="6233"><font size=-1>6233     </font></a><span class="string">    real space expressions of pseudo-potentials are involved (restricted to GTH pseudo-potentials)</span>
<a name="6234"><font size=-1>6234     </font></a><span class="string">    and simple coulomb interaction gives the ion-ion energy.</span>
<a name="6235"><font size=-1>6235     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6236"><font size=-1>6236     </font></a><span class="default">),</span>
<a name="6237"><font size=-1>6237     </font></a><span class="default"></span>
<a name="6238"><font size=-1>6238     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6239"><font size=-1>6239     </font></a><span class="default">    abivarname=</span><span class="string">&quot;icutcoul&quot;</span><span class="default">,</span>
<a name="6240"><font size=-1>6240     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="6241"><font size=-1>6241     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6242"><font size=-1>6242     </font></a><span class="default">    topics=[</span><span class="string">'GWls_compulsory'</span><span class="default">, </span><span class="string">'Susceptibility_basic'</span><span class="default">, </span><span class="string">'Coulomb_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="6243"><font size=-1>6243     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6244"><font size=-1>6244     </font></a><span class="default">    defaultval=</span><span class="number">6</span><span class="default">,</span>
<a name="6245"><font size=-1>6245     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the CUT-off for COULomb interaction&quot;</span><span class="default">,</span>
<a name="6246"><font size=-1>6246     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="6247"><font size=-1>6247     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6248"><font size=-1>6248     </font></a><span class="string">Many-body calculations for isolated systems present a slow convergence with</span>
<a name="6249"><font size=-1>6249     </font></a><span class="string">respect to the size of the supercell due to the long ranged Coulomb</span>
<a name="6250"><font size=-1>6250     </font></a><span class="string">interaction and the high degree of non-locality of the operators involved. A</span>
<a name="6251"><font size=-1>6251     </font></a><span class="string">similar issue also occurs in fully periodic systems due to the presence of the</span>
<a name="6252"><font size=-1>6252     </font></a><span class="string">integrable Coulomb singularity at $\mathbf{G}=0$ that hinders the convergence with</span>
<a name="6253"><font size=-1>6253     </font></a><span class="string">respect to the number of q-points used to sample the Brillouin zone. The</span>
<a name="6254"><font size=-1>6254     </font></a><span class="string">convergence can be accelerated by replacing the true bare Coulomb interaction</span>
<a name="6255"><font size=-1>6255     </font></a><span class="string">with other expressions.</span>
<a name="6256"><font size=-1>6256     </font></a><span class="string"></span>
<a name="6257"><font size=-1>6257     </font></a><span class="string">[[icutcoul]] defines the particular expression to be used for the Coulomb term</span>
<a name="6258"><font size=-1>6258     </font></a><span class="string">in reciprocal space. The choice of [[icutcoul]] depends on the dimensionality</span>
<a name="6259"><font size=-1>6259     </font></a><span class="string">of the system. Possible values of [[icutcoul]] are from 0 to 6. The</span>
<a name="6260"><font size=-1>6260     </font></a><span class="string">corresponding influential variables are [[vcutgeo]] and [[rcut]].</span>
<a name="6261"><font size=-1>6261     </font></a><span class="string"></span>
<a name="6262"><font size=-1>6262     </font></a><span class="string">  * 0 --&gt; sphere (molecules but also 3D-crystals).</span>
<a name="6263"><font size=-1>6263     </font></a><span class="string">  * 1 --&gt; cylinder (nanowires, nanotubes).</span>
<a name="6264"><font size=-1>6264     </font></a><span class="string">  * 2 --&gt; surface.</span>
<a name="6265"><font size=-1>6265     </font></a><span class="string">  * 3 --&gt; 3D crystal (no cut-off, integration in a spherical mini-Brillouin Zone, legacy value).</span>
<a name="6266"><font size=-1>6266     </font></a><span class="string">  * 4 --&gt; ERF, long-range only Coulomb interaction.</span>
<a name="6267"><font size=-1>6267     </font></a><span class="string">  * 5 --&gt; ERFC, short-range only Coulomb interaction (e.g. as used in the HSE functional).</span>
<a name="6268"><font size=-1>6268     </font></a><span class="string">  * 6 --&gt; auxiliary function integration for 3D systems from [[cite:Carrier2007]].</span>
<a name="6269"><font size=-1>6269     </font></a><span class="string">  * 7 --&gt; auxiliary function for 3D systems of Gygi and Baldereschi [[cite:Gygi1986]].</span>
<a name="6270"><font size=-1>6270     </font></a><span class="string"></span>
<a name="6271"><font size=-1>6271     </font></a><span class="string">Note that Spencer and Alavi showed that the</span>
<a name="6272"><font size=-1>6272     </font></a><span class="string">spherical cutoff can efficiently be used also for 3D systems [[cite:Spencer2008]].</span>
<a name="6273"><font size=-1>6273     </font></a><span class="string">In the latter case, use a negative value for the cutoff radius of the sphere ([[rcut]]&lt;0),</span>
<a name="6274"><font size=-1>6274     </font></a><span class="string">which is automatically calculated so that the volume enclosed in the sphere is</span>
<a name="6275"><font size=-1>6275     </font></a><span class="string">equal to the volume of the solid.</span>
<a name="6276"><font size=-1>6276     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6277"><font size=-1>6277     </font></a><span class="default">),</span>
<a name="6278"><font size=-1>6278     </font></a><span class="default"></span>
<a name="6279"><font size=-1>6279     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6280"><font size=-1>6280     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ieig2rf&quot;</span><span class="default">,</span>
<a name="6281"><font size=-1>6281     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="6282"><font size=-1>6282     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6283"><font size=-1>6283     </font></a><span class="default">    topics=[</span><span class="string">'TDepES_compulsory'</span><span class="default">],</span>
<a name="6284"><font size=-1>6284     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6285"><font size=-1>6285     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6286"><font size=-1>6286     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for second-order EIGenvalues from Response-Function&quot;</span><span class="default">,</span>
<a name="6287"><font size=-1>6287     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6288"><font size=-1>6288     </font></a><span class="string">If [[ieig2rf]] is greater then 0, the code will produce a file, named with the</span>
<a name="6289"><font size=-1>6289     </font></a><span class="string">trailing suffix _EIGR2D, containing the second-order electronic eigenvalues</span>
<a name="6290"><font size=-1>6290     </font></a><span class="string">for the perturbation. These files are used in the calculation of the thermal</span>
<a name="6291"><font size=-1>6291     </font></a><span class="string">correction to the electronic eigenvalues.</span>
<a name="6292"><font size=-1>6292     </font></a><span class="string"></span>
<a name="6293"><font size=-1>6293     </font></a><span class="string">  * If [[ieig2rf]] is set to 1, the second-order electronic eigenvalues will be</span>
<a name="6294"><font size=-1>6294     </font></a><span class="string">    calculated from the DFPT method (Sternheimer).</span>
<a name="6295"><font size=-1>6295     </font></a><span class="string"></span>
<a name="6296"><font size=-1>6296     </font></a><span class="string">  * If [[ieig2rf]] is set to 2, the second-order electronic eigenvalues will be</span>
<a name="6297"><font size=-1>6297     </font></a><span class="string">    calculated from the Allen-Cardona method (sum over states).</span>
<a name="6298"><font size=-1>6298     </font></a><span class="string"></span>
<a name="6299"><font size=-1>6299     </font></a><span class="string">  * If [[ieig2rf]] is set to 3, the second-order electronic eigenvalues will be</span>
<a name="6300"><font size=-1>6300     </font></a><span class="string">    calculated from the DFPT method (sum over states) but using a different part</span>
<a name="6301"><font size=-1>6301     </font></a><span class="string">    of the code. This is equivalent to [[ieig2rf]] = 1 [debuging].</span>
<a name="6302"><font size=-1>6302     </font></a><span class="string"></span>
<a name="6303"><font size=-1>6303     </font></a><span class="string">  * If [[ieig2rf]] is set to 4, the second-order electronic eigenvalues will be</span>
<a name="6304"><font size=-1>6304     </font></a><span class="string">    calculated from the dynamical DFPT method (Sternheimer). The code will</span>
<a name="6305"><font size=-1>6305     </font></a><span class="string">    generate _EIGR2D.nc files that contain the electron-phonon matrix element</span>
<a name="6306"><font size=-1>6306     </font></a><span class="string">    squared on the space orthogonal to the active space. The code will also</span>
<a name="6307"><font size=-1>6307     </font></a><span class="string">    produce _FAN.nc files that contain the electron-phonon matrix elements</span>
<a name="6308"><font size=-1>6308     </font></a><span class="string">    squared.</span>
<a name="6309"><font size=-1>6309     </font></a><span class="string"></span>
<a name="6310"><font size=-1>6310     </font></a><span class="string">  * If [[ieig2rf]] is set to 5, the second-order electronic eigenvalues will be</span>
<a name="6311"><font size=-1>6311     </font></a><span class="string">    calculated from the dynamical DFPT method (Sternheimer). The code will</span>
<a name="6312"><font size=-1>6312     </font></a><span class="string">    generate _EIGR2D.nc files that contain the electron-phonon matrix element</span>
<a name="6313"><font size=-1>6313     </font></a><span class="string">    square on the space orthogonal to the active space. The code will also produce</span>
<a name="6314"><font size=-1>6314     </font></a><span class="string">    _GKK.nc files that contain electron-phonon matrix elements. This option is</span>
<a name="6315"><font size=-1>6315     </font></a><span class="string">    preferable for large system to [[ieig2rf]] = 4 as the GKK files take much</span>
<a name="6316"><font size=-1>6316     </font></a><span class="string">    less disk space and memory (but run a little bit slower).</span>
<a name="6317"><font size=-1>6317     </font></a><span class="string"></span>
<a name="6318"><font size=-1>6318     </font></a><span class="string">!!! note</span>
<a name="6319"><font size=-1>6319     </font></a><span class="string">    [[ieig2rf]] = 4 and 5 can only be used if Abinit is compiled with NETCDF support.</span>
<a name="6320"><font size=-1>6320     </font></a><span class="string"></span>
<a name="6321"><font size=-1>6321     </font></a><span class="string"></span>
<a name="6322"><font size=-1>6322     </font></a><span class="string">Related variables:</span>
<a name="6323"><font size=-1>6323     </font></a><span class="string">[[bdeigrf]],[[elph2_imagden]],[[getgam_eig2nkq]],[[smdelta]]</span>
<a name="6324"><font size=-1>6324     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6325"><font size=-1>6325     </font></a><span class="default">),</span>
<a name="6326"><font size=-1>6326     </font></a><span class="default"></span>
<a name="6327"><font size=-1>6327     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6328"><font size=-1>6328     </font></a><span class="default">    abivarname=</span><span class="string">&quot;imgmov&quot;</span><span class="default">,</span>
<a name="6329"><font size=-1>6329     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6330"><font size=-1>6330     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6331"><font size=-1>6331     </font></a><span class="default">    topics=[</span><span class="string">'CrossingBarriers_useful'</span><span class="default">, </span><span class="string">'PIMD_compulsory'</span><span class="default">, </span><span class="string">'TransPath_compulsory'</span><span class="default">],</span>
<a name="6332"><font size=-1>6332     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6333"><font size=-1>6333     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6334"><font size=-1>6334     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;IMaGe MOVEs&quot;</span><span class="default">,</span>
<a name="6335"><font size=-1>6335     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6336"><font size=-1>6336     </font></a><span class="string">Control the collective changes of images (see [[nimage]],[[npimage]],</span>
<a name="6337"><font size=-1>6337     </font></a><span class="string">[[dynimage]], [[ntimimage]], [[tolimg]], [[istatimg]], [[prtvolimg]]).</span>
<a name="6338"><font size=-1>6338     </font></a><span class="string">Similar to [[ionmov]] in spirit, although here, a population of self-consistent</span>
<a name="6339"><font size=-1>6339     </font></a><span class="string">calculations for possibly different (evolving) geometries is managed, while with</span>
<a name="6340"><font size=-1>6340     </font></a><span class="string">[[ionmov]], only self-consistent calculation for one (evolving) geometry is managed.</span>
<a name="6341"><font size=-1>6341     </font></a><span class="string">In this respect the maximal number of time step for image propagation is</span>
<a name="6342"><font size=-1>6342     </font></a><span class="string">[[ntimimage]], corresponding to the input variable [[ntime]] of the single</span>
<a name="6343"><font size=-1>6343     </font></a><span class="string">geometry case. Also, the stopping criterion is governed by [[tolimg]],</span>
<a name="6344"><font size=-1>6344     </font></a><span class="string">corresponding to the input variable [[toldfe]] of the single geometry case.</span>
<a name="6345"><font size=-1>6345     </font></a><span class="string">The stopping condition is crude: the image propagation is stopped when the</span>
<a name="6346"><font size=-1>6346     </font></a><span class="string">mean value (over dynamic images) of the absolute difference of total energy</span>
<a name="6347"><font size=-1>6347     </font></a><span class="string">(previous and current time step) is less than [[tolimg]].</span>
<a name="6348"><font size=-1>6348     </font></a><span class="string"></span>
<a name="6349"><font size=-1>6349     </font></a><span class="string">Actually, there might be combinations of [[ionmov]] and [[imgmov]] in which</span>
<a name="6350"><font size=-1>6350     </font></a><span class="string">the two mechanisms are at work. Usually, however, only one mechanism will be</span>
<a name="6351"><font size=-1>6351     </font></a><span class="string">activated (so, usually, either [[ntimimage]] is bigger than one OR [[ntime]]</span>
<a name="6352"><font size=-1>6352     </font></a><span class="string">is bigger than one). In order for the user to acquire a mental representation</span>
<a name="6353"><font size=-1>6353     </font></a><span class="string">of the interplay between [[ionmov]] and [[imgmov]], here is a F90 pseudo-code</span>
<a name="6354"><font size=-1>6354     </font></a><span class="string">presenting the interplay between the different above-mentioned input</span>
<a name="6355"><font size=-1>6355     </font></a><span class="string">variables, as well as with the parallelism (see input variable [[npimage]]).</span>
<a name="6356"><font size=-1>6356     </font></a><span class="string"></span>
<a name="6357"><font size=-1>6357     </font></a><span class="string">```fortran</span>
<a name="6358"><font size=-1>6358     </font></a><span class="string">    do itimimage=1,ntimimage</span>
<a name="6359"><font size=-1>6359     </font></a><span class="string">      do iimage=1,nimage</span>
<a name="6360"><font size=-1>6360     </font></a><span class="string">        (possibly, parallelisation over images)</span>
<a name="6361"><font size=-1>6361     </font></a><span class="string">        do itime=1,ntime</span>
<a name="6362"><font size=-1>6362     </font></a><span class="string">          Compute the forces and stresses for image(iimage)</span>
<a name="6363"><font size=-1>6363     </font></a><span class="string">          Examine whether the stopping criterion defined by tolmxf is fulfilled</span>
<a name="6364"><font size=-1>6364     </font></a><span class="string">          Predict the next geometry for image(iimage) using ionmov</span>
<a name="6365"><font size=-1>6365     </font></a><span class="string">        enddo</span>
<a name="6366"><font size=-1>6366     </font></a><span class="string">      enddo</span>
<a name="6367"><font size=-1>6367     </font></a><span class="string">      Examine whether the stopping criterion defined by tolimg is fulfilled</span>
<a name="6368"><font size=-1>6368     </font></a><span class="string">      Predict the next geometries for all images using imgmov</span>
<a name="6369"><font size=-1>6369     </font></a><span class="string">    enddo</span>
<a name="6370"><font size=-1>6370     </font></a><span class="string">```</span>
<a name="6371"><font size=-1>6371     </font></a><span class="string"></span>
<a name="6372"><font size=-1>6372     </font></a><span class="string">  * = 0 --&gt; simply **copy** images from previous itimimage step.</span>
<a name="6373"><font size=-1>6373     </font></a><span class="string">  * = 1 --&gt; move images according to **Steepest Descent** following the (scaled) forces,</span>
<a name="6374"><font size=-1>6374     </font></a><span class="string">    the scaling factor being [[fxcartfactor]].</span>
<a name="6375"><font size=-1>6375     </font></a><span class="string">  * = 2 --&gt; **String Method** for finding Minimal Energy Path (MEP) connecting two minima</span>
<a name="6376"><font size=-1>6376     </font></a><span class="string">    (see [[cite:Weinan2002]]), or even two configurations that are not local minima; the algorithm variant can be selected with the [[string_algo]] keyword</span>
<a name="6377"><font size=-1>6377     </font></a><span class="string">    (Simplified String Method by default). The solver for the Ordinary Differential Equation (ODE)</span>
<a name="6378"><font size=-1>6378     </font></a><span class="string">    can be selected with [[mep_solver]] (steepest-descent by default). See also [[mep_mxstep]] keyword.</span>
<a name="6379"><font size=-1>6379     </font></a><span class="string">  * = 3 --&gt; (tentatively, not yet coded) **Metadynamics**.</span>
<a name="6380"><font size=-1>6380     </font></a><span class="string">  * = 4 --&gt; (tentatively, not yet coded) **Genetic Algorithm**.</span>
<a name="6381"><font size=-1>6381     </font></a><span class="string">  * = 5 --&gt; **Nudged Elastic Band (NEB)** for finding Minimal Energy Path (MEP) connecting two minima;</span>
<a name="6382"><font size=-1>6382     </font></a><span class="string">    the algorithm variant can be selected with the [[neb_algo]] keyword (NEB+improved tangent by default).</span>
<a name="6383"><font size=-1>6383     </font></a><span class="string">    The solver for the Ordinary Differential Equation (ODE) can be selected with [[mep_solver]] (steepest-descent by default).</span>
<a name="6384"><font size=-1>6384     </font></a><span class="string">    The spring constant connecting images along the path is defined by [[neb_spring]]. See also [[mep_mxstep]] keyword.</span>
<a name="6385"><font size=-1>6385     </font></a><span class="string">  * = 6 --&gt; **Linear Combination of Constrained DFT Energies**. The images can have different electronic structure ([[occ]] can differ),</span>
<a name="6386"><font size=-1>6386     </font></a><span class="string">    and their total energies are combined linearly using the factors in [[mixesimgf]], giving the actual total energy of the ensemble</span>
<a name="6387"><font size=-1>6387     </font></a><span class="string">    of constrained DFT images. The geometry is the same for all images, forces and stresses are computed, and all usual</span>
<a name="6388"><font size=-1>6388     </font></a><span class="string">    algorithms for MD or geometry optimization are allowed, using [[ionmov]] (instead of [[imgmov]], this is the exception to the rule)</span>
<a name="6389"><font size=-1>6389     </font></a><span class="string">    and related variables.</span>
<a name="6390"><font size=-1>6390     </font></a><span class="string">  * = 9 or 13 --&gt; **Path-Integral Molecular Dynamics** (see e.g. [[cite:Marx1996]]).</span>
<a name="6391"><font size=-1>6391     </font></a><span class="string">    Will use 9 for **Langevin thermostat** (associated friction coefficient given by [[vis]])</span>
<a name="6392"><font size=-1>6392     </font></a><span class="string">    and 13 for **Nose-Hoover thermostat chains** (associated input variables are the number of thermostats in the chains,</span>
<a name="6393"><font size=-1>6393     </font></a><span class="string">    [[nnos]], and the masses of these thermostats [[qmass]]). [[nimage]] is the Trotter number</span>
<a name="6394"><font size=-1>6394     </font></a><span class="string">    (no use of [[dynimage]]); possible transformations of coordinates are defined by [[pitransform]];</span>
<a name="6395"><font size=-1>6395     </font></a><span class="string">    Fictitious masses of the atoms (possibly different from the true masses given by [[amu]]) can be specified by [[pimass]].</span>
<a name="6396"><font size=-1>6396     </font></a><span class="string">    At present, it is only possible to perform calculations in the (N,V,T) ensemble ([[optcell]] = 0).</span>
<a name="6397"><font size=-1>6397     </font></a><span class="string"></span>
<a name="6398"><font size=-1>6398     </font></a><span class="string">No meaning for RF calculations.</span>
<a name="6399"><font size=-1>6399     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6400"><font size=-1>6400     </font></a><span class="default">),</span>
<a name="6401"><font size=-1>6401     </font></a><span class="default"></span>
<a name="6402"><font size=-1>6402     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6403"><font size=-1>6403     </font></a><span class="default">    abivarname=</span><span class="string">&quot;imgwfstor&quot;</span><span class="default">,</span>
<a name="6404"><font size=-1>6404     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6405"><font size=-1>6405     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6406"><font size=-1>6406     </font></a><span class="default">    topics=[</span><span class="string">'CrossingBarriers_useful'</span><span class="default">, </span><span class="string">'PIMD_useful'</span><span class="default">, </span><span class="string">'TransPath_useful'</span><span class="default">],</span>
<a name="6407"><font size=-1>6407     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6408"><font size=-1>6408     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6409"><font size=-1>6409     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;IMaGe WaveFunction STORage&quot;</span><span class="default">,</span>
<a name="6410"><font size=-1>6410     </font></a><span class="default">    requires=</span><span class="string">&quot;[[extrapwf]] == 0 and [[ntimimage]] &gt; 0&quot;</span><span class="default">,</span>
<a name="6411"><font size=-1>6411     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6412"><font size=-1>6412     </font></a><span class="string">Govern the storage of wavefunctions at the level of the loop over images, see [[ntimimage]].</span>
<a name="6413"><font size=-1>6413     </font></a><span class="string">Possible values of [[imgwfstor]] are 0 or 1.</span>
<a name="6414"><font size=-1>6414     </font></a><span class="string">If [[imgwfstor]] is 1, the wavefunctions for each image are stored in a big array of</span>
<a name="6415"><font size=-1>6415     </font></a><span class="string">size [[nimage]] more than the storage needed for one set of wavefunctions..</span>
<a name="6416"><font size=-1>6416     </font></a><span class="string">When the specific computation (optimization/SCF cycle ...) for this image is started,</span>
<a name="6417"><font size=-1>6417     </font></a><span class="string">the past wavefunctions are used, to speed up the computation. If [[imgwfstor]]==0,</span>
<a name="6418"><font size=-1>6418     </font></a><span class="string">the wavefunctions are reinitialised, either at random or from the initial wavefunction file (so, without</span>
<a name="6419"><font size=-1>6419     </font></a><span class="string">any modification to take into account the computations at the previous value of itimimage.</span>
<a name="6420"><font size=-1>6420     </font></a><span class="string"></span>
<a name="6421"><font size=-1>6421     </font></a><span class="string">If [[nimage]] is large, the increase of memory need can be problematic, unless the wavefunctions</span>
<a name="6422"><font size=-1>6422     </font></a><span class="string">are spread over many processors, which happens when [[paral_kgb]] == 1.</span>
<a name="6423"><font size=-1>6423     </font></a><span class="string">For some algorithms, e.g. when some geometry optimization</span>
<a name="6424"><font size=-1>6424     </font></a><span class="string">is performed, [[imgmov]]==2 or 5, the gain in speed of choosing [[imgwfstor]]=1 can be quite large, e.g. two to four.</span>
<a name="6425"><font size=-1>6425     </font></a><span class="string">For algorithms of the molecular dynamics type, [[imgmov]]==9 or 13, the expected gain is smaller.</span>
<a name="6426"><font size=-1>6426     </font></a><span class="string">Of course, with adequate memory resources, [[imgwfstor]]==1 should always be preferred.</span>
<a name="6427"><font size=-1>6427     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6428"><font size=-1>6428     </font></a><span class="default">),</span>
<a name="6429"><font size=-1>6429     </font></a><span class="default"></span>
<a name="6430"><font size=-1>6430     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6431"><font size=-1>6431     </font></a><span class="default">    abivarname=</span><span class="string">&quot;inclvkb&quot;</span><span class="default">,</span>
<a name="6432"><font size=-1>6432     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="6433"><font size=-1>6433     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6434"><font size=-1>6434     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'BSE_expert'</span><span class="default">],</span>
<a name="6435"><font size=-1>6435     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6436"><font size=-1>6436     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="6437"><font size=-1>6437     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;INCLude VKB&quot;</span><span class="default">,</span>
<a name="6438"><font size=-1>6438     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,99]&quot;</span><span class="default">,</span>
<a name="6439"><font size=-1>6439     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6440"><font size=-1>6440     </font></a><span class="string">Possible values of [[inclvkb]] are 0,1,2. If [[inclvkb]] is 1 or 2, the</span>
<a name="6441"><font size=-1>6441     </font></a><span class="string">commutator of the non-local part of the pseudopotential with the position</span>
<a name="6442"><font size=-1>6442     </font></a><span class="string">operator is correctly included in the q --&gt; 0 contribution. This is</span>
<a name="6443"><font size=-1>6443     </font></a><span class="string">unfortunately time-consuming and in particular when the old algorithm</span>
<a name="6444"><font size=-1>6444     </font></a><span class="string">implemented by [[inclvkb]] = 1 is used ([[inclvkb]] = 2 is the recommended option). When</span>
<a name="6445"><font size=-1>6445     </font></a><span class="string">[[inclvkb]] is 0, this contribution is incorrectly omitted, but the computation is much faster.</span>
<a name="6446"><font size=-1>6446     </font></a><span class="string"></span>
<a name="6447"><font size=-1>6447     </font></a><span class="string">The importance of this contribution depends on the number of k points. Turning</span>
<a name="6448"><font size=-1>6448     </font></a><span class="string">off [[inclvkb]] is to let to the choice of the user.</span>
<a name="6449"><font size=-1>6449     </font></a><span class="string"></span>
<a name="6450"><font size=-1>6450     </font></a><span class="string">In general, the use of [[inclvkb]] = 0 is fine for GW calculations in</span>
<a name="6451"><font size=-1>6451     </font></a><span class="string">crystalline systems provided that the k-point sampling is sufficiently converged.</span>
<a name="6452"><font size=-1>6452     </font></a><span class="string"></span>
<a name="6453"><font size=-1>6453     </font></a><span class="string">The use of [[inclvkb]] = 2 is strongly recommended for the calculation of optical properties.</span>
<a name="6454"><font size=-1>6454     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6455"><font size=-1>6455     </font></a><span class="default">),</span>
<a name="6456"><font size=-1>6456     </font></a><span class="default"></span>
<a name="6457"><font size=-1>6457     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6458"><font size=-1>6458     </font></a><span class="default">    abivarname=</span><span class="string">&quot;intxc&quot;</span><span class="default">,</span>
<a name="6459"><font size=-1>6459     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="6460"><font size=-1>6460     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6461"><font size=-1>6461     </font></a><span class="default">    topics=[</span><span class="string">'xc_expert'</span><span class="default">],</span>
<a name="6462"><font size=-1>6462     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6463"><font size=-1>6463     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6464"><font size=-1>6464     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;INTerpolation for eXchange-Correlation&quot;</span><span class="default">,</span>
<a name="6465"><font size=-1>6465     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="6466"><font size=-1>6466     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6467"><font size=-1>6467     </font></a><span class="string">  * 0 --&gt; do &quot;usual&quot; xc quadrature on fft grid</span>
<a name="6468"><font size=-1>6468     </font></a><span class="string">  * 1 --&gt; do higher accuracy xc quadrature using fft grid and additional points at the centers of each cube</span>
<a name="6469"><font size=-1>6469     </font></a><span class="string">   (doubles number of grid points)--the high accuracy version is only valid for boxcut&gt;=2. If boxcut &lt; 2, the code stops.</span>
<a name="6470"><font size=-1>6470     </font></a><span class="string"></span>
<a name="6471"><font size=-1>6471     </font></a><span class="string">For RF calculations only [[intxc]] = 0 is allowed yet. Moreover, the GS</span>
<a name="6472"><font size=-1>6472     </font></a><span class="string">preparation runs (giving the density file and zero-order wavefunctions) must</span>
<a name="6473"><font size=-1>6473     </font></a><span class="string">be done with [[intxc]] = 0</span>
<a name="6474"><font size=-1>6474     </font></a><span class="string"></span>
<a name="6475"><font size=-1>6475     </font></a><span class="string">Prior to ABINITv2.3, the choice [[intxc]] = 1 was favoured (it was the default),</span>
<a name="6476"><font size=-1>6476     </font></a><span class="string">but the continuation of the development of the code lead to prefer the default</span>
<a name="6477"><font size=-1>6477     </font></a><span class="string">[[intxc]] = 0. Indeed, the benefit of [[intxc]] = 1 is rather small, while making</span>
<a name="6478"><font size=-1>6478     </font></a><span class="string">it available for all cases is a non-negligible development effort. Other</span>
<a name="6479"><font size=-1>6479     </font></a><span class="string">targets are prioritary... You will notice that many automatic tests use</span>
<a name="6480"><font size=-1>6480     </font></a><span class="string">[[intxc]] = 1. Please, do not follow this historical choice for your production runs.</span>
<a name="6481"><font size=-1>6481     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6482"><font size=-1>6482     </font></a><span class="default">),</span>
<a name="6483"><font size=-1>6483     </font></a><span class="default"></span>
<a name="6484"><font size=-1>6484     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6485"><font size=-1>6485     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iomode&quot;</span><span class="default">,</span>
<a name="6486"><font size=-1>6486     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="6487"><font size=-1>6487     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6488"><font size=-1>6488     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="6489"><font size=-1>6489     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6490"><font size=-1>6490     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[MPI_IO]] and [[paral_kgb]] == 1'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="6491"><font size=-1>6491     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Input-Output MODE&quot;</span><span class="default">,</span>
<a name="6492"><font size=-1>6492     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="6493"><font size=-1>6493     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6494"><font size=-1>6494     </font></a><span class="string">This option selects the format used to produce the output wavefunction files</span>
<a name="6495"><font size=-1>6495     </font></a><span class="string">and the files containing densities and potentials. It mainly affects the</span>
<a name="6496"><font size=-1>6496     </font></a><span class="string">creation of the output files since several parts of Abinit are able to read</span>
<a name="6497"><font size=-1>6497     </font></a><span class="string">data from files independently of their format (either binary files or netcdf</span>
<a name="6498"><font size=-1>6498     </font></a><span class="string">files). The possible values are:</span>
<a name="6499"><font size=-1>6499     </font></a><span class="string"></span>
<a name="6500"><font size=-1>6500     </font></a><span class="string">  * 0 --&gt; Use standard Fortran IO (ok for sequential runs, not suitable for large parallel runs)</span>
<a name="6501"><font size=-1>6501     </font></a><span class="string">  * 1 --&gt; Use MPI/IO routines (ok both for sequential and large parallel runs)</span>
<a name="6502"><font size=-1>6502     </font></a><span class="string">  * 3 --&gt; Use NetCDF library to produce files according to the ETSF specification [[cite:Gonze2008]]</span>
<a name="6503"><font size=-1>6503     </font></a><span class="string">    (ok for sequential, requires netcdf4 + hdf5 + MPI-IO support for large parallel runs)</span>
<a name="6504"><font size=-1>6504     </font></a><span class="string"></span>
<a name="6505"><font size=-1>6505     </font></a><span class="string">By default, Abinit produces Fortran files and uses parallel MPI-IO under the</span>
<a name="6506"><font size=-1>6506     </font></a><span class="string">hood when these operations cannot be implemented in terms of simple Fortran</span>
<a name="6507"><font size=-1>6507     </font></a><span class="string">write/read statements. For example, [[paral_kgb]] = 1 uses the MPI-IO API</span>
<a name="6508"><font size=-1>6508     </font></a><span class="string">provided by your MPI library.</span>
<a name="6509"><font size=-1>6509     </font></a><span class="string"></span>
<a name="6510"><font size=-1>6510     </font></a><span class="string">In a nutshell, use the default value and make sure that your MPI library</span>
<a name="6511"><font size=-1>6511     </font></a><span class="string">supports MPI-IO before embarking yourself in large parallel runs (HAVE_MPI_IO</span>
<a name="6512"><font size=-1>6512     </font></a><span class="string">should be set to 1 in ~abinit/config.h). Many MPI libraries, nowadays, support</span>
<a name="6513"><font size=-1>6513     </font></a><span class="string">the MPI-2 standard so it's very likely that your MPI supports parallel IO. If</span>
<a name="6514"><font size=-1>6514     </font></a><span class="string">you encounter problems, please ask your sysadmin to install a MPI library with MPI-IO capabilities.</span>
<a name="6515"><font size=-1>6515     </font></a><span class="string"></span>
<a name="6516"><font size=-1>6516     </font></a><span class="string">There are cases, however, in which you would like to change the default</span>
<a name="6517"><font size=-1>6517     </font></a><span class="string">behaviour. For example, you may want to generate WFK or DEN files in etsf-io</span>
<a name="6518"><font size=-1>6518     </font></a><span class="string">format because you need data in this format. In this case, you have to use</span>
<a name="6519"><font size=-1>6519     </font></a><span class="string">iomode==3 in the input file to override the default behaviour. Note however</span>
<a name="6520"><font size=-1>6520     </font></a><span class="string">that you still need parallel IO capabilities enabled in the netcdf library if</span>
<a name="6521"><font size=-1>6521     </font></a><span class="string">you want to produce netcdf files in parallel with [[paral_kgb]] = 1 (i.e.</span>
<a name="6522"><font size=-1>6522     </font></a><span class="string">netcdf4 + hdf5 + MPI-IO). At present, the internal fallbacks provided by</span>
<a name="6523"><font size=-1>6523     </font></a><span class="string">Abinit do not support netcdf4 so you have to link against an external netcdf</span>
<a name="6524"><font size=-1>6524     </font></a><span class="string">library that supports hdf5+MPI-IO and is compatible with the mpif90 used to</span>
<a name="6525"><font size=-1>6525     </font></a><span class="string">compile Abinit. See ~abinit/doc/build/config-examples/ubu_gnu_4.9_mpich.ac for a typical configuration file.</span>
<a name="6526"><font size=-1>6526     </font></a><span class="string"></span>
<a name="6527"><font size=-1>6527     </font></a><span class="string">Additional note : The use of the ETSF_IO library [[cite:Caliste2008]] has been disabled, and replaced by direct NetCDF calls.</span>
<a name="6528"><font size=-1>6528     </font></a><span class="string">The ETSF_IO library was indeed not maintained anymore.</span>
<a name="6529"><font size=-1>6529     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6530"><font size=-1>6530     </font></a><span class="default">),</span>
<a name="6531"><font size=-1>6531     </font></a><span class="default"></span>
<a name="6532"><font size=-1>6532     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6533"><font size=-1>6533     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ionmov&quot;</span><span class="default">,</span>
<a name="6534"><font size=-1>6534     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="6535"><font size=-1>6535     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6536"><font size=-1>6536     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_compulsory'</span><span class="default">, </span><span class="string">'GeoOpt_compulsory'</span><span class="default">],</span>
<a name="6537"><font size=-1>6537     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6538"><font size=-1>6538     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6539"><font size=-1>6539     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;IONic MOVEs&quot;</span><span class="default">,</span>
<a name="6540"><font size=-1>6540     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6541"><font size=-1>6541     </font></a><span class="string">Choice of algorithm to control the displacements of ions, and eventually (see</span>
<a name="6542"><font size=-1>6542     </font></a><span class="string">[[optcell]]) changes of cell shape and size.</span>
<a name="6543"><font size=-1>6543     </font></a><span class="string"></span>
<a name="6544"><font size=-1>6544     </font></a><span class="string">  * 0 --&gt; Do not move ions;</span>
<a name="6545"><font size=-1>6545     </font></a><span class="string"></span>
<a name="6546"><font size=-1>6546     </font></a><span class="string">  * 1 --&gt; Move atoms using molecular dynamics with optional viscous damping (friction linearly proportional to velocity). The viscous damping is controlled by the parameter &quot;[[vis]]&quot;. If actual undamped molecular dynamics is desired, set [[vis]] to 0. The implemented algorithm is the generalisation of the Numerov technique (6th order), but is NOT invariant upon time-reversal, so that the energy is not conserved. The value [[ionmov]] = 6 will usually be preferred, although the algorithm that is implemented is lower-order. The time step is governed by [[dtion]].</span>
<a name="6547"><font size=-1>6547     </font></a><span class="string">**Purpose:** Molecular dynamics (if [[vis]] = 0), Structural optimization (if</span>
<a name="6548"><font size=-1>6548     </font></a><span class="string">[[vis]] &gt;0)</span>
<a name="6549"><font size=-1>6549     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6550"><font size=-1>6550     </font></a><span class="string">**Related variables:** Viscous parameter [[vis]], time step [[dtion]], index</span>
<a name="6551"><font size=-1>6551     </font></a><span class="string">of atoms fixed [[iatfix]]</span>
<a name="6552"><font size=-1>6552     </font></a><span class="string"></span>
<a name="6553"><font size=-1>6553     </font></a><span class="string">  * 2 --&gt; Conduct structural optimization using the Broyden-Fletcher-Goldfarb-Shanno minimization (BFGS). This is much more efficient for structural optimization than viscous damping, when there are less than about 10 degrees of freedom to optimize.</span>
<a name="6554"><font size=-1>6554     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6555"><font size=-1>6555     </font></a><span class="string">**Cell optimization:** Yes (if [[optcell]]/=0)</span>
<a name="6556"><font size=-1>6556     </font></a><span class="string">**Related variables:**</span>
<a name="6557"><font size=-1>6557     </font></a><span class="string"></span>
<a name="6558"><font size=-1>6558     </font></a><span class="string">  * 3 --&gt; Conduct structural optimization using the Broyden-Fletcher-Goldfarb-Shanno minimization (BFGS), modified to take into account the total energy as well as the gradients (as in usual BFGS).</span>
<a name="6559"><font size=-1>6559     </font></a><span class="string">See [[cite:Schlegel1982]]. Might be better than [[ionmov]] = 2 for few degrees of freedom (less than 3 or 4). Can be very</span>
<a name="6560"><font size=-1>6560     </font></a><span class="string">unstable - use with caution!</span>
<a name="6561"><font size=-1>6561     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6562"><font size=-1>6562     </font></a><span class="string">**Cell optimization:** Yes (if [[optcell]]/=0)</span>
<a name="6563"><font size=-1>6563     </font></a><span class="string">**Related variables:**</span>
<a name="6564"><font size=-1>6564     </font></a><span class="string"></span>
<a name="6565"><font size=-1>6565     </font></a><span class="string">  * 4 --&gt; Conjugate gradient algorithm for simultaneous optimization of potential and ionic degrees of freedom. It can be used with [[iscf]] = 2 and [[iscf]] =5 or 6 (WARNING: this is under development, and does not work very well in many cases).</span>
<a name="6566"><font size=-1>6566     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6567"><font size=-1>6567     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6568"><font size=-1>6568     </font></a><span class="string">**Related variables:**</span>
<a name="6569"><font size=-1>6569     </font></a><span class="string"></span>
<a name="6570"><font size=-1>6570     </font></a><span class="string">  * 5 --&gt; Simple relaxation of ionic positions according to (converged) forces. Equivalent to [[ionmov]] = 1 with zero masses, albeit the relaxation coefficient is not [[vis]], but [[iprcfc]].</span>
<a name="6571"><font size=-1>6571     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6572"><font size=-1>6572     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6573"><font size=-1>6573     </font></a><span class="string">**Related variables:**</span>
<a name="6574"><font size=-1>6574     </font></a><span class="string"></span>
<a name="6575"><font size=-1>6575     </font></a><span class="string">  * 6 --&gt; Molecular dynamics using the Verlet algorithm, see [[cite:Allen1987a]] p 81]. The only related parameter is the time step ([[dtion]]).</span>
<a name="6576"><font size=-1>6576     </font></a><span class="string">**Purpose:** Molecular dynamics</span>
<a name="6577"><font size=-1>6577     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6578"><font size=-1>6578     </font></a><span class="string">**Related variables:** time step [[dtion]], index of atoms fixed [[iatfix]]</span>
<a name="6579"><font size=-1>6579     </font></a><span class="string"></span>
<a name="6580"><font size=-1>6580     </font></a><span class="string">  * 7 --&gt; Quenched Molecular dynamics using the Verlet algorithm, and stopping each atom for which the scalar product of velocity and force is negative. The only related parameter is the time step ([[dtion]]). The goal is not to produce a realistic dynamics, but to go as fast as possible to the minimum. For this purpose, it is advised to set all the masses to the same value (for example, use the Carbon mass, i.e. set [[amu]] to 12 for all type of atoms).</span>
<a name="6581"><font size=-1>6581     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6582"><font size=-1>6582     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6583"><font size=-1>6583     </font></a><span class="string">**Related variables:** time step [[dtion]], index of atoms fixed [[iatfix]]</span>
<a name="6584"><font size=-1>6584     </font></a><span class="string"></span>
<a name="6585"><font size=-1>6585     </font></a><span class="string">  * 8 --&gt; Molecular dynamics with Nose-Hoover thermostat, using the Verlet algorithm.</span>
<a name="6586"><font size=-1>6586     </font></a><span class="string">**Purpose:** Molecular dynamics</span>
<a name="6587"><font size=-1>6587     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6588"><font size=-1>6588     </font></a><span class="string">**Related variables:** time step ([[dtion]]), Temperatures ([[mdtemp]]), and</span>
<a name="6589"><font size=-1>6589     </font></a><span class="string">thermostat mass ([[noseinert]]).</span>
<a name="6590"><font size=-1>6590     </font></a><span class="string"></span>
<a name="6591"><font size=-1>6591     </font></a><span class="string">  * 9 --&gt; Langevin molecular dynamics.</span>
<a name="6592"><font size=-1>6592     </font></a><span class="string">**Purpose:** Molecular dynamics</span>
<a name="6593"><font size=-1>6593     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6594"><font size=-1>6594     </font></a><span class="string">**Related variables:** time step ([[dtion]]), temperatures ([[mdtemp]]) and</span>
<a name="6595"><font size=-1>6595     </font></a><span class="string">friction coefficient ([[friction]]).</span>
<a name="6596"><font size=-1>6596     </font></a><span class="string"></span>
<a name="6597"><font size=-1>6597     </font></a><span class="string">  * 10 --&gt; Delocalized internal coordinates. with BFGS simple</span>
<a name="6598"><font size=-1>6598     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6599"><font size=-1>6599     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6600"><font size=-1>6600     </font></a><span class="string">**Related variables:**</span>
<a name="6601"><font size=-1>6601     </font></a><span class="string"></span>
<a name="6602"><font size=-1>6602     </font></a><span class="string">  * 11 --&gt; Delocalized internal coordinates. with BFGS using total energy</span>
<a name="6603"><font size=-1>6603     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6604"><font size=-1>6604     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6605"><font size=-1>6605     </font></a><span class="string">**Related variables:**</span>
<a name="6606"><font size=-1>6606     </font></a><span class="string"></span>
<a name="6607"><font size=-1>6607     </font></a><span class="string">  * 12 --&gt; Isokinetic ensemble molecular dynamics.</span>
<a name="6608"><font size=-1>6608     </font></a><span class="string">The equation of motion of the ions in contact with a thermostat are solved with the algorithm proposed in [[cite:Zhang1997]],</span>
<a name="6609"><font size=-1>6609     </font></a><span class="string">as worked out in [cite:Minary2003]].</span>
<a name="6610"><font size=-1>6610     </font></a><span class="string">The conservation of the kinetic energy is obtained within machine precision, at each step.</span>
<a name="6611"><font size=-1>6611     </font></a><span class="string">As in [[cite:Evans1983]], when there is no fixing of atoms, the number of degrees of freedom in which the</span>
<a name="6612"><font size=-1>6612     </font></a><span class="string">microscopic kinetic energy is hosted is 3*natom-4. Indeed, the total kinetic energy is constrained, which accounts for</span>
<a name="6613"><font size=-1>6613     </font></a><span class="string">minus one degree of freedom (also mentioned in [cite:Minary2003]]), but also there are three degrees of freedom</span>
<a name="6614"><font size=-1>6614     </font></a><span class="string">related to the total momentum in each direction, that cannot be counted as microscopic degrees of freedom, since the</span>
<a name="6615"><font size=-1>6615     </font></a><span class="string">total momentum is also preserved (but this is not mentioned in [cite:Minary2003]]). When some atom is fixed in one or more direction,</span>
<a name="6616"><font size=-1>6616     </font></a><span class="string">e.g. using [[natfix]], [[natfixx]], [[natfixy]], or [[natfixz]], the number of degrees of freedom is decreased accordingly,</span>
<a name="6617"><font size=-1>6617     </font></a><span class="string">albeit taking into account that the total momentum is not preserved</span>
<a name="6618"><font size=-1>6618     </font></a><span class="string">anymore (e.g. fixing the position of one atom gives 3*natom-4, like in the non-fixed case).</span>
<a name="6619"><font size=-1>6619     </font></a><span class="string">**Purpose:** Molecular dynamics</span>
<a name="6620"><font size=-1>6620     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6621"><font size=-1>6621     </font></a><span class="string">**Related variables:** time step ([[dtion]]) and the first temperature in [[mdtemp]] in case the velocities [[vel]] are not initialized, or all initialized to zero.</span>
<a name="6622"><font size=-1>6622     </font></a><span class="string"></span>
<a name="6623"><font size=-1>6623     </font></a><span class="string">  * 13 --&gt; Isothermal/isenthalpic ensemble. The equation of motion of the ions in contact with a thermostat and a barostat are solved with the algorithm proposed in [[cite:Martyna1996]].</span>
<a name="6624"><font size=-1>6624     </font></a><span class="string">If optcell=1 or 2, the mass of the barostat ([[bmass]]) must be given in</span>
<a name="6625"><font size=-1>6625     </font></a><span class="string">addition.</span>
<a name="6626"><font size=-1>6626     </font></a><span class="string">**Purpose:** Molecular dynamics</span>
<a name="6627"><font size=-1>6627     </font></a><span class="string">**Cell optimization:** Yes (if [[optcell]]/=0)</span>
<a name="6628"><font size=-1>6628     </font></a><span class="string">**Related variables:** The time step ([[dtion]]), the temperatures</span>
<a name="6629"><font size=-1>6629     </font></a><span class="string">([[mdtemp]]), the number of thermostats ([[nnos]]), and the masses of</span>
<a name="6630"><font size=-1>6630     </font></a><span class="string">thermostats ([[qmass]]).</span>
<a name="6631"><font size=-1>6631     </font></a><span class="string"></span>
<a name="6632"><font size=-1>6632     </font></a><span class="string">  * 14 --&gt; Simple molecular dynamics with a symplectic algorithm proposed in [[cite:Blanes2002]]  (called SRKNa14] of the kind first published in [[cite:Yoshida1990]]This algorithm requires at least 14 evaluation of the forces (actually 15 are done within Abinit) per time step. At this cost it usually gives much better energy conservation than the verlet algorithm ([[ionmov]] 6) for a 30 times bigger value of [[dtion]]. Notice that the potential energy of the initial atomic configuration is never evaluated using this algorithm.</span>
<a name="6633"><font size=-1>6633     </font></a><span class="string">**Purpose:** Molecular dynamics</span>
<a name="6634"><font size=-1>6634     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6635"><font size=-1>6635     </font></a><span class="string">**Related variables:**</span>
<a name="6636"><font size=-1>6636     </font></a><span class="string"></span>
<a name="6637"><font size=-1>6637     </font></a><span class="string">  * 15 --&gt; Fast inertial relaxation engine (FIRE) algorithm proposed by Erik Bitzek, Pekka Koskinen, Franz Ghler, Michael Moseler, and Peter Gumbsch in [[cite:Bitzek2006]]. This efficiency of this method is competible with bfgs. It is based on conventional molecular dynamics with additional velocity modifications and adaptive time steps. The initial time step is set with [[dtion]]. Note that here the physical meaning and unit of dtion are different from the default one. The purpose of this ionmov is for relaxation, not molecular dynamics. It is still the step of moving the ions, but the cellparameters change as well. The positions are in the reduced coordinates instead of in cartesian coordinates. The suggested first guess of dtion is 0.03.</span>
<a name="6638"><font size=-1>6638     </font></a><span class="string">**Purpose:** Relaxation</span>
<a name="6639"><font size=-1>6639     </font></a><span class="string">**Cell optimization:** Yes (if [[optcell]]/=0)</span>
<a name="6640"><font size=-1>6640     </font></a><span class="string">**Related variables:** The initial time step [[dtion]]</span>
<a name="6641"><font size=-1>6641     </font></a><span class="string"></span>
<a name="6642"><font size=-1>6642     </font></a><span class="string">  * 20 --&gt; Direct inversion of the iterative subspace. Given a starting point [[xred]] that is a vector of length 3*[[natom]] (reduced nuclei coordinates), and unit cell parameters ([[rprimd]]) this routine uses the DIIS (direct inversion of the iterative subspace) to minimize the gradient (forces) on atoms. The preconditioning used to compute errors from gradients is using an inverse hessian matrix obtained by a BFGS algorithm. This method is known to converge to the nearest point where gradients vanish. This is efficient to refine positions around a saddle point for instance.</span>
<a name="6643"><font size=-1>6643     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6644"><font size=-1>6644     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6645"><font size=-1>6645     </font></a><span class="string">**Related variables:** DIIS memory [[diismemory]]</span>
<a name="6646"><font size=-1>6646     </font></a><span class="string"></span>
<a name="6647"><font size=-1>6647     </font></a><span class="string">  * 22 --&gt; Conduct structural optimization using the Limited-memory Broyden-Fletcher-Goldfarb-Shanno minimization (L-BFGS). The working routines were based on the original implementation of J. Nocera available on netlib.org. This algorithm can be much better than the native implementation of BFGS in ABINIT ([[ionmov]] = 2) when one approaches convergence, perhaps because of better treatment of numerical details.</span>
<a name="6648"><font size=-1>6648     </font></a><span class="string">**Purpose:** Structural optimization</span>
<a name="6649"><font size=-1>6649     </font></a><span class="string">**Cell optimization:** Yes (if [[optcell]]/=0)</span>
<a name="6650"><font size=-1>6650     </font></a><span class="string">**Related variables:**</span>
<a name="6651"><font size=-1>6651     </font></a><span class="string"></span>
<a name="6652"><font size=-1>6652     </font></a><span class="string">  * 23 --&gt; Use of Learn on The Fly method (LOTF) for Molecular Dynamics. In the framework of isokinetic MD, the atomic forces and positions are computed by using LOTF interpolation. A SCF computation is performed only any [[lotf_nitex]] steps. The results of the SCF are used to compute the parameters of a short range classical potential (for the moment only the glue potential for gold is implemented). Then these parameters are continuously tuned to compute atomic trajectories. LOTF has to be enabled at configure time. If LOTF is not enabled and [[ionmov]] = 23, abinit will set automatically [[ionmov]] = 12.</span>
<a name="6653"><font size=-1>6653     </font></a><span class="string">The LOTF cycle is divided in the following steps:</span>
<a name="6654"><font size=-1>6654     </font></a><span class="string">a) Initialization (SFC at t=0) and computation of potential parameters.</span>
<a name="6655"><font size=-1>6655     </font></a><span class="string">b) Extrapolation of the atomic forces and positions for [[lotf_nitex]] time</span>
<a name="6656"><font size=-1>6656     </font></a><span class="string">step. To perform this extrapolation, the potential computed in a) is used</span>
<a name="6657"><font size=-1>6657     </font></a><span class="string">(Verlet algorithm).</span>
<a name="6658"><font size=-1>6658     </font></a><span class="string">c) SFC at t=[[lotf_nitex]]. Computation of the potential parameters.</span>
<a name="6659"><font size=-1>6659     </font></a><span class="string">d) LOTF interpolation, linear interpolation of the potential parameters and</span>
<a name="6660"><font size=-1>6660     </font></a><span class="string">computation of the atomic forces and positions between t=0 and t=lotf_nitex.</span>
<a name="6661"><font size=-1>6661     </font></a><span class="string"></span>
<a name="6662"><font size=-1>6662     </font></a><span class="string">**Purpose:** Molecular Dynamics</span>
<a name="6663"><font size=-1>6663     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6664"><font size=-1>6664     </font></a><span class="string">**Related variables:** [[dtion]], [[lotf_classic]], [[lotf_nitex]],</span>
<a name="6665"><font size=-1>6665     </font></a><span class="string">[[lotf_nneigx]], [[lotf_version]].</span>
<a name="6666"><font size=-1>6666     </font></a><span class="string"></span>
<a name="6667"><font size=-1>6667     </font></a><span class="string">  * 24 --&gt; Simple constant energy molecular dynamics using the velocity Verlet symplectic algorithm (second order), see [[cite:Hairer2003]]. The only related parameter is the time step ([[dtion]]).</span>
<a name="6668"><font size=-1>6668     </font></a><span class="string">**Purpose:** Molecular dynamics</span>
<a name="6669"><font size=-1>6669     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6670"><font size=-1>6670     </font></a><span class="string">**Related variables:** time step [[dtion]]</span>
<a name="6671"><font size=-1>6671     </font></a><span class="string"></span>
<a name="6672"><font size=-1>6672     </font></a><span class="string">  * 25 --&gt; Hybrid Monte Carlo sampling of the ionic positions at fixed temperature and unit cell geometry (NVT ensemble). The underlying molecular dynamics corresponds to ionmov=24. The related parameters are the time step ([[dtion]]) and thermostat temperature ([[mdtemp]]).</span>
<a name="6673"><font size=-1>6673     </font></a><span class="string">**Purpose:** Monte Carlo sampling</span>
<a name="6674"><font size=-1>6674     </font></a><span class="string">**Cell optimization:** No (Use [[optcell]] = 0 only)</span>
<a name="6675"><font size=-1>6675     </font></a><span class="string">**Related variables:** time step [[dtion]], thermostat temperature [[mdtemp]],</span>
<a name="6676"><font size=-1>6676     </font></a><span class="string"></span>
<a name="6677"><font size=-1>6677     </font></a><span class="string">No meaning for RF calculations.</span>
<a name="6678"><font size=-1>6678     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6679"><font size=-1>6679     </font></a><span class="default">),</span>
<a name="6680"><font size=-1>6680     </font></a><span class="default"></span>
<a name="6681"><font size=-1>6681     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6682"><font size=-1>6682     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iprcel&quot;</span><span class="default">,</span>
<a name="6683"><font size=-1>6683     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="6684"><font size=-1>6684     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6685"><font size=-1>6685     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_expert'</span><span class="default">],</span>
<a name="6686"><font size=-1>6686     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6687"><font size=-1>6687     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6688"><font size=-1>6688     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for PReConditioning of ELectron response&quot;</span><span class="default">,</span>
<a name="6689"><font size=-1>6689     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="6690"><font size=-1>6690     </font></a><span class="string">Used when [[iscf]] &gt; 0, to define the SCF preconditioning scheme. Potential-</span>
<a name="6691"><font size=-1>6691     </font></a><span class="string">based preconditioning schemes for the SCF loop (electronic part) are still a</span>
<a name="6692"><font size=-1>6692     </font></a><span class="string">subject of active research. The present parameter (electronic part) describes</span>
<a name="6693"><font size=-1>6693     </font></a><span class="string">the way the change of potential is derived from the residual.</span>
<a name="6694"><font size=-1>6694     </font></a><span class="string">The possible values of [[iprcel]] correspond to:</span>
<a name="6695"><font size=-1>6695     </font></a><span class="string"></span>
<a name="6696"><font size=-1>6696     </font></a><span class="string">  * 0 --&gt; model dielectric function described by [[diemac]], [[dielng]] and [[diemix]].</span>
<a name="6697"><font size=-1>6697     </font></a><span class="string">  * larger or equal to 21 --&gt; will compute the dielectric matrix according to [[diecut]], [[dielam]], [[diegap]]. This methodology is described in [[cite:Anglade2008]].</span>
<a name="6698"><font size=-1>6698     </font></a><span class="string">  * Between 21 and 29 --&gt; for the first few steps uses the same as option 0 then compute RPA dielectric function, and use it as such.</span>
<a name="6699"><font size=-1>6699     </font></a><span class="string">  * Between 31 and 39 --&gt; for the first few steps uses the same as option 0 then compute RPA dielectric function, and use it, with the mixing factor [[diemix]].</span>
<a name="6700"><font size=-1>6700     </font></a><span class="string">  * Between 41 and 49 --&gt; compute the RPA dielectric matrix at the first step, and recompute it at a later step, and take into account the mixing factor [[diemix]].</span>
<a name="6701"><font size=-1>6701     </font></a><span class="string">  * Between 51 and 59 --&gt; same as between 41 and 49, but compute the RPA dielectric matrix by another mean</span>
<a name="6702"><font size=-1>6702     </font></a><span class="string">  * Between 61 and 69 --&gt; same as between 41 and 49, but compute the electronic dielectric matrix instead of the RPA one.</span>
<a name="6703"><font size=-1>6703     </font></a><span class="string">  * Between 71 and 78 --&gt; STILL UNDER DEVELOPMENT -- NOT USABLE; Use the modified Kerker preconditioner with a real-space formulation (basic formulation is shown at [[dielng]]). The dielectric matrix is approximated thanks to [[diemac]] and [[dielng]]. Note that [[diemix]] is also used.</span>
<a name="6704"><font size=-1>6704     </font></a><span class="string">  * 79 --&gt; STILL UNDER DEVELOPMENT -- NOT USABLE; same as previous but with an alternate algorithm.</span>
<a name="6705"><font size=-1>6705     </font></a><span class="string">  * 141 to 169 --&gt; same as Between 41 and 69 (but, the dielectric matrix is also recomputed every iprcel modulo 10 step).</span>
<a name="6706"><font size=-1>6706     </font></a><span class="string"></span>
<a name="6707"><font size=-1>6707     </font></a><span class="string">The computation of the dielectric matrix (for 0 [100]&lt; [[iprcel]] &lt; 70 [100])</span>
<a name="6708"><font size=-1>6708     </font></a><span class="string">is based on the **extrapolar** approximation, see [[cite:Anglade2008]]. This approximation can be tuned</span>
<a name="6709"><font size=-1>6709     </font></a><span class="string">with [[diecut]], [[dielam]], and [[diegap]]. Yet its accuracy mainly depends</span>
<a name="6710"><font size=-1>6710     </font></a><span class="string">on the number of conduction bands included in the system. Having 2 to 10 empty</span>
<a name="6711"><font size=-1>6711     </font></a><span class="string">bands in the calculation is usually enough (use [[nband]]).</span>
<a name="6712"><font size=-1>6712     </font></a><span class="string"></span>
<a name="6713"><font size=-1>6713     </font></a><span class="string">NOTES:</span>
<a name="6714"><font size=-1>6714     </font></a><span class="string"></span>
<a name="6715"><font size=-1>6715     </font></a><span class="string">  * The step at which the dielectric matrix is computed or recomputed is determined by modulo([[iprcel]],10). The recomputation happens just once in the calculation for [[iprcel]]  &lt; 100.</span>
<a name="6716"><font size=-1>6716     </font></a><span class="string">  * For non-homogeneous relatively large cells [[iprcel]] = 45 will likely give a large improvement over [[iprcel]] = 0.</span>
<a name="6717"><font size=-1>6717     </font></a><span class="string">  * In case of PAW and [[iprcel]] &gt; 0, see [[pawsushat]] input variable. By default, an approximation (which can be suppressed) is done for the computation of susceptibility matrix.</span>
<a name="6718"><font size=-1>6718     </font></a><span class="string">  * For extremely large inhomogeneous cells where computation of the full dielectric matrix takes too many weeks, 70 &lt; [[iprcel]] &lt; 80 is advised.</span>
<a name="6719"><font size=-1>6719     </font></a><span class="string">  * For [[nsppol]] = 2 or [[nspinor]] = 2 with metallic [[occopt]], only **mod(iprcel,100)** &lt;50 is allowed.</span>
<a name="6720"><font size=-1>6720     </font></a><span class="string">  * No meaning for RF calculations yet.</span>
<a name="6721"><font size=-1>6721     </font></a><span class="string">  * The exchange term in the full dielectric matrix diverges for vanishing densities. Therefore the values of [[iprcel]] beyond 60 must not be used for cells containing vacuum, unless ones computes this matrix for every step ([[iprcel]] = 161).</span>
<a name="6722"><font size=-1>6722     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6723"><font size=-1>6723     </font></a><span class="default">),</span>
<a name="6724"><font size=-1>6724     </font></a><span class="default"></span>
<a name="6725"><font size=-1>6725     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6726"><font size=-1>6726     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iprcfc&quot;</span><span class="default">,</span>
<a name="6727"><font size=-1>6727     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="6728"><font size=-1>6728     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6729"><font size=-1>6729     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_useful'</span><span class="default">],</span>
<a name="6730"><font size=-1>6730     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6731"><font size=-1>6731     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6732"><font size=-1>6732     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for PReConditioner of Force Constants&quot;</span><span class="default">,</span>
<a name="6733"><font size=-1>6733     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="6734"><font size=-1>6734     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6735"><font size=-1>6735     </font></a><span class="string">Used when [[iscf]] &gt; 0, to define the SCF preconditioning scheme. Potential-</span>
<a name="6736"><font size=-1>6736     </font></a><span class="string">based preconditioning schemes for the SCF loop are still under development.</span>
<a name="6737"><font size=-1>6737     </font></a><span class="string">The present parameter (force constant part) describes the way a change of</span>
<a name="6738"><font size=-1>6738     </font></a><span class="string">force is derived from a change of atomic position.</span>
<a name="6739"><font size=-1>6739     </font></a><span class="string">Supported values:</span>
<a name="6740"><font size=-1>6740     </font></a><span class="string"></span>
<a name="6741"><font size=-1>6741     </font></a><span class="string">  * 0 --&gt; hessian is the identity matrix</span>
<a name="6742"><font size=-1>6742     </font></a><span class="string">  * 1 --&gt; hessian is 0.5 times the identity matrix</span>
<a name="6743"><font size=-1>6743     </font></a><span class="string">  * 2 --&gt; hessian is 0.25 times the identity matrix</span>
<a name="6744"><font size=-1>6744     </font></a><span class="string">  * -1 --&gt; hessian is twice the identity matrix</span>
<a name="6745"><font size=-1>6745     </font></a><span class="string">  *... (simply corresponding power of 2 times the identity matrix)</span>
<a name="6746"><font size=-1>6746     </font></a><span class="string"></span>
<a name="6747"><font size=-1>6747     </font></a><span class="string">No meaning for RF calculations.</span>
<a name="6748"><font size=-1>6748     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6749"><font size=-1>6749     </font></a><span class="default">),</span>
<a name="6750"><font size=-1>6750     </font></a><span class="default"></span>
<a name="6751"><font size=-1>6751     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6752"><font size=-1>6752     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iqpt&quot;</span><span class="default">,</span>
<a name="6753"><font size=-1>6753     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="6754"><font size=-1>6754     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6755"><font size=-1>6755     </font></a><span class="default">    topics=[</span><span class="string">'q-points_basic'</span><span class="default">],</span>
<a name="6756"><font size=-1>6756     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6757"><font size=-1>6757     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6758"><font size=-1>6758     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Index for QPoinT generation&quot;</span><span class="default">,</span>
<a name="6759"><font size=-1>6759     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="6760"><font size=-1>6760     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6761"><font size=-1>6761     </font></a><span class="string">Only used if [[nqpt]] = 1, and [[qptopt]] = 1 to 4.</span>
<a name="6762"><font size=-1>6762     </font></a><span class="string"></span>
<a name="6763"><font size=-1>6763     </font></a><span class="string">Defines the index of the Q point to be selected in the list of q points</span>
<a name="6764"><font size=-1>6764     </font></a><span class="string">generated by [[ngqpt]], [[qptrlatt]], [[nshiftq]], and [[shiftq]].</span>
<a name="6765"><font size=-1>6765     </font></a><span class="string"></span>
<a name="6766"><font size=-1>6766     </font></a><span class="string">If [[iqpt]] = 0, then the q point is Gamma (0 0 0).</span>
<a name="6767"><font size=-1>6767     </font></a><span class="string"></span>
<a name="6768"><font size=-1>6768     </font></a><span class="string">The usual working mode is to define a series of values for [[iqpt]], starting</span>
<a name="6769"><font size=-1>6769     </font></a><span class="string">with [[iqpt]] = 0 or 1 (so through the definition of **iqpt:** ), and increasing</span>
<a name="6770"><font size=-1>6770     </font></a><span class="string">it by one for each dataset (thanks to **iqpt+** ).</span>
<a name="6771"><font size=-1>6771     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6772"><font size=-1>6772     </font></a><span class="default">),</span>
<a name="6773"><font size=-1>6773     </font></a><span class="default"></span>
<a name="6774"><font size=-1>6774     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6775"><font size=-1>6775     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irandom&quot;</span><span class="default">,</span>
<a name="6776"><font size=-1>6776     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="6777"><font size=-1>6777     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6778"><font size=-1>6778     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_expert'</span><span class="default">],</span>
<a name="6779"><font size=-1>6779     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6780"><font size=-1>6780     </font></a><span class="default">    defaultval=</span><span class="number">3</span><span class="default">,</span>
<a name="6781"><font size=-1>6781     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for the choice of the RANDOM number generator&quot;</span><span class="default">,</span>
<a name="6782"><font size=-1>6782     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="6783"><font size=-1>6783     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6784"><font size=-1>6784     </font></a><span class="string">For the time being, only used when [[imgmov]] = 9 (Langevin Path-Integral Molecular Dynamics).</span>
<a name="6785"><font size=-1>6785     </font></a><span class="string">[[irandom]] defines the random number generator.</span>
<a name="6786"><font size=-1>6786     </font></a><span class="string"></span>
<a name="6787"><font size=-1>6787     </font></a><span class="string">Supported values:</span>
<a name="6788"><font size=-1>6788     </font></a><span class="string"></span>
<a name="6789"><font size=-1>6789     </font></a><span class="string">  * 1 --&gt; &quot;uniformrandom&quot;, delivered with ABINIT package (initially comes from numerical recipes).</span>
<a name="6790"><font size=-1>6790     </font></a><span class="string">  * 2 --&gt; intrinsic Fortran 90 random number generator.</span>
<a name="6791"><font size=-1>6791     </font></a><span class="string">  * 3 --&gt; &quot;ZBQ&quot; non-deterministic random number generator by R. Chandler and P. Northrop.</span>
<a name="6792"><font size=-1>6792     </font></a><span class="string">  [Documentation](http://www.ucl.ac.uk/~ucakarc/work/software/randgen.txt) and</span>
<a name="6793"><font size=-1>6793     </font></a><span class="string">  [Source code](http://www.ucl.ac.uk/~ucakarc/work/software/randgen.f)</span>
<a name="6794"><font size=-1>6794     </font></a><span class="string"></span>
<a name="6795"><font size=-1>6795     </font></a><span class="string">[[irandom]] = 3 is strongly advised when performing Molecular Dynamics restarts (avoids bias).</span>
<a name="6796"><font size=-1>6796     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6797"><font size=-1>6797     </font></a><span class="default">),</span>
<a name="6798"><font size=-1>6798     </font></a><span class="default"></span>
<a name="6799"><font size=-1>6799     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6800"><font size=-1>6800     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ird1den&quot;</span><span class="default">,</span>
<a name="6801"><font size=-1>6801     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6802"><font size=-1>6802     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6803"><font size=-1>6803     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_useful'</span><span class="default">],</span>
<a name="6804"><font size=-1>6804     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6805"><font size=-1>6805     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[iscf]] &lt; 0'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="6806"><font size=-1>6806     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of 1st-order DEN file&quot;</span><span class="default">,</span>
<a name="6807"><font size=-1>6807     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6808"><font size=-1>6808     </font></a><span class="string">If first order density is needed in single dataset mode (for example in</span>
<a name="6809"><font size=-1>6809     </font></a><span class="string">nonlinear optical response), use [[ird1den]] = 1 to read first-order densities</span>
<a name="6810"><font size=-1>6810     </font></a><span class="string">from _DENx files produced in other calculations. In multi-dataset mode use [[get1den]].</span>
<a name="6811"><font size=-1>6811     </font></a><span class="string"></span>
<a name="6812"><font size=-1>6812     </font></a><span class="string">When [[iscf]] &lt; 0, the reading of a DEN file is always enforced.</span>
<a name="6813"><font size=-1>6813     </font></a><span class="string"></span>
<a name="6814"><font size=-1>6814     </font></a><span class="string">A non-zero value of **ird1den** is treated in the same way as other &quot;ird&quot; variables.</span>
<a name="6815"><font size=-1>6815     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="6816"><font size=-1>6816     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6817"><font size=-1>6817     </font></a><span class="default">),</span>
<a name="6818"><font size=-1>6818     </font></a><span class="default"></span>
<a name="6819"><font size=-1>6819     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6820"><font size=-1>6820     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ird1wf&quot;</span><span class="default">,</span>
<a name="6821"><font size=-1>6821     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6822"><font size=-1>6822     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6823"><font size=-1>6823     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_useful'</span><span class="default">],</span>
<a name="6824"><font size=-1>6824     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6825"><font size=-1>6825     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6826"><font size=-1>6826     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of _1WF files&quot;</span><span class="default">,</span>
<a name="6827"><font size=-1>6827     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6828"><font size=-1>6828     </font></a><span class="string">Indicates eventual starting wavefunctions. As alternative, one can use the</span>
<a name="6829"><font size=-1>6829     </font></a><span class="string">input variables [[getwfk]], [[getwfq]], [[get1wf]] or [[getddk]].</span>
<a name="6830"><font size=-1>6830     </font></a><span class="string"></span>
<a name="6831"><font size=-1>6831     </font></a><span class="string">Ground-state calculation:</span>
<a name="6832"><font size=-1>6832     </font></a><span class="string"></span>
<a name="6833"><font size=-1>6833     </font></a><span class="string">  * only **irdwfk** and [[getwfk]] have a meaning</span>
<a name="6834"><font size=-1>6834     </font></a><span class="string">  * at most one of **irdwfk** or [[getwfk]] can be non-zero</span>
<a name="6835"><font size=-1>6835     </font></a><span class="string">  * if **irdwfk** and [[getwfk]] are both zero, initialize wavefunctions with random numbers for ground state calculation.</span>
<a name="6836"><font size=-1>6836     </font></a><span class="string">  * if **irdwfk** = 1: read ground state wavefunctions from a disk file appended with _WFK,</span>
<a name="6837"><font size=-1>6837     </font></a><span class="string">     produced in a previous ground state calculation.</span>
<a name="6838"><font size=-1>6838     </font></a><span class="string"></span>
<a name="6839"><font size=-1>6839     </font></a><span class="string">Response-function calculation:</span>
<a name="6840"><font size=-1>6840     </font></a><span class="string"></span>
<a name="6841"><font size=-1>6841     </font></a><span class="string">  * one and only one of **irdwfk** or [[getwfk]] MUST be non-zero</span>
<a name="6842"><font size=-1>6842     </font></a><span class="string">  * if **irdwfk** = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="6843"><font size=-1>6843     </font></a><span class="string">    produced in a previous ground state calculation.</span>
<a name="6844"><font size=-1>6844     </font></a><span class="string">  * only one of **irdwfq** or [[getwfq]] can be non-zero, if both of them are non-zero,</span>
<a name="6845"><font size=-1>6845     </font></a><span class="string">     use as k + q file the one defined by **irdwfk** and/or [[getwfk]]</span>
<a name="6846"><font size=-1>6846     </font></a><span class="string">  * if **irdwfq** = 1: read ground state k+q -wavefunctions from a disk file appended with _WFQ,</span>
<a name="6847"><font size=-1>6847     </font></a><span class="string">    produced in a previous ground state calculation.</span>
<a name="6848"><font size=-1>6848     </font></a><span class="string">  * at most one of [[ird1wf]] or [[get1wf]] can be non-zero</span>
<a name="6849"><font size=-1>6849     </font></a><span class="string">  * if both are zero, initialize first order wavefunctions to zeroes</span>
<a name="6850"><font size=-1>6850     </font></a><span class="string">  * if [[ird1wf]] = 1: read first-order wavefunctions from a disk file appended with _1WFx,</span>
<a name="6851"><font size=-1>6851     </font></a><span class="string">    produced in a previous response function calculation.</span>
<a name="6852"><font size=-1>6852     </font></a><span class="string">  * at most one of **irdddk** or [[getddk]] can be non-zero</span>
<a name="6853"><font size=-1>6853     </font></a><span class="string">  * one of them must be non-zero if an homogeneous electric field calculation is done</span>
<a name="6854"><font size=-1>6854     </font></a><span class="string">     (presently, a ddk calculation in the same dataset is not allowed)</span>
<a name="6855"><font size=-1>6855     </font></a><span class="string">  * if **irdddk** = 1: read first-order ddk wavefunctions from a disk file appended with _1WFx,</span>
<a name="6856"><font size=-1>6856     </font></a><span class="string">    produced in a previous response function calculation.</span>
<a name="6857"><font size=-1>6857     </font></a><span class="string"></span>
<a name="6858"><font size=-1>6858     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="6859"><font size=-1>6859     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6860"><font size=-1>6860     </font></a><span class="default">),</span>
<a name="6861"><font size=-1>6861     </font></a><span class="default"></span>
<a name="6862"><font size=-1>6862     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6863"><font size=-1>6863     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdbscoup&quot;</span><span class="default">,</span>
<a name="6864"><font size=-1>6864     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6865"><font size=-1>6865     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6866"><font size=-1>6866     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="6867"><font size=-1>6867     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6868"><font size=-1>6868     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6869"><font size=-1>6869     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of COUPling block&quot;</span><span class="default">,</span>
<a name="6870"><font size=-1>6870     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6871"><font size=-1>6871     </font></a><span class="string">Start the Bethe-Salpeter calculation from the BSC file containing the coupling block produced in a previous run.</span>
<a name="6872"><font size=-1>6872     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6873"><font size=-1>6873     </font></a><span class="default">),</span>
<a name="6874"><font size=-1>6874     </font></a><span class="default"></span>
<a name="6875"><font size=-1>6875     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6876"><font size=-1>6876     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdbseig&quot;</span><span class="default">,</span>
<a name="6877"><font size=-1>6877     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6878"><font size=-1>6878     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6879"><font size=-1>6879     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="6880"><font size=-1>6880     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6881"><font size=-1>6881     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6882"><font size=-1>6882     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of BS_EIG file&quot;</span><span class="default">,</span>
<a name="6883"><font size=-1>6883     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6884"><font size=-1>6884     </font></a><span class="string">Start the Bethe-Salpeter calculation from the BS_EIG containing the exciton eigenvectors produced in a previous run.</span>
<a name="6885"><font size=-1>6885     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6886"><font size=-1>6886     </font></a><span class="default">),</span>
<a name="6887"><font size=-1>6887     </font></a><span class="default"></span>
<a name="6888"><font size=-1>6888     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6889"><font size=-1>6889     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdbsreso&quot;</span><span class="default">,</span>
<a name="6890"><font size=-1>6890     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6891"><font size=-1>6891     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6892"><font size=-1>6892     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="6893"><font size=-1>6893     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6894"><font size=-1>6894     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6895"><font size=-1>6895     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of RESOnant block&quot;</span><span class="default">,</span>
<a name="6896"><font size=-1>6896     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6897"><font size=-1>6897     </font></a><span class="string">Start the Bethe-Salpeter calculation from the BSR file containing the resonant</span>
<a name="6898"><font size=-1>6898     </font></a><span class="string">block produced in a previous run.</span>
<a name="6899"><font size=-1>6899     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6900"><font size=-1>6900     </font></a><span class="default">),</span>
<a name="6901"><font size=-1>6901     </font></a><span class="default"></span>
<a name="6902"><font size=-1>6902     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6903"><font size=-1>6903     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdddb&quot;</span><span class="default">,</span>
<a name="6904"><font size=-1>6904     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6905"><font size=-1>6905     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6906"><font size=-1>6906     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_useful'</span><span class="default">],</span>
<a name="6907"><font size=-1>6907     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6908"><font size=-1>6908     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[iscf]] &lt; 0'</span><span class="default">: </span><span class="string">'1'</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="6909"><font size=-1>6909     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of DDB file&quot;</span><span class="default">,</span>
<a name="6910"><font size=-1>6910     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6911"><font size=-1>6911     </font></a><span class="string">This variable should be used when performing electron-phonon or temperature-</span>
<a name="6912"><font size=-1>6912     </font></a><span class="string">dependence calculations. The Born effective charge as well as the dielectric</span>
<a name="6913"><font size=-1>6913     </font></a><span class="string">tensor will be read from a previous DFPT calculations of the electric field at</span>
<a name="6914"><font size=-1>6914     </font></a><span class="string">q=Gamma. The use of this variable will trigger the cancellation of a residual</span>
<a name="6915"><font size=-1>6915     </font></a><span class="string">dipole that leads to an unphysical divergence of the GKK with vanishing</span>
<a name="6916"><font size=-1>6916     </font></a><span class="string">q-points. The use of this variable greatly improves the k-point convergence</span>
<a name="6917"><font size=-1>6917     </font></a><span class="string">speed as the density of the k-point grid required to obtain the fulfillment of</span>
<a name="6918"><font size=-1>6918     </font></a><span class="string">the charge neutrality sum rule is usually prohibitively large.</span>
<a name="6919"><font size=-1>6919     </font></a><span class="string"></span>
<a name="6920"><font size=-1>6920     </font></a><span class="string">A non-zero value of [[irdddb]] is treated in the same way as other &quot;ird&quot; variables.</span>
<a name="6921"><font size=-1>6921     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="6922"><font size=-1>6922     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6923"><font size=-1>6923     </font></a><span class="default">),</span>
<a name="6924"><font size=-1>6924     </font></a><span class="default"></span>
<a name="6925"><font size=-1>6925     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6926"><font size=-1>6926     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdddk&quot;</span><span class="default">,</span>
<a name="6927"><font size=-1>6927     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6928"><font size=-1>6928     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6929"><font size=-1>6929     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_useful'</span><span class="default">],</span>
<a name="6930"><font size=-1>6930     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6931"><font size=-1>6931     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6932"><font size=-1>6932     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of DDK wavefunctions, in _1WF files&quot;</span><span class="default">,</span>
<a name="6933"><font size=-1>6933     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6934"><font size=-1>6934     </font></a><span class="string">Indicates eventual starting wavefunctions. As alternative, one can use the</span>
<a name="6935"><font size=-1>6935     </font></a><span class="string">input variables [[getwfk]], [[getwfq]], [[get1wf]] or [[getddk]].</span>
<a name="6936"><font size=-1>6936     </font></a><span class="string"></span>
<a name="6937"><font size=-1>6937     </font></a><span class="string">Ground-state calculation:</span>
<a name="6938"><font size=-1>6938     </font></a><span class="string"></span>
<a name="6939"><font size=-1>6939     </font></a><span class="string">  * only **irdwfk** and [[getwfk]] have a meaning</span>
<a name="6940"><font size=-1>6940     </font></a><span class="string">  * at most one of **irdwfk** or [[getwfk]] can be non-zero</span>
<a name="6941"><font size=-1>6941     </font></a><span class="string">  * if **irdwfk** and [[getwfk]] are both zero, initialize wavefunctions with random numbers for ground state calculation.</span>
<a name="6942"><font size=-1>6942     </font></a><span class="string">  * if **irdwfk** = 1: read ground state wavefunctions from a disk file appended with _WFK,</span>
<a name="6943"><font size=-1>6943     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="6944"><font size=-1>6944     </font></a><span class="string"></span>
<a name="6945"><font size=-1>6945     </font></a><span class="string">Response-function calculation:</span>
<a name="6946"><font size=-1>6946     </font></a><span class="string"></span>
<a name="6947"><font size=-1>6947     </font></a><span class="string">  * one and only one of **irdwfk** or [[getwfk]] MUST be non-zero</span>
<a name="6948"><font size=-1>6948     </font></a><span class="string">  * if **irdwfk** = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="6949"><font size=-1>6949     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="6950"><font size=-1>6950     </font></a><span class="string">  * only one of **irdwfq** or [[getwfq]] can be non-zero, if both of them are non-zero,</span>
<a name="6951"><font size=-1>6951     </font></a><span class="string">    use as k + q file the one defined by **irdwfk** and/or [[getwfk]]</span>
<a name="6952"><font size=-1>6952     </font></a><span class="string">  * if **irdwfq** = 1: read ground state k+q -wavefunctions from a disk file appended with _WFQ,</span>
<a name="6953"><font size=-1>6953     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="6954"><font size=-1>6954     </font></a><span class="string">  * at most one of **ird1wf** or [[get1wf]] can be non-zero</span>
<a name="6955"><font size=-1>6955     </font></a><span class="string">  * if both are zero, initialize first order wavefunctions to zeroes</span>
<a name="6956"><font size=-1>6956     </font></a><span class="string">  * if **ird1wf** = 1: read first-order wavefunctions from a disk file appended with _1WFx,</span>
<a name="6957"><font size=-1>6957     </font></a><span class="string">    produced in a previous response function calculation</span>
<a name="6958"><font size=-1>6958     </font></a><span class="string">  * at most one of [[irdddk]] or [[getddk]] can be non-zero</span>
<a name="6959"><font size=-1>6959     </font></a><span class="string">  * one of them must be non-zero if an homogeneous electric field calculation is done (presently,</span>
<a name="6960"><font size=-1>6960     </font></a><span class="string">    a ddk calculation in the same dataset is not allowed)</span>
<a name="6961"><font size=-1>6961     </font></a><span class="string">  * if [[irdddk]] = 1: read first-order ddk wavefunctions from a disk file appended with _1WFx,</span>
<a name="6962"><font size=-1>6962     </font></a><span class="string">    produced in a previous response function calculation</span>
<a name="6963"><font size=-1>6963     </font></a><span class="string"></span>
<a name="6964"><font size=-1>6964     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="6965"><font size=-1>6965     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6966"><font size=-1>6966     </font></a><span class="default">),</span>
<a name="6967"><font size=-1>6967     </font></a><span class="default"></span>
<a name="6968"><font size=-1>6968     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6969"><font size=-1>6969     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdden&quot;</span><span class="default">,</span>
<a name="6970"><font size=-1>6970     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6971"><font size=-1>6971     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6972"><font size=-1>6972     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="6973"><font size=-1>6973     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6974"><font size=-1>6974     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[iscf]] &lt; 0'</span><span class="default">: </span><span class="string">'1'</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="6975"><font size=-1>6975     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of DEN file&quot;</span><span class="default">,</span>
<a name="6976"><font size=-1>6976     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6977"><font size=-1>6977     </font></a><span class="string">Start the ground-state calculation from the density file of a previous run.</span>
<a name="6978"><font size=-1>6978     </font></a><span class="string">When [[iscf]] &lt; 0, the reading of a DEN file is always enforced.</span>
<a name="6979"><font size=-1>6979     </font></a><span class="string"></span>
<a name="6980"><font size=-1>6980     </font></a><span class="string">A non-zero value of [[irdden]] is treated in the same way as other &quot;ird&quot; variables.</span>
<a name="6981"><font size=-1>6981     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="6982"><font size=-1>6982     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6983"><font size=-1>6983     </font></a><span class="default">),</span>
<a name="6984"><font size=-1>6984     </font></a><span class="default"></span>
<a name="6985"><font size=-1>6985     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6986"><font size=-1>6986     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdhaydock&quot;</span><span class="default">,</span>
<a name="6987"><font size=-1>6987     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="6988"><font size=-1>6988     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="6989"><font size=-1>6989     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="6990"><font size=-1>6990     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="6991"><font size=-1>6991     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="6992"><font size=-1>6992     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of the HAYDOCK restart file&quot;</span><span class="default">,</span>
<a name="6993"><font size=-1>6993     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="6994"><font size=-1>6994     </font></a><span class="string">Used to re-start the Haydock iterative technique from the HAYDR_SAVE file produced in a previous run.</span>
<a name="6995"><font size=-1>6995     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="6996"><font size=-1>6996     </font></a><span class="default">),</span>
<a name="6997"><font size=-1>6997     </font></a><span class="default"></span>
<a name="6998"><font size=-1>6998     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="6999"><font size=-1>6999     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdqps&quot;</span><span class="default">,</span>
<a name="7000"><font size=-1>7000     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="7001"><font size=-1>7001     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7002"><font size=-1>7002     </font></a><span class="default">    topics=[</span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'Susceptibility_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="7003"><font size=-1>7003     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7004"><font size=-1>7004     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7005"><font size=-1>7005     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of QuasiParticle Structure&quot;</span><span class="default">,</span>
<a name="7006"><font size=-1>7006     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7007"><font size=-1>7007     </font></a><span class="string">Relevant only when [[optdriver]] = 3 or 4. Indicate the file from which the</span>
<a name="7008"><font size=-1>7008     </font></a><span class="string">eigenvalues and possibly the wavefunctions must be obtained, in order to</span>
<a name="7009"><font size=-1>7009     </font></a><span class="string">achieve a self-consistent quasiparticle calculations. See also [[getqps]]</span>
<a name="7010"><font size=-1>7010     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7011"><font size=-1>7011     </font></a><span class="default">),</span>
<a name="7012"><font size=-1>7012     </font></a><span class="default"></span>
<a name="7013"><font size=-1>7013     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7014"><font size=-1>7014     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdscr&quot;</span><span class="default">,</span>
<a name="7015"><font size=-1>7015     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="7016"><font size=-1>7016     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7017"><font size=-1>7017     </font></a><span class="default">    topics=[</span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="7018"><font size=-1>7018     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7019"><font size=-1>7019     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7020"><font size=-1>7020     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of the SCReening&quot;</span><span class="default">,</span>
<a name="7021"><font size=-1>7021     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7022"><font size=-1>7022     </font></a><span class="string">Relevant only when [[optdriver]] = 4. Indicate the file from which the</span>
<a name="7023"><font size=-1>7023     </font></a><span class="string">dielectric matrix must be obtained. As alternative, one can use the input variable [[getscr]].</span>
<a name="7024"><font size=-1>7024     </font></a><span class="string">When [[optdriver]] = 4, at least one of [[irdscr]] or [[getscr]] (alternatively,</span>
<a name="7025"><font size=-1>7025     </font></a><span class="string">[[irdsuscep]] or [[getsuscep]]) must be non-zero.</span>
<a name="7026"><font size=-1>7026     </font></a><span class="string"></span>
<a name="7027"><font size=-1>7027     </font></a><span class="string">A non-zero value of [[irdscr]] is treated in the same way as other &quot;ird&quot; variables.</span>
<a name="7028"><font size=-1>7028     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="7029"><font size=-1>7029     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7030"><font size=-1>7030     </font></a><span class="default">),</span>
<a name="7031"><font size=-1>7031     </font></a><span class="default"></span>
<a name="7032"><font size=-1>7032     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7033"><font size=-1>7033     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdsuscep&quot;</span><span class="default">,</span>
<a name="7034"><font size=-1>7034     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="7035"><font size=-1>7035     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7036"><font size=-1>7036     </font></a><span class="default">    topics=[</span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="7037"><font size=-1>7037     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7038"><font size=-1>7038     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7039"><font size=-1>7039     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of the SUSCEPtibility&quot;</span><span class="default">,</span>
<a name="7040"><font size=-1>7040     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7041"><font size=-1>7041     </font></a><span class="string">Relevant only when [[optdriver]] = 4. Indicate the file from which the</span>
<a name="7042"><font size=-1>7042     </font></a><span class="string">irreducible polarizability must be obtained.</span>
<a name="7043"><font size=-1>7043     </font></a><span class="string">As alternative, one can use the input variable [[getsuscep]].</span>
<a name="7044"><font size=-1>7044     </font></a><span class="string">When [[optdriver]] = 4, at least one of [[irdsuscep]] or [[getsuscep]]</span>
<a name="7045"><font size=-1>7045     </font></a><span class="string">(alternatively, [[irdscr]] or [[getscr]]) must be non-zero.</span>
<a name="7046"><font size=-1>7046     </font></a><span class="string"></span>
<a name="7047"><font size=-1>7047     </font></a><span class="string">A non-zero value of [[irdsuscep]] is treated in the same way as other &quot;ird&quot; variables.</span>
<a name="7048"><font size=-1>7048     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="7049"><font size=-1>7049     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7050"><font size=-1>7050     </font></a><span class="default">),</span>
<a name="7051"><font size=-1>7051     </font></a><span class="default"></span>
<a name="7052"><font size=-1>7052     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7053"><font size=-1>7053     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdvdw&quot;</span><span class="default">,</span>
<a name="7054"><font size=-1>7054     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="7055"><font size=-1>7055     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7056"><font size=-1>7056     </font></a><span class="default">    topics=[</span><span class="string">'vdw_useful'</span><span class="default">],</span>
<a name="7057"><font size=-1>7057     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7058"><font size=-1>7058     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7059"><font size=-1>7059     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of _VDW files&quot;</span><span class="default">,</span>
<a name="7060"><font size=-1>7060     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="7061"><font size=-1>7061     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7062"><font size=-1>7062     </font></a><span class="string">Used when [[vdw_xc]] &gt; 0, to read previously calculated vdW-DF variables.</span>
<a name="7063"><font size=-1>7063     </font></a><span class="string">Supported values:</span>
<a name="7064"><font size=-1>7064     </font></a><span class="string"></span>
<a name="7065"><font size=-1>7065     </font></a><span class="string">  * 0: do not read vdW-DF variables</span>
<a name="7066"><font size=-1>7066     </font></a><span class="string">  * 1: read vdW-DF variables</span>
<a name="7067"><font size=-1>7067     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7068"><font size=-1>7068     </font></a><span class="default">),</span>
<a name="7069"><font size=-1>7069     </font></a><span class="default"></span>
<a name="7070"><font size=-1>7070     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7071"><font size=-1>7071     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdwfk&quot;</span><span class="default">,</span>
<a name="7072"><font size=-1>7072     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="7073"><font size=-1>7073     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7074"><font size=-1>7074     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">],</span>
<a name="7075"><font size=-1>7075     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7076"><font size=-1>7076     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7077"><font size=-1>7077     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of _WFK files&quot;</span><span class="default">,</span>
<a name="7078"><font size=-1>7078     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7079"><font size=-1>7079     </font></a><span class="string">Indicates eventual starting wavefunctions. As alternative, one can use the</span>
<a name="7080"><font size=-1>7080     </font></a><span class="string">input variables [[getwfk]], [[getwfq]], [[get1wf]] or [[getddk]].</span>
<a name="7081"><font size=-1>7081     </font></a><span class="string"></span>
<a name="7082"><font size=-1>7082     </font></a><span class="string">Ground-state calculation:</span>
<a name="7083"><font size=-1>7083     </font></a><span class="string"></span>
<a name="7084"><font size=-1>7084     </font></a><span class="string">  * only [[irdwfk]] and [[getwfk]] have a meaning</span>
<a name="7085"><font size=-1>7085     </font></a><span class="string">  * at most one of [[irdwfk]] or [[getwfk]] can be non-zero</span>
<a name="7086"><font size=-1>7086     </font></a><span class="string">  * if [[irdwfk]] and [[getwfk]] are both zero, initialize wavefunctions with random numbers for ground state calculation.</span>
<a name="7087"><font size=-1>7087     </font></a><span class="string">  * if [[irdwfk]] = 1: read ground state wavefunctions from a disk file appended with _WFK,</span>
<a name="7088"><font size=-1>7088     </font></a><span class="string">    produced in a previous ground state calculation.</span>
<a name="7089"><font size=-1>7089     </font></a><span class="string"></span>
<a name="7090"><font size=-1>7090     </font></a><span class="string">Response-function calculation:</span>
<a name="7091"><font size=-1>7091     </font></a><span class="string"></span>
<a name="7092"><font size=-1>7092     </font></a><span class="string">  * one and only one of [[irdwfk]] or [[getwfk]] MUST be non-zero</span>
<a name="7093"><font size=-1>7093     </font></a><span class="string">  * if [[irdwfk]] = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="7094"><font size=-1>7094     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="7095"><font size=-1>7095     </font></a><span class="string">  * only one of **irdwfq** or [[getwfq]] can be non-zero, if both of them are non-zero,</span>
<a name="7096"><font size=-1>7096     </font></a><span class="string">     use as k + q file the one defined by [[irdwfk]] and/or [[getwfk]]</span>
<a name="7097"><font size=-1>7097     </font></a><span class="string">  * if **irdwfq** = 1: read ground state k+q -wavefunctions from a disk file appended with _WFQ,</span>
<a name="7098"><font size=-1>7098     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="7099"><font size=-1>7099     </font></a><span class="string">  * at most one of **ird1wf** or [[get1wf]] can be non-zero</span>
<a name="7100"><font size=-1>7100     </font></a><span class="string">  * if both are zero, initialize first order wavefunctions to 0's.</span>
<a name="7101"><font size=-1>7101     </font></a><span class="string">  * if **ird1wf** = 1: read first-order wavefunctions from a disk file appended with _1WFx,</span>
<a name="7102"><font size=-1>7102     </font></a><span class="string">    produced in a previous response function calculation</span>
<a name="7103"><font size=-1>7103     </font></a><span class="string">  * at most one of **irdddk** or [[getddk]] can be non-zero</span>
<a name="7104"><font size=-1>7104     </font></a><span class="string">  * one of them must be non-zero if an homogeneous electric field calculation is done</span>
<a name="7105"><font size=-1>7105     </font></a><span class="string">    (presently, a ddk calculation in the same dataset is not allowed)</span>
<a name="7106"><font size=-1>7106     </font></a><span class="string">  * if **irdddk** = 1: read first-order ddk wavefunctions from a disk file appended with _1WFx,</span>
<a name="7107"><font size=-1>7107     </font></a><span class="string">    produced in a previous response function calculation</span>
<a name="7108"><font size=-1>7108     </font></a><span class="string"></span>
<a name="7109"><font size=-1>7109     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="7110"><font size=-1>7110     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7111"><font size=-1>7111     </font></a><span class="default">),</span>
<a name="7112"><font size=-1>7112     </font></a><span class="default"></span>
<a name="7113"><font size=-1>7113     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7114"><font size=-1>7114     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdwfkfine&quot;</span><span class="default">,</span>
<a name="7115"><font size=-1>7115     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="7116"><font size=-1>7116     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7117"><font size=-1>7117     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_useful'</span><span class="default">, </span><span class="string">'TDepES_useful'</span><span class="default">],</span>
<a name="7118"><font size=-1>7118     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7119"><font size=-1>7119     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7120"><font size=-1>7120     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of the grid _WFK file on the FINE grid&quot;</span><span class="default">,</span>
<a name="7121"><font size=-1>7121     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7122"><font size=-1>7122     </font></a><span class="string">Indicates eventual starting wavefunctions. As alternative, one can use the input variables [[getwfkfine]].</span>
<a name="7123"><font size=-1>7123     </font></a><span class="string"></span>
<a name="7124"><font size=-1>7124     </font></a><span class="string">Ground-state calculation:</span>
<a name="7125"><font size=-1>7125     </font></a><span class="string"></span>
<a name="7126"><font size=-1>7126     </font></a><span class="string">  * only [[irdwfkfine]] and [[getwfkfine]] have a meaning</span>
<a name="7127"><font size=-1>7127     </font></a><span class="string">  * at most one of [[irdwfkfine]] or [[getwfkfine]] can be non-zero</span>
<a name="7128"><font size=-1>7128     </font></a><span class="string">  * if [[irdwfkfine]] = 1: read ground state wavefunctions from a disk file appended with _WFK,</span>
<a name="7129"><font size=-1>7129     </font></a><span class="string">    produced in a previous ground state fine grid calculation</span>
<a name="7130"><font size=-1>7130     </font></a><span class="string"></span>
<a name="7131"><font size=-1>7131     </font></a><span class="string">Response-function calculation:</span>
<a name="7132"><font size=-1>7132     </font></a><span class="string"></span>
<a name="7133"><font size=-1>7133     </font></a><span class="string">  * one and only one of [[irdwfkfine]] or [[getwfkfine]] MUST be non-zero</span>
<a name="7134"><font size=-1>7134     </font></a><span class="string">  * if [[irdwfkfine]] = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="7135"><font size=-1>7135     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="7136"><font size=-1>7136     </font></a><span class="string">  * Reading the fine grid wavefunction will trigger the k-points interpolation technique of the temperature dependent calculations.</span>
<a name="7137"><font size=-1>7137     </font></a><span class="string"></span>
<a name="7138"><font size=-1>7138     </font></a><span class="string">Bethe-Salpeter calculation:</span>
<a name="7139"><font size=-1>7139     </font></a><span class="string"></span>
<a name="7140"><font size=-1>7140     </font></a><span class="string">  * one and only one of [[irdwfkfine]] or [[getwfkfine]] MUST be non-zero</span>
<a name="7141"><font size=-1>7141     </font></a><span class="string">  * if [[irdwfkfine]] = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="7142"><font size=-1>7142     </font></a><span class="string">     produced in a previous ground state calculation</span>
<a name="7143"><font size=-1>7143     </font></a><span class="string">  * This variable or [[getwfkfine]] is mandatory when [[bs_interp_mode]] = 1</span>
<a name="7144"><font size=-1>7144     </font></a><span class="string"></span>
<a name="7145"><font size=-1>7145     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="7146"><font size=-1>7146     </font></a><span class="string"></span>
<a name="7147"><font size=-1>7147     </font></a><span class="string">**This variable is experimental. In development.**</span>
<a name="7148"><font size=-1>7148     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7149"><font size=-1>7149     </font></a><span class="default">),</span>
<a name="7150"><font size=-1>7150     </font></a><span class="default"></span>
<a name="7151"><font size=-1>7151     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7152"><font size=-1>7152     </font></a><span class="default">    abivarname=</span><span class="string">&quot;irdwfq&quot;</span><span class="default">,</span>
<a name="7153"><font size=-1>7153     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="7154"><font size=-1>7154     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7155"><font size=-1>7155     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_useful'</span><span class="default">],</span>
<a name="7156"><font size=-1>7156     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7157"><font size=-1>7157     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7158"><font size=-1>7158     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer that governs the ReaDing of _WFQ files&quot;</span><span class="default">,</span>
<a name="7159"><font size=-1>7159     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7160"><font size=-1>7160     </font></a><span class="string">Indicates eventual starting wavefunctions. As alternative, one can use the</span>
<a name="7161"><font size=-1>7161     </font></a><span class="string">input variables [[getwfk]], [[getwfq]], [[get1wf]] or [[getddk]].</span>
<a name="7162"><font size=-1>7162     </font></a><span class="string"></span>
<a name="7163"><font size=-1>7163     </font></a><span class="string">Ground-state calculation:</span>
<a name="7164"><font size=-1>7164     </font></a><span class="string"></span>
<a name="7165"><font size=-1>7165     </font></a><span class="string">  * only **irdwfk** and [[getwfk]] have a meaning</span>
<a name="7166"><font size=-1>7166     </font></a><span class="string">  * at most one of **irdwfk** or [[getwfk]] can be non-zero</span>
<a name="7167"><font size=-1>7167     </font></a><span class="string">  * if **irdwfk** and [[getwfk]] are both zero, initialize wavefunctions with random numbers for ground state calculation.</span>
<a name="7168"><font size=-1>7168     </font></a><span class="string">  * if **irdwfk** = 1: read ground state wavefunctions from a disk file appended with _WFK,</span>
<a name="7169"><font size=-1>7169     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="7170"><font size=-1>7170     </font></a><span class="string"></span>
<a name="7171"><font size=-1>7171     </font></a><span class="string">Response-function calculation:</span>
<a name="7172"><font size=-1>7172     </font></a><span class="string"></span>
<a name="7173"><font size=-1>7173     </font></a><span class="string">  * one and only one of **irdwfk** or [[getwfk]] MUST be non-zero</span>
<a name="7174"><font size=-1>7174     </font></a><span class="string">  * if **irdwfk** = 1: read ground state k -wavefunctions from a disk file appended with _WFK,</span>
<a name="7175"><font size=-1>7175     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="7176"><font size=-1>7176     </font></a><span class="string">  * only one of [[irdwfq]] or [[getwfq]] can be non-zero, if both of them are non-zero,</span>
<a name="7177"><font size=-1>7177     </font></a><span class="string">    use as k + q file the one defined by **irdwfk** and/or [[getwfk]]</span>
<a name="7178"><font size=-1>7178     </font></a><span class="string">  * if [[irdwfq]] = 1: read ground state k+q -wavefunctions from a disk file appended with _WFQ,</span>
<a name="7179"><font size=-1>7179     </font></a><span class="string">    produced in a previous ground state calculation</span>
<a name="7180"><font size=-1>7180     </font></a><span class="string">  * at most one of **ird1wf** or [[get1wf]] can be non-zero</span>
<a name="7181"><font size=-1>7181     </font></a><span class="string">  * if both are zero, initialize first order wavefunctions to 0's.</span>
<a name="7182"><font size=-1>7182     </font></a><span class="string">  * if **ird1wf** = 1: read first-order wavefunctions from a disk file appended with _1WFx,</span>
<a name="7183"><font size=-1>7183     </font></a><span class="string">    produced in a previous response function calculation</span>
<a name="7184"><font size=-1>7184     </font></a><span class="string">  * at most one of **irdddk** or [[getddk]] can be non-zero</span>
<a name="7185"><font size=-1>7185     </font></a><span class="string">  * one of them must be non-zero if an homogeneous electric field calculation is done (presently,</span>
<a name="7186"><font size=-1>7186     </font></a><span class="string">    a ddk calculation in the same dataset is not allowed)</span>
<a name="7187"><font size=-1>7187     </font></a><span class="string">  * if **irdddk** = 1: read first-order ddk wavefunctions from a disk file appended with _1WFx,</span>
<a name="7188"><font size=-1>7188     </font></a><span class="string">    produced in a previous response function calculation</span>
<a name="7189"><font size=-1>7189     </font></a><span class="string"></span>
<a name="7190"><font size=-1>7190     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="7191"><font size=-1>7191     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7192"><font size=-1>7192     </font></a><span class="default">),</span>
<a name="7193"><font size=-1>7193     </font></a><span class="default"></span>
<a name="7194"><font size=-1>7194     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7195"><font size=-1>7195     </font></a><span class="default">    abivarname=</span><span class="string">&quot;iscf&quot;</span><span class="default">,</span>
<a name="7196"><font size=-1>7196     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="7197"><font size=-1>7197     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7198"><font size=-1>7198     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_basic'</span><span class="default">, </span><span class="string">'TDDFT_compulsory'</span><span class="default">, </span><span class="string">'ElecBandStructure_basic'</span><span class="default">],</span>
<a name="7199"><font size=-1>7199     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7200"><font size=-1>7200     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[usepaw]] == 1'</span><span class="default">: </span><span class="number">17</span><span class="default">, </span><span class="string">'[[usewvl]] == 1'</span><span class="default">: </span><span class="number">0</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">7</span><span class="default">}),</span>
<a name="7201"><font size=-1>7201     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for Self-Consistent-Field cycles&quot;</span><span class="default">,</span>
<a name="7202"><font size=-1>7202     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="7203"><font size=-1>7203     </font></a><span class="string">Controls the self-consistency.</span>
<a name="7204"><font size=-1>7204     </font></a><span class="string">Positive values --&gt; this is the usual choice for doing the usual ground state</span>
<a name="7205"><font size=-1>7205     </font></a><span class="string">(GS) calculations or for structural relaxation, where the potential has to be</span>
<a name="7206"><font size=-1>7206     </font></a><span class="string">determined self-consistently. The choice between different algorithms for SCF</span>
<a name="7207"><font size=-1>7207     </font></a><span class="string">is possible:</span>
<a name="7208"><font size=-1>7208     </font></a><span class="string"></span>
<a name="7209"><font size=-1>7209     </font></a><span class="string">  * 0 --&gt; SCF cycle, direct minimization scheme on the gradient of the wavefunctions. This algorithm is faster than diagonalisation and mixing but is working only for systems with a gap. It is implemented only on the wavelet basis set, when [[usewvl]] = 1.</span>
<a name="7210"><font size=-1>7210     </font></a><span class="string">  * 1 --&gt; get the largest eigenvalue of the SCF cycle</span>
<a name="7211"><font size=-1>7211     </font></a><span class="string">([[DEVELOP]] option, used with [[irdwfk]] = 1 or [[irdwfq]] = 1)</span>
<a name="7212"><font size=-1>7212     </font></a><span class="string"></span>
<a name="7213"><font size=-1>7213     </font></a><span class="string">  * 2 --&gt; SCF cycle, simple mixing of the potential with the preconditioned potential residual (in the usual case, the latter is defined by [[diemix]], [[diemac]] and [[dielng]])</span>
<a name="7214"><font size=-1>7214     </font></a><span class="string">  * 3 --&gt; SCF cycle, Anderson mixing of the potential</span>
<a name="7215"><font size=-1>7215     </font></a><span class="string">  * 4 --&gt; SCF cycle, Anderson mixing of the potential based on the two previous iterations</span>
<a name="7216"><font size=-1>7216     </font></a><span class="string">  * 5 --&gt; SCF cycle, CG based on the minim. of the energy with respect to the potential</span>
<a name="7217"><font size=-1>7217     </font></a><span class="string">  * 7 --&gt; SCF cycle, Pulay mixing of the potential based on the [[npulayit]] previous iterations</span>
<a name="7218"><font size=-1>7218     </font></a><span class="string">  * 12 --&gt; SCF cycle, simple mixing of the density</span>
<a name="7219"><font size=-1>7219     </font></a><span class="string">  * 13 --&gt; SCF cycle, Anderson mixing of the density</span>
<a name="7220"><font size=-1>7220     </font></a><span class="string">  * 14 --&gt; SCF cycle, Anderson mixing of the density based on the two previous iterations</span>
<a name="7221"><font size=-1>7221     </font></a><span class="string">  * 15 --&gt; SCF cycle, CG based on the minim. of the energy with respect to the density</span>
<a name="7222"><font size=-1>7222     </font></a><span class="string">  * 17 --&gt; SCF cycle, Pulay mixing of the density based on the [[npulayit]] previous iterations</span>
<a name="7223"><font size=-1>7223     </font></a><span class="string"></span>
<a name="7224"><font size=-1>7224     </font></a><span class="string">!!! warning</span>
<a name="7225"><font size=-1>7225     </font></a><span class="string"></span>
<a name="7226"><font size=-1>7226     </font></a><span class="string">    Other positive values, including zero ones, are not allowed.</span>
<a name="7227"><font size=-1>7227     </font></a><span class="string"></span>
<a name="7228"><font size=-1>7228     </font></a><span class="string">Such algorithms for treating the &quot;SCF iteration history&quot; should be coupled</span>
<a name="7229"><font size=-1>7229     </font></a><span class="string">with accompanying algorithms for the SCF &quot;preconditioning&quot;. See the input</span>
<a name="7230"><font size=-1>7230     </font></a><span class="string">variable [[iprcel]]. The default value [[iprcel]] = 0 is often a good choice,</span>
<a name="7231"><font size=-1>7231     </font></a><span class="string">but for inhomogeneous systems, you might gain a lot with [[iprcel]] = 45.</span>
<a name="7232"><font size=-1>7232     </font></a><span class="string"></span>
<a name="7233"><font size=-1>7233     </font></a><span class="string">(Warning: if [[iscf]] &gt; 10, at present (v4.6), the energy printed at each SCF</span>
<a name="7234"><font size=-1>7234     </font></a><span class="string">cycle is not variational - this should not affect the other properties, and at</span>
<a name="7235"><font size=-1>7235     </font></a><span class="string">convergence, all values are OK)</span>
<a name="7236"><font size=-1>7236     </font></a><span class="string"></span>
<a name="7237"><font size=-1>7237     </font></a><span class="string">- In the norm-conserving case, the default option is [[iscf]] = 7, which is a</span>
<a name="7238"><font size=-1>7238     </font></a><span class="string">compromise between speed and reliability. The value [[iscf]] =  2 is safer but</span>
<a name="7239"><font size=-1>7239     </font></a><span class="string">slower.</span>
<a name="7240"><font size=-1>7240     </font></a><span class="string">- In the PAW case, default option is [[iscf]] = 17. In PAW you have the</span>
<a name="7241"><font size=-1>7241     </font></a><span class="string">possibility to mix density/potential on the fine or coarse FFT grid (see</span>
<a name="7242"><font size=-1>7242     </font></a><span class="string">[[pawmixdg]]).</span>
<a name="7243"><font size=-1>7243     </font></a><span class="string">- Note that a Pulay mixing ([[iscf]] = 7 or 17) with [[npulayit]] =1 (resp. 2)</span>
<a name="7244"><font size=-1>7244     </font></a><span class="string">is equivalent to an Anderson mixing with [[iscf]] = 3 or 13 (resp. 4 or 14).</span>
<a name="7245"><font size=-1>7245     </font></a><span class="string">- Also note that:</span>
<a name="7246"><font size=-1>7246     </font></a><span class="string">* when mixing is done on potential (iscf &lt;10), total energy is computed by &quot;direct&quot; decomposition.</span>
<a name="7247"><font size=-1>7247     </font></a><span class="string">* when mixing is done on density (iscf &gt;=10), total energy is computed by &quot;double counting&quot; decomposition.</span>
<a name="7248"><font size=-1>7248     </font></a><span class="string">&quot;Direct&quot; and &quot;double counting&quot; decomposition of energy are equal when SCF</span>
<a name="7249"><font size=-1>7249     </font></a><span class="string">cycle is converged. Note that, when using GGA XC functionals, these</span>
<a name="7250"><font size=-1>7250     </font></a><span class="string">decompositions of energy can be slightly different due to imprecise</span>
<a name="7251"><font size=-1>7251     </font></a><span class="string">computation of density gradients on FFT grid (difference decreases as size of</span>
<a name="7252"><font size=-1>7252     </font></a><span class="string">FFT grid increases - see [[ecut]] for NC pseudopotentials, [[pawecutdg]] for PAW).</span>
<a name="7253"><font size=-1>7253     </font></a><span class="string"></span>
<a name="7254"><font size=-1>7254     </font></a><span class="string">Other (negative) options:</span>
<a name="7255"><font size=-1>7255     </font></a><span class="string"></span>
<a name="7256"><font size=-1>7256     </font></a><span class="string">  * -2 --&gt; a non-self-consistent calculation is to be done; in this case an electron density rho(r) on a real space grid (produced in a previous calculation) will be read from a disk file (automatically if [[ndtset]] = 0, or according to the value of [[getden]] if [[ndtset]]/=0).</span>
<a name="7257"><font size=-1>7257     </font></a><span class="string">The name of th density file must be given as indicated [[help:abinit#files-file|here]].</span>
<a name="7258"><font size=-1>7258     </font></a><span class="string">[[iscf]] = -2 would be used for band structure calculations, to permit</span>
<a name="7259"><font size=-1>7259     </font></a><span class="string">computation of the eigenvalues of occupied and unoccupied states at arbitrary</span>
<a name="7260"><font size=-1>7260     </font></a><span class="string">k points in the fixed self consistent potential produced by some integration</span>
<a name="7261"><font size=-1>7261     </font></a><span class="string">grid of k points. Due to this typical use, ABINIT insist that either</span>
<a name="7262"><font size=-1>7262     </font></a><span class="string">[[prtvol]] &gt; 2 or [[prteig]] does not vanish when there are more than 50 k points.</span>
<a name="7263"><font size=-1>7263     </font></a><span class="string">To compute the eigenvalues (and wavefunctions) of unoccupied states in a</span>
<a name="7264"><font size=-1>7264     </font></a><span class="string">separate (non-selfconsistent) run, the user should save the self-consistent</span>
<a name="7265"><font size=-1>7265     </font></a><span class="string">rho(r) and then run [[iscf]] = -2 for the intended set of k-points and bands.</span>
<a name="7266"><font size=-1>7266     </font></a><span class="string">To prepare a run with [[iscf]] = -2, a density file can be produced using the</span>
<a name="7267"><font size=-1>7267     </font></a><span class="string">parameter [[prtden]] (see its description). When a self-consistent set of</span>
<a name="7268"><font size=-1>7268     </font></a><span class="string">wavefunctions is already available, abinit can be used with [[nstep]] = 0 (see</span>
<a name="7269"><font size=-1>7269     </font></a><span class="string">Test_v2/t47.in), and the adequate value of [[prtden]].</span>
<a name="7270"><font size=-1>7270     </font></a><span class="string"></span>
<a name="7271"><font size=-1>7271     </font></a><span class="string">  * -3 --&gt; like -2, but initialize [[occ]] and [[wtk]], directly or indirectly (using [[ngkpt]] or [[kptrlatt]]) depending on the value of [[occopt]].</span>
<a name="7272"><font size=-1>7272     </font></a><span class="string">For GS, this option might be used to generate Density-of-states (thanks to</span>
<a name="7273"><font size=-1>7273     </font></a><span class="string">[[prtdos]]), or to produce STM charge density map (thanks to [[prtstm]]).</span>
<a name="7274"><font size=-1>7274     </font></a><span class="string">For RF, this option is needed to compute the response to ddk perturbation.</span>
<a name="7275"><font size=-1>7275     </font></a><span class="string"></span>
<a name="7276"><font size=-1>7276     </font></a><span class="string">  * -1 --&gt; like -2, but the non-self-consistent calculation is followed by the determination of excited states within TDDFT. This is only possible for [[nkpt]] = 1, with [[kpt]] = 0 0 0. Note that the oscillator strength needs to be defined with respect to an origin of coordinate, thanks to the input variable [[boxcenter]]. The maximal number of Kohn-Sham excitations to be used to build the excited state TDDFT matrix can be defined by [[td_mexcit]], or indirectly by the maximum Kohn-Sham excitation energy [[td_maxene]].</span>
<a name="7277"><font size=-1>7277     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7278"><font size=-1>7278     </font></a><span class="default">),</span>
<a name="7279"><font size=-1>7279     </font></a><span class="default"></span>
<a name="7280"><font size=-1>7280     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7281"><font size=-1>7281     </font></a><span class="default">    abivarname=</span><span class="string">&quot;isecur&quot;</span><span class="default">,</span>
<a name="7282"><font size=-1>7282     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="7283"><font size=-1>7283     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7284"><font size=-1>7284     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_expert'</span><span class="default">],</span>
<a name="7285"><font size=-1>7285     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7286"><font size=-1>7286     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7287"><font size=-1>7287     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for level of SECURity choice&quot;</span><span class="default">,</span>
<a name="7288"><font size=-1>7288     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="7289"><font size=-1>7289     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7290"><font size=-1>7290     </font></a><span class="string">In the presently used algorithms, there is a compromise between speed and</span>
<a name="7291"><font size=-1>7291     </font></a><span class="string">robustness, that can be tuned by using [[isecur]].</span>
<a name="7292"><font size=-1>7292     </font></a><span class="string">If [[isecur]] =0, an extrapolation of out-of-line data is allowed, and might</span>
<a name="7293"><font size=-1>7293     </font></a><span class="string">save one non-SCF calculation every two line minimisation when some stability</span>
<a name="7294"><font size=-1>7294     </font></a><span class="string">conditions are fulfilled (since there are 2 non-SCF calculations per line</span>
<a name="7295"><font size=-1>7295     </font></a><span class="string">minimisation, 1 out of 4 is saved)</span>
<a name="7296"><font size=-1>7296     </font></a><span class="string">Using [[isecur]] = 1 or higher integers will raise gradually the threshold to make extrapolation.</span>
<a name="7297"><font size=-1>7297     </font></a><span class="string">Using [[isecur]] = -2 will allow to save 2 non-SCF calculations every three line</span>
<a name="7298"><font size=-1>7298     </font></a><span class="string">minimisation, but this can make the algorithm unstable. Lower values of</span>
<a name="7299"><font size=-1>7299     </font></a><span class="string">[[isecur]] allows one for more (tentative) savings. In any case, there must be one</span>
<a name="7300"><font size=-1>7300     </font></a><span class="string">non-SCF computation per line minimisation.</span>
<a name="7301"><font size=-1>7301     </font></a><span class="string">No meaning for RF calculations yet.</span>
<a name="7302"><font size=-1>7302     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7303"><font size=-1>7303     </font></a><span class="default">),</span>
<a name="7304"><font size=-1>7304     </font></a><span class="default"></span>
<a name="7305"><font size=-1>7305     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7306"><font size=-1>7306     </font></a><span class="default">    abivarname=</span><span class="string">&quot;istatimg&quot;</span><span class="default">,</span>
<a name="7307"><font size=-1>7307     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="7308"><font size=-1>7308     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7309"><font size=-1>7309     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_expert'</span><span class="default">],</span>
<a name="7310"><font size=-1>7310     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7311"><font size=-1>7311     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="7312"><font size=-1>7312     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer governing the computation of STATic IMaGes&quot;</span><span class="default">,</span>
<a name="7313"><font size=-1>7313     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7314"><font size=-1>7314     </font></a><span class="string">This input variable is relevant when sets of images are activated (see [[imgmov]]).</span>
<a name="7315"><font size=-1>7315     </font></a><span class="string">Not all images might be required to evolve from one time step to the other</span>
<a name="7316"><font size=-1>7316     </font></a><span class="string">(see[[dynimage]]): these are static images.</span>
<a name="7317"><font size=-1>7317     </font></a><span class="string">If [[istatimg]] = 0, the total energy of static images is not computed (but</span>
<a name="7318"><font size=-1>7318     </font></a><span class="string">static images are used to make the dynamic images evolve).</span>
<a name="7319"><font size=-1>7319     </font></a><span class="string">This can be useful to save CPU time.</span>
<a name="7320"><font size=-1>7320     </font></a><span class="string">If [[istatimg]] = 1, the total energy of static images is computed.</span>
<a name="7321"><font size=-1>7321     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7322"><font size=-1>7322     </font></a><span class="default">),</span>
<a name="7323"><font size=-1>7323     </font></a><span class="default"></span>
<a name="7324"><font size=-1>7324     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7325"><font size=-1>7325     </font></a><span class="default">    abivarname=</span><span class="string">&quot;istatr&quot;</span><span class="default">,</span>
<a name="7326"><font size=-1>7326     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="7327"><font size=-1>7327     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7328"><font size=-1>7328     </font></a><span class="default">    topics=[</span><span class="string">'printing_prmisc'</span><span class="default">],</span>
<a name="7329"><font size=-1>7329     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7330"><font size=-1>7330     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7331"><font size=-1>7331     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for STATus file rate&quot;</span><span class="default">,</span>
<a name="7332"><font size=-1>7332     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">, </span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="7333"><font size=-1>7333     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Values lower than 10 may not work on some machines.&quot;</span><span class="default">,</span>
<a name="7334"><font size=-1>7334     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7335"><font size=-1>7335     </font></a><span class="string">Govern the rate of output of the status file. This status file is written when</span>
<a name="7336"><font size=-1>7336     </font></a><span class="string">the number of the call to the status subroutine is equal to [[istatshft]]</span>
<a name="7337"><font size=-1>7337     </font></a><span class="string">modulo [[istatr]], so that it is written once every [[istatr]] call.</span>
<a name="7338"><font size=-1>7338     </font></a><span class="string">When [[istatr]] = 0, there is no writing of a status file (which is the default).</span>
<a name="7339"><font size=-1>7339     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7340"><font size=-1>7340     </font></a><span class="default">),</span>
<a name="7341"><font size=-1>7341     </font></a><span class="default"></span>
<a name="7342"><font size=-1>7342     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7343"><font size=-1>7343     </font></a><span class="default">    abivarname=</span><span class="string">&quot;istatshft&quot;</span><span class="default">,</span>
<a name="7344"><font size=-1>7344     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="7345"><font size=-1>7345     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7346"><font size=-1>7346     </font></a><span class="default">    topics=[</span><span class="string">'printing_prmisc'</span><span class="default">],</span>
<a name="7347"><font size=-1>7347     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7348"><font size=-1>7348     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="7349"><font size=-1>7349     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for STATus file SHiFT&quot;</span><span class="default">,</span>
<a name="7350"><font size=-1>7350     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">, </span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="7351"><font size=-1>7351     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7352"><font size=-1>7352     </font></a><span class="string">Govern the rate of output of the status file. This status file is written when</span>
<a name="7353"><font size=-1>7353     </font></a><span class="string">the number of the call to the status subroutine is equal to '[[istatshft]]'</span>
<a name="7354"><font size=-1>7354     </font></a><span class="string">modulo ' **istatr** ', so that it is written once every ' **istatr** ' call.</span>
<a name="7355"><font size=-1>7355     </font></a><span class="string">There is also a writing for each of the 5 first calls, and the 10th call.</span>
<a name="7356"><font size=-1>7356     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7357"><font size=-1>7357     </font></a><span class="default">),</span>
<a name="7358"><font size=-1>7358     </font></a><span class="default"></span>
<a name="7359"><font size=-1>7359     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7360"><font size=-1>7360     </font></a><span class="default">    abivarname=</span><span class="string">&quot;istwfk&quot;</span><span class="default">,</span>
<a name="7361"><font size=-1>7361     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="7362"><font size=-1>7362     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7363"><font size=-1>7363     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">, </span><span class="string">'TuningSpeed_basic'</span><span class="default">],</span>
<a name="7364"><font size=-1>7364     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nkpt]]'</span><span class="default">],</span>
<a name="7365"><font size=-1>7365     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="7366"><font size=-1>7366     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for choice of STorage of WaveFunction at each k point&quot;</span><span class="default">,</span>
<a name="7367"><font size=-1>7367     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;For RF calculations, the Default is not used: &lt;b&gt;istwfk&lt;/b&gt; is forced to be 1 deep inside the code, for all k points. For spin-orbit calculations ([[nspinor]] = 2), &lt;b&gt;istwfk&lt;/b&gt; is also forced to be 1, for all k points.&quot;</span><span class="default">,</span>
<a name="7368"><font size=-1>7368     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7369"><font size=-1>7369     </font></a><span class="string">Control the way the wavefunction for each k-point is stored inside ABINIT, in reciprocal space.</span>
<a name="7370"><font size=-1>7370     </font></a><span class="string">For the GS calculations, in the &quot;cg&quot; array containing the wavefunction</span>
<a name="7371"><font size=-1>7371     </font></a><span class="string">coefficients, there is for each k-point and each band, a segment</span>
<a name="7372"><font size=-1>7372     </font></a><span class="string">cg(1:2,1:npw). The 'full' number of plane wave is determined by [[ecut]].</span>
<a name="7373"><font size=-1>7373     </font></a><span class="string"></span>
<a name="7374"><font size=-1>7374     </font></a><span class="string">However, if the k-point coordinates are build only from zeroes and halves (see</span>
<a name="7375"><font size=-1>7375     </font></a><span class="string">list below), the use of time-reversal symmetry (that connects coefficients)</span>
<a name="7376"><font size=-1>7376     </font></a><span class="string">has been implemented, in order to use real-to-complex FFTs (see [[fftalg]]),</span>
<a name="7377"><font size=-1>7377     </font></a><span class="string">and to treat explicitly only half of the number of plane waves (this being used as 'npw').</span>
<a name="7378"><font size=-1>7378     </font></a><span class="string">For the RF calculations, there is not only the &quot;cg&quot; array, but also the &quot;cgq&quot;</span>
<a name="7379"><font size=-1>7379     </font></a><span class="string">and &quot;cg1&quot; arrays. For the time-reversal symmetry to decrease the number of</span>
<a name="7380"><font size=-1>7380     </font></a><span class="string">plane waves of these arrays, the q vector MUST be (0 0 0). Then, for each k</span>
<a name="7381"><font size=-1>7381     </font></a><span class="string">point, the same rule as for the RF can be applied.</span>
<a name="7382"><font size=-1>7382     </font></a><span class="string">WARNING (991018): for the time being, the time-reversal symmetry cannot be</span>
<a name="7383"><font size=-1>7383     </font></a><span class="string">used in the RF calculations.</span>
<a name="7384"><font size=-1>7384     </font></a><span class="string"></span>
<a name="7385"><font size=-1>7385     </font></a><span class="string">  * 1 --&gt; do NOT take advantage of the time-reversal symmetry</span>
<a name="7386"><font size=-1>7386     </font></a><span class="string">  * 2 --&gt; use time-reversal symmetry for k=( 0 0 0 )</span>
<a name="7387"><font size=-1>7387     </font></a><span class="string">  * 3 --&gt; use time-reversal symmetry for k=(1/2 0 0 )</span>
<a name="7388"><font size=-1>7388     </font></a><span class="string">  * 4 --&gt; use time-reversal symmetry for k=( 0 0 1/2)</span>
<a name="7389"><font size=-1>7389     </font></a><span class="string">  * 5 --&gt; use time-reversal symmetry for k=(1/2 0 1/2)</span>
<a name="7390"><font size=-1>7390     </font></a><span class="string">  * 6 --&gt; use time-reversal symmetry for k=( 0 1/2 0 )</span>
<a name="7391"><font size=-1>7391     </font></a><span class="string">  * 7 --&gt; use time-reversal symmetry for k=(1/2 1/2 0 )</span>
<a name="7392"><font size=-1>7392     </font></a><span class="string">  * 8 --&gt; use time-reversal symmetry for k=( 0 1/2 1/2)</span>
<a name="7393"><font size=-1>7393     </font></a><span class="string">  * 9 --&gt; use time-reversal symmetry for k=(1/2 1/2 1/2)</span>
<a name="7394"><font size=-1>7394     </font></a><span class="string">  * 0 --&gt; (preprocessed) for each k point, choose automatically the appropriate time-reversal</span>
<a name="7395"><font size=-1>7395     </font></a><span class="string">    option when it is allowed, and chose [[istwfk]] = 1 for all the other k points.</span>
<a name="7396"><font size=-1>7396     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7397"><font size=-1>7397     </font></a><span class="default">),</span>
<a name="7398"><font size=-1>7398     </font></a><span class="default"></span>
<a name="7399"><font size=-1>7399     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7400"><font size=-1>7400     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ixc&quot;</span><span class="default">,</span>
<a name="7401"><font size=-1>7401     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="7402"><font size=-1>7402     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7403"><font size=-1>7403     </font></a><span class="default">    topics=[</span><span class="string">'xc_basic'</span><span class="default">, </span><span class="string">'Hybrids_compulsory'</span><span class="default">, </span><span class="string">'TDDFT_useful'</span><span class="default">],</span>
<a name="7404"><font size=-1>7404     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7405"><font size=-1>7405     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="7406"><font size=-1>7406     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Index of eXchange-Correlation functional&quot;</span><span class="default">,</span>
<a name="7407"><font size=-1>7407     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Default corresponds to Teter parametrization. However, if all the pseudopotentials have the same value of pspxc, the initial value of ixc will be that common value&quot;</span><span class="default">,</span>
<a name="7408"><font size=-1>7408     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="7409"><font size=-1>7409     </font></a><span class="string">Controls the choice of exchange and correlation (xc). The list of XC</span>
<a name="7410"><font size=-1>7410     </font></a><span class="string">functionals is given below. Positive values are for ABINIT native library of</span>
<a name="7411"><font size=-1>7411     </font></a><span class="string">XC functionals, while negative values are for calling the much wider set of</span>
<a name="7412"><font size=-1>7412     </font></a><span class="string">functionals from the ETSF LibXC library (by M. Marques), available at the [</span>
<a name="7413"><font size=-1>7413     </font></a><span class="string">LibXC home page ](http://octopus-code.org/wiki/Libxc)</span>
<a name="7414"><font size=-1>7414     </font></a><span class="string">Note that the choice made here should preferably agree with the choice made in</span>
<a name="7415"><font size=-1>7415     </font></a><span class="string">generating the original pseudopotential, except for [[ixc]] = 0 (usually only</span>
<a name="7416"><font size=-1>7416     </font></a><span class="string">used for debugging). A warning is issued if this is not the case.</span>
<a name="7417"><font size=-1>7417     </font></a><span class="string">Unfortunately, pseudopotential (or PAW) generators for hybrid functionals and</span>
<a name="7418"><font size=-1>7418     </font></a><span class="string">mGGA are currently under development, so that one usually uses GGA or LDA</span>
<a name="7419"><font size=-1>7419     </font></a><span class="string">pseudopotentials instead. The error should be limited when GGA or LDA</span>
<a name="7420"><font size=-1>7420     </font></a><span class="string">pseudopotentials with semi-core states are used. Still this is a non-</span>
<a name="7421"><font size=-1>7421     </font></a><span class="string">controlled error.. Moreover, the choices [[ixc]] = 1, 2, 3 and 7 are fits to the</span>
<a name="7422"><font size=-1>7422     </font></a><span class="string">same data, from Ceperley-Alder, and are rather similar, at least for spin-</span>
<a name="7423"><font size=-1>7423     </font></a><span class="string">unpolarized systems.</span>
<a name="7424"><font size=-1>7424     </font></a><span class="string">The choice between the non-spin-polarized and spin-polarized case is governed</span>
<a name="7425"><font size=-1>7425     </font></a><span class="string">by the value of [[nsppol]] (see below).</span>
<a name="7426"><font size=-1>7426     </font></a><span class="string"></span>
<a name="7427"><font size=-1>7427     </font></a><span class="string">**Native ABINIT XC functionals**</span>
<a name="7428"><font size=-1>7428     </font></a><span class="string"></span>
<a name="7429"><font size=-1>7429     </font></a><span class="string">NOTE: in the implementation of the spin-dependence of these functionals, and</span>
<a name="7430"><font size=-1>7430     </font></a><span class="string">in order to avoid divergences in their derivatives, the interpolating function</span>
<a name="7431"><font size=-1>7431     </font></a><span class="string">between spin-unpolarized and fully-spin-polarized function has been slightly</span>
<a name="7432"><font size=-1>7432     </font></a><span class="string">modified, by including a zeta rescaled by 1.d0-1.d-6. This should affect total</span>
<a name="7433"><font size=-1>7433     </font></a><span class="string">energy at the level of 1.d-6Ha, and should have an even smaller effect on</span>
<a name="7434"><font size=-1>7434     </font></a><span class="string">differences of energies, or derivatives.</span>
<a name="7435"><font size=-1>7435     </font></a><span class="string">The value [[ixc]] = 10 is used internally: gives the difference between</span>
<a name="7436"><font size=-1>7436     </font></a><span class="string">[[ixc]] = 7 and [[ixc]] = 9, for use with an accurate RPA correlation energy.</span>
<a name="7437"><font size=-1>7437     </font></a><span class="string"></span>
<a name="7438"><font size=-1>7438     </font></a><span class="string">  * 0 --&gt; NO xc.</span>
<a name="7439"><font size=-1>7439     </font></a><span class="string"></span>
<a name="7440"><font size=-1>7440     </font></a><span class="string">  * 1 --&gt; LDA or LSD, Teter Pade parametrization (4/93, published in [[cite:Goedecker1996]], which reproduces Perdew-Wang 92 [[cite:Perdew1992a]] (which reproduces Ceperley-Alder [[cite:Ceperley1980]]!).</span>
<a name="7441"><font size=-1>7441     </font></a><span class="string">  * 2 --&gt; LDA, Perdew-Zunger-Ceperley-Alder (no spin-polarization) [[cite:Perdew1981]]</span>
<a name="7442"><font size=-1>7442     </font></a><span class="string">  * 3 --&gt; LDA, old Teter rational polynomial parametrization (4/91) fit to Ceperley-Alder data (no spin-polarization) [[cite:Ceperley1980]]</span>
<a name="7443"><font size=-1>7443     </font></a><span class="string">  * 4 --&gt; LDA, Wigner functional (no spin-polarization)</span>
<a name="7444"><font size=-1>7444     </font></a><span class="string">  * 5 --&gt; LDA, Hedin-Lundqvist functional (no spin-polarization) [[cite:Hedin1971]]</span>
<a name="7445"><font size=-1>7445     </font></a><span class="string">  * 6 --&gt; LDA, &quot;X-alpha&quot; functional (no spin-polarization)</span>
<a name="7446"><font size=-1>7446     </font></a><span class="string">  * 7 --&gt; LDA or LSD, Perdew-Wang 92 functional [[cite:Perdew1992a]]</span>
<a name="7447"><font size=-1>7447     </font></a><span class="string">  * 8 --&gt; LDA or LSD, x-only part of the Perdew-Wang 92 functional [[cite:Perdew1992a]]</span>
<a name="7448"><font size=-1>7448     </font></a><span class="string">  * 9 --&gt; LDA or LSD, x- and RPA correlation part of the Perdew-Wang 92 functional [[cite:Perdew1992a]]</span>
<a name="7449"><font size=-1>7449     </font></a><span class="string"></span>
<a name="7450"><font size=-1>7450     </font></a><span class="string">  * 11 --&gt; GGA, Perdew-Burke-Ernzerhof GGA functional [[cite:Perdew1996]]</span>
<a name="7451"><font size=-1>7451     </font></a><span class="string">  * 12 --&gt; GGA, x-only part of Perdew-Burke-Ernzerhof GGA functional [[cite:Perdew1996]]</span>
<a name="7452"><font size=-1>7452     </font></a><span class="string">  * 13 --&gt; GGA potential of van Leeuwen-Baerends [[cite:VanLeeuwen1994]], while for energy, Perdew-Wang 92 functional [[cite:Perdew1992a]]</span>
<a name="7453"><font size=-1>7453     </font></a><span class="string">  * 14 --&gt; GGA, revPBE of [[cite:Zhang1998]]</span>
<a name="7454"><font size=-1>7454     </font></a><span class="string">  * 15 --&gt; GGA, RPBE of [[cite:Hammer1999]]</span>
<a name="7455"><font size=-1>7455     </font></a><span class="string">  * 16 --&gt; GGA, HTCH93 of [[cite:Hamprecht1998]]</span>
<a name="7456"><font size=-1>7456     </font></a><span class="string">  * 17 --&gt; GGA, HTCH120 of [[cite:Boese2000]] - The usual HCTH functional.</span>
<a name="7457"><font size=-1>7457     </font></a><span class="string">  * 18 --&gt; (NOT AVAILABLE: used internally for GGA BLYP pseudopotentials from [[cite:Krack2005]], available from the [ CP2K repository ](https://github.com/cp2k/cp2k/tree/master/potentials/Goedecker/abinit/blyp) \- use the LibXC instead, with [[ixc]] = -106131.</span>
<a name="7458"><font size=-1>7458     </font></a><span class="string">  * 19 --&gt; (NOT AVAILABLE: used internally for GGA BP86 pseudopotentials from [[cite:Krack2005]], available from the [ CP2K repository ](https://github.com/cp2k/cp2k/tree/master/potentials/Goedecker/abinit/bp) \- use the LibXC instead, with [[ixc]] = -106132.</span>
<a name="7459"><font size=-1>7459     </font></a><span class="string"></span>
<a name="7460"><font size=-1>7460     </font></a><span class="string">  * 20 --&gt; Fermi-Amaldi xc ( -1/N Hartree energy, where N is the number of electrons per cell; G=0 is not taken into account however),</span>
<a name="7461"><font size=-1>7461     </font></a><span class="string">                            for TDDFT tests. No spin-pol. Does not work for RF.</span>
<a name="7462"><font size=-1>7462     </font></a><span class="string">  * 21 --&gt; same as 20, except that the xc-kernel is the LDA ([[ixc]] = 1) one, for TDDFT tests.</span>
<a name="7463"><font size=-1>7463     </font></a><span class="string">  * 22 --&gt; same as 20, except that the xc-kernel is the Burke-Petersilka-Gross hybrid, for TDDFT tests.</span>
<a name="7464"><font size=-1>7464     </font></a><span class="string">  * 23 --&gt; GGA of [[cite:Wu2006]].</span>
<a name="7465"><font size=-1>7465     </font></a><span class="string">  * 24 --&gt; GGA, C09x exchange of [[cite:Cooper2010]].</span>
<a name="7466"><font size=-1>7466     </font></a><span class="string">  * 26 --&gt; GGA, HTCH147 of [[cite:Boese2000]].</span>
<a name="7467"><font size=-1>7467     </font></a><span class="string">  * 27 --&gt; GGA, HTCH407 of [[cite:Boese2001]].</span>
<a name="7468"><font size=-1>7468     </font></a><span class="string">  * 28 --&gt; (NOT AVAILABLE: used internally for GGA OLYP pseudopotentials from [[cite:Krack2005]], available from the [ CP2K repository ](https://github.com/cp2k/cp2k/tree/master/potentials/Goedecker/abinit/olyp) \- use the LibXC instead, with [[ixc]] = -110131.</span>
<a name="7469"><font size=-1>7469     </font></a><span class="string"></span>
<a name="7470"><font size=-1>7470     </font></a><span class="string">  * 40 --&gt; Hartree-Fock</span>
<a name="7471"><font size=-1>7471     </font></a><span class="string">  * 41 --&gt; PBE0, [[cite:Perdew1996]].</span>
<a name="7472"><font size=-1>7472     </font></a><span class="string">  * 42 --&gt; PBE0-1/3, [[cite:Guido2013]].</span>
<a name="7473"><font size=-1>7473     </font></a><span class="string"></span>
<a name="7474"><font size=-1>7474     </font></a><span class="string">**ETSF Lib XC functionals**</span>
<a name="7475"><font size=-1>7475     </font></a><span class="string"></span>
<a name="7476"><font size=-1>7476     </font></a><span class="string">Note that you must compile ABINIT with the LibXC plug-in in order to be able</span>
<a name="7477"><font size=-1>7477     </font></a><span class="string">to access these functionals.</span>
<a name="7478"><font size=-1>7478     </font></a><span class="string">The LibXC functionals are accessed by **negative values** of [[ixc]]. The</span>
<a name="7479"><font size=-1>7479     </font></a><span class="string">LibXC contains functional forms for either exchange-only functionals,</span>
<a name="7480"><font size=-1>7480     </font></a><span class="string">correlation-only functionals, or combined exchange and correlation</span>
<a name="7481"><font size=-1>7481     </font></a><span class="string">functionals. Each of them is to be specified by a three-digit number. In case</span>
<a name="7482"><font size=-1>7482     </font></a><span class="string">of a combined exchange and correlation functional, only one such three-digit</span>
<a name="7483"><font size=-1>7483     </font></a><span class="string">number has to be specified as value of [[ixc]], with a minus sign (to indicate</span>
<a name="7484"><font size=-1>7484     </font></a><span class="string">that it comes from the LibXC). In the case of separate exchange functional</span>
<a name="7485"><font size=-1>7485     </font></a><span class="string">(let us represent its identifier by XXX) and correlation functional (let us</span>
<a name="7486"><font size=-1>7486     </font></a><span class="string">represent its identified by CCC), a six-digit number will have to be specified</span>
<a name="7487"><font size=-1>7487     </font></a><span class="string">for [[ixc]], by concatenation, be it XXXCCC or CCCXXX. As an example,</span>
<a name="7488"><font size=-1>7488     </font></a><span class="string">[[ixc]] = -020 gives access to the Teter93 LDA, while [[ixc]] = -101130 gives</span>
<a name="7489"><font size=-1>7489     </font></a><span class="string">access to the PBE GGA. In version 0.9 of LibXC (December 2008), there are 16</span>
<a name="7490"><font size=-1>7490     </font></a><span class="string">three-dimensional (S)LDA functionals (1 for X, 14 for C, 1 for combined XC),</span>
<a name="7491"><font size=-1>7491     </font></a><span class="string">and there are 41 three-dimensional GGA (23 for X, 8 for C, 10 for combined</span>
<a name="7492"><font size=-1>7492     </font></a><span class="string">XC). Note that for a meta-GGA, the kinetic energy density is needed.</span>
<a name="7493"><font size=-1>7493     </font></a><span class="string">This means having [[usekden]] = 1.</span>
<a name="7494"><font size=-1>7494     </font></a><span class="string"></span>
<a name="7495"><font size=-1>7495     </font></a><span class="string">(S)LDA functionals (do not forget to add a minus sign, as discussed above)</span>
<a name="7496"><font size=-1>7496     </font></a><span class="string"></span>
<a name="7497"><font size=-1>7497     </font></a><span class="string">  * 001 --&gt; XC_LDA_X  [[cite:Dirac1930]], [[cite:Bloch1929]]</span>
<a name="7498"><font size=-1>7498     </font></a><span class="string">  * 002 --&gt; XC_LDA_C_WIGNER  Wigner parametrization [[cite:Wigner1938]]</span>
<a name="7499"><font size=-1>7499     </font></a><span class="string">  * 003 --&gt; XC_LDA_C_RPA  Random Phase Approximation [[cite:GellMann1957]]</span>
<a name="7500"><font size=-1>7500     </font></a><span class="string">  * 004 --&gt; XC_LDA_C_HL  Hedin &amp; Lundqvist [[cite:Hedin1971]]</span>
<a name="7501"><font size=-1>7501     </font></a><span class="string">  * 005 --&gt; XC_LDA_C_GL  Gunnarson &amp; Lundqvist [[cite:Gunnarsson1976]]</span>
<a name="7502"><font size=-1>7502     </font></a><span class="string">  * 006 --&gt; XC_LDA_C_XALPHA  Slaters Xalpha</span>
<a name="7503"><font size=-1>7503     </font></a><span class="string">  * 007 --&gt; XC_LDA_C_VWN  [[cite:Vosko1980]]</span>
<a name="7504"><font size=-1>7504     </font></a><span class="string">  * 008 --&gt; XC_LDA_C_VWN_RPA  [[cite:Vosko1980]]</span>
<a name="7505"><font size=-1>7505     </font></a><span class="string">  * 009 --&gt; XC_LDA_C_PZ  Perdew &amp; Zunger [[cite:Perdew1981]]</span>
<a name="7506"><font size=-1>7506     </font></a><span class="string">  * 010 --&gt; XC_LDA_C_PZ_MOD  Perdew &amp; Zunger (Modified) [[cite:Perdew1981]] Modified to improve the matching between the low and high rs part</span>
<a name="7507"><font size=-1>7507     </font></a><span class="string">  * 011 --&gt; XC_LDA_C_OB_PZ  Ortiz &amp; Ballone (PZ) [[cite:Ortiz1994]] [[cite:Ortiz1997]] [[cite:Perdew1981]]</span>
<a name="7508"><font size=-1>7508     </font></a><span class="string">  * 012 --&gt; XC_LDA_C_PW  Perdew &amp; Wang [[cite:Perdew1992a]]</span>
<a name="7509"><font size=-1>7509     </font></a><span class="string">  * 013 --&gt; XC_LDA_C_PW_MOD  Perdew &amp; Wang (Modified) [[cite:Perdew1992a]]; Added extra digits to some constants as in the PBE routine.</span>
<a name="7510"><font size=-1>7510     </font></a><span class="string">  * 014 --&gt; XC_LDA_C_OB_PW  Ortiz &amp; Ballone (PW) [[cite:Ortiz1994]] [[cite:Ortiz1997]] [[cite:Perdew1992a]]</span>
<a name="7511"><font size=-1>7511     </font></a><span class="string">  * 017 --&gt; XC_LDA_C_vBH  von Barth &amp; Hedin [[cite:Barth1972]]</span>
<a name="7512"><font size=-1>7512     </font></a><span class="string">  * 020 --&gt; XC_LDA_XC_TETER93  Teter 93 parametrization [[cite:Goedecker1996]]</span>
<a name="7513"><font size=-1>7513     </font></a><span class="string">  * 022 --&gt; XC_LDA_C_ML1  Modified LSD (version 1) of Proynov and Salahub [[cite:Proynov1994]]</span>
<a name="7514"><font size=-1>7514     </font></a><span class="string">  * 023 --&gt; XC_LDA_C_ML2  Modified LSD (version 2) of Proynov and Salahub [[cite:Proynov1994]]</span>
<a name="7515"><font size=-1>7515     </font></a><span class="string">  * 024 --&gt; XC_LDA_C_GOMBAS  Gombas parametrization [[cite:Gombas1967]]</span>
<a name="7516"><font size=-1>7516     </font></a><span class="string">  * 025 --&gt; XC_LDA_C_PW_RPA  Perdew &amp; Wang fit of the RPA [[cite:Perdew1992a]]</span>
<a name="7517"><font size=-1>7517     </font></a><span class="string">  * 027 --&gt; XC_LDA_C_RC04  Ragot-Cortona [[cite:Ragot2004]]</span>
<a name="7518"><font size=-1>7518     </font></a><span class="string">  * 028 --&gt; XC_LDA_C_VWN_1  Vosko, Wilk, &amp; Nussair (1) [[cite:Vosko1980]]</span>
<a name="7519"><font size=-1>7519     </font></a><span class="string">  * 029 --&gt; XC_LDA_C_VWN_2  Vosko, Wilk, &amp; Nussair (2) [[cite:Vosko1980]]</span>
<a name="7520"><font size=-1>7520     </font></a><span class="string">  * 030 --&gt; XC_LDA_C_VWN_3  Vosko, Wilk, &amp; Nussair (3) [[cite:Vosko1980]]</span>
<a name="7521"><font size=-1>7521     </font></a><span class="string">  * 031 --&gt; XC_LDA_C_VWN_4  Vosko, Wilk, &amp; Nussair (4) [[cite:Vosko1980]]</span>
<a name="7522"><font size=-1>7522     </font></a><span class="string"></span>
<a name="7523"><font size=-1>7523     </font></a><span class="string">GGA functionals (do not forget to add a minus sign, as discussed above)</span>
<a name="7524"><font size=-1>7524     </font></a><span class="string"></span>
<a name="7525"><font size=-1>7525     </font></a><span class="string">  * 84 --&gt; XC_GGA_C_OP_XALPHA  one-parameter progressive functional (G96 version) [[cite:Tsuneda1999]]</span>
<a name="7526"><font size=-1>7526     </font></a><span class="string">  * 85 --&gt; XC_GGA_C_OP_G96  one-parameter progressive functional (G96 version) [[cite:Tsuneda1999]]</span>
<a name="7527"><font size=-1>7527     </font></a><span class="string">  * 86 --&gt; XC_GGA_C_OP_PBE  one-parameter progressive functional (PBE version) [[cite:Tsuneda1999]]</span>
<a name="7528"><font size=-1>7528     </font></a><span class="string">  * 87 --&gt; XC_GGA_C_OP_B88  one-parameter progressive functional (B88 version) [[cite:Tsuneda1999]]</span>
<a name="7529"><font size=-1>7529     </font></a><span class="string">  * 88 --&gt; XC_GGA_C_FT97  Filatov &amp; Thiel correlation [[cite:Filatov1997a]]  [[cite:Filatov1997]]</span>
<a name="7530"><font size=-1>7530     </font></a><span class="string"></span>
<a name="7531"><font size=-1>7531     </font></a><span class="string">!!! warning</span>
<a name="7532"><font size=-1>7532     </font></a><span class="string">    this functional is not tested. Use at your own risks.</span>
<a name="7533"><font size=-1>7533     </font></a><span class="string"></span>
<a name="7534"><font size=-1>7534     </font></a><span class="string">  * 89 --&gt; XC_GGA_C_SPBE  PBE correlation to be used with the SSB exchange [[cite:Swart2009]]</span>
<a name="7535"><font size=-1>7535     </font></a><span class="string">  * 90 --&gt; XC_GGA_X_SSB_SW  Swart, Sola and Bickelhaupt correction to PBE [[cite:Swart2009a]]</span>
<a name="7536"><font size=-1>7536     </font></a><span class="string">  * 91 --&gt; XC_GGA_X_SSB  [[cite:Swart2009]]</span>
<a name="7537"><font size=-1>7537     </font></a><span class="string"></span>
<a name="7538"><font size=-1>7538     </font></a><span class="string">!!! warning</span>
<a name="7539"><font size=-1>7539     </font></a><span class="string">    This functional gives NaN on IBM (XG20130608).</span>
<a name="7540"><font size=-1>7540     </font></a><span class="string"></span>
<a name="7541"><font size=-1>7541     </font></a><span class="string">  * 92 --&gt;  XC_GGA_X_SSB_D  [[cite:Swart2009]]</span>
<a name="7542"><font size=-1>7542     </font></a><span class="string"></span>
<a name="7543"><font size=-1>7543     </font></a><span class="string">!!! warning</span>
<a name="7544"><font size=-1>7544     </font></a><span class="string">    This functional gives NaN on IBM (XG20130608).</span>
<a name="7545"><font size=-1>7545     </font></a><span class="string"></span>
<a name="7546"><font size=-1>7546     </font></a><span class="string">  * 93 --&gt;  XC_GGA_XC_HCTH_407P  HCTH/407+ [[cite:Boese2003]]</span>
<a name="7547"><font size=-1>7547     </font></a><span class="string">  * 94 --&gt;  XC_GGA_XC_HCTH_P76  HCTH p=7/6 [[cite:Menconi2001]]</span>
<a name="7548"><font size=-1>7548     </font></a><span class="string">  * 95 --&gt;  XC_GGA_XC_HCTH_P14  HCTH p=1/4 [[cite:Menconi2001]]</span>
<a name="7549"><font size=-1>7549     </font></a><span class="string">  * 96 --&gt;  XC_GGA_XC_B97_GGA1  Becke 97 GGA-1 [[cite:Cohen2000]]</span>
<a name="7550"><font size=-1>7550     </font></a><span class="string">  * 97 --&gt;  XC_GGA_XC_HCTH_A  HCTH-A [[cite:Hamprecht1998]]</span>
<a name="7551"><font size=-1>7551     </font></a><span class="string">  * 98 --&gt;  XC_GGA_X_BPCCAC  BPCCAC (GRAC for the energy) [[cite:Bremond2012]]</span>
<a name="7552"><font size=-1>7552     </font></a><span class="string">  * 99 --&gt;  XC_GGA_C_REVTCA  Tognetti, Cortona, Adamo (revised) [[cite:Tognetti2008]]</span>
<a name="7553"><font size=-1>7553     </font></a><span class="string">  * 100 --&gt;  XC_GGA_C_TCA  Tognetti, Cortona, Adamo [[cite:Tognetti2008a]]</span>
<a name="7554"><font size=-1>7554     </font></a><span class="string">  * 101 --&gt;  XC_GGA_X_PBE  Perdew, Burke &amp; Ernzerhof exchange [[cite:Perdew1996]]  [[cite:Perdew1997]]</span>
<a name="7555"><font size=-1>7555     </font></a><span class="string">  * 102 --&gt;  XC_GGA_X_PBE_R  Perdew, Burke &amp; Ernzerhof exchange (revised) [[cite:Zhang1998]]</span>
<a name="7556"><font size=-1>7556     </font></a><span class="string">  * 103 --&gt;  XC_GGA_X_B86  Becke 86 Xalfa,beta,gamma [[cite:Becke1986]]</span>
<a name="7557"><font size=-1>7557     </font></a><span class="string">  * 104 --&gt;  XC_GGA_X_HERMAN  Herman Xalphabeta GGA [[cite:Herman1969]]  [[cite:Herman2009]]</span>
<a name="7558"><font size=-1>7558     </font></a><span class="string">  * 105 --&gt;  XC_GGA_X_B86_MGC  Becke 86 Xalfa,beta,gamma (with mod. grad. correction) [[cite:Becke1986]]  [[cite:Becke1986a]]</span>
<a name="7559"><font size=-1>7559     </font></a><span class="string">  * 106 --&gt;  XC_GGA_X_B88  Becke 88 [[cite:Becke1988]]</span>
<a name="7560"><font size=-1>7560     </font></a><span class="string">  * 107 --&gt;  XC_GGA_X_G96  Gill 96 [[cite:Gill1996]]</span>
<a name="7561"><font size=-1>7561     </font></a><span class="string">  * 108 --&gt;  XC_GGA_X_PW86  Perdew &amp; Wang 86 [[cite:Perdew1986a]]</span>
<a name="7562"><font size=-1>7562     </font></a><span class="string">  * 109 --&gt;  XC_GGA_X_PW91  Perdew &amp; Wang 91 [JP Perdew, in Proceedings of the 21st Annual International Symposium on the Electronic Structure of Solids, ed. by P Ziesche and H Eschrig (Akademie Verlag, Berlin, 1991), p. 11. ]  [[cite:Perdew1992]]  [[cite:Perdew1993]]</span>
<a name="7563"><font size=-1>7563     </font></a><span class="string">  * 110 --&gt;  XC_GGA_X_OPTX  Handy &amp; Cohen OPTX 01 [[cite:Handy2001]]</span>
<a name="7564"><font size=-1>7564     </font></a><span class="string">  * 111 --&gt;  XC_GGA_X_DK87_R1  dePristo &amp; Kress 87 (version R1) [[cite:DePristo1987]]</span>
<a name="7565"><font size=-1>7565     </font></a><span class="string">  * 112 --&gt;  XC_GGA_X_DK87_R2  dePristo &amp; Kress 87 (version R2) [[cite:DePristo1987]]</span>
<a name="7566"><font size=-1>7566     </font></a><span class="string">  * 113 --&gt;  XC_GGA_X_LG93  Lacks &amp; Gordon 93 [[cite:Lacks1993]]</span>
<a name="7567"><font size=-1>7567     </font></a><span class="string">  * 114 --&gt;  XC_GGA_X_FT97_A  Filatov &amp; Thiel 97 (version A) [[cite:Filatov1997a]]</span>
<a name="7568"><font size=-1>7568     </font></a><span class="string">  * 115 --&gt;  XC_GGA_X_FT97_B  Filatov &amp; Thiel 97 (version B) [[cite:Filatov1997a]]</span>
<a name="7569"><font size=-1>7569     </font></a><span class="string">  * 116 --&gt;  XC_GGA_X_PBE_SOL  Perdew, Burke &amp; Ernzerhof exchange (solids) [[cite:Perdew2008]]</span>
<a name="7570"><font size=-1>7570     </font></a><span class="string">  * 117 --&gt;  XC_GGA_X_RPBE  Hammer, Hansen &amp; Norskov (PBE-like) [[cite:Hammer1999]]</span>
<a name="7571"><font size=-1>7571     </font></a><span class="string">  * 118 --&gt;  XC_GGA_X_WC  Wu &amp; Cohen [[cite:Wu2006]]</span>
<a name="7572"><font size=-1>7572     </font></a><span class="string">  * 119 --&gt;  XC_GGA_X_mPW91  Modified form of PW91 by Adamo &amp; Barone [[cite:Adamo1998]]</span>
<a name="7573"><font size=-1>7573     </font></a><span class="string">  * 120 --&gt;  XC_GGA_X_AM05  Armiento &amp; Mattsson 05 exchange [[cite:Armiento2005]]  [[cite:Mattsson2008]]</span>
<a name="7574"><font size=-1>7574     </font></a><span class="string">  * 121 --&gt;  XC_GGA_X_PBEA  Madsen (PBE-like) [[cite:Madsen2007]]</span>
<a name="7575"><font size=-1>7575     </font></a><span class="string">  * 122 --&gt;  XC_GGA_X_MPBE  Adamo &amp; Barone modification to PBE [[cite:Adamo2002]]</span>
<a name="7576"><font size=-1>7576     </font></a><span class="string">  * 123 --&gt;  XC_GGA_X_XPBE  xPBE reparametrization by Xu &amp; Goddard [[cite:Xu2004]]</span>
<a name="7577"><font size=-1>7577     </font></a><span class="string">  * 125 --&gt;  XC_GGA_X_BAYESIAN  Bayesian best fit for the enhancement factor [[cite:Mortensen2005]]</span>
<a name="7578"><font size=-1>7578     </font></a><span class="string">  * 126 --&gt;  XC_GGA_X_PBE_JSJR  PBE JSJR reparametrization by Pedroza, Silva &amp; Capelle [[cite:Pedroza2009]]</span>
<a name="7579"><font size=-1>7579     </font></a><span class="string">  * 130 --&gt;  XC_GGA_C_PBE  Perdew, Burke &amp; Ernzerhof correlation [[cite:Perdew1996]]  [[cite:Perdew1997]]</span>
<a name="7580"><font size=-1>7580     </font></a><span class="string">  * 131 --&gt;  XC_GGA_C_LYP  Lee, Yang &amp; Parr [[cite:Lee1988]]  [[cite:Miehlich1989]]</span>
<a name="7581"><font size=-1>7581     </font></a><span class="string">  * 132 --&gt;  XC_GGA_C_P86  Perdew 86 [[cite:Perdew1986]]</span>
<a name="7582"><font size=-1>7582     </font></a><span class="string">  * 133 --&gt;  XC_GGA_C_PBE_SOL  Perdew, Burke &amp; Ernzerhof correlation SOL [[cite:Perdew2008]]</span>
<a name="7583"><font size=-1>7583     </font></a><span class="string">  * 134 --&gt;  XC_GGA_C_PW91  Perdew &amp; Wang 91 [[cite:Perdew1992]]</span>
<a name="7584"><font size=-1>7584     </font></a><span class="string">  * 135 --&gt;  XC_GGA_C_AM05  Armiento &amp; Mattsson 05 correlation [[cite:Armiento2005]]  [[cite:Mattsson2008]]</span>
<a name="7585"><font size=-1>7585     </font></a><span class="string">  * 136 --&gt;  XC_GGA_C_XPBE  xPBE reparametrization by Xu &amp; Goddard [[cite:Xu2004]]</span>
<a name="7586"><font size=-1>7586     </font></a><span class="string">  * 137 --&gt;  XC_GGA_C_LM  Langreth and Mehl correlation [[cite:Langreth1981]]</span>
<a name="7587"><font size=-1>7587     </font></a><span class="string">  * 138 --&gt;  XC_GGA_C_PBE_JRGX  JRGX reparametrization by Pedroza, Silva &amp; Capelle [[cite:Pedroza2009]]</span>
<a name="7588"><font size=-1>7588     </font></a><span class="string">  * 139 --&gt;  XC_GGA_X_OPTB88_VDW  Becke 88 reoptimized to be used with vdW functional of Dion et al [[cite:Klimes2011]]</span>
<a name="7589"><font size=-1>7589     </font></a><span class="string">  * 140 --&gt;  XC_GGA_X_PBEK1_VDW  PBE reparametrization for vdW [[cite:Klimes2011]]</span>
<a name="7590"><font size=-1>7590     </font></a><span class="string">  * 141 --&gt;  XC_GGA_X_OPTPBE_VDW  PBE reparametrization for vdW [[cite:Klimes2011]]</span>
<a name="7591"><font size=-1>7591     </font></a><span class="string">  * 142 --&gt;  XC_GGA_X_RGE2  Regularized PBE [[cite:Ruzsinszky2009]]</span>
<a name="7592"><font size=-1>7592     </font></a><span class="string">  * 143 --&gt;  XC_GGA_C_RGE2  Regularized PBE [[cite:Ruzsinszky2009]]</span>
<a name="7593"><font size=-1>7593     </font></a><span class="string">  * 144 --&gt;  XC_GGA_X_RPW86  refitted Perdew &amp; Wang 86 [[cite:Murray2009]]</span>
<a name="7594"><font size=-1>7594     </font></a><span class="string">  * 145 --&gt;  XC_GGA_X_KT1  Keal and Tozer version 1 [[cite:Keal2003]]</span>
<a name="7595"><font size=-1>7595     </font></a><span class="string">  * 146 --&gt;  XC_GGA_XC_KT2 Keal and Tozer version 2 [[cite:Keal2003]]</span>
<a name="7596"><font size=-1>7596     </font></a><span class="string"></span>
<a name="7597"><font size=-1>7597     </font></a><span class="string">!!! warning</span>
<a name="7598"><font size=-1>7598     </font></a><span class="string">    This functional gives NaN on IBM (XG20130608).</span>
<a name="7599"><font size=-1>7599     </font></a><span class="string"></span>
<a name="7600"><font size=-1>7600     </font></a><span class="string">  * 147 --&gt;  XC_GGA_C_WL  Wilson &amp; Levy [[cite:Wilson1990]]</span>
<a name="7601"><font size=-1>7601     </font></a><span class="string">  * 148 --&gt;  XC_GGA_C_WI  Wilson &amp; Ivanov [[cite:Wilson1998]]</span>
<a name="7602"><font size=-1>7602     </font></a><span class="string">  * 149 --&gt;  XC_GGA_X_MB88  Modified Becke 88 for proton transfer [[cite:Tognetti2009]]</span>
<a name="7603"><font size=-1>7603     </font></a><span class="string">  * 150 --&gt;  XC_GGA_X_SOGGA  Second-order generalized gradient approximation [[cite:Zhao2008]]</span>
<a name="7604"><font size=-1>7604     </font></a><span class="string">  * 151 --&gt;  XC_GGA_X_SOGGA11  Second-order generalized gradient approximation 2011 [[cite:Peverati2011]]</span>
<a name="7605"><font size=-1>7605     </font></a><span class="string">  * 152 --&gt;  XC_GGA_C_SOGGA11  Second-order generalized gradient approximation 2011 [[cite:Peverati2011]]</span>
<a name="7606"><font size=-1>7606     </font></a><span class="string">  * 153 --&gt;  XC_GGA_C_WI0  Wilson &amp; Ivanov initial version [[cite:Wilson1998]]</span>
<a name="7607"><font size=-1>7607     </font></a><span class="string">  * 154 --&gt;  XC_GGA_XC_TH1  Tozer and Handy v. 1 [[cite:Tozer1998]]</span>
<a name="7608"><font size=-1>7608     </font></a><span class="string"></span>
<a name="7609"><font size=-1>7609     </font></a><span class="string">!!! warning</span>
<a name="7610"><font size=-1>7610     </font></a><span class="string">    This functional is not tested. Use at your own risks.</span>
<a name="7611"><font size=-1>7611     </font></a><span class="string"></span>
<a name="7612"><font size=-1>7612     </font></a><span class="string">  * 155 --&gt;  XC_GGA_XC_TH2  Tozer and Handy v. 2 [[cite:Tozer1998a]]</span>
<a name="7613"><font size=-1>7613     </font></a><span class="string">  * 156 --&gt;  XC_GGA_XC_TH3  Tozer and Handy v. 3 [[cite:Handy1998]]</span>
<a name="7614"><font size=-1>7614     </font></a><span class="string">  * 157 --&gt;  XC_GGA_XC_TH4  Tozer and Handy v. 4 [[cite:Handy1998]]</span>
<a name="7615"><font size=-1>7615     </font></a><span class="string">  * 158 --&gt;  XC_GGA_X_C09X  C09x to be used with the VdW of Rutgers-Chalmers [[cite:Cooper2010]]</span>
<a name="7616"><font size=-1>7616     </font></a><span class="string">  * 159 --&gt;  XC_GGA_C_SOGGA11_X  To be used with hyb_gga_x_SOGGA11-X [[cite:Peverati2011a]]</span>
<a name="7617"><font size=-1>7617     </font></a><span class="string">  * 161 --&gt;  XC_GGA_XC_HCTH_93  HCTH functional fitted to 93 molecules [[cite:Hamprecht1998]]</span>
<a name="7618"><font size=-1>7618     </font></a><span class="string">  * 162 --&gt;  XC_GGA_XC_HCTH_120  HCTH functional fitted to 120 molecules [[cite:Boese2000]]</span>
<a name="7619"><font size=-1>7619     </font></a><span class="string">  * 163 --&gt;  XC_GGA_XC_HCTH_147  HCTH functional fitted to 147 molecules [[cite:Boese2000]]</span>
<a name="7620"><font size=-1>7620     </font></a><span class="string">  * 164 --&gt;  XC_GGA_XC_HCTH_407  HCTH functional fitted to 407 molecules [[cite:Boese2001]]</span>
<a name="7621"><font size=-1>7621     </font></a><span class="string">  * 165 --&gt;  XC_GGA_XC_EDF1  Empirical functionals from Adamson, Gill, and Pople [[cite:Adamson1998]]</span>
<a name="7622"><font size=-1>7622     </font></a><span class="string">  * 166 --&gt;  XC_GGA_XC_XLYP  XLYP functional [[cite:Xu2004a]]</span>
<a name="7623"><font size=-1>7623     </font></a><span class="string">  * 167 --&gt;  XC_GGA_XC_B97  Becke 97 [[cite:Becke1997]]</span>
<a name="7624"><font size=-1>7624     </font></a><span class="string">  * 168 --&gt;  XC_GGA_XC_B97_1  Becke 97-1 [[cite:Hamprecht1998]]  [[cite:Becke1997]]</span>
<a name="7625"><font size=-1>7625     </font></a><span class="string">  * 169 --&gt;  XC_GGA_XC_B97_2  Becke 97-2 [[cite:Becke1997]]</span>
<a name="7626"><font size=-1>7626     </font></a><span class="string">  * 170 --&gt;  XC_GGA_XC_B97_D  Grimme functional to be used with C6 vdW term [[cite:Grimme2006]]</span>
<a name="7627"><font size=-1>7627     </font></a><span class="string">  * 171 --&gt;  XC_GGA_XC_B97_K  Boese-Martin for Kinetics [[cite:Boese2004]]</span>
<a name="7628"><font size=-1>7628     </font></a><span class="string">  * 172 --&gt;  XC_GGA_XC_B97_3  Becke 97-3 [[cite:Keal2005]]</span>
<a name="7629"><font size=-1>7629     </font></a><span class="string">  * 173 --&gt;  XC_GGA_XC_PBE1W  Functionals fitted for water [[cite:Dahlke2005]]</span>
<a name="7630"><font size=-1>7630     </font></a><span class="string">  * 174 --&gt;  XC_GGA_XC_MPWLYP1W  Functionals fitted for water [[cite:Dahlke2005]]</span>
<a name="7631"><font size=-1>7631     </font></a><span class="string">  * 175 --&gt;  XC_GGA_XC_PBELYP1W  Functionals fitted for water [[cite:Dahlke2005]]</span>
<a name="7632"><font size=-1>7632     </font></a><span class="string">  * 176 --&gt;  XC_GGA_XC_SB98_1a  Schmider-Becke 98 parameterization 1a [[cite:Schmider1998]]</span>
<a name="7633"><font size=-1>7633     </font></a><span class="string">  * 177 --&gt;  XC_GGA_XC_SB98_1b  Schmider-Becke 98 parameterization 1b [[cite:Schmider1998]]</span>
<a name="7634"><font size=-1>7634     </font></a><span class="string">  * 178 --&gt;  XC_GGA_XC_SB98_1c  Schmider-Becke 98 parameterization 1c [[cite:Schmider1998]]</span>
<a name="7635"><font size=-1>7635     </font></a><span class="string">  * 179 --&gt;  XC_GGA_XC_SB98_2a  Schmider-Becke 98 parameterization 2a [[cite:Schmider1998]]</span>
<a name="7636"><font size=-1>7636     </font></a><span class="string">  * 180 --&gt;  XC_GGA_XC_SB98_2b  Schmider-Becke 98 parameterization 2b [[cite:Schmider1998]]</span>
<a name="7637"><font size=-1>7637     </font></a><span class="string">  * 181 --&gt;  XC_GGA_XC_SB98_2c  Schmider-Becke 98 parameterization 2c [[cite:Schmider1998]]</span>
<a name="7638"><font size=-1>7638     </font></a><span class="string">  * 183 --&gt;  XC_GGA_X_OL2  Exchange form based on Ou-Yang and Levy v.2 [[cite:Fuentealba1995]]  [[cite:OuYang1991]]</span>
<a name="7639"><font size=-1>7639     </font></a><span class="string">  * 184 --&gt;  XC_GGA_X_APBE  mu fixed from the semiclassical neutral atom [[cite:Constantin2011]]</span>
<a name="7640"><font size=-1>7640     </font></a><span class="string">  * 186 --&gt;  XC_GGA_C_APBE  mu fixed from the semiclassical neutral atom [[cite:Constantin2011]]</span>
<a name="7641"><font size=-1>7641     </font></a><span class="string">  * 191 --&gt;  XC_GGA_X_HTBS  Haas, Tran, Blaha, and Schwarz [[cite:Haas2011]]</span>
<a name="7642"><font size=-1>7642     </font></a><span class="string">  * 192 --&gt;  XC_GGA_X_AIRY  Constantin et al based on the Airy gas [[cite:Constantin2009]]</span>
<a name="7643"><font size=-1>7643     </font></a><span class="string">  * 193 --&gt;  XC_GGA_X_LAG  Local Airy Gas [[cite:Vitos2000]]</span>
<a name="7644"><font size=-1>7644     </font></a><span class="string">  * 194 --&gt;  XC_GGA_XC_MOHLYP  Functional for organometallic chemistry [[cite:Schultz2005]]</span>
<a name="7645"><font size=-1>7645     </font></a><span class="string">  * 195 --&gt;  XC_GGA_XC_MOHLYP2  Functional for barrier heights [[cite:Zheng2009]]</span>
<a name="7646"><font size=-1>7646     </font></a><span class="string">  * 196 --&gt;  XC_GGA_XC_TH_FL  Tozer and Handy v. FL [[cite:Tozer1997]]</span>
<a name="7647"><font size=-1>7647     </font></a><span class="string">  * 197 --&gt;  XC_GGA_XC_TH_FC  Tozer and Handy v. FC [[cite:Tozer1997]]</span>
<a name="7648"><font size=-1>7648     </font></a><span class="string">  * 198 --&gt;  XC_GGA_XC_TH_FCFO  Tozer and Handy v. FCFO [[cite:Tozer1997]]</span>
<a name="7649"><font size=-1>7649     </font></a><span class="string">  * 199 --&gt;  XC_GGA_XC_TH_FCO  Tozer and Handy v. FCO [[cite:Tozer1997]]</span>
<a name="7650"><font size=-1>7650     </font></a><span class="string">  * 200 --&gt;  XC_GGA_C_OPTC  Optimized correlation functional of Cohen and Handy [[cite:Cohen2001]]</span>
<a name="7651"><font size=-1>7651     </font></a><span class="string">  * 524 --&gt;  XC_GGA_X_WPBEH  short-range version of the PBE [[cite:Heyd2003]]</span>
<a name="7652"><font size=-1>7652     </font></a><span class="string">  * 525 --&gt;  XC_GGA_X_HJS_PBE  HJS screened exchange PBE version [[cite:Henderson2008]]</span>
<a name="7653"><font size=-1>7653     </font></a><span class="string">  * 526 --&gt;  XC_GGA_X_HJS_PBE_SOL  HJS screened exchange PBE_SOL version [[cite:Henderson2008]]</span>
<a name="7654"><font size=-1>7654     </font></a><span class="string">  * 527 --&gt;  XC_GGA_X_HJS_B88  HJS screened exchange B88 version [[cite:Henderson2008]]</span>
<a name="7655"><font size=-1>7655     </font></a><span class="string"></span>
<a name="7656"><font size=-1>7656     </font></a><span class="string">!!! warning</span>
<a name="7657"><font size=-1>7657     </font></a><span class="string">    This functional is not tested. Use at your own risks.</span>
<a name="7658"><font size=-1>7658     </font></a><span class="string"></span>
<a name="7659"><font size=-1>7659     </font></a><span class="string">  * 528 --&gt;  XC_GGA_X_HJS_B97X  HJS screened exchange B97x version [[cite:Henderson2008]]</span>
<a name="7660"><font size=-1>7660     </font></a><span class="string">  * 529 --&gt;  XC_GGA_X_ITYH  short-range recipe for exchange GGA functionals [[cite:Iikura2001]]</span>
<a name="7661"><font size=-1>7661     </font></a><span class="string"></span>
<a name="7662"><font size=-1>7662     </font></a><span class="string">!!! warning</span>
<a name="7663"><font size=-1>7663     </font></a><span class="string">    This functional is not tested. Use at your own risks.</span>
<a name="7664"><font size=-1>7664     </font></a><span class="string"></span>
<a name="7665"><font size=-1>7665     </font></a><span class="string"></span>
<a name="7666"><font size=-1>7666     </font></a><span class="string">MetaGGA functionals (do not forget to add a minus sign, as discussed above).</span>
<a name="7667"><font size=-1>7667     </font></a><span class="string">See [[cite:Sun2011]] for the formulas.</span>
<a name="7668"><font size=-1>7668     </font></a><span class="string"></span>
<a name="7669"><font size=-1>7669     </font></a><span class="string">  * 202 --&gt;  XC_MGGA_X_TPSS  Tao, Perdew, Staroverov &amp; Scuseria [[cite:Tao2003]]  [[cite:Perdew2004]]</span>
<a name="7670"><font size=-1>7670     </font></a><span class="string">  * 203 --&gt;  XC_MGGA_X_M06L  Zhao, Truhlar exchange [[cite:Zhao2006]]  [[cite:Zhao2007]]</span>
<a name="7671"><font size=-1>7671     </font></a><span class="string">  * 204 --&gt;  XC_MGGA_X_GVT4  GVT4 (X part of VSXC) from van Voorhis and Scuseria [[cite:Voorhis1998]]</span>
<a name="7672"><font size=-1>7672     </font></a><span class="string">  * 205 --&gt;  XC_MGGA_X_TAU_HCTH  tau-HCTH from Boese and Handy [[cite:Boese2002]]</span>
<a name="7673"><font size=-1>7673     </font></a><span class="string">  * 207 --&gt;  XC_MGGA_X_BJ06  Becke &amp; Johnson correction to Becke-Roussel 89 [[cite:Becke2006]]</span>
<a name="7674"><font size=-1>7674     </font></a><span class="string"></span>
<a name="7675"><font size=-1>7675     </font></a><span class="string">!!! warning</span>
<a name="7676"><font size=-1>7676     </font></a><span class="string">    This Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92 [[cite:Perdew1992a]].</span>
<a name="7677"><font size=-1>7677     </font></a><span class="string"></span>
<a name="7678"><font size=-1>7678     </font></a><span class="string">  * 208 --&gt;  XC_MGGA_X_TB09  Tran-blaha - correction to Becke &amp; Johnson correction to Becke-Roussel 89 [[cite:Tran2009]]</span>
<a name="7679"><font size=-1>7679     </font></a><span class="string"></span>
<a name="7680"><font size=-1>7680     </font></a><span class="string">!!! warning</span>
<a name="7681"><font size=-1>7681     </font></a><span class="string">    This Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92 [[cite:Perdew1992a]].</span>
<a name="7682"><font size=-1>7682     </font></a><span class="string"></span>
<a name="7683"><font size=-1>7683     </font></a><span class="string">  * 209 --&gt;  XC_MGGA_X_RPP09  Rasanen, Pittalis, and Proetto correction to Becke &amp; Johnson [[cite:Rasanen2010]]</span>
<a name="7684"><font size=-1>7684     </font></a><span class="string"></span>
<a name="7685"><font size=-1>7685     </font></a><span class="string">!!! warning</span>
<a name="7686"><font size=-1>7686     </font></a><span class="string">    This Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92 [[cite:Perdew1992a]].</span>
<a name="7687"><font size=-1>7687     </font></a><span class="string"></span>
<a name="7688"><font size=-1>7688     </font></a><span class="string">  * 232 --&gt;  XC_MGGA_C_VSXC  VSxc from Van Voorhis and Scuseria (correlation part) [[cite:Voorhis1998]]</span>
<a name="7689"><font size=-1>7689     </font></a><span class="string"></span>
<a name="7690"><font size=-1>7690     </font></a><span class="string">Hybrid functionals (do not forget to add a minus sign, as discussed above).</span>
<a name="7691"><font size=-1>7691     </font></a><span class="string"></span>
<a name="7692"><font size=-1>7692     </font></a><span class="string">  * 402 --&gt;  XC_HYB_GGA_XC_B3LYP  The (in)famous B3LYP [[cite:Stephens1994]]</span>
<a name="7693"><font size=-1>7693     </font></a><span class="string">  * 406 --&gt;  XC_HYB_GGA_XC_PBEH  PBEH (PBE0) [[cite:Adamo1999]]  [[cite:Ernzerhof1999]]</span>
<a name="7694"><font size=-1>7694     </font></a><span class="string">  * 427 --&gt;  XC_HYB_GGA_XC_HSE03  The 2003 version of the screened hybrid HSE</span>
<a name="7695"><font size=-1>7695     </font></a><span class="string">                                  (in this case one should use $\omega^{HF} = 0.15/\sqrt{2}$</span>
<a name="7696"><font size=-1>7696     </font></a><span class="string">                                  and $\omega^{PBE} = 0.15*(2.0)^{1/3}$ )</span>
<a name="7697"><font size=-1>7697     </font></a><span class="string">  * 428 --&gt;  XC_HYB_GGA_XC_HSE06  The 2006 version of the screened hybrid HSE</span>
<a name="7698"><font size=-1>7698     </font></a><span class="string">                                  (in this case one should use $\omega^{HF} = \omega^{PBE} = 0.11$)</span>
<a name="7699"><font size=-1>7699     </font></a><span class="string">                                  (The following section is taken from the LibXC sources. In ABINIT, we stick to the LibXC choice.)</span>
<a name="7700"><font size=-1>7700     </font></a><span class="string">                                  Note that there is an enormous mess in the literature</span>
<a name="7701"><font size=-1>7701     </font></a><span class="string">                                  concerning the values of omega in HSE. This is due to an error in the original</span>
<a name="7702"><font size=-1>7702     </font></a><span class="string">                                  paper that stated that they had used $\omega=0.15$. This was in fact not true,</span>
<a name="7703"><font size=-1>7703     </font></a><span class="string">                                  and the real value used was $\omega^{HF} = 0.15 / \sqrt{2} \sim 0.1061$</span>
<a name="7704"><font size=-1>7704     </font></a><span class="string">                                  and $\omega^{PBE} = 0.15 * (2.0)^{1/3} \sim 0.1890$.</span>
<a name="7705"><font size=-1>7705     </font></a><span class="string">                                  In 2006 Krukau et al [[cite:Krukau2006]] tried</span>
<a name="7706"><font size=-1>7706     </font></a><span class="string">                                  to clarify the situation, and called HSE03 to the above choice of parameters,</span>
<a name="7707"><font size=-1>7707     </font></a><span class="string">                                  and called HSE06 to the functional where $\omega^{HF}=\omega^{PBE}$. By testing</span>
<a name="7708"><font size=-1>7708     </font></a><span class="string">                                  several properties for atoms they reached the conclusion that the best value</span>
<a name="7709"><font size=-1>7709     </font></a><span class="string">                                  for $\omega=0.11$. Of course, codes are just as messy as the papers. In Quantum Espresso</span>
<a name="7710"><font size=-1>7710     </font></a><span class="string">                                  HSE06 has the value $\omega=0.106.$ VASP, on the other hand, uses for HSE03 the</span>
<a name="7711"><font size=-1>7711     </font></a><span class="string">                                  same value $\omega^{HF} = \omega^{PBE} = 0.3 (A^{-1}) \sim 0.1587$,</span>
<a name="7712"><font size=-1>7712     </font></a><span class="string">                                  and for HSE06 $\omega^{HF} = \omega^{PBE} = 0.2 (A^{-1}) \sim 0.1058$.</span>
<a name="7713"><font size=-1>7713     </font></a><span class="string">                                  [[cite:Heyd2003]] [[cite:Heyd2006]] [[cite:Krukau2006]]</span>
<a name="7714"><font size=-1>7714     </font></a><span class="string"></span>
<a name="7715"><font size=-1>7715     </font></a><span class="string">  * 456 --&gt;  XC_HYB_GGA_XC_PBE0_13  PBE0-1/3 [[cite:Cortona2012]]</span>
<a name="7716"><font size=-1>7716     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7717"><font size=-1>7717     </font></a><span class="default">),</span>
<a name="7718"><font size=-1>7718     </font></a><span class="default"></span>
<a name="7719"><font size=-1>7719     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7720"><font size=-1>7720     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ixc_sigma&quot;</span><span class="default">,</span>
<a name="7721"><font size=-1>7721     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="7722"><font size=-1>7722     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7723"><font size=-1>7723     </font></a><span class="default">    topics=[</span><span class="string">'xc_expert'</span><span class="default">, </span><span class="string">'Hybrids_expert'</span><span class="default">],</span>
<a name="7724"><font size=-1>7724     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7725"><font size=-1>7725     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="7726"><font size=-1>7726     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Index of eXchange-Correlation functional used for self-energy calculations (SIGMA)&quot;</span><span class="default">,</span>
<a name="7727"><font size=-1>7727     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Default corresponds to Teter parametrization.&quot;</span><span class="default">,</span>
<a name="7728"><font size=-1>7728     </font></a><span class="default">    requires=</span><span class="string">&quot;mod([[gwcalctyp]],10)==5&quot;</span><span class="default">,</span>
<a name="7729"><font size=-1>7729     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7730"><font size=-1>7730     </font></a><span class="string">When [[gwcalctyp]] == 5, 15 or 25, [[ixc_sigma]] gives the identifier of the</span>
<a name="7731"><font size=-1>7731     </font></a><span class="string">advanced functional (usually a hybrid) that is used perturbatively or self-</span>
<a name="7732"><font size=-1>7732     </font></a><span class="string">consistently to obtain the improved electronic structure.</span>
<a name="7733"><font size=-1>7733     </font></a><span class="string"></span>
<a name="7734"><font size=-1>7734     </font></a><span class="string">The meaning of the values of [[ixc_sigma]] is the same as the ones of [[ixc]],</span>
<a name="7735"><font size=-1>7735     </font></a><span class="string">so we refer to the latter for the list of possible values.</span>
<a name="7736"><font size=-1>7736     </font></a><span class="string"></span>
<a name="7737"><font size=-1>7737     </font></a><span class="string">This input variable is introduced because in such calculation with</span>
<a name="7738"><font size=-1>7738     </font></a><span class="string">[[gwcalctyp]] == 5, 15 or 25, there is an underlying primary exchange-</span>
<a name="7739"><font size=-1>7739     </font></a><span class="string">correlation functional, that was used to obtain the starting wavefunctions and</span>
<a name="7740"><font size=-1>7740     </font></a><span class="string">eigenenergies, whose identified is [[ixc]]. The definition of both [[ixc]] and</span>
<a name="7741"><font size=-1>7741     </font></a><span class="string">[[ixc_sigma]] allows one to bypass possible sources of confusion.</span>
<a name="7742"><font size=-1>7742     </font></a><span class="string"></span>
<a name="7743"><font size=-1>7743     </font></a><span class="string">Note however that in the case where [[gwcalctyp]] == 5, 15 or 25, the values of</span>
<a name="7744"><font size=-1>7744     </font></a><span class="string">the input variables [[auxc_ixc]], [[hyb_mixing]], [[hyb_mixing_sr]],</span>
<a name="7745"><font size=-1>7745     </font></a><span class="string">[[hyb_range_fock]] and [[hyb_range_dft]] refers to the advanced functional,</span>
<a name="7746"><font size=-1>7746     </font></a><span class="string">and not the primary one. Also, [[icutcoul]] and [[rcut]] have precedence over</span>
<a name="7747"><font size=-1>7747     </font></a><span class="string">[[hyb_mixing]], [[hyb_mixing_sr]], [[hyb_range_fock]] and [[hyb_range_dft]] to</span>
<a name="7748"><font size=-1>7748     </font></a><span class="string">define the parameters of the hybrid functional.</span>
<a name="7749"><font size=-1>7749     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7750"><font size=-1>7750     </font></a><span class="default">),</span>
<a name="7751"><font size=-1>7751     </font></a><span class="default"></span>
<a name="7752"><font size=-1>7752     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7753"><font size=-1>7753     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ixcpositron&quot;</span><span class="default">,</span>
<a name="7754"><font size=-1>7754     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="7755"><font size=-1>7755     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7756"><font size=-1>7756     </font></a><span class="default">    topics=[</span><span class="string">'positron_basic'</span><span class="default">],</span>
<a name="7757"><font size=-1>7757     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7758"><font size=-1>7758     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="7759"><font size=-1>7759     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Integer for the eXchange-Correlation applied to the electron-POSITRON interaction&quot;</span><span class="default">,</span>
<a name="7760"><font size=-1>7760     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;(Teter parameterization). However, if all the pseudopotentials have the same value of pspxc, the initial value of ixc will be that common value&quot;</span><span class="default">,</span>
<a name="7761"><font size=-1>7761     </font></a><span class="default">    requires=</span><span class="string">&quot;[[positron]]/=0&quot;</span><span class="default">,</span>
<a name="7762"><font size=-1>7762     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7763"><font size=-1>7763     </font></a><span class="string">Relevant only when [[positron]]/=0.</span>
<a name="7764"><font size=-1>7764     </font></a><span class="string">Define the type of electron-positron correlation that is used in case of a</span>
<a name="7765"><font size=-1>7765     </font></a><span class="string">electron-positron two-component DFT calculation.</span>
<a name="7766"><font size=-1>7766     </font></a><span class="string">Define also the analytical formula of the enhancement factor used to compute</span>
<a name="7767"><font size=-1>7767     </font></a><span class="string">the electron-positron annhilation rate:</span>
<a name="7768"><font size=-1>7768     </font></a><span class="string"></span>
<a name="7769"><font size=-1>7769     </font></a><span class="string">Electron-positron correlation functional:</span>
<a name="7770"><font size=-1>7770     </font></a><span class="string"></span>
<a name="7771"><font size=-1>7771     </font></a><span class="string">  * ixcpositron=1: LDA zero positron density limit parametrized by</span>
<a name="7772"><font size=-1>7772     </font></a><span class="string">Arponen &amp; Pajanne and provided by Boronski &amp; Nieminen [[cite:Arponen1979a]],[[cite:Boronski1986]]</span>
<a name="7773"><font size=-1>7773     </font></a><span class="string">  * ixcpositron=11: LDA zero positron density limit parametrized by</span>
<a name="7774"><font size=-1>7774     </font></a><span class="string">Arponen &amp; Pajanne and fitted by Sterne &amp; Kaiser [[cite:Arponen1979a]],[[cite:Sterne1991]]</span>
<a name="7775"><font size=-1>7775     </font></a><span class="string">  * ixcpositron=2: LDA electron-positron correlation provided by</span>
<a name="7776"><font size=-1>7776     </font></a><span class="string">Puska, Seitsonen, and Nieminen [[cite:Arponen1979a]],[[cite:Puska1995]]</span>
<a name="7777"><font size=-1>7777     </font></a><span class="string">  * ixcpositron=3: GGA zero positron density limit parametrized by</span>
<a name="7778"><font size=-1>7778     </font></a><span class="string">Arponen &amp; Pajanne and provided by Boronski &amp; Nieminen [[cite:Arponen1979a]],[[cite:Boronski1986]],[[cite:Barbiellini1995]]</span>
<a name="7779"><font size=-1>7779     </font></a><span class="string">  * ixcpositron=31: GGA zero positron density limit parametrized</span>
<a name="7780"><font size=-1>7780     </font></a><span class="string">by Arponen &amp; Pajanne and fitted by Sterne &amp; Kaiser [[cite:Arponen1979a]],[[cite:Sterne1991]],[[cite:Barbiellini1995]]</span>
<a name="7781"><font size=-1>7781     </font></a><span class="string"></span>
<a name="7782"><font size=-1>7782     </font></a><span class="string">Annihilation rate enhancement factor:</span>
<a name="7783"><font size=-1>7783     </font></a><span class="string"></span>
<a name="7784"><font size=-1>7784     </font></a><span class="string">  * ixcpositron=1: Boronski and Nieminen full modelisation and RPA limit [[cite:Arponen1979a]]</span>
<a name="7785"><font size=-1>7785     </font></a><span class="string">  * ixcpositron=11: Sterne and Kaiser [[cite:Boronski1986]]</span>
<a name="7786"><font size=-1>7786     </font></a><span class="string">  * ixcpositron=2: Puska, Seitsonen and Nieminen [[cite:Sterne1991]]</span>
<a name="7787"><font size=-1>7787     </font></a><span class="string">  * ixcpositron=3: Boronski and Nieminen full modelisation and RPA limit [[cite:Arponen1979a]], with GGA corrections</span>
<a name="7788"><font size=-1>7788     </font></a><span class="string">  * ixcpositron=31: Sterne and Kaiser [[cite:Boronski1986]], with GGA corrections</span>
<a name="7789"><font size=-1>7789     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7790"><font size=-1>7790     </font></a><span class="default">),</span>
<a name="7791"><font size=-1>7791     </font></a><span class="default"></span>
<a name="7792"><font size=-1>7792     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7793"><font size=-1>7793     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ixcrot&quot;</span><span class="default">,</span>
<a name="7794"><font size=-1>7794     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="7795"><font size=-1>7795     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7796"><font size=-1>7796     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">, </span><span class="string">'xc_expert'</span><span class="default">],</span>
<a name="7797"><font size=-1>7797     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7798"><font size=-1>7798     </font></a><span class="default">    defaultval=</span><span class="number">3</span><span class="default">,</span>
<a name="7799"><font size=-1>7799     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Index of the XC ROTation method used to calculate first-order exchange-correlation potential in non-collinear DFPT calculations&quot;</span><span class="default">,</span>
<a name="7800"><font size=-1>7800     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="7801"><font size=-1>7801     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7802"><font size=-1>7802     </font></a><span class="string">Method of calculation of the 1st order XC potential in non-collinear DFPT</span>
<a name="7803"><font size=-1>7803     </font></a><span class="string">calculations. The possible values 1,2 and 3 correspond to the following</span>
<a name="7804"><font size=-1>7804     </font></a><span class="string">methods</span>
<a name="7805"><font size=-1>7805     </font></a><span class="string"></span>
<a name="7806"><font size=-1>7806     </font></a><span class="string">  * If ixcrot=1, the spinor rotation matrix U at each fft point is not calculated explicitly. Instead the needed expressions involving U are derived based on the general properties of the U matrix.</span>
<a name="7807"><font size=-1>7807     </font></a><span class="string">  * If ixcrot=2, U is computed explicitly</span>
<a name="7808"><font size=-1>7808     </font></a><span class="string">  * If ixcrot=3, the brute force evaluation of the 1st order XC potential as a functional derivative is used. Rotation matrices are not computed.</span>
<a name="7809"><font size=-1>7809     </font></a><span class="string"></span>
<a name="7810"><font size=-1>7810     </font></a><span class="string">In theory, all methods give identical results. However, due to different</span>
<a name="7811"><font size=-1>7811     </font></a><span class="string">implementation approaches, the round-off errors can lead to slight differences</span>
<a name="7812"><font size=-1>7812     </font></a><span class="string">intermediate and final results obtained using methods 1,2 and 3. The choice of</span>
<a name="7813"><font size=-1>7813     </font></a><span class="string">the method can also affect the convergence.</span>
<a name="7814"><font size=-1>7814     </font></a><span class="string"></span>
<a name="7815"><font size=-1>7815     </font></a><span class="string">!!! note</span>
<a name="7816"><font size=-1>7816     </font></a><span class="string">    For non-zero perturbation wavevector, only ixcrot=3 implementation is currently available.</span>
<a name="7817"><font size=-1>7817     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7818"><font size=-1>7818     </font></a><span class="default">),</span>
<a name="7819"><font size=-1>7819     </font></a><span class="default"></span>
<a name="7820"><font size=-1>7820     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7821"><font size=-1>7821     </font></a><span class="default">    abivarname=</span><span class="string">&quot;jdtset&quot;</span><span class="default">,</span>
<a name="7822"><font size=-1>7822     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="7823"><font size=-1>7823     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7824"><font size=-1>7824     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_basic'</span><span class="default">],</span>
<a name="7825"><font size=-1>7825     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ndtset]]'</span><span class="default">],</span>
<a name="7826"><font size=-1>7826     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#7747">Range</a>({</span><span class="string">'start'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'stop'</span><span class="default">: </span><span class="string">'[[ndtset]]'</span><span class="default">}),</span>
<a name="7827"><font size=-1>7827     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;index -J- for DaTaSETs&quot;</span><span class="default">,</span>
<a name="7828"><font size=-1>7828     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="7829"><font size=-1>7829     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7830"><font size=-1>7830     </font></a><span class="string">Gives the dataset index of each of the datasets. This index will be used:</span>
<a name="7831"><font size=-1>7831     </font></a><span class="string"></span>
<a name="7832"><font size=-1>7832     </font></a><span class="string">  * to determine which input variables are specific to each dataset, since the variable names for this dataset will be made from the bare variable name concatenated with this index, and only if such a composite variable name does not exist, the code will consider the bare variable name, or even, the Default;</span>
<a name="7833"><font size=-1>7833     </font></a><span class="string">  * to characterize output variable names, if their content differs from dataset to dataset;</span>
<a name="7834"><font size=-1>7834     </font></a><span class="string">  * to characterize output files ( root names appended with _DSx where 'x' is the dataset index ).</span>
<a name="7835"><font size=-1>7835     </font></a><span class="string"></span>
<a name="7836"><font size=-1>7836     </font></a><span class="string">The allowed index values are between 1 and 9999.</span>
<a name="7837"><font size=-1>7837     </font></a><span class="string">An input variable name appended with 0 is not allowed.</span>
<a name="7838"><font size=-1>7838     </font></a><span class="string">When [[ndtset]] == 0, this array is not used, and moreover, no input variable</span>
<a name="7839"><font size=-1>7839     </font></a><span class="string">name appended with a digit is allowed. This array might be initialized thanks</span>
<a name="7840"><font size=-1>7840     </font></a><span class="string">to the use of the input variable [[udtset]]. In this case, [[jdtset]] cannot be used.</span>
<a name="7841"><font size=-1>7841     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7842"><font size=-1>7842     </font></a><span class="default">),</span>
<a name="7843"><font size=-1>7843     </font></a><span class="default"></span>
<a name="7844"><font size=-1>7844     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7845"><font size=-1>7845     </font></a><span class="default">    abivarname=</span><span class="string">&quot;jellslab&quot;</span><span class="default">,</span>
<a name="7846"><font size=-1>7846     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="7847"><font size=-1>7847     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7848"><font size=-1>7848     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_expert'</span><span class="default">],</span>
<a name="7849"><font size=-1>7849     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="7850"><font size=-1>7850     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="7851"><font size=-1>7851     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;include a JELLium SLAB in the cell&quot;</span><span class="default">,</span>
<a name="7852"><font size=-1>7852     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7853"><font size=-1>7853     </font></a><span class="string">If set to 1, a slab of uniform positive background charge density, that is, a</span>
<a name="7854"><font size=-1>7854     </font></a><span class="string">jellium slab, is included in the calculation cell. A portion of the unit cell</span>
<a name="7855"><font size=-1>7855     </font></a><span class="string">is filled with such positive charge density distribution which is equal to a</span>
<a name="7856"><font size=-1>7856     </font></a><span class="string">bulk-mean value $n_{bulk}$ between two edges and zero in the vacuum region if present.</span>
<a name="7857"><font size=-1>7857     </font></a><span class="string">For the sake of convenience the unit cell is supposed to have the third</span>
<a name="7858"><font size=-1>7858     </font></a><span class="string">crystal primitive lattice vector orthogonal to the other ones so that the</span>
<a name="7859"><font size=-1>7859     </font></a><span class="string">portion of the cell filled by the jellium slab can be defined through its edges along z.</span>
<a name="7860"><font size=-1>7860     </font></a><span class="string">The bulk-mean positive charge density is fixed by the input variable</span>
<a name="7861"><font size=-1>7861     </font></a><span class="string">[[slabwsrad]], while the position of the slab edges along z is defined through</span>
<a name="7862"><font size=-1>7862     </font></a><span class="string">the input variables [[slabzbeg]] and [[slabzend]].</span>
<a name="7863"><font size=-1>7863     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7864"><font size=-1>7864     </font></a><span class="default">),</span>
<a name="7865"><font size=-1>7865     </font></a><span class="default"></span>
<a name="7866"><font size=-1>7866     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7867"><font size=-1>7867     </font></a><span class="default">    abivarname=</span><span class="string">&quot;jfielddir&quot;</span><span class="default">,</span>
<a name="7868"><font size=-1>7868     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="7869"><font size=-1>7869     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7870"><font size=-1>7870     </font></a><span class="default">    topics=[</span><span class="string">'Berry_basic'</span><span class="default">],</span>
<a name="7871"><font size=-1>7871     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="7872"><font size=-1>7872     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="7873"><font size=-1>7873     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;electric/displacement FIELD DIRection&quot;</span><span class="default">,</span>
<a name="7874"><font size=-1>7874     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] = 17&quot;</span><span class="default">,</span>
<a name="7875"><font size=-1>7875     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7876"><font size=-1>7876     </font></a><span class="string">When specifying mixed electric field boundary conditions ( [[berryopt]] = 17),</span>
<a name="7877"><font size=-1>7877     </font></a><span class="string">[[jfielddir]] controls whether reduced electric field ([[jfielddir]] = 1) or reduced</span>
<a name="7878"><font size=-1>7878     </font></a><span class="string">electric displacement field ([[jfielddir]] = 2) is chosen to be fixed, in each</span>
<a name="7879"><font size=-1>7879     </font></a><span class="string">of the three lattice directions (i.e., in the reduced, not the Cartesian,</span>
<a name="7880"><font size=-1>7880     </font></a><span class="string">frame). For example, [[jfielddir]] = (1 1 2) tells the code to use fixed $\\bar{e}_1$</span>
<a name="7881"><font size=-1>7881     </font></a><span class="string">and $\\bar{e}_2$ along the first two lattice directions and fixed $d_3$ along the third.</span>
<a name="7882"><font size=-1>7882     </font></a><span class="string">For the case of mixed electric field boundary conditions, [[red_efieldbar]]</span>
<a name="7883"><font size=-1>7883     </font></a><span class="string">and [[red_dfield]] are used to control $\\bar{e}$ and $d$, respectively. For example,</span>
<a name="7884"><font size=-1>7884     </font></a><span class="string">for electric boundary conditions corresponding to a material in a parallel-</span>
<a name="7885"><font size=-1>7885     </font></a><span class="string">plate capacitor, if you want to control $d_3=d_0$, while fixing $\\bar{e}_1=\\bar{e}_1=0$,</span>
<a name="7886"><font size=-1>7886     </font></a><span class="string">then the input files should have [[berryopt]] = 17, [[jfielddir]] = (1 1 2),</span>
<a name="7887"><font size=-1>7887     </font></a><span class="string">[[red_efieldbar]] = (0.0 0.0 a), and [[red_dfield]] = ($b\ c\ d_0$). Here a, b, and c</span>
<a name="7888"><font size=-1>7888     </font></a><span class="string">are the starting values. They can be chosen in this way: do a single run for</span>
<a name="7889"><font size=-1>7889     </font></a><span class="string">fixed d calculation ([[red_dfield]] = 0,0,$d_0$), from the final results you will</span>
<a name="7890"><font size=-1>7890     </font></a><span class="string">have $\\bar{e}_3$, which is a good guess for a. Then do another single run for fixed</span>
<a name="7891"><font size=-1>7891     </font></a><span class="string">ebar calculation ([[red_efieldbar]] = (0 0 0)), from the final results you will</span>
<a name="7892"><font size=-1>7892     </font></a><span class="string">have $d_1$,$d_2$, these are good guesses for b, c.</span>
<a name="7893"><font size=-1>7893     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7894"><font size=-1>7894     </font></a><span class="default">),</span>
<a name="7895"><font size=-1>7895     </font></a><span class="default"></span>
<a name="7896"><font size=-1>7896     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7897"><font size=-1>7897     </font></a><span class="default">    abivarname=</span><span class="string">&quot;jpawu&quot;</span><span class="default">,</span>
<a name="7898"><font size=-1>7898     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="7899"><font size=-1>7899     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="7900"><font size=-1>7900     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_compulsory'</span><span class="default">],</span>
<a name="7901"><font size=-1>7901     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="7902"><font size=-1>7902     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="7903"><font size=-1>7903     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;value of J for PAW+U&quot;</span><span class="default">,</span>
<a name="7904"><font size=-1>7904     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="7905"><font size=-1>7905     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[usepawu]] == 1&quot;</span><span class="default">,</span>
<a name="7906"><font size=-1>7906     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7907"><font size=-1>7907     </font></a><span class="string">Gives the value of the screened exchange interaction between correlated</span>
<a name="7908"><font size=-1>7908     </font></a><span class="string">electrons corresponding to [[lpawu]] for each species.</span>
<a name="7909"><font size=-1>7909     </font></a><span class="string">In the case where [[lpawu]] =-1, the value is not used.</span>
<a name="7910"><font size=-1>7910     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7911"><font size=-1>7911     </font></a><span class="default">),</span>
<a name="7912"><font size=-1>7912     </font></a><span class="default"></span>
<a name="7913"><font size=-1>7913     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7914"><font size=-1>7914     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kberry&quot;</span><span class="default">,</span>
<a name="7915"><font size=-1>7915     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="7916"><font size=-1>7916     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="7917"><font size=-1>7917     </font></a><span class="default">    topics=[</span><span class="string">'Berry_basic'</span><span class="default">],</span>
<a name="7918"><font size=-1>7918     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nberry]]'</span><span class="default">],</span>
<a name="7919"><font size=-1>7919     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="7920"><font size=-1>7920     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K wavevectors for BERRY phase computation&quot;</span><span class="default">,</span>
<a name="7921"><font size=-1>7921     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] = 1, 2, or 3&quot;</span><span class="default">,</span>
<a name="7922"><font size=-1>7922     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7923"><font size=-1>7923     </font></a><span class="string">Used for values of [[berryopt]] = 1, 2, or 3.</span>
<a name="7924"><font size=-1>7924     </font></a><span class="string"></span>
<a name="7925"><font size=-1>7925     </font></a><span class="string">This array defines, for each Berry phase calculation (the number of such</span>
<a name="7926"><font size=-1>7926     </font></a><span class="string">calculations is defined by [[nberry]]), the difference of wavevector between k</span>
<a name="7927"><font size=-1>7927     </font></a><span class="string">points for which the overlap matrix must be computed. The polarisation vector</span>
<a name="7928"><font size=-1>7928     </font></a><span class="string">will be projected on the direction of that wavevector, and the result of the</span>
<a name="7929"><font size=-1>7929     </font></a><span class="string">computation will be the magnitude of this projection. Doing more than one</span>
<a name="7930"><font size=-1>7930     </font></a><span class="string">wavevector, with different independent direction, allows one to find the full</span>
<a name="7931"><font size=-1>7931     </font></a><span class="string">polarisation vector. However, note that converged results need oriented grids,</span>
<a name="7932"><font size=-1>7932     </font></a><span class="string">denser along the difference wavevector than usual Monkhorst-Pack grids.</span>
<a name="7933"><font size=-1>7933     </font></a><span class="string"></span>
<a name="7934"><font size=-1>7934     </font></a><span class="string">The difference of wavevector is computed in the coordinate system defined by</span>
<a name="7935"><font size=-1>7935     </font></a><span class="string">the k-points grid (see [[ngkpt]] and [[kptrlatt]]), so that the values of</span>
<a name="7936"><font size=-1>7936     </font></a><span class="string">[[kberry]] are integers. Of course, such a k point grid must exist, and all</span>
<a name="7937"><font size=-1>7937     </font></a><span class="string">the corresponding wavefunctions must be available, so that the computation is</span>
<a name="7938"><font size=-1>7938     </font></a><span class="string">allowed only when [[kptopt]] is equal to 3. In order to save computing time,</span>
<a name="7939"><font size=-1>7939     </font></a><span class="string">it is suggested to make a preliminary calculation of the wavefunctions on the</span>
<a name="7940"><font size=-1>7940     </font></a><span class="string">irreducible part of the grid, with [[kptopt]] equal to 1, and then use these</span>
<a name="7941"><font size=-1>7941     </font></a><span class="string">converged wavefunctions in the entire Brillouin zone, by reading them to</span>
<a name="7942"><font size=-1>7942     </font></a><span class="string">initialize the [[kptopt]] = 3 computation.</span>
<a name="7943"><font size=-1>7943     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7944"><font size=-1>7944     </font></a><span class="default">),</span>
<a name="7945"><font size=-1>7945     </font></a><span class="default"></span>
<a name="7946"><font size=-1>7946     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7947"><font size=-1>7947     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kpt&quot;</span><span class="default">,</span>
<a name="7948"><font size=-1>7948     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="7949"><font size=-1>7949     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="7950"><font size=-1>7950     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="7951"><font size=-1>7951     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nkpt]]'</span><span class="default">],</span>
<a name="7952"><font size=-1>7952     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="7953"><font size=-1>7953     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K - PoinTs&quot;</span><span class="default">,</span>
<a name="7954"><font size=-1>7954     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Adequate for one molecule in a supercell&quot;</span><span class="default">,</span>
<a name="7955"><font size=-1>7955     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7956"><font size=-1>7956     </font></a><span class="string">Contains the k points in terms of reciprocal space primitive translations (NOT</span>
<a name="7957"><font size=-1>7957     </font></a><span class="string">in cartesian coordinates!).</span>
<a name="7958"><font size=-1>7958     </font></a><span class="string">Needed ONLY if [[kptopt]] = 0, otherwise deduced from other input variables.</span>
<a name="7959"><font size=-1>7959     </font></a><span class="string"></span>
<a name="7960"><font size=-1>7960     </font></a><span class="string">It contains dimensionless numbers in terms of which the cartesian coordinates</span>
<a name="7961"><font size=-1>7961     </font></a><span class="string">would be:</span>
<a name="7962"><font size=-1>7962     </font></a><span class="string">k_cartesian = k1*G1+k2*G2+k3*G3</span>
<a name="7963"><font size=-1>7963     </font></a><span class="string">where  (k1,k2,k3)  represent the dimensionless &quot;reduced coordinates&quot; and  G1,</span>
<a name="7964"><font size=-1>7964     </font></a><span class="string">G2, G3  are the cartesian coordinates of the primitive translation vectors.</span>
<a name="7965"><font size=-1>7965     </font></a><span class="string">G1,G2,G3 are related to the choice of direct space primitive translation</span>
<a name="7966"><font size=-1>7966     </font></a><span class="string">vectors made in [[rprim]]. Note that an overall norm for the k points is</span>
<a name="7967"><font size=-1>7967     </font></a><span class="string">supplied by [[kptnrm]]. This allows one to avoid supplying many digits for the</span>
<a name="7968"><font size=-1>7968     </font></a><span class="string">k points to represent such points as (1,1,1)/3.</span>
<a name="7969"><font size=-1>7969     </font></a><span class="string">Note: one of the algorithms used to set up the sphere of G vectors for the</span>
<a name="7970"><font size=-1>7970     </font></a><span class="string">basis needs components of k-points in the range [-1,1], so the remapping is</span>
<a name="7971"><font size=-1>7971     </font></a><span class="string">easily done by adding or subtracting 1 from each component until it is in the</span>
<a name="7972"><font size=-1>7972     </font></a><span class="string">range [-1,1]. That is, given the k point normalization [[kptnrm]] described</span>
<a name="7973"><font size=-1>7973     </font></a><span class="string">below, each component must lie in [ -[[kptnrm]], [[kptnrm]] ].</span>
<a name="7974"><font size=-1>7974     </font></a><span class="string">Note: a global shift can be provided by [[qptn]]</span>
<a name="7975"><font size=-1>7975     </font></a><span class="string">Not read if [[kptopt]]/=0.</span>
<a name="7976"><font size=-1>7976     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="7977"><font size=-1>7977     </font></a><span class="default">),</span>
<a name="7978"><font size=-1>7978     </font></a><span class="default"></span>
<a name="7979"><font size=-1>7979     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="7980"><font size=-1>7980     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptbounds&quot;</span><span class="default">,</span>
<a name="7981"><font size=-1>7981     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="7982"><font size=-1>7982     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="7983"><font size=-1>7983     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">, </span><span class="string">'ElecBandStructure_basic'</span><span class="default">],</span>
<a name="7984"><font size=-1>7984     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'abs([[kptopt]])+1)'</span><span class="default">],</span>
<a name="7985"><font size=-1>7985     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K PoinT BOUNDarieS&quot;</span><span class="default">,</span>
<a name="7986"><font size=-1>7986     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="7987"><font size=-1>7987     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="7988"><font size=-1>7988     </font></a><span class="string">It is used to generate the circuit to be followed by the band structure, when</span>
<a name="7989"><font size=-1>7989     </font></a><span class="string">[[kptopt]] is negative (it is not read if [[kptopt]] is zero or positive).</span>
<a name="7990"><font size=-1>7990     </font></a><span class="string"></span>
<a name="7991"><font size=-1>7991     </font></a><span class="string">There are abs([[kptopt]]) segments to be defined, each of which starting from</span>
<a name="7992"><font size=-1>7992     </font></a><span class="string">the end point of the preceeding one. Thus, the number of points to be input is</span>
<a name="7993"><font size=-1>7993     </font></a><span class="string">abs([[kptopt]])+1. They form a circuit starting at</span>
<a name="7994"><font size=-1>7994     </font></a><span class="string">[[kptbounds]](1:3,1)/[[kptnrm]] and ending at</span>
<a name="7995"><font size=-1>7995     </font></a><span class="string">[[kptbounds]](1:3,abs([[kptopt]])+1)/[[kptnrm]]. The number of divisions of</span>
<a name="7996"><font size=-1>7996     </font></a><span class="string">each segment can be defined either using the array [[ndivk]] or the variable</span>
<a name="7997"><font size=-1>7997     </font></a><span class="string">[[ndivsm]] that just defines the number of divisions for the smallest segment</span>
<a name="7998"><font size=-1>7998     </font></a><span class="string"></span>
<a name="7999"><font size=-1>7999     </font></a><span class="string">As for [[kpt]], [[kptbounds]] is specified using the primitive vectors in</span>
<a name="8000"><font size=-1>8000     </font></a><span class="string">reciprocal space. If your Bravais lattice is simple, then it should be quite</span>
<a name="8001"><font size=-1>8001     </font></a><span class="string">easy to find the coordinates of the end points. On the other hand, for</span>
<a name="8002"><font size=-1>8002     </font></a><span class="string">centered, body-centered, face-centered, hexagonal, and rhombohedral Bravais</span>
<a name="8003"><font size=-1>8003     </font></a><span class="string">lattice, the conversion might be more difficult. See the description of</span>
<a name="8004"><font size=-1>8004     </font></a><span class="string">[[kpt]] for an explanation of how to convert data from the &quot;conventional&quot;</span>
<a name="8005"><font size=-1>8005     </font></a><span class="string">cartesian coordinates to the primitive vectors in the reciprocal space. In</span>
<a name="8006"><font size=-1>8006     </font></a><span class="string">order to help a bit, we list below a series of typical values, for the FCC,</span>
<a name="8007"><font size=-1>8007     </font></a><span class="string">BCC, hexagonal and rhombohedral Bravais lattices. Note: all the data below</span>
<a name="8008"><font size=-1>8008     </font></a><span class="string">are given in dimensionless units; they have to be rescaled by the actual</span>
<a name="8009"><font size=-1>8009     </font></a><span class="string">lengths defined by the [[acell]] values. However, [[kptbounds]] values can be</span>
<a name="8010"><font size=-1>8010     </font></a><span class="string">used as such, if the values of [[rprim]] given below are adopted.</span>
<a name="8011"><font size=-1>8011     </font></a><span class="string"></span>
<a name="8012"><font size=-1>8012     </font></a><span class="string">A. **FCC lattice**</span>
<a name="8013"><font size=-1>8013     </font></a><span class="string"></span>
<a name="8014"><font size=-1>8014     </font></a><span class="string">Suppose the primitive vectors in real space are given by</span>
<a name="8015"><font size=-1>8015     </font></a><span class="string"></span>
<a name="8016"><font size=-1>8016     </font></a><span class="string">      rprim   0 1 1    1 0 1    1 1 0</span>
<a name="8017"><font size=-1>8017     </font></a><span class="string">or</span>
<a name="8018"><font size=-1>8018     </font></a><span class="string"></span>
<a name="8019"><font size=-1>8019     </font></a><span class="string">      rprim   0 1/2 1/2    1/2 0 1/2    1/2 1/2 0</span>
<a name="8020"><font size=-1>8020     </font></a><span class="string"></span>
<a name="8021"><font size=-1>8021     </font></a><span class="string">(these two possibilities only differ by a scaling factor, irrelevant for the</span>
<a name="8022"><font size=-1>8022     </font></a><span class="string">definition of the k points in the primitive vectors in reciprocal space).</span>
<a name="8023"><font size=-1>8023     </font></a><span class="string">Then, the reciprocal primitive vectors (in conventional cartesian coordinates) are</span>
<a name="8024"><font size=-1>8024     </font></a><span class="string"></span>
<a name="8025"><font size=-1>8025     </font></a><span class="string">      (-1/2 1/2 1/2), (1/2 -1/2 1/2), (1/2 1/2 -1/2)</span>
<a name="8026"><font size=-1>8026     </font></a><span class="string"></span>
<a name="8027"><font size=-1>8027     </font></a><span class="string">or</span>
<a name="8028"><font size=-1>8028     </font></a><span class="string"></span>
<a name="8029"><font size=-1>8029     </font></a><span class="string">      (-1 1 1), (1 -1 1), (1 1 -1)</span>
<a name="8030"><font size=-1>8030     </font></a><span class="string"></span>
<a name="8031"><font size=-1>8031     </font></a><span class="string">and, in both cases, the coordinates of several special points with respect to</span>
<a name="8032"><font size=-1>8032     </font></a><span class="string">primitive vectors in reciprocal space are</span>
<a name="8033"><font size=-1>8033     </font></a><span class="string"></span>
<a name="8034"><font size=-1>8034     </font></a><span class="string">      X (0   1/2 1/2)   (conventional cartesian coordinate 1/2 0 0)</span>
<a name="8035"><font size=-1>8035     </font></a><span class="string">      X'(1/2 1/2 1  )   (conventional cartesian coordinate 1/2 1/2 0)  (an other instance of X, in another Brillouin zone)</span>
<a name="8036"><font size=-1>8036     </font></a><span class="string">      L (1/2 1/2 1/2)   (conventional cartesian coordinate  1/4 1/4 1/4)</span>
<a name="8037"><font size=-1>8037     </font></a><span class="string">      L'(1/2 0   0  )   (conventional cartesian coordinate -1/4 1/4 1/4) (an other instance of L, on another face of the BZ)</span>
<a name="8038"><font size=-1>8038     </font></a><span class="string">      W (1/4 1/2 3/4)   (conventional cartesian coordinate 1/2 1/4 0)</span>
<a name="8039"><font size=-1>8039     </font></a><span class="string">      U (1/4 5/8 5/8)   (conventional cartesian coordinate 1/2 1/8 1/8)</span>
<a name="8040"><font size=-1>8040     </font></a><span class="string">      K (3/8 3/8 3/4)   (conventional cartesian coordinate 3/8 3/8 0)</span>
<a name="8041"><font size=-1>8041     </font></a><span class="string"></span>
<a name="8042"><font size=-1>8042     </font></a><span class="string">Note that K is actually equivalent to U, by spatial and translational</span>
<a name="8043"><font size=-1>8043     </font></a><span class="string">symmetry. So, if you want to specify a typical circuit, the following might do</span>
<a name="8044"><font size=-1>8044     </font></a><span class="string">the work: L-Gamma-X-W-K,U-L-W-X-K,U-Gamma with</span>
<a name="8045"><font size=-1>8045     </font></a><span class="string"></span>
<a name="8046"><font size=-1>8046     </font></a><span class="string">      kptbounds  1/2 0 0  0 0 0  0 1/2 1/2  1/4 1/2 3/4  3/8 3/8 3/4  1/2 1/2 1/2  1/4 1/2 3/4  1/2 1/2 1  3/8 3/8 3/4  0 0 0</span>
<a name="8047"><font size=-1>8047     </font></a><span class="string"></span>
<a name="8048"><font size=-1>8048     </font></a><span class="string">The lengths of segments (this information is useful to draw the band</span>
<a name="8049"><font size=-1>8049     </font></a><span class="string">structure, with the correct relative scale between special points) can be</span>
<a name="8050"><font size=-1>8050     </font></a><span class="string">found using the conventional cartesian coordinates:\n</span>
<a name="8051"><font size=-1>8051     </font></a><span class="string">$l$(L-Gamma)=$\sqrt{3}/4=$0.433... \n</span>
<a name="8052"><font size=-1>8052     </font></a><span class="string">$l$(Gamma-X)=$1/2$=0.5 \n</span>
<a name="8053"><font size=-1>8053     </font></a><span class="string">$l$(X-W)=$1/4$=0.25 \n</span>
<a name="8054"><font size=-1>8054     </font></a><span class="string">$l$(W-K)=$\sqrt{2}/8$=0.177... \n</span>
<a name="8055"><font size=-1>8055     </font></a><span class="string">$l$(K-L)=$\sqrt{6}/8$=0.306... \n</span>
<a name="8056"><font size=-1>8056     </font></a><span class="string">$l$(L-W)=$\sqrt{2}/4$=0.354... \n</span>
<a name="8057"><font size=-1>8057     </font></a><span class="string">$l$(W-X)=$1/4$=0.25 \n</span>
<a name="8058"><font size=-1>8058     </font></a><span class="string">$l$(X-K)=$\sqrt{2}/8$=0.177... \n</span>
<a name="8059"><font size=-1>8059     </font></a><span class="string">$l$(K-Gamma)=$3\sqrt{2}/8$=0.530... \n</span>
<a name="8060"><font size=-1>8060     </font></a><span class="string"></span>
<a name="8061"><font size=-1>8061     </font></a><span class="string">B. **BCC lattice**</span>
<a name="8062"><font size=-1>8062     </font></a><span class="string"></span>
<a name="8063"><font size=-1>8063     </font></a><span class="string">Suppose the primitive vectors in real space are given by</span>
<a name="8064"><font size=-1>8064     </font></a><span class="string"></span>
<a name="8065"><font size=-1>8065     </font></a><span class="string">      rprim  -1 1 1    1 -1 1    1 1 -1</span>
<a name="8066"><font size=-1>8066     </font></a><span class="string"></span>
<a name="8067"><font size=-1>8067     </font></a><span class="string">(as for the FCC lattice, there is a scale invariance). Then, the reciprocal</span>
<a name="8068"><font size=-1>8068     </font></a><span class="string">primitive vectors (in conventional cartesian coordinates) are (0 1/2 1/2),</span>
<a name="8069"><font size=-1>8069     </font></a><span class="string">(1/2 0 1/2), and (1/2 1/2 0) and the coordinates of several special points</span>
<a name="8070"><font size=-1>8070     </font></a><span class="string">with respect to primitive vectors in reciprocal space are</span>
<a name="8071"><font size=-1>8071     </font></a><span class="string"></span>
<a name="8072"><font size=-1>8072     </font></a><span class="string">      H (-1/2 1/2 1/2)   (conventional cartesian coordinate 1/2 0 0)</span>
<a name="8073"><font size=-1>8073     </font></a><span class="string">      N ( 0   0   1/2)   (conventional cartesian coordinate 1/4 1/4 0)</span>
<a name="8074"><font size=-1>8074     </font></a><span class="string">      P ( 1/4 1/4 1/4)   (conventional cartesian coordinate 1/4 1/4 1/4)</span>
<a name="8075"><font size=-1>8075     </font></a><span class="string"></span>
<a name="8076"><font size=-1>8076     </font></a><span class="string">So, if you want to specify a typical circuit, the following might do the work: Gamma-H-N-Gamma-P-N-P-H</span>
<a name="8077"><font size=-1>8077     </font></a><span class="string"></span>
<a name="8078"><font size=-1>8078     </font></a><span class="string">      kptbounds  0 0 0  -1/2 1/2 1/2  0 0 1/2  0 0 0   1/4 1/4 1/4  0 0 1/2  1/4 1/4 1/4  -1/2 1/2 1/2</span>
<a name="8079"><font size=-1>8079     </font></a><span class="string"></span>
<a name="8080"><font size=-1>8080     </font></a><span class="string">The lengths of segments (this information is useful to draw the band</span>
<a name="8081"><font size=-1>8081     </font></a><span class="string">structure, with the correct relative scale between special points) can be</span>
<a name="8082"><font size=-1>8082     </font></a><span class="string">found using the conventional cartesian coordinates:\n</span>
<a name="8083"><font size=-1>8083     </font></a><span class="string">$l$(Gamma-H)=$1/2$=0.5 \n</span>
<a name="8084"><font size=-1>8084     </font></a><span class="string">$l$(H-N)=$\sqrt{2}/4$=0.354... \n</span>
<a name="8085"><font size=-1>8085     </font></a><span class="string">$l$(N-Gamma)=$\sqrt{2}/4$=0.354... \n</span>
<a name="8086"><font size=-1>8086     </font></a><span class="string">$l$(Gamma-P)=$\sqrt{3}/4$=0.433... \n</span>
<a name="8087"><font size=-1>8087     </font></a><span class="string">$l$(P-N)=$1/4$=0.25 \n</span>
<a name="8088"><font size=-1>8088     </font></a><span class="string">$l$(N-P)=$1/4$=0.25 \n</span>
<a name="8089"><font size=-1>8089     </font></a><span class="string">$l$(P-H)=$\sqrt{3}/4$=0.433... \n</span>
<a name="8090"><font size=-1>8090     </font></a><span class="string"></span>
<a name="8091"><font size=-1>8091     </font></a><span class="string">C. **Hexagonal lattices**</span>
<a name="8092"><font size=-1>8092     </font></a><span class="string"></span>
<a name="8093"><font size=-1>8093     </font></a><span class="string">Suppose the primitive vectors in real space are given by</span>
<a name="8094"><font size=-1>8094     </font></a><span class="string"></span>
<a name="8095"><font size=-1>8095     </font></a><span class="string">      rprim  1 0 0    -1/2 sqrt(0.75) 0    0 0 1</span>
<a name="8096"><font size=-1>8096     </font></a><span class="string"></span>
<a name="8097"><font size=-1>8097     </font></a><span class="string">The coordinates of several special points with respect to primitive vectors in</span>
<a name="8098"><font size=-1>8098     </font></a><span class="string">reciprocal space are</span>
<a name="8099"><font size=-1>8099     </font></a><span class="string"></span>
<a name="8100"><font size=-1>8100     </font></a><span class="string">      M (1/2 0 0) or (0 1/2 0) or (-1/2 1/2 0)</span>
<a name="8101"><font size=-1>8101     </font></a><span class="string">      L (1/2 0 1/2) or (0 1/2 1/2) or (-1/2 1/2 1/2)</span>
<a name="8102"><font size=-1>8102     </font></a><span class="string">      K (1/3 1/3 0) or (2/3 -1/3 0) or (-1/3 2/3 0)</span>
<a name="8103"><font size=-1>8103     </font></a><span class="string">      H (1/3 1/3 1/2) or (2/3 -1/3 1/2) or (-1/3 2/3 1/2)</span>
<a name="8104"><font size=-1>8104     </font></a><span class="string">      A (0 0 1/2)</span>
<a name="8105"><font size=-1>8105     </font></a><span class="string"></span>
<a name="8106"><font size=-1>8106     </font></a><span class="string">So, if you want to specify a typical circuit, the following</span>
<a name="8107"><font size=-1>8107     </font></a><span class="string">might do the work: K-Gamma-M-K-H-A-L-H-L-M-Gamma-A</span>
<a name="8108"><font size=-1>8108     </font></a><span class="string"></span>
<a name="8109"><font size=-1>8109     </font></a><span class="string">      kptbounds  1/3 1/3 0  0 0 0  1/2 0 0  1/3 1/3 0  1/3 1/3 1/2  0 0 1/2  1/2 0 1/2  1/3 1/3 1/2  1/2 0 1/2  1/2 0 0  0 0 0  0 0 1/2</span>
<a name="8110"><font size=-1>8110     </font></a><span class="string"></span>
<a name="8111"><font size=-1>8111     </font></a><span class="string">In order to find the lengths of segments (this information is useful to draw</span>
<a name="8112"><font size=-1>8112     </font></a><span class="string">the band structure, with the correct relative scale between special points)</span>
<a name="8113"><font size=-1>8113     </font></a><span class="string">one needs to know the a and c lattice parameters. Also, in what follows, we</span>
<a name="8114"><font size=-1>8114     </font></a><span class="string">omit the 2$\pi$ factor sometimes present in the definition of the reciprocal</span>
<a name="8115"><font size=-1>8115     </font></a><span class="string">space vectors. The reciprocal vectors are $(1/a\: 1/(\sqrt{3}a)\: 0)$, $(0\: 2/(\sqrt{3}a)\: 0)$,</span>
<a name="8116"><font size=-1>8116     </font></a><span class="string"> $(0\: 0\: 1/c)$. The lengths of the above-mentioned segments can</span>
<a name="8117"><font size=-1>8117     </font></a><span class="string">be computed as:\n</span>
<a name="8118"><font size=-1>8118     </font></a><span class="string">$l$(K-Gamma)=$2/(3a)$=0.666.../a \n</span>
<a name="8119"><font size=-1>8119     </font></a><span class="string">$l$(Gamma-M)=$1/(\sqrt{3}a)$=0.577.../a \n</span>
<a name="8120"><font size=-1>8120     </font></a><span class="string">$l$(M-K)=$1/(3a)$=0.333.../a \n</span>
<a name="8121"><font size=-1>8121     </font></a><span class="string">$l$(K-H)=$1/(2c)$=0.5.../c \n</span>
<a name="8122"><font size=-1>8122     </font></a><span class="string">$l$(H-A)=$2/(3a)$=0.666.../a \n</span>
<a name="8123"><font size=-1>8123     </font></a><span class="string">$l$(A-L)=$1/(\sqrt{3}a)$=0.577.../a \n</span>
<a name="8124"><font size=-1>8124     </font></a><span class="string">$l$(L-H)=$1/(3a)$=0.333.../a \n</span>
<a name="8125"><font size=-1>8125     </font></a><span class="string">$l$(H-L)=$1/(3a)$=0.333.../a \n</span>
<a name="8126"><font size=-1>8126     </font></a><span class="string">$l$(L-M)=$1/(2c)$=0.5.../c \n</span>
<a name="8127"><font size=-1>8127     </font></a><span class="string">$l$(M-Gamma)=$1/(\sqrt{3}a)$=0.577.../a \n</span>
<a name="8128"><font size=-1>8128     </font></a><span class="string">$l$(Gamma-A)=$1/(2c)$=0.5.../c \n</span>
<a name="8129"><font size=-1>8129     </font></a><span class="string"></span>
<a name="8130"><font size=-1>8130     </font></a><span class="string">D. **Rhombohedral lattices**</span>
<a name="8131"><font size=-1>8131     </font></a><span class="string"></span>
<a name="8132"><font size=-1>8132     </font></a><span class="string">Rhombohedral lattices are characterised by two parameters, the length of the</span>
<a name="8133"><font size=-1>8133     </font></a><span class="string">primitive vectors, that we will denote a0, and the angle they form, $\gamma$.</span>
<a name="8134"><font size=-1>8134     </font></a><span class="string">These can be directly input of ABINIT, as [[acell]] and [[angdeg]]</span>
<a name="8135"><font size=-1>8135     </font></a><span class="string"></span>
<a name="8136"><font size=-1>8136     </font></a><span class="string">This will generate the primitive vectors in real space, with</span>
<a name="8137"><font size=-1>8137     </font></a><span class="string"></span>
<a name="8138"><font size=-1>8138     </font></a><span class="string">      acell a0 a0 a0    and      rprim  a 0 c    -a/2 a*sqrt(0.75) c    -a/2 -a*sqrt(0.75) c</span>
<a name="8139"><font size=-1>8139     </font></a><span class="string"></span>
<a name="8140"><font size=-1>8140     </font></a><span class="string">with,</span>
<a name="8141"><font size=-1>8141     </font></a><span class="string"></span>
<a name="8142"><font size=-1>8142     </font></a><span class="string"> * $a^2+c^2=1$,</span>
<a name="8143"><font size=-1>8143     </font></a><span class="string"> * $a^2=2/3(1-\cos(\gamma))$,</span>
<a name="8144"><font size=-1>8144     </font></a><span class="string"> * $c^2=1/3(1+2\cos(\gamma))$,</span>
<a name="8145"><font size=-1>8145     </font></a><span class="string"> * $(a/c)^2=2(1-\cos(\gamma))/(1+2\cos(\gamma))$, and also</span>
<a name="8146"><font size=-1>8146     </font></a><span class="string"> * $\cos(\gamma)=(1-(a/c)^2/2)/(1+(a/c)^2)$.</span>
<a name="8147"><font size=-1>8147     </font></a><span class="string"></span>
<a name="8148"><font size=-1>8148     </font></a><span class="string">Alternatively, these values of [[rprim]]</span>
<a name="8149"><font size=-1>8149     </font></a><span class="string">might directly be the input of ABINIT (then, the balance of the scaling factor</span>
<a name="8150"><font size=-1>8150     </font></a><span class="string">might be adjusted between [[acell]] and [[rprim]]).</span>
<a name="8151"><font size=-1>8151     </font></a><span class="string"></span>
<a name="8152"><font size=-1>8152     </font></a><span class="string">Unlike for the simple cubic, FCC, BCC, hexagonal (and some other) Bravais</span>
<a name="8153"><font size=-1>8153     </font></a><span class="string">lattice, the topology of the Brillouin zone will depend on the $\gamma$ (or $a/c$)</span>
<a name="8154"><font size=-1>8154     </font></a><span class="string">value. We give below information concerning the case when $\cos(\gamma)$ is</span>
<a name="8155"><font size=-1>8155     </font></a><span class="string">positive, that is, $(a/c)^2$ lower than 2.</span>
<a name="8156"><font size=-1>8156     </font></a><span class="string"></span>
<a name="8157"><font size=-1>8157     </font></a><span class="string">The coordinates of several special points with respect to primitive vectors in</span>
<a name="8158"><font size=-1>8158     </font></a><span class="string">reciprocal space will not depend on the $a/c$ ratio, but some others will depend</span>
<a name="8159"><font size=-1>8159     </font></a><span class="string">on it. So, some care has to be exercised. Notations for the Brillouin Zone</span>
<a name="8160"><font size=-1>8160     </font></a><span class="string">special points are the same as in [[cite:Gonze1990]].</span>
<a name="8161"><font size=-1>8161     </font></a><span class="string"></span>
<a name="8162"><font size=-1>8162     </font></a><span class="string">      L (1/2 0 0) or (0 1/2 0) or (0 0 1/2) (or with negative signs)</span>
<a name="8163"><font size=-1>8163     </font></a><span class="string">      T (1/2 1/2 1/2)</span>
<a name="8164"><font size=-1>8164     </font></a><span class="string">      X (1/2 1/2 0) or (1/2 0 1/2) or (0 1/2 1/2) (or with separate negative signs)</span>
<a name="8165"><font size=-1>8165     </font></a><span class="string">      W (5/6 - (a/c)^2/6, 1/2, 1/6 + (a/c)^2/6 ) = (1 0 -1)*(1-(a/c)^2/2)/3 + (1 1 1)/2</span>
<a name="8166"><font size=-1>8166     </font></a><span class="string">      U ( (1+(a/c)^2)/6, (8-(a/c)^2)/12, (8-(a/c)^2)/12 ) = (-1 1/2 1/2)*(1-(a/c)^2/2)/3 + (1 1 1)/2</span>
<a name="8167"><font size=-1>8167     </font></a><span class="string">      K (1 0 -1)*(1+(a/c)^2/4)/3</span>
<a name="8168"><font size=-1>8168     </font></a><span class="string"></span>
<a name="8169"><font size=-1>8169     </font></a><span class="string">So, if you want to specify a typical circuit, the following might do the work</span>
<a name="8170"><font size=-1>8170     </font></a><span class="string">(the representative points on lines of symmetry are indicated - there are</span>
<a name="8171"><font size=-1>8171     </font></a><span class="string">sometimes more than one way to go from one point to another): X-V-K-Sigma-</span>
<a name="8172"><font size=-1>8172     </font></a><span class="string">Gamma-Lambda-T-Q-W-Y-L-sigma-Gamma-sigma-X. The suggestion is to sample this</span>
<a name="8173"><font size=-1>8173     </font></a><span class="string">path with the following coordinates for the special points X, Gamma, T, L, Gamma, X:</span>
<a name="8174"><font size=-1>8174     </font></a><span class="string"></span>
<a name="8175"><font size=-1>8175     </font></a><span class="string">      kptbounds  1/2 0 -1/2   0 0 0    1/2 1/2 1/2  1 1/2 0   1 0 0  1 1/2 1/2</span>
<a name="8176"><font size=-1>8176     </font></a><span class="string"></span>
<a name="8177"><font size=-1>8177     </font></a><span class="string">In order to find the lengths of segments (this information is useful to draw</span>
<a name="8178"><font size=-1>8178     </font></a><span class="string">the band structure, with the correct relative scale between special points)</span>
<a name="8179"><font size=-1>8179     </font></a><span class="string">one needs to know the a and c lattice parameters. Also, in what follows, we</span>
<a name="8180"><font size=-1>8180     </font></a><span class="string">omit the $2\pi$ factor sometimes present in the definition of the reciprocal</span>
<a name="8181"><font size=-1>8181     </font></a><span class="string">space vectors. The reciprocal vectors are $( 2/(3a)\: 0\: 1/(3c) )$, $( -1/(3a)\:</span>
<a name="8182"><font size=-1>8182     </font></a><span class="string">1/(\sqrt{3}a)\: 1/(3c) )$, $( -1/(3a)\: -1/(\sqrt{3}a)\: 1/(3c) )$. The lengths of the</span>
<a name="8183"><font size=-1>8183     </font></a><span class="string">above-mentioned segments can be computed as:\n</span>
<a name="8184"><font size=-1>8184     </font></a><span class="string">$l$(X-Gamma)=$2/(\sqrt{3}a)$=1.155.../a \n</span>
<a name="8185"><font size=-1>8185     </font></a><span class="string">$l$(K-Gamma)=$4(1+(a/c)^2/4)/(3\sqrt{3}a)$ \n</span>
<a name="8186"><font size=-1>8186     </font></a><span class="string">$l$(Gamma-T)=$1/(2c)$ \n</span>
<a name="8187"><font size=-1>8187     </font></a><span class="string">$l$(T-L)=$2/(\sqrt{3}a)$=1.155.../a \n</span>
<a name="8188"><font size=-1>8188     </font></a><span class="string">$l$(T-W)=$4(1-(a/c)^2/2)/(3\sqrt{3}a)$ \n</span>
<a name="8189"><font size=-1>8189     </font></a><span class="string">$l$(L-Gamma)=$\sqrt{4/(a^2)+1/(c^2)}/3$ \n</span>
<a name="8190"><font size=-1>8190     </font></a><span class="string">$l$(Gamma-X)=$2\sqrt{1/(a^2)+1/(c^2)}/3$ \n</span>
<a name="8191"><font size=-1>8191     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8192"><font size=-1>8192     </font></a><span class="default">),</span>
<a name="8193"><font size=-1>8193     </font></a><span class="default"></span>
<a name="8194"><font size=-1>8194     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8195"><font size=-1>8195     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptgw&quot;</span><span class="default">,</span>
<a name="8196"><font size=-1>8196     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="8197"><font size=-1>8197     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8198"><font size=-1>8198     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="8199"><font size=-1>8199     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nkptgw]]'</span><span class="default">],</span>
<a name="8200"><font size=-1>8200     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="8201"><font size=-1>8201     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K-PoinTs for GW calculations&quot;</span><span class="default">,</span>
<a name="8202"><font size=-1>8202     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [4, 7]&quot;</span><span class="default">,</span>
<a name="8203"><font size=-1>8203     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8204"><font size=-1>8204     </font></a><span class="string">For each k-point with number igwpt in the range (1:[[nkptgw]]),</span>
<a name="8205"><font size=-1>8205     </font></a><span class="string">[[kptgw]](1,igwpt) is the reduced coordinate of the k-point where the self-energy</span>
<a name="8206"><font size=-1>8206     </font></a><span class="string">corrections are required while [[bdgw]] (1:2,igwpt) specifies the range of</span>
<a name="8207"><font size=-1>8207     </font></a><span class="string">bands to be considered.</span>
<a name="8208"><font size=-1>8208     </font></a><span class="string"></span>
<a name="8209"><font size=-1>8209     </font></a><span class="string">At present, not all k-points are possible. Only those corresponding to the</span>
<a name="8210"><font size=-1>8210     </font></a><span class="string">k-point grid defined with the same repetition parameters ( [[kptrlatt]], or</span>
<a name="8211"><font size=-1>8211     </font></a><span class="string">[[ngkpt]] ) than the GS one, but **without** any shift, are allowed.</span>
<a name="8212"><font size=-1>8212     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8213"><font size=-1>8213     </font></a><span class="default">),</span>
<a name="8214"><font size=-1>8214     </font></a><span class="default"></span>
<a name="8215"><font size=-1>8215     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8216"><font size=-1>8216     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptnrm&quot;</span><span class="default">,</span>
<a name="8217"><font size=-1>8217     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="8218"><font size=-1>8218     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8219"><font size=-1>8219     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="8220"><font size=-1>8220     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8221"><font size=-1>8221     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="8222"><font size=-1>8222     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K - PoinTs NoRMalization&quot;</span><span class="default">,</span>
<a name="8223"><font size=-1>8223     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8224"><font size=-1>8224     </font></a><span class="string">Establishes a normalizing denominator for each k point. Needed only if</span>
<a name="8225"><font size=-1>8225     </font></a><span class="string">[[kptopt]]&lt;=0, otherwise deduced from other input variables.</span>
<a name="8226"><font size=-1>8226     </font></a><span class="string">The k point coordinates as fractions of reciprocal lattice translations are</span>
<a name="8227"><font size=-1>8227     </font></a><span class="string">therefore [[kpt]](mu,ikpt)/[[kptnrm]]. [[kptnrm]] defaults to 1 and can be</span>
<a name="8228"><font size=-1>8228     </font></a><span class="string">ignored by the user. It is introduced to avoid the need for many digits in</span>
<a name="8229"><font size=-1>8229     </font></a><span class="string">representing numbers such as 1/3. It cannot be smaller than 1.0d0</span>
<a name="8230"><font size=-1>8230     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8231"><font size=-1>8231     </font></a><span class="default">),</span>
<a name="8232"><font size=-1>8232     </font></a><span class="default"></span>
<a name="8233"><font size=-1>8233     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8234"><font size=-1>8234     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptns&quot;</span><span class="default">,</span>
<a name="8235"><font size=-1>8235     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="8236"><font size=-1>8236     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8237"><font size=-1>8237     </font></a><span class="default">    topics=[</span><span class="string">'k-points_internal'</span><span class="default">],</span>
<a name="8238"><font size=-1>8238     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nkpt]]'</span><span class="default">],</span>
<a name="8239"><font size=-1>8239     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K-PoinTs re-Normalized and Shifted&quot;</span><span class="default">,</span>
<a name="8240"><font size=-1>8240     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="8241"><font size=-1>8241     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8242"><font size=-1>8242     </font></a><span class="string">If [[nqpt]] = 0, or if one is doing a reponse calculation, this internal</span>
<a name="8243"><font size=-1>8243     </font></a><span class="string">variable is derived from [[kpt]] and [[kptnrm]]: [[kptns]](1:3,:)=</span>
<a name="8244"><font size=-1>8244     </font></a><span class="string">[[kpt]](1:3,:)/ [[kptnrm]], so that it is [[kpt]] renormalized by [[kptnrm]].</span>
<a name="8245"><font size=-1>8245     </font></a><span class="string"></span>
<a name="8246"><font size=-1>8246     </font></a><span class="string">If [[nqpt]] = 1 and one is not doing a ground-state calculation, this internal</span>
<a name="8247"><font size=-1>8247     </font></a><span class="string">variable is derived from [[kpt]], [[kptnrm]] and [[qptn]] : [[kptns]](1:3,:)=</span>
<a name="8248"><font size=-1>8248     </font></a><span class="string">[[kpt]](1:3,:)/ [[kptnrm]]+ [[qptn]](1:3), so that it is [[kpt]] renormalized</span>
<a name="8249"><font size=-1>8249     </font></a><span class="string">by [[kptnrm]], then shifted by [[qptn]](1:3).</span>
<a name="8250"><font size=-1>8250     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8251"><font size=-1>8251     </font></a><span class="default">),</span>
<a name="8252"><font size=-1>8252     </font></a><span class="default"></span>
<a name="8253"><font size=-1>8253     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8254"><font size=-1>8254     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptns_hf&quot;</span><span class="default">,</span>
<a name="8255"><font size=-1>8255     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="8256"><font size=-1>8256     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8257"><font size=-1>8257     </font></a><span class="default">    topics=[</span><span class="string">'k-points_internal'</span><span class="default">],</span>
<a name="8258"><font size=-1>8258     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nkpthf]]'</span><span class="default">],</span>
<a name="8259"><font size=-1>8259     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K-PoinTs re-Normalized and Shifted, for the Hartree-Fock operator&quot;</span><span class="default">,</span>
<a name="8260"><font size=-1>8260     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="8261"><font size=-1>8261     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8262"><font size=-1>8262     </font></a><span class="string">[[kptns_hf]] is the subset of the full Brillouin Zone k point grid for</span>
<a name="8263"><font size=-1>8263     </font></a><span class="string">wavefunctions, used to build the Fock operator, see [[fockdownsampling]].</span>
<a name="8264"><font size=-1>8264     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8265"><font size=-1>8265     </font></a><span class="default">),</span>
<a name="8266"><font size=-1>8266     </font></a><span class="default"></span>
<a name="8267"><font size=-1>8267     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8268"><font size=-1>8268     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptopt&quot;</span><span class="default">,</span>
<a name="8269"><font size=-1>8269     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="8270"><font size=-1>8270     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8271"><font size=-1>8271     </font></a><span class="default">    topics=[</span><span class="string">'k-points_basic'</span><span class="default">, </span><span class="string">'ElecBandStructure_basic'</span><span class="default">],</span>
<a name="8272"><font size=-1>8272     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8273"><font size=-1>8273     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nspden]] == 4'</span><span class="default">: </span><span class="number">4</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="8274"><font size=-1>8274     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;KPoinTs OPTion&quot;</span><span class="default">,</span>
<a name="8275"><font size=-1>8275     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8276"><font size=-1>8276     </font></a><span class="string">Controls the set up of the k-points list. The aim will be to initialize, by</span>
<a name="8277"><font size=-1>8277     </font></a><span class="string">straight reading or by a preprocessing approach based on other input</span>
<a name="8278"><font size=-1>8278     </font></a><span class="string">variables, the following input variables, giving the k points, their number,</span>
<a name="8279"><font size=-1>8279     </font></a><span class="string">and their weight: [[kpt]], [[kptnrm]], [[nkpt]], and, for [[iscf]]/=-2, [[wtk]].</span>
<a name="8280"><font size=-1>8280     </font></a><span class="string"></span>
<a name="8281"><font size=-1>8281     </font></a><span class="string">Often, the k points will form a lattice in reciprocal space. In this case, one</span>
<a name="8282"><font size=-1>8282     </font></a><span class="string">will also aim at initializing input variables that give the reciprocal of this</span>
<a name="8283"><font size=-1>8283     </font></a><span class="string">k-point lattice, as well as its shift with respect to the origin: [[ngkpt]] or</span>
<a name="8284"><font size=-1>8284     </font></a><span class="string">[[kptrlatt]], as well as on [[nshiftk]] and [[shiftk]].</span>
<a name="8285"><font size=-1>8285     </font></a><span class="string"></span>
<a name="8286"><font size=-1>8286     </font></a><span class="string">A global additional shift can be provided by [[qptn]]</span>
<a name="8287"><font size=-1>8287     </font></a><span class="string"></span>
<a name="8288"><font size=-1>8288     </font></a><span class="string">  * 0 --&gt; read directly [[nkpt]], [[kpt]], [[kptnrm]] and [[wtk]].</span>
<a name="8289"><font size=-1>8289     </font></a><span class="string">  * 1 --&gt; rely on [[ngkpt]] or [[kptrlatt]], as well as on [[nshiftk]] and [[shiftk]] to set up the k points.</span>
<a name="8290"><font size=-1>8290     </font></a><span class="string">    Take fully into account the symmetry to generate the k points in the Irreducible Brillouin Zone only,</span>
<a name="8291"><font size=-1>8291     </font></a><span class="string">    with the appropriate weights. (This is the usual mode for GS calculations)</span>
<a name="8292"><font size=-1>8292     </font></a><span class="string"></span>
<a name="8293"><font size=-1>8293     </font></a><span class="string">  * 2 --&gt; rely on [[ngkpt]] or [[kptrlatt]], as well as on [[nshiftk]] and [[shiftk]] to set up the k points.</span>
<a name="8294"><font size=-1>8294     </font></a><span class="string">    Take into account only the time-reversal symmetry: k points will be generated in half the Brillouin zone,</span>
<a name="8295"><font size=-1>8295     </font></a><span class="string">    with the appropriate weights.</span>
<a name="8296"><font size=-1>8296     </font></a><span class="string">    (This is to be used when preparing or executing a RF calculation at q=(0 0 0))</span>
<a name="8297"><font size=-1>8297     </font></a><span class="string"></span>
<a name="8298"><font size=-1>8298     </font></a><span class="string">  * 3 --&gt; rely on [[ngkpt]] or [[kptrlatt]], as well as on [[nshiftk]] and [[shiftk]] to set up the k points.</span>
<a name="8299"><font size=-1>8299     </font></a><span class="string">    Do not take into account any symmetry: k points will be generated in the full Brillouin zone, with the appropriate weights.</span>
<a name="8300"><font size=-1>8300     </font></a><span class="string">    (This is to be used when preparing or executing a RF calculation at non-zero q)</span>
<a name="8301"><font size=-1>8301     </font></a><span class="string"></span>
<a name="8302"><font size=-1>8302     </font></a><span class="string">  * 4 --&gt; rely on [[ngkpt]] or [[kptrlatt]], as well as on [[nshiftk]] and [[shiftk]] to set up the k points.</span>
<a name="8303"><font size=-1>8303     </font></a><span class="string">   Take into account all the symmetries EXCEPT the time-reversal symmetry to generate the k points</span>
<a name="8304"><font size=-1>8304     </font></a><span class="string">   in the Irreducible Brillouin Zone, with the appropriate weights.</span>
<a name="8305"><font size=-1>8305     </font></a><span class="string">   This has to be used when performing calculations with non-collinear magnetism allowed ([[nspden]] = 4)</span>
<a name="8306"><font size=-1>8306     </font></a><span class="string"></span>
<a name="8307"><font size=-1>8307     </font></a><span class="string">  * A negative value  --&gt; rely on [[kptbounds]], and [[ndivk]] ([[ndivsm]]) to set up a band structure calculation</span>
<a name="8308"><font size=-1>8308     </font></a><span class="string">    along different lines (allowed only for [[iscf]] == -2). The absolute value of [[kptopt]] gives</span>
<a name="8309"><font size=-1>8309     </font></a><span class="string">    the number of segments of the band structure. Weights are usually irrelevant with this option,</span>
<a name="8310"><font size=-1>8310     </font></a><span class="string">    and will be left to their default value.</span>
<a name="8311"><font size=-1>8311     </font></a><span class="string"></span>
<a name="8312"><font size=-1>8312     </font></a><span class="string">In the case of a grid of k points, the auxiliary variables [[kptrlen]],</span>
<a name="8313"><font size=-1>8313     </font></a><span class="string">[[ngkpt]] and [[prtkpt]] might help you to select the optimal grid.</span>
<a name="8314"><font size=-1>8314     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8315"><font size=-1>8315     </font></a><span class="default">),</span>
<a name="8316"><font size=-1>8316     </font></a><span class="default"></span>
<a name="8317"><font size=-1>8317     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8318"><font size=-1>8318     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptrlatt&quot;</span><span class="default">,</span>
<a name="8319"><font size=-1>8319     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="8320"><font size=-1>8320     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8321"><font size=-1>8321     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="8322"><font size=-1>8322     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="number">3</span><span class="default">],</span>
<a name="8323"><font size=-1>8323     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="8324"><font size=-1>8324     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K - PoinTs grid: Real space LATTice&quot;</span><span class="default">,</span>
<a name="8325"><font size=-1>8325     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[ngkpt]]&quot;</span><span class="default">,</span>
<a name="8326"><font size=-1>8326     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8327"><font size=-1>8327     </font></a><span class="string">This input variable is used only when [[kptopt]] is positive. It partially</span>
<a name="8328"><font size=-1>8328     </font></a><span class="string">defines the k point grid. The other piece of information is contained in</span>
<a name="8329"><font size=-1>8329     </font></a><span class="string">[[shiftk]]. [[kptrlatt]] cannot be used together with [[ngkpt]].</span>
<a name="8330"><font size=-1>8330     </font></a><span class="string"></span>
<a name="8331"><font size=-1>8331     </font></a><span class="string">The values [[kptrlatt]](1:3,1), [[kptrlatt]](1:3,2), [[kptrlatt]](1:3,3) are the</span>
<a name="8332"><font size=-1>8332     </font></a><span class="string">coordinates of three vectors in real space, expressed in the [[rprimd]]</span>
<a name="8333"><font size=-1>8333     </font></a><span class="string">coordinate system (reduced coordinates). They defines a super-lattice in real</span>
<a name="8334"><font size=-1>8334     </font></a><span class="string">space. The k point lattice is the reciprocal of this super-lattice, possibly shifted (see [[shiftk]]).</span>
<a name="8335"><font size=-1>8335     </font></a><span class="string"></span>
<a name="8336"><font size=-1>8336     </font></a><span class="string">If neither [[ngkpt]] nor [[kptrlatt]] are defined, ABINIT will automatically</span>
<a name="8337"><font size=-1>8337     </font></a><span class="string">generate a set of k point grids, and select the best combination of</span>
<a name="8338"><font size=-1>8338     </font></a><span class="string">[[kptrlatt]] and [[shiftk]] that allows one to reach a sufficient value of</span>
<a name="8339"><font size=-1>8339     </font></a><span class="string">[[kptrlen]]. See this latter variable for a complete description of this procedure.</span>
<a name="8340"><font size=-1>8340     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8341"><font size=-1>8341     </font></a><span class="default">),</span>
<a name="8342"><font size=-1>8342     </font></a><span class="default"></span>
<a name="8343"><font size=-1>8343     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8344"><font size=-1>8344     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kptrlen&quot;</span><span class="default">,</span>
<a name="8345"><font size=-1>8345     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="8346"><font size=-1>8346     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8347"><font size=-1>8347     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="8348"><font size=-1>8348     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8349"><font size=-1>8349     </font></a><span class="default">    defaultval=</span><span class="number">30.0</span><span class="default">,</span>
<a name="8350"><font size=-1>8350     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;K - PoinTs grid: Real space LENgth&quot;</span><span class="default">,</span>
<a name="8351"><font size=-1>8351     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8352"><font size=-1>8352     </font></a><span class="string">This input variable is used only when [[kptopt]] is positive and non-zero.</span>
<a name="8353"><font size=-1>8353     </font></a><span class="string"></span>
<a name="8354"><font size=-1>8354     </font></a><span class="string">Preliminary explanation:</span>
<a name="8355"><font size=-1>8355     </font></a><span class="string">The k point lattice defined by [[ngkpt]] or [[kptrlatt]] is used to perform</span>
<a name="8356"><font size=-1>8356     </font></a><span class="string">integrations of periodic quantities in the Brillouin Zone, like the density or</span>
<a name="8357"><font size=-1>8357     </font></a><span class="string">the kinetic energy. One can relate the error made by replacing the continuous</span>
<a name="8358"><font size=-1>8358     </font></a><span class="string">integral by a sum over k point lattice to the Fourier transform of the</span>
<a name="8359"><font size=-1>8359     </font></a><span class="string">periodic quantity. Erroneous contributions will appear only for the vectors in</span>
<a name="8360"><font size=-1>8360     </font></a><span class="string">real space that belong to the reciprocal of the k point lattice, except the</span>
<a name="8361"><font size=-1>8361     </font></a><span class="string">origin. Moreover, the expected size of these contributions usually decreases</span>
<a name="8362"><font size=-1>8362     </font></a><span class="string">exponentially with the distance. So, the length of the smallest of these real</span>
<a name="8363"><font size=-1>8363     </font></a><span class="string">space vectors is a measure of the accuracy of the k point grid.</span>
<a name="8364"><font size=-1>8364     </font></a><span class="string"></span>
<a name="8365"><font size=-1>8365     </font></a><span class="string">When either [[ngkpt]] or [[kptrlatt]] is defined, [[kptrlen]] is not used as</span>
<a name="8366"><font size=-1>8366     </font></a><span class="string">an input variable, but the length of the smallest vector will be placed in</span>
<a name="8367"><font size=-1>8367     </font></a><span class="string">this variable, and echoed in the output file.</span>
<a name="8368"><font size=-1>8368     </font></a><span class="string"></span>
<a name="8369"><font size=-1>8369     </font></a><span class="string">On the other hand, when neither [[ngkpt]] nor [[kptrlatt]] are defined, ABINIT</span>
<a name="8370"><font size=-1>8370     </font></a><span class="string">will automatically generate a large set of possible k point grids, and select</span>
<a name="8371"><font size=-1>8371     </font></a><span class="string">among this set, the grids that give a length of smallest vector LARGER than</span>
<a name="8372"><font size=-1>8372     </font></a><span class="string">[[kptrlen]], and among these grids, the one that, when used with [[kptopt]] = 1,</span>
<a name="8373"><font size=-1>8373     </font></a><span class="string">reduces to the smallest number of k points. Note that this procedure can be</span>
<a name="8374"><font size=-1>8374     </font></a><span class="string">time-consuming. It is worth doing it once for a given unit cell and set of</span>
<a name="8375"><font size=-1>8375     </font></a><span class="string">symmetries, but not use this procedure by default. The best is then to set</span>
<a name="8376"><font size=-1>8376     </font></a><span class="string">[[prtkpt]] = 1, in order to get a detailed analysis of the set of grids.</span>
<a name="8377"><font size=-1>8377     </font></a><span class="string"></span>
<a name="8378"><font size=-1>8378     </font></a><span class="string">If some layer of vacuum is detected in the unit cell (see the input variable</span>
<a name="8379"><font size=-1>8379     </font></a><span class="string">[[vacuum]]), the computation of [[kptrlen]] will ignore the dimension related</span>
<a name="8380"><font size=-1>8380     </font></a><span class="string">to the direction perpendicular to the vacuum layer, and generate a bi-</span>
<a name="8381"><font size=-1>8381     </font></a><span class="string">dimensional k point grid. If the system is confined in a tube, a one-</span>
<a name="8382"><font size=-1>8382     </font></a><span class="string">dimensional k point grid will be generated. For a cluster, this procedure will</span>
<a name="8383"><font size=-1>8383     </font></a><span class="string">only generate the Gamma point.</span>
<a name="8384"><font size=-1>8384     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8385"><font size=-1>8385     </font></a><span class="default">),</span>
<a name="8386"><font size=-1>8386     </font></a><span class="default"></span>
<a name="8387"><font size=-1>8387     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8388"><font size=-1>8388     </font></a><span class="default">    abivarname=</span><span class="string">&quot;kssform&quot;</span><span class="default">,</span>
<a name="8389"><font size=-1>8389     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="8390"><font size=-1>8390     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8391"><font size=-1>8391     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="8392"><font size=-1>8392     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8393"><font size=-1>8393     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="8394"><font size=-1>8394     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Kohn Sham Structure file FORMat&quot;</span><span class="default">,</span>
<a name="8395"><font size=-1>8395     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8396"><font size=-1>8396     </font></a><span class="string">Governs the choice of the format for the file that contains the Kohn-Sham</span>
<a name="8397"><font size=-1>8397     </font></a><span class="string">electronic structure information, for use in GW calculations, see the input</span>
<a name="8398"><font size=-1>8398     </font></a><span class="string">variables [[optdriver]] and [[nbandkss]].</span>
<a name="8399"><font size=-1>8399     </font></a><span class="string"></span>
<a name="8400"><font size=-1>8400     </font></a><span class="string">  * [[kssform]] = 1, a single file.kss (double precision) containing complete information on the Kohn Sham Structure (eigenstates and the pseudopotentials used) will be generated through full diagonalization of the complete Hamiltonian matrix. The file has at the beginning the standard abinit header.</span>
<a name="8401"><font size=-1>8401     </font></a><span class="string">  * [[kssform]] = 3, a single file.kss (double precision) containing complete information on the Kohn Sham Structure (eigenstates and the pseudopotentials used) will be generated through the usual conjugate gradient algorithm (so, a restricted number of states). The file has at the beginning the standard abinit header.</span>
<a name="8402"><font size=-1>8402     </font></a><span class="string"></span>
<a name="8403"><font size=-1>8403     </font></a><span class="string">!!! warning</span>
<a name="8404"><font size=-1>8404     </font></a><span class="string"></span>
<a name="8405"><font size=-1>8405     </font></a><span class="string">    For the time being, [[istwfk]] must be 1 for all the k-points.</span>
<a name="8406"><font size=-1>8406     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8407"><font size=-1>8407     </font></a><span class="default">),</span>
<a name="8408"><font size=-1>8408     </font></a><span class="default"></span>
<a name="8409"><font size=-1>8409     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8410"><font size=-1>8410     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ldaminushalf&quot;</span><span class="default">,</span>
<a name="8411"><font size=-1>8411     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="8412"><font size=-1>8412     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8413"><font size=-1>8413     </font></a><span class="default">    topics=[</span><span class="string">'LDAminushalf_compulsory'</span><span class="default">],</span>
<a name="8414"><font size=-1>8414     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="8415"><font size=-1>8415     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="8416"><font size=-1>8416     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;LDA minus half&quot;</span><span class="default">,</span>
<a name="8417"><font size=-1>8417     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8418"><font size=-1>8418     </font></a><span class="string">For each type of atom, gives whether a LDA-${\\frac{1}{2}}$ calculation is to be performed.</span>
<a name="8419"><font size=-1>8419     </font></a><span class="string">[[ldaminushalf]] =0: the LDA-$\\frac{1}{2}$ approach is not used.</span>
<a name="8420"><font size=-1>8420     </font></a><span class="string">[[ldaminushalf]] =1: the LDA-$\\frac{1}{2}$ approach is used.</span>
<a name="8421"><font size=-1>8421     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8422"><font size=-1>8422     </font></a><span class="default">),</span>
<a name="8423"><font size=-1>8423     </font></a><span class="default"></span>
<a name="8424"><font size=-1>8424     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8425"><font size=-1>8425     </font></a><span class="default">    abivarname=</span><span class="string">&quot;lexexch&quot;</span><span class="default">,</span>
<a name="8426"><font size=-1>8426     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="8427"><font size=-1>8427     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8428"><font size=-1>8428     </font></a><span class="default">    topics=[</span><span class="string">'xc_useful'</span><span class="default">],</span>
<a name="8429"><font size=-1>8429     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="8430"><font size=-1>8430     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="8431"><font size=-1>8431     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;value of angular momentum L for EXact EXCHange&quot;</span><span class="default">,</span>
<a name="8432"><font size=-1>8432     </font></a><span class="default">    requires=</span><span class="string">&quot;[[useexexch]] == 1&quot;</span><span class="default">,</span>
<a name="8433"><font size=-1>8433     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8434"><font size=-1>8434     </font></a><span class="string">Give for each species the value of the angular momentum (only values 2 or 3</span>
<a name="8435"><font size=-1>8435     </font></a><span class="string">are allowed) on which to apply the exact exchange correction.</span>
<a name="8436"><font size=-1>8436     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8437"><font size=-1>8437     </font></a><span class="default">),</span>
<a name="8438"><font size=-1>8438     </font></a><span class="default"></span>
<a name="8439"><font size=-1>8439     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8440"><font size=-1>8440     </font></a><span class="default">    abivarname=</span><span class="string">&quot;localrdwf&quot;</span><span class="default">,</span>
<a name="8441"><font size=-1>8441     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="8442"><font size=-1>8442     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8443"><font size=-1>8443     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="8444"><font size=-1>8444     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8445"><font size=-1>8445     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="8446"><font size=-1>8446     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;LOCAL ReaD WaveFunctions&quot;</span><span class="default">,</span>
<a name="8447"><font size=-1>8447     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8448"><font size=-1>8448     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8449"><font size=-1>8449     </font></a><span class="string">This input variable is used only when running abinit in parallel. If</span>
<a name="8450"><font size=-1>8450     </font></a><span class="string">[[localrdwf]] = 1, the input wavefunction disk file or the KSS/SCR file in case</span>
<a name="8451"><font size=-1>8451     </font></a><span class="string">of GW calculations, is read locally by each processor, while if</span>
<a name="8452"><font size=-1>8452     </font></a><span class="string">[[localrdwf]] = 0, only one processor reads it, and broadcast the data to the</span>
<a name="8453"><font size=-1>8453     </font></a><span class="string">other processors.</span>
<a name="8454"><font size=-1>8454     </font></a><span class="string"></span>
<a name="8455"><font size=-1>8455     </font></a><span class="string">The option [[localrdwf]] = 0 is NOT allowed when parallel I/O are activated</span>
<a name="8456"><font size=-1>8456     </font></a><span class="string">(MPI-IO access), i.e. when [[iomode]] == 1.</span>
<a name="8457"><font size=-1>8457     </font></a><span class="string"></span>
<a name="8458"><font size=-1>8458     </font></a><span class="string">In the case of a parallel computer with a unique file system, both options are</span>
<a name="8459"><font size=-1>8459     </font></a><span class="string">as convenient for the user. However, if the I/O are slow compared to</span>
<a name="8460"><font size=-1>8460     </font></a><span class="string">communications between processors,, [[localrdwf]] = 0 should be much more</span>
<a name="8461"><font size=-1>8461     </font></a><span class="string">efficient; if you really need temporary disk storage, switch to localrdwf=1 ).</span>
<a name="8462"><font size=-1>8462     </font></a><span class="string"></span>
<a name="8463"><font size=-1>8463     </font></a><span class="string">In the case of a cluster of nodes, with a different file system for each</span>
<a name="8464"><font size=-1>8464     </font></a><span class="string">machine, the input wavefunction file must be available on all nodes if</span>
<a name="8465"><font size=-1>8465     </font></a><span class="string">[[localrdwf]] = 1, while it is needed only for the master node if [[localrdwf]] = 0.</span>
<a name="8466"><font size=-1>8466     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8467"><font size=-1>8467     </font></a><span class="default">),</span>
<a name="8468"><font size=-1>8468     </font></a><span class="default"></span>
<a name="8469"><font size=-1>8469     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8470"><font size=-1>8470     </font></a><span class="default">    abivarname=</span><span class="string">&quot;lotf_classic&quot;</span><span class="default">,</span>
<a name="8471"><font size=-1>8471     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8472"><font size=-1>8472     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8473"><font size=-1>8473     </font></a><span class="default">    topics=[</span><span class="string">'LOTF_expert'</span><span class="default">],</span>
<a name="8474"><font size=-1>8474     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8475"><font size=-1>8475     </font></a><span class="default">    defaultval=</span><span class="number">5</span><span class="default">,</span>
<a name="8476"><font size=-1>8476     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;LOTF CLASSIC model for glue model&quot;</span><span class="default">,</span>
<a name="8477"><font size=-1>8477     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8478"><font size=-1>8478     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8479"><font size=-1>8479     </font></a><span class="string">Glue model used in LOTF. For the moment it is imposed to be 5.</span>
<a name="8480"><font size=-1>8480     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8481"><font size=-1>8481     </font></a><span class="default">),</span>
<a name="8482"><font size=-1>8482     </font></a><span class="default"></span>
<a name="8483"><font size=-1>8483     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8484"><font size=-1>8484     </font></a><span class="default">    abivarname=</span><span class="string">&quot;lotf_nitex&quot;</span><span class="default">,</span>
<a name="8485"><font size=-1>8485     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8486"><font size=-1>8486     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8487"><font size=-1>8487     </font></a><span class="default">    topics=[</span><span class="string">'LOTF_expert'</span><span class="default">],</span>
<a name="8488"><font size=-1>8488     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8489"><font size=-1>8489     </font></a><span class="default">    defaultval=</span><span class="number">10</span><span class="default">,</span>
<a name="8490"><font size=-1>8490     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;LOTF Number of ITerations&quot;</span><span class="default">,</span>
<a name="8491"><font size=-1>8491     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8492"><font size=-1>8492     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8493"><font size=-1>8493     </font></a><span class="string">Set the number of Molecular Dynamics iterations which are computed by LOTF.</span>
<a name="8494"><font size=-1>8494     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8495"><font size=-1>8495     </font></a><span class="default">),</span>
<a name="8496"><font size=-1>8496     </font></a><span class="default"></span>
<a name="8497"><font size=-1>8497     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8498"><font size=-1>8498     </font></a><span class="default">    abivarname=</span><span class="string">&quot;lotf_nneigx&quot;</span><span class="default">,</span>
<a name="8499"><font size=-1>8499     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8500"><font size=-1>8500     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8501"><font size=-1>8501     </font></a><span class="default">    topics=[</span><span class="string">'LOTF_expert'</span><span class="default">],</span>
<a name="8502"><font size=-1>8502     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8503"><font size=-1>8503     </font></a><span class="default">    defaultval=</span><span class="number">5</span><span class="default">,</span>
<a name="8504"><font size=-1>8504     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;LOTF max Number of NEIGhbours&quot;</span><span class="default">,</span>
<a name="8505"><font size=-1>8505     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8506"><font size=-1>8506     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8507"><font size=-1>8507     </font></a><span class="string">Set the max number of Neighbours used in the LOTF method.</span>
<a name="8508"><font size=-1>8508     </font></a><span class="string">For the moment it is imposed to be 40.</span>
<a name="8509"><font size=-1>8509     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8510"><font size=-1>8510     </font></a><span class="default">),</span>
<a name="8511"><font size=-1>8511     </font></a><span class="default"></span>
<a name="8512"><font size=-1>8512     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8513"><font size=-1>8513     </font></a><span class="default">    abivarname=</span><span class="string">&quot;lotf_version&quot;</span><span class="default">,</span>
<a name="8514"><font size=-1>8514     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8515"><font size=-1>8515     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8516"><font size=-1>8516     </font></a><span class="default">    topics=[</span><span class="string">'LOTF_expert'</span><span class="default">],</span>
<a name="8517"><font size=-1>8517     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8518"><font size=-1>8518     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="8519"><font size=-1>8519     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;LOTF VERSION of MD algorithm&quot;</span><span class="default">,</span>
<a name="8520"><font size=-1>8520     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8521"><font size=-1>8521     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8522"><font size=-1>8522     </font></a><span class="string">Set the MD algorithm in the LOTF method. For the moment it is imposed to be 2.</span>
<a name="8523"><font size=-1>8523     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8524"><font size=-1>8524     </font></a><span class="default">),</span>
<a name="8525"><font size=-1>8525     </font></a><span class="default"></span>
<a name="8526"><font size=-1>8526     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8527"><font size=-1>8527     </font></a><span class="default">    abivarname=</span><span class="string">&quot;lpawu&quot;</span><span class="default">,</span>
<a name="8528"><font size=-1>8528     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="8529"><font size=-1>8529     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8530"><font size=-1>8530     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_compulsory'</span><span class="default">],</span>
<a name="8531"><font size=-1>8531     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="8532"><font size=-1>8532     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=-</span><span class="number">1</span><span class="default">),</span>
<a name="8533"><font size=-1>8533     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;value of angular momentum L for PAW+U&quot;</span><span class="default">,</span>
<a name="8534"><font size=-1>8534     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepawu]] == 1 or 2&quot;</span><span class="default">,</span>
<a name="8535"><font size=-1>8535     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8536"><font size=-1>8536     </font></a><span class="string">Give for each species the value of the angular momentum (only values 2 or 3</span>
<a name="8537"><font size=-1>8537     </font></a><span class="string">are allowed)  on which to apply the LDA+U correction.</span>
<a name="8538"><font size=-1>8538     </font></a><span class="string"></span>
<a name="8539"><font size=-1>8539     </font></a><span class="string">  * If equal to 2 (d-orbitals)  or 3 (f-orbitals), values of [[upawu]] and  [[jpawu]] are used in the calculation.</span>
<a name="8540"><font size=-1>8540     </font></a><span class="string">  * If equal to -1: do not apply LDA+U correction on the species.</span>
<a name="8541"><font size=-1>8541     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8542"><font size=-1>8542     </font></a><span class="default">),</span>
<a name="8543"><font size=-1>8543     </font></a><span class="default"></span>
<a name="8544"><font size=-1>8544     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8545"><font size=-1>8545     </font></a><span class="default">    abivarname=</span><span class="string">&quot;macro_uj&quot;</span><span class="default">,</span>
<a name="8546"><font size=-1>8546     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8547"><font size=-1>8547     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8548"><font size=-1>8548     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="8549"><font size=-1>8549     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8550"><font size=-1>8550     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="8551"><font size=-1>8551     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MACRO variable that activates the determination of the U and J parameter (for the PAW+U calculations)&quot;</span><span class="default">,</span>
<a name="8552"><font size=-1>8552     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8553"><font size=-1>8553     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8554"><font size=-1>8554     </font></a><span class="string">Sets proper input values for the determination of U and J i.e. for [[pawujat]]</span>
<a name="8555"><font size=-1>8555     </font></a><span class="string">(first atom treated with PAW+U), [[irdwfk]] (=1), [[tolvrs]] (=10^(-8)),</span>
<a name="8556"><font size=-1>8556     </font></a><span class="string">[[nstep]] (=255), [[diemix]] (=0.45), [[atvshift]] ([[pawujat]]) [[pawujv]]).</span>
<a name="8557"><font size=-1>8557     </font></a><span class="string">Do not overwrite these variables manually unless you know what you are doing.</span>
<a name="8558"><font size=-1>8558     </font></a><span class="string"></span>
<a name="8559"><font size=-1>8559     </font></a><span class="string">  * [[macro_uj]] = 1 (and [[nsppol]] = 2) Standard procedure to determine U on atom pawujat through a shift of the potential on both spin channels.</span>
<a name="8560"><font size=-1>8560     </font></a><span class="string">  * [[macro_uj]] = 1 (and [[nsppol]] = 1) Non standard procedure to determine U from potential shift on atom pawujat (experimental).</span>
<a name="8561"><font size=-1>8561     </font></a><span class="string">  * [[macro_uj]] = 2 (and [[nsppol]] = 2) Non standard procedure to determine U from potential shift on atom pawujat through a shift on spin channel 1 on this atom and the response on this channel (experimental).</span>
<a name="8562"><font size=-1>8562     </font></a><span class="string">  * [[macro_uj]] = 3 (and [[nsppol]] = 2) Standard procedure to determine J from potential shift on spin channel 1 on atom pawujat and response on spin channel 2 (experimental).</span>
<a name="8563"><font size=-1>8563     </font></a><span class="string"></span>
<a name="8564"><font size=-1>8564     </font></a><span class="string">Determination of U and J can be done only if the symmetry of the atomic</span>
<a name="8565"><font size=-1>8565     </font></a><span class="string">arrangement is reduced and the atom pawujat is not connected to any other atom</span>
<a name="8566"><font size=-1>8566     </font></a><span class="string">by symmetry relations (either input reduced symmetries manually, define</span>
<a name="8567"><font size=-1>8567     </font></a><span class="string">concerned atom as a separate atomic species or shift concerned atom from ideal</span>
<a name="8568"><font size=-1>8568     </font></a><span class="string">position).</span>
<a name="8569"><font size=-1>8569     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8570"><font size=-1>8570     </font></a><span class="default">),</span>
<a name="8571"><font size=-1>8571     </font></a><span class="default"></span>
<a name="8572"><font size=-1>8572     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8573"><font size=-1>8573     </font></a><span class="default">    abivarname=</span><span class="string">&quot;magcon_lambda&quot;</span><span class="default">,</span>
<a name="8574"><font size=-1>8574     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="8575"><font size=-1>8575     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8576"><font size=-1>8576     </font></a><span class="default">    topics=[</span><span class="string">'MagMom_useful'</span><span class="default">],</span>
<a name="8577"><font size=-1>8577     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8578"><font size=-1>8578     </font></a><span class="default">    defaultval=</span><span class="number">0.01</span><span class="default">,</span>
<a name="8579"><font size=-1>8579     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MAGnetization CONstraint LAMBDA parameter&quot;</span><span class="default">,</span>
<a name="8580"><font size=-1>8580     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8581"><font size=-1>8581     </font></a><span class="string">This variable gives the amplitude of the constraint imposed on the</span>
<a name="8582"><font size=-1>8582     </font></a><span class="string">magnetization vectors on each atom (turned on with flag variable</span>
<a name="8583"><font size=-1>8583     </font></a><span class="string">[[magconon]]). Typical values for [[magcon_lambda]] are 0.001 to 0.1. The SCF convergence</span>
<a name="8584"><font size=-1>8584     </font></a><span class="string">will be difficult if [[magcon_lambda]] is too large. If [[magcon_lambda]] is too small, the</span>
<a name="8585"><font size=-1>8585     </font></a><span class="string">constraint will not be very effective and it will give magnetization not close</span>
<a name="8586"><font size=-1>8586     </font></a><span class="string">to the desired [[spinat]] target. In case of convergence problem, it can help</span>
<a name="8587"><font size=-1>8587     </font></a><span class="string">to start with a small value of [[magcon_lambda]] and to increase it by reading the</span>
<a name="8588"><font size=-1>8588     </font></a><span class="string">wavefunction obtained with a lower [[magcon_lambda]] value. See variable [[magconon]] for more details.</span>
<a name="8589"><font size=-1>8589     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8590"><font size=-1>8590     </font></a><span class="default">),</span>
<a name="8591"><font size=-1>8591     </font></a><span class="default"></span>
<a name="8592"><font size=-1>8592     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8593"><font size=-1>8593     </font></a><span class="default">    abivarname=</span><span class="string">&quot;magconon&quot;</span><span class="default">,</span>
<a name="8594"><font size=-1>8594     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="8595"><font size=-1>8595     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8596"><font size=-1>8596     </font></a><span class="default">    topics=[</span><span class="string">'MagMom_useful'</span><span class="default">],</span>
<a name="8597"><font size=-1>8597     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8598"><font size=-1>8598     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="8599"><font size=-1>8599     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;turn MAGnetization CONstraint ON&quot;</span><span class="default">,</span>
<a name="8600"><font size=-1>8600     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8601"><font size=-1>8601     </font></a><span class="string">Turns on the imposition of a Lagrangian constraint on the magnetization. For</span>
<a name="8602"><font size=-1>8602     </font></a><span class="string">each atom, the magnetization is calculated in a sphere (radius [[ratsph]]) and</span>
<a name="8603"><font size=-1>8603     </font></a><span class="string">a constraint is applied to bring it closer to the input values of [[spinat]].</span>
<a name="8604"><font size=-1>8604     </font></a><span class="string">The constraint can be either on the direction only ([[magconon]] = 1) or on the full</span>
<a name="8605"><font size=-1>8605     </font></a><span class="string">vector ([[magconon]] = 2). The Lagrangian constraint has an amplitude</span>
<a name="8606"><font size=-1>8606     </font></a><span class="string">[[magcon_lambda]] which should be neither too big (bad or impossible</span>
<a name="8607"><font size=-1>8607     </font></a><span class="string">convergence) nor too small (no effect).</span>
<a name="8608"><font size=-1>8608     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8609"><font size=-1>8609     </font></a><span class="default">),</span>
<a name="8610"><font size=-1>8610     </font></a><span class="default"></span>
<a name="8611"><font size=-1>8611     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8612"><font size=-1>8612     </font></a><span class="default">    abivarname=</span><span class="string">&quot;max_ncpus&quot;</span><span class="default">,</span>
<a name="8613"><font size=-1>8613     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="8614"><font size=-1>8614     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8615"><font size=-1>8615     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="8616"><font size=-1>8616     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8617"><font size=-1>8617     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="8618"><font size=-1>8618     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MAXimum Number of CPUS&quot;</span><span class="default">,</span>
<a name="8619"><font size=-1>8619     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8620"><font size=-1>8620     </font></a><span class="string">If [[autoparal]] &gt; 1 and [[max_ncpus]] is greater than 0, ABINIT analyzes the</span>
<a name="8621"><font size=-1>8621     </font></a><span class="string">efficiency of the process distribution for each possible number of processors</span>
<a name="8622"><font size=-1>8622     </font></a><span class="string">from 2 to [[max_ncpus]]. After having printed out the efficiency, the code stops.</span>
<a name="8623"><font size=-1>8623     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8624"><font size=-1>8624     </font></a><span class="default">),</span>
<a name="8625"><font size=-1>8625     </font></a><span class="default"></span>
<a name="8626"><font size=-1>8626     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8627"><font size=-1>8627     </font></a><span class="default">    abivarname=</span><span class="string">&quot;maxestep&quot;</span><span class="default">,</span>
<a name="8628"><font size=-1>8628     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="8629"><font size=-1>8629     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8630"><font size=-1>8630     </font></a><span class="default">    topics=[</span><span class="string">'Berry_useful'</span><span class="default">],</span>
<a name="8631"><font size=-1>8631     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8632"><font size=-1>8632     </font></a><span class="default">    defaultval=</span><span class="number">0.005</span><span class="default">,</span>
<a name="8633"><font size=-1>8633     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MAXimum Electric field STEP&quot;</span><span class="default">,</span>
<a name="8634"><font size=-1>8634     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] = 6, 16, or 17&quot;</span><span class="default">,</span>
<a name="8635"><font size=-1>8635     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8636"><font size=-1>8636     </font></a><span class="string">This variable controls the maximum change of electric field when updating the</span>
<a name="8637"><font size=-1>8637     </font></a><span class="string">electric field after each SCF iteration. When the calculation is difficult to</span>
<a name="8638"><font size=-1>8638     </font></a><span class="string">converge, try reducing this value or reducing [[ddamp]]. This variable is used</span>
<a name="8639"><font size=-1>8639     </font></a><span class="string">in finite electric displacement field calculations ([[berryopt]] = 6,16,17).</span>
<a name="8640"><font size=-1>8640     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8641"><font size=-1>8641     </font></a><span class="default">),</span>
<a name="8642"><font size=-1>8642     </font></a><span class="default"></span>
<a name="8643"><font size=-1>8643     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8644"><font size=-1>8644     </font></a><span class="default">    abivarname=</span><span class="string">&quot;maxnsym&quot;</span><span class="default">,</span>
<a name="8645"><font size=-1>8645     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8646"><font size=-1>8646     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8647"><font size=-1>8647     </font></a><span class="default">    topics=[</span><span class="string">'crystal_expert'</span><span class="default">],</span>
<a name="8648"><font size=-1>8648     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8649"><font size=-1>8649     </font></a><span class="default">    defaultval=</span><span class="number">384</span><span class="default">,</span>
<a name="8650"><font size=-1>8650     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MAXimum Number of SYMetries&quot;</span><span class="default">,</span>
<a name="8651"><font size=-1>8651     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8652"><font size=-1>8652     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8653"><font size=-1>8653     </font></a><span class="string">Gives the maximum number of spatial symetries allowed in the memory.</span>
<a name="8654"><font size=-1>8654     </font></a><span class="string">The default value is sufficient for most applications. It might have to be</span>
<a name="8655"><font size=-1>8655     </font></a><span class="string">increased in the case of the use of a supercell (unit cell identically</span>
<a name="8656"><font size=-1>8656     </font></a><span class="string">repeated).</span>
<a name="8657"><font size=-1>8657     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8658"><font size=-1>8658     </font></a><span class="default">),</span>
<a name="8659"><font size=-1>8659     </font></a><span class="default"></span>
<a name="8660"><font size=-1>8660     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8661"><font size=-1>8661     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mband&quot;</span><span class="default">,</span>
<a name="8662"><font size=-1>8662     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="8663"><font size=-1>8663     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8664"><font size=-1>8664     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_internal'</span><span class="default">],</span>
<a name="8665"><font size=-1>8665     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8666"><font size=-1>8666     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Maximum number of BANDs&quot;</span><span class="default">,</span>
<a name="8667"><font size=-1>8667     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="8668"><font size=-1>8668     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8669"><font size=-1>8669     </font></a><span class="string">This internal variable derives the maximum number of bands over all k-points</span>
<a name="8670"><font size=-1>8670     </font></a><span class="string">and spin-polarisation from [[nband]](1:nkpt*nsppol).</span>
<a name="8671"><font size=-1>8671     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8672"><font size=-1>8672     </font></a><span class="default">),</span>
<a name="8673"><font size=-1>8673     </font></a><span class="default"></span>
<a name="8674"><font size=-1>8674     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8675"><font size=-1>8675     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mbpt_sciss&quot;</span><span class="default">,</span>
<a name="8676"><font size=-1>8676     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="8677"><font size=-1>8677     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8678"><font size=-1>8678     </font></a><span class="default">    topics=[</span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'Susceptibility_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="8679"><font size=-1>8679     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8680"><font size=-1>8680     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="8681"><font size=-1>8681     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Many Body Perturbation Theory SCISSor operator&quot;</span><span class="default">,</span>
<a name="8682"><font size=-1>8682     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="8683"><font size=-1>8683     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4,99]&quot;</span><span class="default">,</span>
<a name="8684"><font size=-1>8684     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8685"><font size=-1>8685     </font></a><span class="string">The scissor operator energy added to the conductions states. In some cases,</span>
<a name="8686"><font size=-1>8686     </font></a><span class="string">it mimics a second iteration self-consistent GW calculation.</span>
<a name="8687"><font size=-1>8687     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8688"><font size=-1>8688     </font></a><span class="default">),</span>
<a name="8689"><font size=-1>8689     </font></a><span class="default"></span>
<a name="8690"><font size=-1>8690     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8691"><font size=-1>8691     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mdf_epsinf&quot;</span><span class="default">,</span>
<a name="8692"><font size=-1>8692     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="8693"><font size=-1>8693     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8694"><font size=-1>8694     </font></a><span class="default">    topics=[</span><span class="string">'BSE_useful'</span><span class="default">],</span>
<a name="8695"><font size=-1>8695     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8696"><font size=-1>8696     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="8697"><font size=-1>8697     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Model Dielectric Function, EPSilon INFinity&quot;</span><span class="default">,</span>
<a name="8698"><font size=-1>8698     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 99 and [[bs_coulomb_term]] in [20,21] (Bethe-Salpeter calculas with a model dielectric function&quot;</span><span class="default">,</span>
<a name="8699"><font size=-1>8699     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8700"><font size=-1>8700     </font></a><span class="string">[[mdf_epsinf]] specifies the value of the macroscopic dielectric function used</span>
<a name="8701"><font size=-1>8701     </font></a><span class="string">to model the screening function (see [[cite:Bechstedt1992]]).</span>
<a name="8702"><font size=-1>8702     </font></a><span class="string">The proper spatial symmetry of the screening $W(\mathbf{r},\mathbf{r}^\prime)$ is enforced using</span>
<a name="8703"><font size=-1>8703     </font></a><span class="string">Eq. (7) of [[cite:vonderLinden1988]].</span>
<a name="8704"><font size=-1>8704     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8705"><font size=-1>8705     </font></a><span class="default">),</span>
<a name="8706"><font size=-1>8706     </font></a><span class="default"></span>
<a name="8707"><font size=-1>8707     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8708"><font size=-1>8708     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mdtemp&quot;</span><span class="default">,</span>
<a name="8709"><font size=-1>8709     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="8710"><font size=-1>8710     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8711"><font size=-1>8711     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_compulsory'</span><span class="default">, </span><span class="string">'MolecularDynamics_compulsory'</span><span class="default">],</span>
<a name="8712"><font size=-1>8712     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="8713"><font size=-1>8713     </font></a><span class="default">    defaultval=[</span><span class="number">300</span><span class="default">, </span><span class="number">300</span><span class="default">],</span>
<a name="8714"><font size=-1>8714     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Molecular Dynamics TEMPeratures&quot;</span><span class="default">,</span>
<a name="8715"><font size=-1>8715     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8716"><font size=-1>8716     </font></a><span class="string">Give the initial and final temperature of the Nose-Hoover thermostat</span>
<a name="8717"><font size=-1>8717     </font></a><span class="string">([[ionmov]] = 8) and Langevin dynamics ([[ionmov]] = 9), in Kelvin. This</span>
<a name="8718"><font size=-1>8718     </font></a><span class="string">temperature will change linearly from the initial temperature **mdtemp(1)** at</span>
<a name="8719"><font size=-1>8719     </font></a><span class="string">itime=1 to the final temperature **mdtemp(2)** at the end of the [[ntime]] timesteps.</span>
<a name="8720"><font size=-1>8720     </font></a><span class="string"></span>
<a name="8721"><font size=-1>8721     </font></a><span class="string">In the case of the isokinetic molecular dynamics ([[ionmov]] = 12), **mdtemp(1)** allows ABINIT</span>
<a name="8722"><font size=-1>8722     </font></a><span class="string">to generate velocities ([[vel]]) to start the run if they are not provided by the user or if they all vanish. However **mdtemp(2)** is not used (even if it must be defined to please the parser). If some velocities are non-zero, **mdtemp** is not used, the kinetic energy computed from the velocities is kept constant during the run.</span>
<a name="8723"><font size=-1>8723     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8724"><font size=-1>8724     </font></a><span class="default">),</span>
<a name="8725"><font size=-1>8725     </font></a><span class="default"></span>
<a name="8726"><font size=-1>8726     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8727"><font size=-1>8727     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mdwall&quot;</span><span class="default">,</span>
<a name="8728"><font size=-1>8728     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="8729"><font size=-1>8729     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8730"><font size=-1>8730     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="8731"><font size=-1>8731     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8732"><font size=-1>8732     </font></a><span class="default">    defaultval=</span><span class="number">10000.0</span><span class="default">,</span>
<a name="8733"><font size=-1>8733     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Molecular Dynamics WALL location&quot;</span><span class="default">,</span>
<a name="8734"><font size=-1>8734     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;the walls are extremely far away&quot;</span><span class="default">,</span>
<a name="8735"><font size=-1>8735     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8736"><font size=-1>8736     </font></a><span class="string">Gives the location (atomic units) of walls on which the atoms will bounce</span>
<a name="8737"><font size=-1>8737     </font></a><span class="string">back. when [[ionmov]] = 6, 7, 8 or 9. For each cartesian direction idir=1, 2 or</span>
<a name="8738"><font size=-1>8738     </font></a><span class="string">3, there is a pair of walls with coordinates xcart(idir)=-wall and</span>
<a name="8739"><font size=-1>8739     </font></a><span class="string">xcart(idir)=rprimd(idir,idir)+wall. Supposing the particle will cross the</span>
<a name="8740"><font size=-1>8740     </font></a><span class="string">wall, its velocity normal to the wall is reversed, so that it bounces back.</span>
<a name="8741"><font size=-1>8741     </font></a><span class="string">By default, given in Bohr atomic units (1 Bohr=0.5291772108 Angstroms),</span>
<a name="8742"><font size=-1>8742     </font></a><span class="string">although Angstrom can be specified, if preferred, since [[mdwall]] has the</span>
<a name="8743"><font size=-1>8743     </font></a><span class="string">'[[LENGTH]]' characteristics.</span>
<a name="8744"><font size=-1>8744     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8745"><font size=-1>8745     </font></a><span class="default">),</span>
<a name="8746"><font size=-1>8746     </font></a><span class="default"></span>
<a name="8747"><font size=-1>8747     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8748"><font size=-1>8748     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mem_test&quot;</span><span class="default">,</span>
<a name="8749"><font size=-1>8749     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8750"><font size=-1>8750     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8751"><font size=-1>8751     </font></a><span class="default">    topics=[</span><span class="string">'Control_expert'</span><span class="default">],</span>
<a name="8752"><font size=-1>8752     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8753"><font size=-1>8753     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="8754"><font size=-1>8754     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MEMory TEST&quot;</span><span class="default">,</span>
<a name="8755"><font size=-1>8755     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8756"><font size=-1>8756     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8757"><font size=-1>8757     </font></a><span class="string">This variable controls the memory test done in the `memana` routine. Possible</span>
<a name="8758"><font size=-1>8758     </font></a><span class="string">values:</span>
<a name="8759"><font size=-1>8759     </font></a><span class="string"></span>
<a name="8760"><font size=-1>8760     </font></a><span class="string">  * 0 no test on the available memory is performed</span>
<a name="8761"><font size=-1>8761     </font></a><span class="string">  * 1 the routine tries to allocate the estimated memory, for testing purposes, and if a failure occurs, the routine stops.</span>
<a name="8762"><font size=-1>8762     </font></a><span class="string">  * 2 like 1, but before stopping, the routine will provide an estimation of the available memory.</span>
<a name="8763"><font size=-1>8763     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8764"><font size=-1>8764     </font></a><span class="default">),</span>
<a name="8765"><font size=-1>8765     </font></a><span class="default"></span>
<a name="8766"><font size=-1>8766     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8767"><font size=-1>8767     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mep_mxstep&quot;</span><span class="default">,</span>
<a name="8768"><font size=-1>8768     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="8769"><font size=-1>8769     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8770"><font size=-1>8770     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_useful'</span><span class="default">],</span>
<a name="8771"><font size=-1>8771     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8772"><font size=-1>8772     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[imgmov]] == 5'</span><span class="default">: </span><span class="number">0.4</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">100.0</span><span class="default">}),</span>
<a name="8773"><font size=-1>8773     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Minimal Energy Path search: MaXimum allowed STEP size&quot;</span><span class="default">,</span>
<a name="8774"><font size=-1>8774     </font></a><span class="default">    characteristics=[</span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="8775"><font size=-1>8775     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8776"><font size=-1>8776     </font></a><span class="string">Relevant only when [[imgmov]] = 1 (Steepest-Descent), 2 (String Method) or 5</span>
<a name="8777"><font size=-1>8777     </font></a><span class="string">(Nudged Elastic Band).</span>
<a name="8778"><font size=-1>8778     </font></a><span class="string">The optimizer used to solve the Ordinary Differential Equation (ODE) can be</span>
<a name="8779"><font size=-1>8779     </font></a><span class="string">constrained with a maximum allowed step size for each image. By default this</span>
<a name="8780"><font size=-1>8780     </font></a><span class="string">feature is only activated for Nudged Elastic Band (NEB) and the value is</span>
<a name="8781"><font size=-1>8781     </font></a><span class="string">inspired by [[cite:Sheppard2008]].</span>
<a name="8782"><font size=-1>8782     </font></a><span class="string">Note that the step size is defined for each image as _step = SQRT[SUM(R_i dot</span>
<a name="8783"><font size=-1>8783     </font></a><span class="string">R_i)]_ where the _R_i_ are the positions of the atoms in the cell.</span>
<a name="8784"><font size=-1>8784     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8785"><font size=-1>8785     </font></a><span class="default">),</span>
<a name="8786"><font size=-1>8786     </font></a><span class="default"></span>
<a name="8787"><font size=-1>8787     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8788"><font size=-1>8788     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mep_solver&quot;</span><span class="default">,</span>
<a name="8789"><font size=-1>8789     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="8790"><font size=-1>8790     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8791"><font size=-1>8791     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_basic'</span><span class="default">],</span>
<a name="8792"><font size=-1>8792     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8793"><font size=-1>8793     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Minimal Energy Path ordinary differential equation SOLVER&quot;</span><span class="default">,</span>
<a name="8794"><font size=-1>8794     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8795"><font size=-1>8795     </font></a><span class="string">Relevant only when [[imgmov]] = 2 (String Method) or 5 (Nudged Elastic Band).</span>
<a name="8796"><font size=-1>8796     </font></a><span class="string">Gives the algorithm used to solve the Ordinary Differential Equation (ODE)</span>
<a name="8797"><font size=-1>8797     </font></a><span class="string">when searching for a Minimal Energy Path (MEP).</span>
<a name="8798"><font size=-1>8798     </font></a><span class="string">Possible values can be:</span>
<a name="8799"><font size=-1>8799     </font></a><span class="string"></span>
<a name="8800"><font size=-1>8800     </font></a><span class="string">  * 0 --&gt; **Steepest-Descent algorithm** following the (scaled) forces, the scaling factor being [[fxcartfactor]] (forward Euler method).</span>
<a name="8801"><font size=-1>8801     </font></a><span class="string">Compatible with all MEP search methods.</span>
<a name="8802"><font size=-1>8802     </font></a><span class="string"></span>
<a name="8803"><font size=-1>8803     </font></a><span class="string">  * 1 --&gt; **Quick-min optimizer** following the (scaled) forces, the scaling factor being [[fxcartfactor]]. The &quot;quick minimizer&quot; improves upon the steepest-descent method by accelerating the system in the direction of the forces. The velocity (of the image) is projected long the force and cancelled if antiparallel to it.</span>
<a name="8804"><font size=-1>8804     </font></a><span class="string">Compatible only with Nudged Elastic Band ([[imgmov]] = 5).</span>
<a name="8805"><font size=-1>8805     </font></a><span class="string">See [[cite:Sheppard2008]].</span>
<a name="8806"><font size=-1>8806     </font></a><span class="string"></span>
<a name="8807"><font size=-1>8807     </font></a><span class="string">  * 2 --&gt; **Local Broyden-Fletcher-Goldfarb-Shanno (L-BFGS) algorithm**; each image along the band is minimized with a different instance of the BFGS optimizer.</span>
<a name="8808"><font size=-1>8808     </font></a><span class="string">Compatible only with Nudged Elastic Band ([[imgmov]] = 5).</span>
<a name="8809"><font size=-1>8809     </font></a><span class="string">See [[cite:Sheppard2008]].</span>
<a name="8810"><font size=-1>8810     </font></a><span class="string">IN [[DEVELOP]]PMENT - NOT RELIABLE</span>
<a name="8811"><font size=-1>8811     </font></a><span class="string"></span>
<a name="8812"><font size=-1>8812     </font></a><span class="string">  * 3 --&gt; **Global Broyden-Fletcher-Goldfarb-Shanno (GL-BFGS) algorithm**; all images along the band are minimized with a single instance of the BFGS optimizer.</span>
<a name="8813"><font size=-1>8813     </font></a><span class="string">Compatible only with Nudged Elastic Band ([[imgmov]] = 5).</span>
<a name="8814"><font size=-1>8814     </font></a><span class="string">See [[cite:Sheppard2008]].</span>
<a name="8815"><font size=-1>8815     </font></a><span class="string">IN [[DEVELOP]]PMENT - NOT RELIABLE</span>
<a name="8816"><font size=-1>8816     </font></a><span class="string"></span>
<a name="8817"><font size=-1>8817     </font></a><span class="string">  * 4 --&gt; **Fourth-order Runge-Kutta method**; the images along the band are moved every four steps (1 &lt;=istep&lt;=[[ntimimage]]) following the Runge-Kutta algorithm, the time step being [[fxcartfactor]].</span>
<a name="8818"><font size=-1>8818     </font></a><span class="string">Compatible only with Simplified String Method ([[imgmov]] = 2 and</span>
<a name="8819"><font size=-1>8819     </font></a><span class="string">[[string_algo]] = 1 or 2).</span>
<a name="8820"><font size=-1>8820     </font></a><span class="string">See [[cite:Weinan2007]].</span>
<a name="8821"><font size=-1>8821     </font></a><span class="string"></span>
<a name="8822"><font size=-1>8822     </font></a><span class="string">All of the optimizers can be constrained with a maximum allowed step size for</span>
<a name="8823"><font size=-1>8823     </font></a><span class="string">each image; see [[mep_mxstep]]. This is by default the case of the Nudged</span>
<a name="8824"><font size=-1>8824     </font></a><span class="string">Elastic Band ([[imgmov]] = 5).</span>
<a name="8825"><font size=-1>8825     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8826"><font size=-1>8826     </font></a><span class="default">),</span>
<a name="8827"><font size=-1>8827     </font></a><span class="default"></span>
<a name="8828"><font size=-1>8828     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8829"><font size=-1>8829     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mgfft&quot;</span><span class="default">,</span>
<a name="8830"><font size=-1>8830     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="8831"><font size=-1>8831     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8832"><font size=-1>8832     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_internal'</span><span class="default">],</span>
<a name="8833"><font size=-1>8833     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8834"><font size=-1>8834     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Maximum of nGFFT&quot;</span><span class="default">,</span>
<a name="8835"><font size=-1>8835     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="8836"><font size=-1>8836     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8837"><font size=-1>8837     </font></a><span class="string">This internal variable contains the maximum of [[ngfft]](1:3).</span>
<a name="8838"><font size=-1>8838     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8839"><font size=-1>8839     </font></a><span class="default">),</span>
<a name="8840"><font size=-1>8840     </font></a><span class="default"></span>
<a name="8841"><font size=-1>8841     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8842"><font size=-1>8842     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mgfftdg&quot;</span><span class="default">,</span>
<a name="8843"><font size=-1>8843     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="8844"><font size=-1>8844     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8845"><font size=-1>8845     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_internal'</span><span class="default">],</span>
<a name="8846"><font size=-1>8846     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8847"><font size=-1>8847     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Maximum of nGFFT for the Double Grid&quot;</span><span class="default">,</span>
<a name="8848"><font size=-1>8848     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="8849"><font size=-1>8849     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8850"><font size=-1>8850     </font></a><span class="string">This internal variable contains the maximum of [[ngfftdg]](1:3).</span>
<a name="8851"><font size=-1>8851     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8852"><font size=-1>8852     </font></a><span class="default">),</span>
<a name="8853"><font size=-1>8853     </font></a><span class="default"></span>
<a name="8854"><font size=-1>8854     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8855"><font size=-1>8855     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mixalch&quot;</span><span class="default">,</span>
<a name="8856"><font size=-1>8856     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="8857"><font size=-1>8857     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8858"><font size=-1>8858     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_useful'</span><span class="default">],</span>
<a name="8859"><font size=-1>8859     </font></a><span class="default">    dimensions=[</span><span class="string">'[[npspalch]]'</span><span class="default">, </span><span class="string">'[[ntypalch]]'</span><span class="default">],</span>
<a name="8860"><font size=-1>8860     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MIXing coefficients for ALCHemical potentials&quot;</span><span class="default">,</span>
<a name="8861"><font size=-1>8861     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="8862"><font size=-1>8862     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8863"><font size=-1>8863     </font></a><span class="string">Used for the generation of alchemical pseudoatoms, that is, when [[ntypalch]]</span>
<a name="8864"><font size=-1>8864     </font></a><span class="string">is non-zero.</span>
<a name="8865"><font size=-1>8865     </font></a><span class="string"></span>
<a name="8866"><font size=-1>8866     </font></a><span class="string">This array gives, for each type of alchemical pseudatom (there are</span>
<a name="8867"><font size=-1>8867     </font></a><span class="string">[[ntypalch]] such pseudoatoms), the mixing coefficients of the basic</span>
<a name="8868"><font size=-1>8868     </font></a><span class="string">[[npspalch]] pseudopotentials for alchemical use. For each type of alchemical</span>
<a name="8869"><font size=-1>8869     </font></a><span class="string">pseudoatom, the sum of the mixing coefficients must equal 1.</span>
<a name="8870"><font size=-1>8870     </font></a><span class="string"></span>
<a name="8871"><font size=-1>8871     </font></a><span class="string">The actual use of the mixing coefficients is defined by the input variable</span>
<a name="8872"><font size=-1>8872     </font></a><span class="string">[[algalch]]. Note that the masses of the atoms, [[amu]] are also mixed</span>
<a name="8873"><font size=-1>8873     </font></a><span class="string">according to the value of [[mixalch]], by default.</span>
<a name="8874"><font size=-1>8874     </font></a><span class="string"></span>
<a name="8875"><font size=-1>8875     </font></a><span class="string">Example 1. Suppose that we want to describe Ba(0.25) Sr(0.75) Ti O$_3$.</span>
<a name="8876"><font size=-1>8876     </font></a><span class="string">The input variables related to the construction of the alchemical Ba(0.25)</span>
<a name="8877"><font size=-1>8877     </font></a><span class="string">Sr(0.75) potential will be:</span>
<a name="8878"><font size=-1>8878     </font></a><span class="string"></span>
<a name="8879"><font size=-1>8879     </font></a><span class="string">      npsp   4                 ! 4 pseudopotentials should be read.</span>
<a name="8880"><font size=-1>8880     </font></a><span class="string">      znucl  8 40 56 38        ! The nuclear charges. Note that the two</span>
<a name="8881"><font size=-1>8881     </font></a><span class="string">                               ! atoms whose pseudopotentials are to be mixed</span>
<a name="8882"><font size=-1>8882     </font></a><span class="string">                               ! are mentioned at the end of the series.</span>
<a name="8883"><font size=-1>8883     </font></a><span class="string">      ntypat  3                ! There will be three types of atoms.</span>
<a name="8884"><font size=-1>8884     </font></a><span class="string">      ntypalch   1             ! One pseudoatom will be alchemical.</span>
<a name="8885"><font size=-1>8885     </font></a><span class="string">                               ! Hence, there will be ntyppure=2 pure pseudoatoms,</span>
<a name="8886"><font size=-1>8886     </font></a><span class="string">                               ! with znucl 8 (O) and 40 (Ti), corresponding to</span>
<a name="8887"><font size=-1>8887     </font></a><span class="string">                               ! the two first pseudopotentials. Out of the</span>
<a name="8888"><font size=-1>8888     </font></a><span class="string">                               ! four pseudopotentials, npspalch=2 are left</span>
<a name="8889"><font size=-1>8889     </font></a><span class="string">                               ! for alchemical purposes, with znucl 56 (Ba)</span>
<a name="8890"><font size=-1>8890     </font></a><span class="string">                               ! and 38 (Sr).</span>
<a name="8891"><font size=-1>8891     </font></a><span class="string">      mixalch    0.25  0.75    ! For that unique pseudoatom to be</span>
<a name="8892"><font size=-1>8892     </font></a><span class="string">                               ! generated, here are the mixing coeeficients,</span>
<a name="8893"><font size=-1>8893     </font></a><span class="string">                               ! to be used to combine the Ba and Sr pseudopotentials.</span>
<a name="8894"><font size=-1>8894     </font></a><span class="string"></span>
<a name="8895"><font size=-1>8895     </font></a><span class="string"></span>
<a name="8896"><font size=-1>8896     </font></a><span class="string">Example 2. More complicated, and illustrate some minor drawback of the design</span>
<a name="8897"><font size=-1>8897     </font></a><span class="string">of input variables. Suppose that one wants to generate Al(0.25)Ga(0.75)</span>
<a name="8898"><font size=-1>8898     </font></a><span class="string">As(0.10)Sb(0.90).</span>
<a name="8899"><font size=-1>8899     </font></a><span class="string">The input variables will be:</span>
<a name="8900"><font size=-1>8900     </font></a><span class="string"></span>
<a name="8901"><font size=-1>8901     </font></a><span class="string">      npsp  4                  ! 4 pseudopotentials should be read</span>
<a name="8902"><font size=-1>8902     </font></a><span class="string">      znucl  13 31 33 51       ! The atomic numbers. All pseudopotentials</span>
<a name="8903"><font size=-1>8903     </font></a><span class="string">                               ! will be used for some alchemical purpose</span>
<a name="8904"><font size=-1>8904     </font></a><span class="string">      ntypat  2                ! There will be two types of atoms.</span>
<a name="8905"><font size=-1>8905     </font></a><span class="string">      ntypalch   2             ! None of the atoms will be &quot;pure&quot;.</span>
<a name="8906"><font size=-1>8906     </font></a><span class="string">                               ! Hence, there will be npspalch=4 pseudopotentials</span>
<a name="8907"><font size=-1>8907     </font></a><span class="string">                               !  to be used for alchemical purposes.</span>
<a name="8908"><font size=-1>8908     </font></a><span class="string">      mixalch    0.25  0.75 0.0  0.0   ! This array is a (4,2) array, arranged in the</span>
<a name="8909"><font size=-1>8909     </font></a><span class="string">                 0.0   0.0  0.1  0.9   ! usual Fortran order.</span>
<a name="8910"><font size=-1>8910     </font></a><span class="string"></span>
<a name="8911"><font size=-1>8911     </font></a><span class="string">Minor drawback: one should not forget to fill [[mixalch]] with the needed</span>
<a name="8912"><font size=-1>8912     </font></a><span class="string">zero's, in this later case.</span>
<a name="8913"><font size=-1>8913     </font></a><span class="string"></span>
<a name="8914"><font size=-1>8914     </font></a><span class="string">In most cases, the use of [[mixalch]] will be as a static (non-evolving)</span>
<a name="8915"><font size=-1>8915     </font></a><span class="string">variable. However, the possibility to have different values of [[mixalch]] for</span>
<a name="8916"><font size=-1>8916     </font></a><span class="string">different images has been coded. A population of cells with different atomic</span>
<a name="8917"><font size=-1>8917     </font></a><span class="string">characteristics can thus be considered, and can be made to evolve, e.g. with a</span>
<a name="8918"><font size=-1>8918     </font></a><span class="string">genetic algorithm (not coded in v7.0.0 though). There is one restriction to</span>
<a name="8919"><font size=-1>8919     </font></a><span class="string">this possibility: the value of [[ziontypat]] for the atoms that are mixed</span>
<a name="8920"><font size=-1>8920     </font></a><span class="string">should be identical.</span>
<a name="8921"><font size=-1>8921     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8922"><font size=-1>8922     </font></a><span class="default">),</span>
<a name="8923"><font size=-1>8923     </font></a><span class="default"></span>
<a name="8924"><font size=-1>8924     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8925"><font size=-1>8925     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mixesimgf&quot;</span><span class="default">,</span>
<a name="8926"><font size=-1>8926     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="8927"><font size=-1>8927     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="8928"><font size=-1>8928     </font></a><span class="default">    topics=[</span><span class="string">'CrossingBarriers_useful'</span><span class="default">],</span>
<a name="8929"><font size=-1>8929     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nimage]]'</span><span class="default">],</span>
<a name="8930"><font size=-1>8930     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;MIXing Electronic Structure IMAGE Factors&quot;</span><span class="default">,</span>
<a name="8931"><font size=-1>8931     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8932"><font size=-1>8932     </font></a><span class="string">Used in the algorithm Linear Combination of Constrained DFT Energies, that is, when [[imgmov]]==6.</span>
<a name="8933"><font size=-1>8933     </font></a><span class="string"></span>
<a name="8934"><font size=-1>8934     </font></a><span class="string">This array gives, for each one of the [[nimage]] images, the factor</span>
<a name="8935"><font size=-1>8935     </font></a><span class="string">by which the total energies for systems with same geometry but different electronic structures (occupation numbers) are linearly combined.</span>
<a name="8936"><font size=-1>8936     </font></a><span class="string">The sum of these factors must equal 1.</span>
<a name="8937"><font size=-1>8937     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8938"><font size=-1>8938     </font></a><span class="default">),</span>
<a name="8939"><font size=-1>8939     </font></a><span class="default"></span>
<a name="8940"><font size=-1>8940     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8941"><font size=-1>8941     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mpw&quot;</span><span class="default">,</span>
<a name="8942"><font size=-1>8942     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="8943"><font size=-1>8943     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8944"><font size=-1>8944     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_internal'</span><span class="default">],</span>
<a name="8945"><font size=-1>8945     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8946"><font size=-1>8946     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Maximum number of Plane Waves&quot;</span><span class="default">,</span>
<a name="8947"><font size=-1>8947     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="8948"><font size=-1>8948     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8949"><font size=-1>8949     </font></a><span class="string">This internal variable gives the maximum of the number of plane waves over all</span>
<a name="8950"><font size=-1>8950     </font></a><span class="string">k-points. It is computed from [[ecut]] and the description of the cell,</span>
<a name="8951"><font size=-1>8951     </font></a><span class="string">provided by [[acell]], [[rprim]], and/or [[angdeg]].</span>
<a name="8952"><font size=-1>8952     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8953"><font size=-1>8953     </font></a><span class="default">),</span>
<a name="8954"><font size=-1>8954     </font></a><span class="default"></span>
<a name="8955"><font size=-1>8955     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8956"><font size=-1>8956     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mqgrid&quot;</span><span class="default">,</span>
<a name="8957"><font size=-1>8957     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="8958"><font size=-1>8958     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8959"><font size=-1>8959     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_expert'</span><span class="default">],</span>
<a name="8960"><font size=-1>8960     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8961"><font size=-1>8961     </font></a><span class="default">    defaultval=</span><span class="number">3001</span><span class="default">,</span>
<a name="8962"><font size=-1>8962     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Maximum number of Q-space GRID points for pseudopotentials&quot;</span><span class="default">,</span>
<a name="8963"><font size=-1>8963     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8964"><font size=-1>8964     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8965"><font size=-1>8965     </font></a><span class="string">Govern the size of the one-dimensional information related to</span>
<a name="8966"><font size=-1>8966     </font></a><span class="string">pseudopotentials, in reciprocal space: potentials, or projector functions.</span>
<a name="8967"><font size=-1>8967     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8968"><font size=-1>8968     </font></a><span class="default">),</span>
<a name="8969"><font size=-1>8969     </font></a><span class="default"></span>
<a name="8970"><font size=-1>8970     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8971"><font size=-1>8971     </font></a><span class="default">    abivarname=</span><span class="string">&quot;mqgriddg&quot;</span><span class="default">,</span>
<a name="8972"><font size=-1>8972     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="8973"><font size=-1>8973     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8974"><font size=-1>8974     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="8975"><font size=-1>8975     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="8976"><font size=-1>8976     </font></a><span class="default">    defaultval=</span><span class="number">3001</span><span class="default">,</span>
<a name="8977"><font size=-1>8977     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Maximum number of Q-wavevectors for the 1-dimensional GRID  for the Double Grid in PAW&quot;</span><span class="default">,</span>
<a name="8978"><font size=-1>8978     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="8979"><font size=-1>8979     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8980"><font size=-1>8980     </font></a><span class="string">Maximum number of wavevectors used to sample the local part of the potential,</span>
<a name="8981"><font size=-1>8981     </font></a><span class="string">in PAW. Actually referred to as mqgrid_vl internally. Should change name to</span>
<a name="8982"><font size=-1>8982     </font></a><span class="string">the latter... See also [[mqgrid]]</span>
<a name="8983"><font size=-1>8983     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="8984"><font size=-1>8984     </font></a><span class="default">),</span>
<a name="8985"><font size=-1>8985     </font></a><span class="default"></span>
<a name="8986"><font size=-1>8986     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="8987"><font size=-1>8987     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natcon&quot;</span><span class="default">,</span>
<a name="8988"><font size=-1>8988     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="8989"><font size=-1>8989     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="8990"><font size=-1>8990     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_useful'</span><span class="default">],</span>
<a name="8991"><font size=-1>8991     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nconeq]]'</span><span class="default">],</span>
<a name="8992"><font size=-1>8992     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="8993"><font size=-1>8993     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of AToms in CONstraint equations&quot;</span><span class="default">,</span>
<a name="8994"><font size=-1>8994     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">, </span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="8995"><font size=-1>8995     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="8996"><font size=-1>8996     </font></a><span class="string">Gives the number of atoms appearing in each of the [[nconeq]] independent</span>
<a name="8997"><font size=-1>8997     </font></a><span class="string">equations constraining the motion of atoms during structural optimization or</span>
<a name="8998"><font size=-1>8998     </font></a><span class="string">molecular dynamics (see [[nconeq]], [[iatcon]], and [[wtatcon]]).</span>
<a name="8999"><font size=-1>8999     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9000"><font size=-1>9000     </font></a><span class="default">),</span>
<a name="9001"><font size=-1>9001     </font></a><span class="default"></span>
<a name="9002"><font size=-1>9002     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9003"><font size=-1>9003     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natfix&quot;</span><span class="default">,</span>
<a name="9004"><font size=-1>9004     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9005"><font size=-1>9005     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9006"><font size=-1>9006     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="9007"><font size=-1>9007     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9008"><font size=-1>9008     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9009"><font size=-1>9009     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Atoms that are FIXed&quot;</span><span class="default">,</span>
<a name="9010"><font size=-1>9010     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9011"><font size=-1>9011     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;(no atoms held fixed)&quot;</span><span class="default">,</span>
<a name="9012"><font size=-1>9012     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9013"><font size=-1>9013     </font></a><span class="string">Gives the number of atoms (not to exceed [[natom]]) which are to be held fixed</span>
<a name="9014"><font size=-1>9014     </font></a><span class="string">during a structural optimization or molecular dynamics.</span>
<a name="9015"><font size=-1>9015     </font></a><span class="string">When [[natfix]] &gt; 0, [[natfix]] entries should be provided in array [[iatfix]]</span>
<a name="9016"><font size=-1>9016     </font></a><span class="string">.</span>
<a name="9017"><font size=-1>9017     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9018"><font size=-1>9018     </font></a><span class="default">),</span>
<a name="9019"><font size=-1>9019     </font></a><span class="default"></span>
<a name="9020"><font size=-1>9020     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9021"><font size=-1>9021     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natfixx&quot;</span><span class="default">,</span>
<a name="9022"><font size=-1>9022     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9023"><font size=-1>9023     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9024"><font size=-1>9024     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="9025"><font size=-1>9025     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9026"><font size=-1>9026     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9027"><font size=-1>9027     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Atoms that are FIXed along the X direction&quot;</span><span class="default">,</span>
<a name="9028"><font size=-1>9028     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9029"><font size=-1>9029     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9030"><font size=-1>9030     </font></a><span class="string">Gives the number of atoms (not to exceed [[natom]]) which are to be held fixed</span>
<a name="9031"><font size=-1>9031     </font></a><span class="string">along the X direction during a structural optimization or molecular dynamics.</span>
<a name="9032"><font size=-1>9032     </font></a><span class="string">When [[natfixx]] &gt; 0, [[natfixx]] entries should be provided in array</span>
<a name="9033"><font size=-1>9033     </font></a><span class="string">[[iatfixx]].</span>
<a name="9034"><font size=-1>9034     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9035"><font size=-1>9035     </font></a><span class="default">),</span>
<a name="9036"><font size=-1>9036     </font></a><span class="default"></span>
<a name="9037"><font size=-1>9037     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9038"><font size=-1>9038     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natfixy&quot;</span><span class="default">,</span>
<a name="9039"><font size=-1>9039     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9040"><font size=-1>9040     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9041"><font size=-1>9041     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="9042"><font size=-1>9042     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9043"><font size=-1>9043     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9044"><font size=-1>9044     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Atoms that are FIXed along the Y direction&quot;</span><span class="default">,</span>
<a name="9045"><font size=-1>9045     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9046"><font size=-1>9046     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9047"><font size=-1>9047     </font></a><span class="string">Gives the number of atoms (not to exceed [[natom]]) which are to be held fixed</span>
<a name="9048"><font size=-1>9048     </font></a><span class="string">along the Y direction during a structural optimization or molecular dynamics.</span>
<a name="9049"><font size=-1>9049     </font></a><span class="string">When [[natfixy]] &gt; 0, [[natfixy]] entries should be provided in array [[iatfixy]]</span>
<a name="9050"><font size=-1>9050     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9051"><font size=-1>9051     </font></a><span class="default">),</span>
<a name="9052"><font size=-1>9052     </font></a><span class="default"></span>
<a name="9053"><font size=-1>9053     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9054"><font size=-1>9054     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natfixz&quot;</span><span class="default">,</span>
<a name="9055"><font size=-1>9055     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9056"><font size=-1>9056     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9057"><font size=-1>9057     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_basic'</span><span class="default">],</span>
<a name="9058"><font size=-1>9058     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9059"><font size=-1>9059     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9060"><font size=-1>9060     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Atoms that are FIXed along the Z direction&quot;</span><span class="default">,</span>
<a name="9061"><font size=-1>9061     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9062"><font size=-1>9062     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9063"><font size=-1>9063     </font></a><span class="string">Gives the number of atoms (not to exceed [[natom]]) which are to be held fixed</span>
<a name="9064"><font size=-1>9064     </font></a><span class="string">along the Z direction during a structural optimization or molecular dynamics.</span>
<a name="9065"><font size=-1>9065     </font></a><span class="string">When [[natfixz]] &gt; 0, [[natfixz]] entries should be provided in array [[iatfixz]].</span>
<a name="9066"><font size=-1>9066     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9067"><font size=-1>9067     </font></a><span class="default">),</span>
<a name="9068"><font size=-1>9068     </font></a><span class="default"></span>
<a name="9069"><font size=-1>9069     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9070"><font size=-1>9070     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natom&quot;</span><span class="default">,</span>
<a name="9071"><font size=-1>9071     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9072"><font size=-1>9072     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9073"><font size=-1>9073     </font></a><span class="default">    topics=[</span><span class="string">'crystal_basic'</span><span class="default">, </span><span class="string">'SmartSymm_basic'</span><span class="default">],</span>
<a name="9074"><font size=-1>9074     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9075"><font size=-1>9075     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="9076"><font size=-1>9076     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of ATOMs&quot;</span><span class="default">,</span>
<a name="9077"><font size=-1>9077     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9078"><font size=-1>9078     </font></a><span class="string">Gives the total number of atoms in the unit cell. Default is 1 but you will</span>
<a name="9079"><font size=-1>9079     </font></a><span class="string">obviously want to input this value explicitly.</span>
<a name="9080"><font size=-1>9080     </font></a><span class="string">Note that [[natom]] refers to all atoms in the unit cell, not only to the</span>
<a name="9081"><font size=-1>9081     </font></a><span class="string">irreducible set of atoms in the unit cell (using symmetry operations, this set</span>
<a name="9082"><font size=-1>9082     </font></a><span class="string">allows one to recover all atoms). If you want to specify only the irreducible set</span>
<a name="9083"><font size=-1>9083     </font></a><span class="string">of atoms, use the symmetriser, see the input variable [[natrd]].</span>
<a name="9084"><font size=-1>9084     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9085"><font size=-1>9085     </font></a><span class="default">),</span>
<a name="9086"><font size=-1>9086     </font></a><span class="default"></span>
<a name="9087"><font size=-1>9087     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9088"><font size=-1>9088     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natpawu&quot;</span><span class="default">,</span>
<a name="9089"><font size=-1>9089     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="9090"><font size=-1>9090     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9091"><font size=-1>9091     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_internal'</span><span class="default">],</span>
<a name="9092"><font size=-1>9092     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9093"><font size=-1>9093     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of AToms on which PAW+U is applied&quot;</span><span class="default">,</span>
<a name="9094"><font size=-1>9094     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="9095"><font size=-1>9095     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepawu]] == 1&quot;</span><span class="default">,</span>
<a name="9096"><font size=-1>9096     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9097"><font size=-1>9097     </font></a><span class="string">This internal variable gives the number of atoms on which the LDA/GGA+U method</span>
<a name="9098"><font size=-1>9098     </font></a><span class="string">is applied. This value is determined from [[lpawu]].</span>
<a name="9099"><font size=-1>9099     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9100"><font size=-1>9100     </font></a><span class="default">),</span>
<a name="9101"><font size=-1>9101     </font></a><span class="default"></span>
<a name="9102"><font size=-1>9102     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9103"><font size=-1>9103     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natrd&quot;</span><span class="default">,</span>
<a name="9104"><font size=-1>9104     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="9105"><font size=-1>9105     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9106"><font size=-1>9106     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_basic'</span><span class="default">, </span><span class="string">'SmartSymm_basic'</span><span class="default">],</span>
<a name="9107"><font size=-1>9107     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9108"><font size=-1>9108     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[natom]]&quot;</span><span class="default">,</span>
<a name="9109"><font size=-1>9109     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of AToms ReaD&quot;</span><span class="default">,</span>
<a name="9110"><font size=-1>9110     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9111"><font size=-1>9111     </font></a><span class="string">Gives the number of atoms to be read from the input file, in the case the atom</span>
<a name="9112"><font size=-1>9112     </font></a><span class="string">manipulator or the smart symmetriser is used. In this case, [[natrd]] is also</span>
<a name="9113"><font size=-1>9113     </font></a><span class="string">used to dimension the array [[typat]], and the arrays [[xred]], [[xangst]] and</span>
<a name="9114"><font size=-1>9114     </font></a><span class="string">[[xcart]].</span>
<a name="9115"><font size=-1>9115     </font></a><span class="string">Must take into account the vacancies (see [[vacnum]] and [[vaclst]]).</span>
<a name="9116"><font size=-1>9116     </font></a><span class="string">Despite possible vacancies, cannot be bigger than [[natom]].</span>
<a name="9117"><font size=-1>9117     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9118"><font size=-1>9118     </font></a><span class="default">),</span>
<a name="9119"><font size=-1>9119     </font></a><span class="default"></span>
<a name="9120"><font size=-1>9120     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9121"><font size=-1>9121     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natsph&quot;</span><span class="default">,</span>
<a name="9122"><font size=-1>9122     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="9123"><font size=-1>9123     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9124"><font size=-1>9124     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">, </span><span class="string">'ElecBandStructure_useful'</span><span class="default">, </span><span class="string">'ElecDOS_useful'</span><span class="default">],</span>
<a name="9125"><font size=-1>9125     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9126"><font size=-1>9126     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[natom]]&quot;</span><span class="default">,</span>
<a name="9127"><font size=-1>9127     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of ATomic SPHeres for the atom-projected density-of-states&quot;</span><span class="default">,</span>
<a name="9128"><font size=-1>9128     </font></a><span class="default">    requires=</span><span class="string">&quot;[[prtdos]] == 3 or [[pawfatbnd]] in [1,2]&quot;</span><span class="default">,</span>
<a name="9129"><font size=-1>9129     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9130"><font size=-1>9130     </font></a><span class="string">[[natsph]] gives the number of atoms around which the sphere for atom-projected</span>
<a name="9131"><font size=-1>9131     </font></a><span class="string">density-of-states will be built, in the [[prtdos]] = 3 case. The</span>
<a name="9132"><font size=-1>9132     </font></a><span class="string">indices of these atoms are given by [[iatsph]]. The radius of these spheres is</span>
<a name="9133"><font size=-1>9133     </font></a><span class="string">given by [[ratsph]].</span>
<a name="9134"><font size=-1>9134     </font></a><span class="string">If [[pawfatbnd]] = 1 or 2, it gives the number of atoms around which atom-projected</span>
<a name="9135"><font size=-1>9135     </font></a><span class="string">band structure will be built (the indices of these atoms are given</span>
<a name="9136"><font size=-1>9136     </font></a><span class="string">by [[iatsph]]).</span>
<a name="9137"><font size=-1>9137     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9138"><font size=-1>9138     </font></a><span class="default">),</span>
<a name="9139"><font size=-1>9139     </font></a><span class="default"></span>
<a name="9140"><font size=-1>9140     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9141"><font size=-1>9141     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natsph_extra&quot;</span><span class="default">,</span>
<a name="9142"><font size=-1>9142     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="9143"><font size=-1>9143     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9144"><font size=-1>9144     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">],</span>
<a name="9145"><font size=-1>9145     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9146"><font size=-1>9146     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9147"><font size=-1>9147     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of ATomic SPHeres for the l-projected density-of-states in EXTRA set&quot;</span><span class="default">,</span>
<a name="9148"><font size=-1>9148     </font></a><span class="default">    requires=</span><span class="string">&quot;[[prtdos]] == 3 or [[pawfatbnd]] in [1,2]&quot;</span><span class="default">,</span>
<a name="9149"><font size=-1>9149     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9150"><font size=-1>9150     </font></a><span class="string">[[natsph_extra]] gives the number of extra spheres for which the angular-</span>
<a name="9151"><font size=-1>9151     </font></a><span class="string">momentum-projected density-of-states will be built, in the [[prtdos]] = 3 case.</span>
<a name="9152"><font size=-1>9152     </font></a><span class="string">The radius of these spheres is given by [[ratsph_extra]]. This simulates the</span>
<a name="9153"><font size=-1>9153     </font></a><span class="string">STS signal for an STM tip atom placed at the sphere position, according to the</span>
<a name="9154"><font size=-1>9154     </font></a><span class="string">chemical nature of the tip (s- p- d- wave etc...).</span>
<a name="9155"><font size=-1>9155     </font></a><span class="string">If [[pawfatbnd]] = 1 or 2, it gives the number of spheres in which $l$-projected</span>
<a name="9156"><font size=-1>9156     </font></a><span class="string">band structure will be built.</span>
<a name="9157"><font size=-1>9157     </font></a><span class="string">The position of the spheres is given by the [[xredsph_extra]] variable.</span>
<a name="9158"><font size=-1>9158     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9159"><font size=-1>9159     </font></a><span class="default">),</span>
<a name="9160"><font size=-1>9160     </font></a><span class="default"></span>
<a name="9161"><font size=-1>9161     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9162"><font size=-1>9162     </font></a><span class="default">    abivarname=</span><span class="string">&quot;natvshift&quot;</span><span class="default">,</span>
<a name="9163"><font size=-1>9163     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="9164"><font size=-1>9164     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9165"><font size=-1>9165     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="9166"><font size=-1>9166     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9167"><font size=-1>9167     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9168"><font size=-1>9168     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of ATomic potential (V) energy SHIFTs (per atom)&quot;</span><span class="default">,</span>
<a name="9169"><font size=-1>9169     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepawu]] /= 0, [[atvshift]]&quot;</span><span class="default">,</span>
<a name="9170"><font size=-1>9170     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9171"><font size=-1>9171     </font></a><span class="string">Number of atomic potential energy shifts (per atom), to be used to define the</span>
<a name="9172"><font size=-1>9172     </font></a><span class="string">array [[atvshift]]. If non-zero, only two possibilities exist: 5 for d states</span>
<a name="9173"><font size=-1>9173     </font></a><span class="string">(with [[lpawu]] = 2), and 7 for f states (with [[lpawu]] = 3). If non-zero, one</span>
<a name="9174"><font size=-1>9174     </font></a><span class="string">should define [[usepawu]], [[lpawu]] and [[atvshift]].</span>
<a name="9175"><font size=-1>9175     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9176"><font size=-1>9176     </font></a><span class="default">),</span>
<a name="9177"><font size=-1>9177     </font></a><span class="default"></span>
<a name="9178"><font size=-1>9178     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9179"><font size=-1>9179     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nband&quot;</span><span class="default">,</span>
<a name="9180"><font size=-1>9180     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9181"><font size=-1>9181     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9182"><font size=-1>9182     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_basic'</span><span class="default">, </span><span class="string">'GW_basic'</span><span class="default">, </span><span class="string">'RPACorrEn_basic'</span><span class="default">, </span><span class="string">'Susceptibility_basic'</span><span class="default">],</span>
<a name="9183"><font size=-1>9183     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9184"><font size=-1>9184     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of BANDs&quot;</span><span class="default">,</span>
<a name="9185"><font size=-1>9185     </font></a><span class="default">    commentdefault=</span><span class="string">&quot; the estimated number of occupied bands +1 (TODO provide the mathematical formulation)&quot;</span><span class="default">,</span>
<a name="9186"><font size=-1>9186     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9187"><font size=-1>9187     </font></a><span class="string">Gives number of bands, occupied plus possibly unoccupied, for which</span>
<a name="9188"><font size=-1>9188     </font></a><span class="string">wavefunctions are being computed along with eigenvalues.</span>
<a name="9189"><font size=-1>9189     </font></a><span class="string">Note: if the parameter [[occopt]] (see below) is not set to 2, [[nband]] is a</span>
<a name="9190"><font size=-1>9190     </font></a><span class="string">scalar integer, but if the parameter [[occopt]] is set to 2, then [[nband]]</span>
<a name="9191"><font size=-1>9191     </font></a><span class="string">must be an array [[nband]]([[nkpt]]* [[nsppol]]) giving the number of bands</span>
<a name="9192"><font size=-1>9192     </font></a><span class="string">explicitly for each k point. This option is provided in order to allow the</span>
<a name="9193"><font size=-1>9193     </font></a><span class="string">number of bands treated to vary from k point to k point.</span>
<a name="9194"><font size=-1>9194     </font></a><span class="string">For the values of [[occopt]] not equal to 0 or 2, [[nband]] can be omitted.</span>
<a name="9195"><font size=-1>9195     </font></a><span class="string">The number of bands will be set up thanks to the use of the variable</span>
<a name="9196"><font size=-1>9196     </font></a><span class="string">[[fband]]. The present Default will not be used.</span>
<a name="9197"><font size=-1>9197     </font></a><span class="string"></span>
<a name="9198"><font size=-1>9198     </font></a><span class="string">If [[nspinor]] is 2, nband must be even for each k point.</span>
<a name="9199"><font size=-1>9199     </font></a><span class="string"></span>
<a name="9200"><font size=-1>9200     </font></a><span class="string">In the case of a GW calculation ([[optdriver]] = 3 or 4), [[nband]] gives the</span>
<a name="9201"><font size=-1>9201     </font></a><span class="string">number of bands to be treated to generate the screening (susceptibility and</span>
<a name="9202"><font size=-1>9202     </font></a><span class="string">dielectric matrix), as well as the self-energy. However, to generate the _KSS</span>
<a name="9203"><font size=-1>9203     </font></a><span class="string">file (see [[kssform]]) the relevant number of bands is given by [[nbandkss]].</span>
<a name="9204"><font size=-1>9204     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9205"><font size=-1>9205     </font></a><span class="default">),</span>
<a name="9206"><font size=-1>9206     </font></a><span class="default"></span>
<a name="9207"><font size=-1>9207     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9208"><font size=-1>9208     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nbandhf&quot;</span><span class="default">,</span>
<a name="9209"><font size=-1>9209     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9210"><font size=-1>9210     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9211"><font size=-1>9211     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_useful'</span><span class="default">],</span>
<a name="9212"><font size=-1>9212     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9213"><font size=-1>9213     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of BANDs for (Hartree)-Fock exact exchange&quot;</span><span class="default">,</span>
<a name="9214"><font size=-1>9214     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;the estimated number of occupied bands (TODO: provide the mathematical formulation)&quot;</span><span class="default">,</span>
<a name="9215"><font size=-1>9215     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9216"><font size=-1>9216     </font></a><span class="string">Gives the maximum number of occupied bands with which Fock exact exchange is</span>
<a name="9217"><font size=-1>9217     </font></a><span class="string">being computed for the wavefunctions.</span>
<a name="9218"><font size=-1>9218     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9219"><font size=-1>9219     </font></a><span class="default">),</span>
<a name="9220"><font size=-1>9220     </font></a><span class="default"></span>
<a name="9221"><font size=-1>9221     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9222"><font size=-1>9222     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nbandkss&quot;</span><span class="default">,</span>
<a name="9223"><font size=-1>9223     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="9224"><font size=-1>9224     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9225"><font size=-1>9225     </font></a><span class="default">    topics=[</span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'Susceptibility_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="9226"><font size=-1>9226     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9227"><font size=-1>9227     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9228"><font size=-1>9228     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of BANDs in the KSS file&quot;</span><span class="default">,</span>
<a name="9229"><font size=-1>9229     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="9230"><font size=-1>9230     </font></a><span class="string">This input variable is used for the preparation of a GW calculation: it is</span>
<a name="9231"><font size=-1>9231     </font></a><span class="string">used in a GS run (where [[optdriver]] = 0) to generate a _KSS file. In this run,</span>
<a name="9232"><font size=-1>9232     </font></a><span class="string">[[nbandkss]] should be non-zero. The generated _KSS file can be subsequently</span>
<a name="9233"><font size=-1>9233     </font></a><span class="string">used to calculate the irreducible polarizabilty $\chi^{(0)}_{KS}$ using</span>
<a name="9234"><font size=-1>9234     </font></a><span class="string">[[optdriver]] = 3 or to calculate GW corrections setting [[optdriver]] = 4.</span>
<a name="9235"><font size=-1>9235     </font></a><span class="string"></span>
<a name="9236"><font size=-1>9236     </font></a><span class="string">  * If [[nbandkss]] = 0, no _KSS file is created.</span>
<a name="9237"><font size=-1>9237     </font></a><span class="string">  * If [[nbandkss]] = -1, all the available eigenstates (energies and eigenfunctions) are stored in the abo_KSS file at the end of the ground state calculation. The number of states is forced to be the same for all k-points: it will be the minimum of the number of plane waves over all k-points.</span>
<a name="9238"><font size=-1>9238     </font></a><span class="string">  * If [[nbandkss]] is greater than 0, abinit stores (about) [[nbandkss]] eigenstates in the abo_KSS file. This number of states is forced to be the same for all k-points.</span>
<a name="9239"><font size=-1>9239     </font></a><span class="string"></span>
<a name="9240"><font size=-1>9240     </font></a><span class="string">See [[npwkss]] for the selection of the number of the planewave components of</span>
<a name="9241"><font size=-1>9241     </font></a><span class="string">the eigenstates to be stored.</span>
<a name="9242"><font size=-1>9242     </font></a><span class="string">The input variable [[iomode]] can be used to read and write KSS files</span>
<a name="9243"><font size=-1>9243     </font></a><span class="string">according to different fileformat (presently only [[iomode]] = 0 and 3 are</span>
<a name="9244"><font size=-1>9244     </font></a><span class="string">available in the GW part).</span>
<a name="9245"><font size=-1>9245     </font></a><span class="string">The precision of the KSS file can be tuned through the input variable [[kssform]].</span>
<a name="9246"><font size=-1>9246     </font></a><span class="string">For more details about the format of the abo_KSS file, see the routine outkss.F90.</span>
<a name="9247"><font size=-1>9247     </font></a><span class="string"></span>
<a name="9248"><font size=-1>9248     </font></a><span class="string">!!! warning</span>
<a name="9249"><font size=-1>9249     </font></a><span class="string"></span>
<a name="9250"><font size=-1>9250     </font></a><span class="string">    For the time being, [[istwfk]] must be 1 for all the k-points in order to generate a _KSS file.</span>
<a name="9251"><font size=-1>9251     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9252"><font size=-1>9252     </font></a><span class="default">),</span>
<a name="9253"><font size=-1>9253     </font></a><span class="default"></span>
<a name="9254"><font size=-1>9254     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9255"><font size=-1>9255     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nbdblock&quot;</span><span class="default">,</span>
<a name="9256"><font size=-1>9256     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="9257"><font size=-1>9257     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9258"><font size=-1>9258     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="9259"><font size=-1>9259     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9260"><font size=-1>9260     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="9261"><font size=-1>9261     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of BanDs in a BLOCK&quot;</span><span class="default">,</span>
<a name="9262"><font size=-1>9262     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="9263"><font size=-1>9263     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9264"><font size=-1>9264     </font></a><span class="string">In case of non-standard, blocked algorithms for the optimization of the</span>
<a name="9265"><font size=-1>9265     </font></a><span class="string">wavefunctions (that is, if [[wfoptalg]] = 4):</span>
<a name="9266"><font size=-1>9266     </font></a><span class="string"></span>
<a name="9267"><font size=-1>9267     </font></a><span class="string">  * if [[wfoptalg]] = 4, [[nbdblock]] defines the number of blocks (the number of bands in the block is then [[nband]]/[[nbdblock]] ).</span>
<a name="9268"><font size=-1>9268     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9269"><font size=-1>9269     </font></a><span class="default">),</span>
<a name="9270"><font size=-1>9270     </font></a><span class="default"></span>
<a name="9271"><font size=-1>9271     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9272"><font size=-1>9272     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nbdbuf&quot;</span><span class="default">,</span>
<a name="9273"><font size=-1>9273     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="9274"><font size=-1>9274     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9275"><font size=-1>9275     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_useful'</span><span class="default">, </span><span class="string">'BandOcc_useful'</span><span class="default">],</span>
<a name="9276"><font size=-1>9276     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9277"><font size=-1>9277     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[optdriver]] == 0 and [[iscf]]&lt;0'</span><span class="default">: </span><span class="string">'2*[[nspinor]]'</span><span class="default">,</span>
<a name="9278"><font size=-1>9278     </font></a><span class="default"> </span><span class="string">'[[optdriver]] == 1 and 3&lt;=[[occopt]] and [[occopt]]&lt;= 8'</span><span class="default">: </span><span class="string">'2*[[nspinor]]'</span><span class="default">,</span>
<a name="9279"><font size=-1>9279     </font></a><span class="default"> </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="9280"><font size=-1>9280     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of BanDs for the BUFfer&quot;</span><span class="default">,</span>
<a name="9281"><font size=-1>9281     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9282"><font size=-1>9282     </font></a><span class="string">[[nbdbuf]] gives the number of bands, the highest in energy, that, among the</span>
<a name="9283"><font size=-1>9283     </font></a><span class="string">[[nband]] bands, are to be considered as part of a buffer. This concept is</span>
<a name="9284"><font size=-1>9284     </font></a><span class="string">useful in three situations: in non-self-consistent calculations, for the</span>
<a name="9285"><font size=-1>9285     </font></a><span class="string">determination of the convergence tolerance; for response functions of metals,</span>
<a name="9286"><font size=-1>9286     </font></a><span class="string">to avoid instabilities, and also when finite electric fields or non-linear</span>
<a name="9287"><font size=-1>9287     </font></a><span class="string">responses (with electric field perturbations) are considered. For the two</span>
<a name="9288"><font size=-1>9288     </font></a><span class="string">first, the need of a buffer is a natural requirement of the problem, so that</span>
<a name="9289"><font size=-1>9289     </font></a><span class="string">the default value is changed to 2 automatically, as explained in the</span>
<a name="9290"><font size=-1>9290     </font></a><span class="string">following. The third case is only for implementation convenience.</span>
<a name="9291"><font size=-1>9291     </font></a><span class="string"></span>
<a name="9292"><font size=-1>9292     </font></a><span class="string">In non-self-consistent GS calculations ([[iscf]]&lt;0), the highest levels might</span>
<a name="9293"><font size=-1>9293     </font></a><span class="string">be difficult to converge, if they are degenerate with another level, that does</span>
<a name="9294"><font size=-1>9294     </font></a><span class="string">not belong to the set of bands treated. Then, it might take extremely long to</span>
<a name="9295"><font size=-1>9295     </font></a><span class="string">reach [[tolwfr]], although the other bands are already extremely well-</span>
<a name="9296"><font size=-1>9296     </font></a><span class="string">converged, and the energy of the highest bands (whose residual are not yet</span>
<a name="9297"><font size=-1>9297     </font></a><span class="string">good enough), is also rather well converged.</span>
<a name="9298"><font size=-1>9298     </font></a><span class="string">In response to this problem, for non-zero [[nbdbuf]], the largest residual</span>
<a name="9299"><font size=-1>9299     </font></a><span class="string">(residm), to be later compared with [[tolwfr]], will be computed only in the</span>
<a name="9300"><font size=-1>9300     </font></a><span class="string">set of non-buffer bands (this modification applies for non-self-consistent as</span>
<a name="9301"><font size=-1>9301     </font></a><span class="string">well as self-consistent calculation, for GS as well as RF calculations).</span>
<a name="9302"><font size=-1>9302     </font></a><span class="string">For a GS calculation, with [[iscf]]&lt;0, supposing [[nbdbuf]] is not initialized</span>
<a name="9303"><font size=-1>9303     </font></a><span class="string">in the input file, then ABINIT will overcome the default [[nbdbuf]] value, and</span>
<a name="9304"><font size=-1>9304     </font></a><span class="string">automatically set [[nbdbuf]] to 2.</span>
<a name="9305"><font size=-1>9305     </font></a><span class="string"></span>
<a name="9306"><font size=-1>9306     </font></a><span class="string">In metallic RF calculations, in the conjugate gradient optimisation of first-</span>
<a name="9307"><font size=-1>9307     </font></a><span class="string">order wavefunctions, there is an instability situation when the q wavevector</span>
<a name="9308"><font size=-1>9308     </font></a><span class="string">of the perturbation brings the eigenenergy of the highest treated band at some</span>
<a name="9309"><font size=-1>9309     </font></a><span class="string">k point higher than the lowest untreated eigenenergy at some k+q point. If one</span>
<a name="9310"><font size=-1>9310     </font></a><span class="string">accepts a buffer of frozen states, this instability can be made to disappear.</span>
<a name="9311"><font size=-1>9311     </font></a><span class="string">Frozen states receive automatically a residual value of -0.1d0.</span>
<a name="9312"><font size=-1>9312     </font></a><span class="string">For a RF calculation, with 3&lt;=[[occopt]]&lt;=7, supposing [[nbdbuf]] is not</span>
<a name="9313"><font size=-1>9313     </font></a><span class="string">initialized in the input file, then ABINIT will overcome the default</span>
<a name="9314"><font size=-1>9314     </font></a><span class="string">[[nbdbuf]] value, and automatically set [[nbdbuf]] to 2. This value might be</span>
<a name="9315"><font size=-1>9315     </font></a><span class="string">too low in some cases.</span>
<a name="9316"><font size=-1>9316     </font></a><span class="string"></span>
<a name="9317"><font size=-1>9317     </font></a><span class="string">Also, the number of active bands, in all cases, is imposed to be at least 1,</span>
<a name="9318"><font size=-1>9318     </font></a><span class="string">irrespective of the value of [[nbdbuf]].</span>
<a name="9319"><font size=-1>9319     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9320"><font size=-1>9320     </font></a><span class="default">),</span>
<a name="9321"><font size=-1>9321     </font></a><span class="default"></span>
<a name="9322"><font size=-1>9322     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9323"><font size=-1>9323     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nberry&quot;</span><span class="default">,</span>
<a name="9324"><font size=-1>9324     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="9325"><font size=-1>9325     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9326"><font size=-1>9326     </font></a><span class="default">    topics=[</span><span class="string">'Berry_basic'</span><span class="default">],</span>
<a name="9327"><font size=-1>9327     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9328"><font size=-1>9328     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="9329"><font size=-1>9329     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of BERRY phase computations&quot;</span><span class="default">,</span>
<a name="9330"><font size=-1>9330     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] = 1, 2, or 3&quot;</span><span class="default">,</span>
<a name="9331"><font size=-1>9331     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9332"><font size=-1>9332     </font></a><span class="string">Gives the number of Berry phase computations of polarisation, or finite-</span>
<a name="9333"><font size=-1>9333     </font></a><span class="string">difference estimations of the derivative of wavefunctions with respect to the</span>
<a name="9334"><font size=-1>9334     </font></a><span class="string">wavevector, each of which might be characterized by a different change of</span>
<a name="9335"><font size=-1>9335     </font></a><span class="string">wavevector [[kberry]].</span>
<a name="9336"><font size=-1>9336     </font></a><span class="string"></span>
<a name="9337"><font size=-1>9337     </font></a><span class="string">When equal to 0, no Berry phase calculation of polarisation is performed. The</span>
<a name="9338"><font size=-1>9338     </font></a><span class="string">maximal value of [[nberry]] is 20.</span>
<a name="9339"><font size=-1>9339     </font></a><span class="string"></span>
<a name="9340"><font size=-1>9340     </font></a><span class="string">Note that the computation of the polarisation for a set of bands having</span>
<a name="9341"><font size=-1>9341     </font></a><span class="string">different occupation numbers is meaningless (although in the case of spin-</span>
<a name="9342"><font size=-1>9342     </font></a><span class="string">polarized calculations, the spin up bands might have an identical occupation</span>
<a name="9343"><font size=-1>9343     </font></a><span class="string">number, that might differ from the identical occupation number of spin down</span>
<a name="9344"><font size=-1>9344     </font></a><span class="string">bands). Although meaningless, ABINIT will perform such computation, if</span>
<a name="9345"><font size=-1>9345     </font></a><span class="string">required by the user. The input variable [[bdberry]] governs the set of bands</span>
<a name="9346"><font size=-1>9346     </font></a><span class="string">for which a Berry phase is computed.</span>
<a name="9347"><font size=-1>9347     </font></a><span class="string"></span>
<a name="9348"><font size=-1>9348     </font></a><span class="string">For the [[berryopt]] = 1, 2, and 3 cases, spinor wavefunctions are not</span>
<a name="9349"><font size=-1>9349     </font></a><span class="string">allowed, nor are parallel computations.</span>
<a name="9350"><font size=-1>9350     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9351"><font size=-1>9351     </font></a><span class="default">),</span>
<a name="9352"><font size=-1>9352     </font></a><span class="default"></span>
<a name="9353"><font size=-1>9353     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9354"><font size=-1>9354     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nc_xccc_gspace&quot;</span><span class="default">,</span>
<a name="9355"><font size=-1>9355     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="9356"><font size=-1>9356     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9357"><font size=-1>9357     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_expert'</span><span class="default">],</span>
<a name="9358"><font size=-1>9358     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9359"><font size=-1>9359     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[usepaw]] == 0'</span><span class="default">: </span><span class="number">0</span><span class="default">, </span><span class="string">'[[usepaw]] == 1'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="9360"><font size=-1>9360     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Norm-Conserving pseudopotentials - use XC Core-Correction in G-SPACE&quot;</span><span class="default">,</span>
<a name="9361"><font size=-1>9361     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="9362"><font size=-1>9362     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;0 when [[usepaw]] = 0, 1 when [[usepaw]] = 1&quot;</span><span class="default">,</span>
<a name="9363"><font size=-1>9363     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9364"><font size=-1>9364     </font></a><span class="string">Historically, Abinit treats the model core charge used for the non-linear core</span>
<a name="9365"><font size=-1>9365     </font></a><span class="string">correction in real space. Alternatively, it is possible to instruct the code</span>
<a name="9366"><font size=-1>9366     </font></a><span class="string">to compute the core charge in G-space following the same approach used in the</span>
<a name="9367"><font size=-1>9367     </font></a><span class="string">PAW code. The G-space formalism is more accurate than the interpolation in</span>
<a name="9368"><font size=-1>9368     </font></a><span class="string">real space, especially when derivatives of the model core charge are needed,</span>
<a name="9369"><font size=-1>9369     </font></a><span class="string">e.g. DFPT. Preliminary tests showed that the violation of the acoustic sum</span>
<a name="9370"><font size=-1>9370     </font></a><span class="string">rule is reduced when [[nc_xccc_gspace]] == 1, especially for LDA. It is worth</span>
<a name="9371"><font size=-1>9371     </font></a><span class="string">stressing, however, that [[nc_xccc_gspace]] == 1 should be used only in</span>
<a name="9372"><font size=-1>9372     </font></a><span class="string">conjunction with NC pseudos whose model core charge that decays quickly in</span>
<a name="9373"><font size=-1>9373     </font></a><span class="string">G-space. Several NC pseudos available in the Abinit table are not optimized</span>
<a name="9374"><font size=-1>9374     </font></a><span class="string">for the G-space formalism and users are strongly invited to perform</span>
<a name="9375"><font size=-1>9375     </font></a><span class="string">convergence studies with respect to ecut before using this option.</span>
<a name="9376"><font size=-1>9376     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9377"><font size=-1>9377     </font></a><span class="default">),</span>
<a name="9378"><font size=-1>9378     </font></a><span class="default"></span>
<a name="9379"><font size=-1>9379     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9380"><font size=-1>9380     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nconeq&quot;</span><span class="default">,</span>
<a name="9381"><font size=-1>9381     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9382"><font size=-1>9382     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9383"><font size=-1>9383     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_useful'</span><span class="default">],</span>
<a name="9384"><font size=-1>9384     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9385"><font size=-1>9385     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9386"><font size=-1>9386     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of CONstraint EQuations&quot;</span><span class="default">,</span>
<a name="9387"><font size=-1>9387     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="9388"><font size=-1>9388     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9389"><font size=-1>9389     </font></a><span class="string">Gives the number of independent equations constraining the motion of atoms</span>
<a name="9390"><font size=-1>9390     </font></a><span class="string">during structural optimization or molecular dynamics (see [[natcon]],</span>
<a name="9391"><font size=-1>9391     </font></a><span class="string">[[iatcon]], and [[wtatcon]]).</span>
<a name="9392"><font size=-1>9392     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9393"><font size=-1>9393     </font></a><span class="default">),</span>
<a name="9394"><font size=-1>9394     </font></a><span class="default"></span>
<a name="9395"><font size=-1>9395     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9396"><font size=-1>9396     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nctime&quot;</span><span class="default">,</span>
<a name="9397"><font size=-1>9397     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="9398"><font size=-1>9398     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9399"><font size=-1>9399     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_useful'</span><span class="default">],</span>
<a name="9400"><font size=-1>9400     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9401"><font size=-1>9401     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9402"><font size=-1>9402     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;NetCdf TIME between output of molecular dynamics informations&quot;</span><span class="default">,</span>
<a name="9403"><font size=-1>9403     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="9404"><font size=-1>9404     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9405"><font size=-1>9405     </font></a><span class="string">When [[nctime]] is non-zero, the molecular dynamics information is output in</span>
<a name="9406"><font size=-1>9406     </font></a><span class="string">NetCDF format, every [[nctime]] time step. Here is the content of an example</span>
<a name="9407"><font size=-1>9407     </font></a><span class="string">file:</span>
<a name="9408"><font size=-1>9408     </font></a><span class="string"></span>
<a name="9409"><font size=-1>9409     </font></a><span class="string">```</span>
<a name="9410"><font size=-1>9410     </font></a><span class="string">    netcdf md32.outH_moldyn1 {</span>
<a name="9411"><font size=-1>9411     </font></a><span class="string">    dimensions:</span>
<a name="9412"><font size=-1>9412     </font></a><span class="string">       time = UNLIMITED; // (11 currently)</span>
<a name="9413"><font size=-1>9413     </font></a><span class="string">       DimTensor = 6;</span>
<a name="9414"><font size=-1>9414     </font></a><span class="string">       DimCoord = 3;</span>
<a name="9415"><font size=-1>9415     </font></a><span class="string">       NbAtoms = 32;</span>
<a name="9416"><font size=-1>9416     </font></a><span class="string">       DimVector = 3;</span>
<a name="9417"><font size=-1>9417     </font></a><span class="string">       DimScalar = 1;</span>
<a name="9418"><font size=-1>9418     </font></a><span class="string">    variables:</span>
<a name="9419"><font size=-1>9419     </font></a><span class="string">       double E_pot(time);</span>
<a name="9420"><font size=-1>9420     </font></a><span class="string">          E_pot:units = &quot;hartree&quot;;</span>
<a name="9421"><font size=-1>9421     </font></a><span class="string">       double E_kin(time);</span>
<a name="9422"><font size=-1>9422     </font></a><span class="string">          E_kin:units = &quot;hartree&quot;;</span>
<a name="9423"><font size=-1>9423     </font></a><span class="string">       double Stress(time, DimTensor);</span>
<a name="9424"><font size=-1>9424     </font></a><span class="string">          Stress:units = &quot;hartree/Bohr^3&quot;;</span>
<a name="9425"><font size=-1>9425     </font></a><span class="string">       double Position(time, DimCoord, NbAtoms);</span>
<a name="9426"><font size=-1>9426     </font></a><span class="string">          Position:units = &quot;Bohr&quot;;</span>
<a name="9427"><font size=-1>9427     </font></a><span class="string">       double Celerity(time, DimCoord, NbAtoms);</span>
<a name="9428"><font size=-1>9428     </font></a><span class="string">          Celerity:units = &quot;Bohr/(atomic time unit)&quot;;</span>
<a name="9429"><font size=-1>9429     </font></a><span class="string">       double PrimitiveVector1(DimVector);</span>
<a name="9430"><font size=-1>9430     </font></a><span class="string">       double PrimitiveVector2(DimVector);</span>
<a name="9431"><font size=-1>9431     </font></a><span class="string">       double PrimitiveVector3(DimVector);</span>
<a name="9432"><font size=-1>9432     </font></a><span class="string">       double Cell_Volume(DimScalar);</span>
<a name="9433"><font size=-1>9433     </font></a><span class="string">          Cell_Volume:units = &quot;Bohr^3&quot;;</span>
<a name="9434"><font size=-1>9434     </font></a><span class="string">    }</span>
<a name="9435"><font size=-1>9435     </font></a><span class="string">```</span>
<a name="9436"><font size=-1>9436     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9437"><font size=-1>9437     </font></a><span class="default">),</span>
<a name="9438"><font size=-1>9438     </font></a><span class="default"></span>
<a name="9439"><font size=-1>9439     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9440"><font size=-1>9440     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ndivk&quot;</span><span class="default">,</span>
<a name="9441"><font size=-1>9441     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="9442"><font size=-1>9442     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9443"><font size=-1>9443     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">, </span><span class="string">'ElecBandStructure_useful'</span><span class="default">],</span>
<a name="9444"><font size=-1>9444     </font></a><span class="default">    dimensions=[</span><span class="string">'abs([[kptopt]])'</span><span class="default">],</span>
<a name="9445"><font size=-1>9445     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of DIVisions of K lines&quot;</span><span class="default">,</span>
<a name="9446"><font size=-1>9446     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9447"><font size=-1>9447     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Will be generated automatically from [[ndivsm]] if the latter is defined.&quot;</span><span class="default">,</span>
<a name="9448"><font size=-1>9448     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[ndivsm]]&quot;</span><span class="default">,</span>
<a name="9449"><font size=-1>9449     </font></a><span class="default">    requires=</span><span class="string">&quot;[[kptopt]] &lt; 0&quot;</span><span class="default">,</span>
<a name="9450"><font size=-1>9450     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9451"><font size=-1>9451     </font></a><span class="string">Gives the number of divisions of each of the segments of the band structure,</span>
<a name="9452"><font size=-1>9452     </font></a><span class="string">whose path is determined by [[kptopt]] and [[kptbounds]]. In this case, the</span>
<a name="9453"><font size=-1>9453     </font></a><span class="string">absolute value of [[kptopt]] is the number of such segments.</span>
<a name="9454"><font size=-1>9454     </font></a><span class="string"></span>
<a name="9455"><font size=-1>9455     </font></a><span class="string">For example, suppose that the number of segment is just one ([[kptopt]] = -1), a</span>
<a name="9456"><font size=-1>9456     </font></a><span class="string">value [[ndivk]] = 4 will lead to the computation of points with relative</span>
<a name="9457"><font size=-1>9457     </font></a><span class="string">coordinates 0.0, 0.25, 0.5, 0.75 and 1.0, along the segment in consideration.</span>
<a name="9458"><font size=-1>9458     </font></a><span class="string"></span>
<a name="9459"><font size=-1>9459     </font></a><span class="string">Now, suppose that there are two segments ([[kptopt]] = -2), with [[ndivk]](1)=4</span>
<a name="9460"><font size=-1>9460     </font></a><span class="string">and [[ndivk]](2)=2, the computation of the eigenvalues will be done at 7</span>
<a name="9461"><font size=-1>9461     </font></a><span class="string">points, 5 belonging to the first segment, with relative coordinates 0.0, 0.25,</span>
<a name="9462"><font size=-1>9462     </font></a><span class="string">0.5, 0.75 and 1.0, the last one being also the starting point of the next</span>
<a name="9463"><font size=-1>9463     </font></a><span class="string">segment, for which two other points must be computed, with relative</span>
<a name="9464"><font size=-1>9464     </font></a><span class="string">coordinates 0.5 and 1.0.</span>
<a name="9465"><font size=-1>9465     </font></a><span class="string"></span>
<a name="9466"><font size=-1>9466     </font></a><span class="string">It is easy to compute disconnected circuits (non-chained segments), by</span>
<a name="9467"><font size=-1>9467     </font></a><span class="string">separating the circuits with the value [[ndivk]] = 1 for the intermediate</span>
<a name="9468"><font size=-1>9468     </font></a><span class="string">segment connecting the end of one circuit with the beginning of the next one</span>
<a name="9469"><font size=-1>9469     </font></a><span class="string">(in which case no intermediate point is computed along this segment).</span>
<a name="9470"><font size=-1>9470     </font></a><span class="string"></span>
<a name="9471"><font size=-1>9471     </font></a><span class="string">Alternatively it is possible to generate automatically the array [[ndivk]] by</span>
<a name="9472"><font size=-1>9472     </font></a><span class="string">just specifying the number of divisions for the smallest segment. See the</span>
<a name="9473"><font size=-1>9473     </font></a><span class="string">related input variable [[ndivsm]].</span>
<a name="9474"><font size=-1>9474     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9475"><font size=-1>9475     </font></a><span class="default">),</span>
<a name="9476"><font size=-1>9476     </font></a><span class="default"></span>
<a name="9477"><font size=-1>9477     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9478"><font size=-1>9478     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ndivsm&quot;</span><span class="default">,</span>
<a name="9479"><font size=-1>9479     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="9480"><font size=-1>9480     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9481"><font size=-1>9481     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">, </span><span class="string">'ElecBandStructure_basic'</span><span class="default">],</span>
<a name="9482"><font size=-1>9482     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9483"><font size=-1>9483     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of DIVisions for the SMallest segment&quot;</span><span class="default">,</span>
<a name="9484"><font size=-1>9484     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9485"><font size=-1>9485     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9486"><font size=-1>9486     </font></a><span class="string">This variable defines the number of divisions used to sample the smallest</span>
<a name="9487"><font size=-1>9487     </font></a><span class="string">segment of the circuit employed in a band structure calculations (see related</span>
<a name="9488"><font size=-1>9488     </font></a><span class="string">input variables [[kptopt]] and [[kptbounds]]). If [[ndivsm]] is given in the</span>
<a name="9489"><font size=-1>9489     </font></a><span class="string">input file, there is no need to specify the number of divisions to be used for</span>
<a name="9490"><font size=-1>9490     </font></a><span class="string">the other segments. Indeed [[ndivk]] is automatically calculated inside the</span>
<a name="9491"><font size=-1>9491     </font></a><span class="string">code in order to generate a path where the number of divisions in each segment</span>
<a name="9492"><font size=-1>9492     </font></a><span class="string">is proportional to the length of the segment itself. This option is activated</span>
<a name="9493"><font size=-1>9493     </font></a><span class="string">only when [[kptopt]] is negative. In this case, the absolute value of</span>
<a name="9494"><font size=-1>9494     </font></a><span class="string">[[kptopt]] is the number of such segments.</span>
<a name="9495"><font size=-1>9495     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9496"><font size=-1>9496     </font></a><span class="default">),</span>
<a name="9497"><font size=-1>9497     </font></a><span class="default"></span>
<a name="9498"><font size=-1>9498     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9499"><font size=-1>9499     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ndtset&quot;</span><span class="default">,</span>
<a name="9500"><font size=-1>9500     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9501"><font size=-1>9501     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9502"><font size=-1>9502     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_compulsory'</span><span class="default">],</span>
<a name="9503"><font size=-1>9503     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9504"><font size=-1>9504     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9505"><font size=-1>9505     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of DaTaSETs&quot;</span><span class="default">,</span>
<a name="9506"><font size=-1>9506     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="9507"><font size=-1>9507     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9508"><font size=-1>9508     </font></a><span class="string">Gives the number of data sets to be treated.</span>
<a name="9509"><font size=-1>9509     </font></a><span class="string">If 0, means that the multi-data set treatment is not used, so that the root</span>
<a name="9510"><font size=-1>9510     </font></a><span class="string">filenames will not be appended with _DSx, where 'x' is the dataset index</span>
<a name="9511"><font size=-1>9511     </font></a><span class="string">defined by the input variable [[jdtset]], and also that input names with a</span>
<a name="9512"><font size=-1>9512     </font></a><span class="string">dataset index are not allowed. Otherwise, [[ndtset]] = 0 is equivalent to</span>
<a name="9513"><font size=-1>9513     </font></a><span class="string">[[ndtset]] = 1.</span>
<a name="9514"><font size=-1>9514     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9515"><font size=-1>9515     </font></a><span class="default">),</span>
<a name="9516"><font size=-1>9516     </font></a><span class="default"></span>
<a name="9517"><font size=-1>9517     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9518"><font size=-1>9518     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ndynimage&quot;</span><span class="default">,</span>
<a name="9519"><font size=-1>9519     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="9520"><font size=-1>9520     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9521"><font size=-1>9521     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_internal'</span><span class="default">],</span>
<a name="9522"><font size=-1>9522     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9523"><font size=-1>9523     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of DYNamical IMAGEs&quot;</span><span class="default">,</span>
<a name="9524"><font size=-1>9524     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="9525"><font size=-1>9525     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9526"><font size=-1>9526     </font></a><span class="string">This internal variable gives the number of dynamical images, immediately</span>
<a name="9527"><font size=-1>9527     </font></a><span class="string">deduced from the number of non-zero values present in [[dynimage]]. It is used</span>
<a name="9528"><font size=-1>9528     </font></a><span class="string">to dimension many memory-consuming arrays (one copy for each image), e.g. the</span>
<a name="9529"><font size=-1>9529     </font></a><span class="string">wavefunction array (cg), the density array (rho), etc.</span>
<a name="9530"><font size=-1>9530     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9531"><font size=-1>9531     </font></a><span class="default">),</span>
<a name="9532"><font size=-1>9532     </font></a><span class="default"></span>
<a name="9533"><font size=-1>9533     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9534"><font size=-1>9534     </font></a><span class="default">    abivarname=</span><span class="string">&quot;neb_algo&quot;</span><span class="default">,</span>
<a name="9535"><font size=-1>9535     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9536"><font size=-1>9536     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9537"><font size=-1>9537     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_useful'</span><span class="default">],</span>
<a name="9538"><font size=-1>9538     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9539"><font size=-1>9539     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="9540"><font size=-1>9540     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Nudged Elastic Band ALGOrithm&quot;</span><span class="default">,</span>
<a name="9541"><font size=-1>9541     </font></a><span class="default">    requires=</span><span class="string">&quot;[[imgmov]] == 5&quot;</span><span class="default">,</span>
<a name="9542"><font size=-1>9542     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9543"><font size=-1>9543     </font></a><span class="string">Gives the variant of the NEB method used. Possible values can be:</span>
<a name="9544"><font size=-1>9544     </font></a><span class="string"></span>
<a name="9545"><font size=-1>9545     </font></a><span class="string">  * 0 --&gt; **Original NEB method**.</span>
<a name="9546"><font size=-1>9546     </font></a><span class="string">See [[cite:Berne1998]] pp. 385-404</span>
<a name="9547"><font size=-1>9547     </font></a><span class="string"></span>
<a name="9548"><font size=-1>9548     </font></a><span class="string">  * 1 --&gt; **NEB + improved tangent**.</span>
<a name="9549"><font size=-1>9549     </font></a><span class="string">The Improved Tangent Method builds on the NEB with an improved estimate of the</span>
<a name="9550"><font size=-1>9550     </font></a><span class="string">tangent direction and a resulting change of the component of the spring force</span>
<a name="9551"><font size=-1>9551     </font></a><span class="string">acting on the images.</span>
<a name="9552"><font size=-1>9552     </font></a><span class="string">See [[cite:Henkelman2000]]</span>
<a name="9553"><font size=-1>9553     </font></a><span class="string"></span>
<a name="9554"><font size=-1>9554     </font></a><span class="string">  * 2 --&gt; **Climbing-Image NEB (CI-NEB)**.</span>
<a name="9555"><font size=-1>9555     </font></a><span class="string">XG 20180813 : This algorithm seems to be BROKEN.</span>
<a name="9556"><font size=-1>9556     </font></a><span class="string">The CI-NEB method constitutes a small modification to the NEB method.</span>
<a name="9557"><font size=-1>9557     </font></a><span class="string">Information about the shape of the MEP is retained, but a rigorous convergence</span>
<a name="9558"><font size=-1>9558     </font></a><span class="string">to a saddle point is also obtained. By default the spring constants are</span>
<a name="9559"><font size=-1>9559     </font></a><span class="string">variable (see [[neb_spring]]). As the image with the highest energy has to be</span>
<a name="9560"><font size=-1>9560     </font></a><span class="string">identified, the calculation begins with several iterations of the standard NEB</span>
<a name="9561"><font size=-1>9561     </font></a><span class="string">algorithm. The effective CI-NEB begins at the [[cineb_start]] iteration.</span>
<a name="9562"><font size=-1>9562     </font></a><span class="string">See [[cite:Henkelman2000a]]</span>
<a name="9563"><font size=-1>9563     </font></a><span class="string"></span>
<a name="9564"><font size=-1>9564     </font></a><span class="string">Note that, in all cases, it is possible to define the value of the spring</span>
<a name="9565"><font size=-1>9565     </font></a><span class="string">constant connecting images with [[neb_spring]], keeping it constant or</span>
<a name="9566"><font size=-1>9566     </font></a><span class="string">allowing it to vary between 2 values (to have higher resolution close to the saddle point).</span>
<a name="9567"><font size=-1>9567     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9568"><font size=-1>9568     </font></a><span class="default">),</span>
<a name="9569"><font size=-1>9569     </font></a><span class="default"></span>
<a name="9570"><font size=-1>9570     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9571"><font size=-1>9571     </font></a><span class="default">    abivarname=</span><span class="string">&quot;neb_spring&quot;</span><span class="default">,</span>
<a name="9572"><font size=-1>9572     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9573"><font size=-1>9573     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="9574"><font size=-1>9574     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_useful'</span><span class="default">],</span>
<a name="9575"><font size=-1>9575     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="9576"><font size=-1>9576     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[neb_algo]] == 2'</span><span class="default">: [</span><span class="number">0.02</span><span class="default">, </span><span class="number">0.15</span><span class="default">], </span><span class="string">'defaultval'</span><span class="default">: [</span><span class="number">0.05</span><span class="default">, </span><span class="number">0.05</span><span class="default">]}),</span>
<a name="9577"><font size=-1>9577     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Nudged Elastic Band: SPRING constant&quot;</span><span class="default">,</span>
<a name="9578"><font size=-1>9578     </font></a><span class="default">    requires=</span><span class="string">&quot;[[imgmov]] == 5&quot;</span><span class="default">,</span>
<a name="9579"><font size=-1>9579     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9580"><font size=-1>9580     </font></a><span class="string">Gives the minimal and maximal values of the spring constant connecting images</span>
<a name="9581"><font size=-1>9581     </font></a><span class="string">for the NEB method.</span>
<a name="9582"><font size=-1>9582     </font></a><span class="string">In the standard &quot;Nudged Elastic Band&quot; method, the spring constant is constant</span>
<a name="9583"><font size=-1>9583     </font></a><span class="string">along the path, but, in order to have higher resolution close to the saddle</span>
<a name="9584"><font size=-1>9584     </font></a><span class="string">point, it can be better to have stronger springs close to it.</span>
<a name="9585"><font size=-1>9585     </font></a><span class="string">See [[cite:Henkelman2000a]]</span>
<a name="9586"><font size=-1>9586     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9587"><font size=-1>9587     </font></a><span class="default">),</span>
<a name="9588"><font size=-1>9588     </font></a><span class="default"></span>
<a name="9589"><font size=-1>9589     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9590"><font size=-1>9590     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nelect&quot;</span><span class="default">,</span>
<a name="9591"><font size=-1>9591     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="9592"><font size=-1>9592     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="9593"><font size=-1>9593     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_internal'</span><span class="default">],</span>
<a name="9594"><font size=-1>9594     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9595"><font size=-1>9595     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[AUTO_FROM_PSP]]&quot;</span><span class="default">,</span>
<a name="9596"><font size=-1>9596     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of ELECTrons&quot;</span><span class="default">,</span>
<a name="9597"><font size=-1>9597     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="9598"><font size=-1>9598     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9599"><font size=-1>9599     </font></a><span class="string">This internal variable gives the number of electrons per unit cell, as</span>
<a name="9600"><font size=-1>9600     </font></a><span class="string">computed from the sum of the valence electrons related to each atom (given in</span>
<a name="9601"><font size=-1>9601     </font></a><span class="string">the pseudopotential, where it is called &quot;zion&quot;), and the input variable [[charge]]:</span>
<a name="9602"><font size=-1>9602     </font></a><span class="string">[[nelect]] = zion-[[charge]].</span>
<a name="9603"><font size=-1>9603     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9604"><font size=-1>9604     </font></a><span class="default">),</span>
<a name="9605"><font size=-1>9605     </font></a><span class="default"></span>
<a name="9606"><font size=-1>9606     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9607"><font size=-1>9607     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nfft&quot;</span><span class="default">,</span>
<a name="9608"><font size=-1>9608     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="9609"><font size=-1>9609     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9610"><font size=-1>9610     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_internal'</span><span class="default">],</span>
<a name="9611"><font size=-1>9611     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9612"><font size=-1>9612     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of FFT points&quot;</span><span class="default">,</span>
<a name="9613"><font size=-1>9613     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="9614"><font size=-1>9614     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9615"><font size=-1>9615     </font></a><span class="string">If space parallelization is not used (that is, if [[paral_kgb]] == 0), this</span>
<a name="9616"><font size=-1>9616     </font></a><span class="string">internal variable gives the number of Fast Fourier Transform points in the</span>
<a name="9617"><font size=-1>9617     </font></a><span class="string">grid generated by [[ngfft]](1:3). It is simply the product of the three</span>
<a name="9618"><font size=-1>9618     </font></a><span class="string">components of [[ngfft]].</span>
<a name="9619"><font size=-1>9619     </font></a><span class="string"></span>
<a name="9620"><font size=-1>9620     </font></a><span class="string">If space parallelisation is used (that is, if [[paral_kgb]] == 1), then it</span>
<a name="9621"><font size=-1>9621     </font></a><span class="string">becomes the number of Fast Fourier Transform points attributed to the</span>
<a name="9622"><font size=-1>9622     </font></a><span class="string">particular processor. It is no longer the above-mentioned simple product, but</span>
<a name="9623"><font size=-1>9623     </font></a><span class="string">a number usually close to this product divided by the number of processors on</span>
<a name="9624"><font size=-1>9624     </font></a><span class="string">which the space is shared.</span>
<a name="9625"><font size=-1>9625     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9626"><font size=-1>9626     </font></a><span class="default">),</span>
<a name="9627"><font size=-1>9627     </font></a><span class="default"></span>
<a name="9628"><font size=-1>9628     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9629"><font size=-1>9629     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nfftdg&quot;</span><span class="default">,</span>
<a name="9630"><font size=-1>9630     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="9631"><font size=-1>9631     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9632"><font size=-1>9632     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_internal'</span><span class="default">],</span>
<a name="9633"><font size=-1>9633     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9634"><font size=-1>9634     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of FFT points for the Double Grid&quot;</span><span class="default">,</span>
<a name="9635"><font size=-1>9635     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="9636"><font size=-1>9636     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9637"><font size=-1>9637     </font></a><span class="string">If space parallelisation is not used (that is, if [[paral_kgb]] == 0), this</span>
<a name="9638"><font size=-1>9638     </font></a><span class="string">internal variable gives the number of Fast Fourier Transform points in the</span>
<a name="9639"><font size=-1>9639     </font></a><span class="string">(double) grid generated by [[ngfftdg]](1:3). It is simply the product of the</span>
<a name="9640"><font size=-1>9640     </font></a><span class="string">three components of [[ngfftdg]].</span>
<a name="9641"><font size=-1>9641     </font></a><span class="string"></span>
<a name="9642"><font size=-1>9642     </font></a><span class="string">If space parallelisation is used (that is, if [[paral_kgb]] == 1), then it</span>
<a name="9643"><font size=-1>9643     </font></a><span class="string">becomes the number of Fast Fourier Transform points attributed to the</span>
<a name="9644"><font size=-1>9644     </font></a><span class="string">particular processor. It is no longer the above-mentioned simple product, but</span>
<a name="9645"><font size=-1>9645     </font></a><span class="string">a number usually close to this product divided by the number of processors on</span>
<a name="9646"><font size=-1>9646     </font></a><span class="string">which the space is shared.</span>
<a name="9647"><font size=-1>9647     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9648"><font size=-1>9648     </font></a><span class="default">),</span>
<a name="9649"><font size=-1>9649     </font></a><span class="default"></span>
<a name="9650"><font size=-1>9650     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9651"><font size=-1>9651     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nfreqim&quot;</span><span class="default">,</span>
<a name="9652"><font size=-1>9652     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="9653"><font size=-1>9653     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9654"><font size=-1>9654     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_basic'</span><span class="default">, </span><span class="string">'RPACorrEn_compulsory'</span><span class="default">],</span>
<a name="9655"><font size=-1>9655     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9656"><font size=-1>9656     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9657"><font size=-1>9657     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of FREQuencies along the IMaginary axis&quot;</span><span class="default">,</span>
<a name="9658"><font size=-1>9658     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[gwcalctyp]] in [2,12,22,9,19,29]&quot;</span><span class="default">,</span>
<a name="9659"><font size=-1>9659     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9660"><font size=-1>9660     </font></a><span class="string">[[nfreqim]] sets the number of pure imaginary frequencies used to calculate</span>
<a name="9661"><font size=-1>9661     </font></a><span class="string">the dielectric matrix in order to perform the numerical integration of the GW self-energy.</span>
<a name="9662"><font size=-1>9662     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9663"><font size=-1>9663     </font></a><span class="default">),</span>
<a name="9664"><font size=-1>9664     </font></a><span class="default"></span>
<a name="9665"><font size=-1>9665     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9666"><font size=-1>9666     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nfreqmidm&quot;</span><span class="default">,</span>
<a name="9667"><font size=-1>9667     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="9668"><font size=-1>9668     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9669"><font size=-1>9669     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_basic'</span><span class="default">],</span>
<a name="9670"><font size=-1>9670     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9671"><font size=-1>9671     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Nth FREQuency Moment of the Imaginary part of the Dielectric Matrix&quot;</span><span class="default">,</span>
<a name="9672"><font size=-1>9672     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="9673"><font size=-1>9673     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9674"><font size=-1>9674     </font></a><span class="string">depending on the value of [[nfreqmidm]] will calculate the frequency moment of</span>
<a name="9675"><font size=-1>9675     </font></a><span class="string">the dielectric matrix or its inverse,</span>
<a name="9676"><font size=-1>9676     </font></a><span class="string"></span>
<a name="9677"><font size=-1>9677     </font></a><span class="string">  * if [[nfreqmidm]] is positive: calculate (nth=[[nfreqmidm]]) frequency moment of the dielectric matrix.</span>
<a name="9678"><font size=-1>9678     </font></a><span class="string">  * if [[nfreqmidm]] is negative: calculate (nth=[[nfreqmidm]]) frequency moment of the inverse dielectric matrix.</span>
<a name="9679"><font size=-1>9679     </font></a><span class="string">  * if [[nfreqmidm]] = 0: calculate first frequency moment of the full polarizability.</span>
<a name="9680"><font size=-1>9680     </font></a><span class="string"></span>
<a name="9681"><font size=-1>9681     </font></a><span class="string">See [[cite:Taut1985]].</span>
<a name="9682"><font size=-1>9682     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9683"><font size=-1>9683     </font></a><span class="default">),</span>
<a name="9684"><font size=-1>9684     </font></a><span class="default"></span>
<a name="9685"><font size=-1>9685     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9686"><font size=-1>9686     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nfreqre&quot;</span><span class="default">,</span>
<a name="9687"><font size=-1>9687     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="9688"><font size=-1>9688     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9689"><font size=-1>9689     </font></a><span class="default">    topics=[</span><span class="string">'FrequencyMeshMBPT_basic'</span><span class="default">],</span>
<a name="9690"><font size=-1>9690     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9691"><font size=-1>9691     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9692"><font size=-1>9692     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of FREQuencies along the REal axis&quot;</span><span class="default">,</span>
<a name="9693"><font size=-1>9693     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[gwcalctyp]] in [2,12,22,9,19,29]&quot;</span><span class="default">,</span>
<a name="9694"><font size=-1>9694     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="9695"><font size=-1>9695     </font></a><span class="string">[[nfreqre]] sets the number of real frequencies used to calculate the</span>
<a name="9696"><font size=-1>9696     </font></a><span class="string">dielectric matrix in order to perform the numerical integration of the GW self-energy.</span>
<a name="9697"><font size=-1>9697     </font></a><span class="string"></span>
<a name="9698"><font size=-1>9698     </font></a><span class="string">It can be used also in case of GW calculations with plasmon-pole models, _i.e._</span>
<a name="9699"><font size=-1>9699     </font></a><span class="string">[[gwcalctyp]]&lt;10, to reduce the number of frequencies used to evaluate the</span>
<a name="9700"><font size=-1>9700     </font></a><span class="string">dielectric matrix from the (default) two to one frequency (omega=0) by setting</span>
<a name="9701"><font size=-1>9701     </font></a><span class="string">[[nfreqre]] = 1. This might be a good idea in case one is planning to use</span>
<a name="9702"><font size=-1>9702     </font></a><span class="string">[[ppmodel]] &gt; 1. This will force the calculation of the screening on a single</span>
<a name="9703"><font size=-1>9703     </font></a><span class="string">frequency ($\omega=0$) and hence reduce memory and disk space requirement. The</span>
<a name="9704"><font size=-1>9704     </font></a><span class="string">only draw back is that the user will not be able to perform self energy</span>
<a name="9705"><font size=-1>9705     </font></a><span class="string">calculation using [[ppmodel]] = 1, since in the last case the dielectric matrix</span>
<a name="9706"><font size=-1>9706     </font></a><span class="string">calculated on two frequencies is required. If the user is not sure which</span>
<a name="9707"><font size=-1>9707     </font></a><span class="string">ppmodel to use, then s/he is not advised to use this input variable. Using the</span>
<a name="9708"><font size=-1>9708     </font></a><span class="string">default values, one must be able to get a screening file that can be used with any [[ppmodel]].</span>
<a name="9709"><font size=-1>9709     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9710"><font size=-1>9710     </font></a><span class="default">),</span>
<a name="9711"><font size=-1>9711     </font></a><span class="default"></span>
<a name="9712"><font size=-1>9712     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9713"><font size=-1>9713     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nfreqsp&quot;</span><span class="default">,</span>
<a name="9714"><font size=-1>9714     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="9715"><font size=-1>9715     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9716"><font size=-1>9716     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="9717"><font size=-1>9717     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9718"><font size=-1>9718     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9719"><font size=-1>9719     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of FREQuencies for the SPectral function&quot;</span><span class="default">,</span>
<a name="9720"><font size=-1>9720     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="9721"><font size=-1>9721     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9722"><font size=-1>9722     </font></a><span class="string">[[nfreqsp]] defines the number of real frequencies used to calculate the</span>
<a name="9723"><font size=-1>9723     </font></a><span class="string">spectral function of the GW Green's function.</span>
<a name="9724"><font size=-1>9724     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9725"><font size=-1>9725     </font></a><span class="default">),</span>
<a name="9726"><font size=-1>9726     </font></a><span class="default"></span>
<a name="9727"><font size=-1>9727     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9728"><font size=-1>9728     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ngfft&quot;</span><span class="default">,</span>
<a name="9729"><font size=-1>9729     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="9730"><font size=-1>9730     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9731"><font size=-1>9731     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_useful'</span><span class="default">],</span>
<a name="9732"><font size=-1>9732     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="9733"><font size=-1>9733     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="9734"><font size=-1>9734     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Grid points for Fast Fourier Transform&quot;</span><span class="default">,</span>
<a name="9735"><font size=-1>9735     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;(automatic selection of optimal values)&quot;</span><span class="default">,</span>
<a name="9736"><font size=-1>9736     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9737"><font size=-1>9737     </font></a><span class="string">Gives the size of fast Fourier transform (FFT) grid in three dimensions. Each</span>
<a name="9738"><font size=-1>9738     </font></a><span class="string">number must be composed of the factors 2, 3, and 5 to be consistent with the</span>
<a name="9739"><font size=-1>9739     </font></a><span class="string">radices available in our FFT.</span>
<a name="9740"><font size=-1>9740     </font></a><span class="string"></span>
<a name="9741"><font size=-1>9741     </font></a><span class="string">If no [[ngfft]] is provided or if [[ngfft]] is set to 0 0 0, the code will automatically</span>
<a name="9742"><font size=-1>9742     </font></a><span class="string">provide an optimal set of [[ngfft]] values, based on [[acell]], [[rprim]] and [[ecut]]</span>
<a name="9743"><font size=-1>9743     </font></a><span class="string">(see also [[boxcutmin]] for speed/accuracy concerns).</span>
<a name="9744"><font size=-1>9744     </font></a><span class="string">This is the recommended procedure, of course.</span>
<a name="9745"><font size=-1>9745     </font></a><span class="string">The total number of FFT points is the product: [[ngfft]](1) x [[ngfft]](2) x [[ngfft]](3)=[[nfft]].</span>
<a name="9746"><font size=-1>9746     </font></a><span class="string"></span>
<a name="9747"><font size=-1>9747     </font></a><span class="string">When [[ngfft]] is made smaller than recommended values (e.g. by setting</span>
<a name="9748"><font size=-1>9748     </font></a><span class="string">[[boxcutmin]] to a value smaller than 2.0 or by setting [[ngfft]] manually),</span>
<a name="9749"><font size=-1>9749     </font></a><span class="string">the code runs faster and the equations in effect are approximated by a low</span>
<a name="9750"><font size=-1>9750     </font></a><span class="string">pass Fourier filter. The code reports to standard output (unit 06) a parameter</span>
<a name="9751"><font size=-1>9751     </font></a><span class="string">&quot;boxcut&quot; which is the smallest ratio of the FFT box side to the $\GG$ vector basis</span>
<a name="9752"><font size=-1>9752     </font></a><span class="string">sphere diameter. When boxcut is less than 2 the Fourier filter approximation</span>
<a name="9753"><font size=-1>9753     </font></a><span class="string">is being used. When boxcut gets less than about 1.5 the approximation may be</span>
<a name="9754"><font size=-1>9754     </font></a><span class="string">too severe for realistic results and should be tested against larger values of</span>
<a name="9755"><font size=-1>9755     </font></a><span class="string">[[ngfft]]. When boxcut is larger than 2, [[ngfft]] could be reduced without</span>
<a name="9756"><font size=-1>9756     </font></a><span class="string">loss of accuracy. In this case, the small variations that are observed are</span>
<a name="9757"><font size=-1>9757     </font></a><span class="string">solely due to the xc quadrature, that may be handled with [[intxc]] = 1 to even</span>
<a name="9758"><font size=-1>9758     </font></a><span class="string">reduce this effect.</span>
<a name="9759"><font size=-1>9759     </font></a><span class="string"></span>
<a name="9760"><font size=-1>9760     </font></a><span class="string">Internally, [[ngfft]] is an array of size 18. The present components are</span>
<a name="9761"><font size=-1>9761     </font></a><span class="string">stored in [[ngfft]](1:3), while</span>
<a name="9762"><font size=-1>9762     </font></a><span class="string"></span>
<a name="9763"><font size=-1>9763     </font></a><span class="string">  * [[ngfft]](4:6) contains slightly different (larger) values, modified for efficiency of the FFT</span>
<a name="9764"><font size=-1>9764     </font></a><span class="string">  * [[ngfft]](7) is [[fftalg]]</span>
<a name="9765"><font size=-1>9765     </font></a><span class="string">  * [[ngfft]](8) is [[fftcache]]</span>
<a name="9766"><font size=-1>9766     </font></a><span class="string">  * [[ngfft]](9) is set to 0 if the parallelization of the FFT is not activated, while it is set to 1 if it is activated.</span>
<a name="9767"><font size=-1>9767     </font></a><span class="string">  * [[ngfft]](10) is the number of processors of the FFT group</span>
<a name="9768"><font size=-1>9768     </font></a><span class="string">  * [[ngfft]](11) is the index of the processor in the group of processors</span>
<a name="9769"><font size=-1>9769     </font></a><span class="string">  * [[ngfft]](12) is n2proc, the number of x-z planes, in reciprocal space, treated by the processor</span>
<a name="9770"><font size=-1>9770     </font></a><span class="string">  * [[ngfft]](13) is n3proc, the number of x-y planes, in real space, treated by the processor</span>
<a name="9771"><font size=-1>9771     </font></a><span class="string">  * [[ngfft]](14) is mpi_comm_fft, the handle on the MPI communicator in charge of the FFT parallelisation</span>
<a name="9772"><font size=-1>9772     </font></a><span class="string">  * [[ngfft]](15:18) are not yet used</span>
<a name="9773"><font size=-1>9773     </font></a><span class="string"></span>
<a name="9774"><font size=-1>9774     </font></a><span class="string">The number of points stored by this processor in real space is n1*n2*n3proc,</span>
<a name="9775"><font size=-1>9775     </font></a><span class="string">while in reciprocal space, it is n1*n2proc*n3.</span>
<a name="9776"><font size=-1>9776     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9777"><font size=-1>9777     </font></a><span class="default">),</span>
<a name="9778"><font size=-1>9778     </font></a><span class="default"></span>
<a name="9779"><font size=-1>9779     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9780"><font size=-1>9780     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ngfftdg&quot;</span><span class="default">,</span>
<a name="9781"><font size=-1>9781     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="9782"><font size=-1>9782     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9783"><font size=-1>9783     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">],</span>
<a name="9784"><font size=-1>9784     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="9785"><font size=-1>9785     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="9786"><font size=-1>9786     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Grid points for Fast Fourier Transform: Double Grid&quot;</span><span class="default">,</span>
<a name="9787"><font size=-1>9787     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="9788"><font size=-1>9788     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9789"><font size=-1>9789     </font></a><span class="string">This variable has the same meaning as ngfft (gives the size of fast Fourier</span>
<a name="9790"><font size=-1>9790     </font></a><span class="string">transform (fft) grid in three dimensions) but concerns the &quot;double grid&quot; only</span>
<a name="9791"><font size=-1>9791     </font></a><span class="string">used for PAW calculations.</span>
<a name="9792"><font size=-1>9792     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9793"><font size=-1>9793     </font></a><span class="default">),</span>
<a name="9794"><font size=-1>9794     </font></a><span class="default"></span>
<a name="9795"><font size=-1>9795     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9796"><font size=-1>9796     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ngkpt&quot;</span><span class="default">,</span>
<a name="9797"><font size=-1>9797     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9798"><font size=-1>9798     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9799"><font size=-1>9799     </font></a><span class="default">    topics=[</span><span class="string">'k-points_basic'</span><span class="default">],</span>
<a name="9800"><font size=-1>9800     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="9801"><font size=-1>9801     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="9802"><font size=-1>9802     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Grid points for K PoinTs generation&quot;</span><span class="default">,</span>
<a name="9803"><font size=-1>9803     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9804"><font size=-1>9804     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[kptrlatt]]&quot;</span><span class="default">,</span>
<a name="9805"><font size=-1>9805     </font></a><span class="default">    requires=</span><span class="string">&quot;[[kptopt]] &gt;=0,&quot;</span><span class="default">,</span>
<a name="9806"><font size=-1>9806     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9807"><font size=-1>9807     </font></a><span class="string">Used when [[kptopt]] &gt;= 0, if [[kptrlatt]] has not been defined ([[kptrlatt]]</span>
<a name="9808"><font size=-1>9808     </font></a><span class="string">and [[ngkpt]] are exclusive of each other).</span>
<a name="9809"><font size=-1>9809     </font></a><span class="string">Its three positive components give the number of k points of Monkhorst-Pack</span>
<a name="9810"><font size=-1>9810     </font></a><span class="string">grids (defined with respect to primitive axis in reciprocal space) in each of</span>
<a name="9811"><font size=-1>9811     </font></a><span class="string">the three dimensions. [[ngkpt]] will be used to generate the corresponding</span>
<a name="9812"><font size=-1>9812     </font></a><span class="string">[[kptrlatt]] input variable. The use of [[nshiftk]] and [[shiftk]], allows one to</span>
<a name="9813"><font size=-1>9813     </font></a><span class="string">generate shifted grids, or Monkhorst-Pack grids defined with respect to</span>
<a name="9814"><font size=-1>9814     </font></a><span class="string">conventional unit cells.</span>
<a name="9815"><font size=-1>9815     </font></a><span class="string"></span>
<a name="9816"><font size=-1>9816     </font></a><span class="string">When [[nshiftk]] = 1, [[kptrlatt]] is initialized as a diagonal (3x3) matrix,</span>
<a name="9817"><font size=-1>9817     </font></a><span class="string">whose diagonal elements are the three values [[ngkpt]](1:3). When [[nshiftk]]</span>
<a name="9818"><font size=-1>9818     </font></a><span class="string">is greater than 1, ABINIT will try to generate [[kptrlatt]] on the basis of</span>
<a name="9819"><font size=-1>9819     </font></a><span class="string">the primitive vectors of the k-lattice: the number of shifts might be reduced,</span>
<a name="9820"><font size=-1>9820     </font></a><span class="string">in which case [[kptrlatt]] will not be diagonal anymore.</span>
<a name="9821"><font size=-1>9821     </font></a><span class="string"></span>
<a name="9822"><font size=-1>9822     </font></a><span class="string">Monkhorst-Pack grids are usually the most efficient when their defining</span>
<a name="9823"><font size=-1>9823     </font></a><span class="string">integer numbers are even. For a measure of the efficiency, see the input</span>
<a name="9824"><font size=-1>9824     </font></a><span class="string">variable [[kptrlen]].</span>
<a name="9825"><font size=-1>9825     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9826"><font size=-1>9826     </font></a><span class="default">),</span>
<a name="9827"><font size=-1>9827     </font></a><span class="default"></span>
<a name="9828"><font size=-1>9828     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9829"><font size=-1>9829     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ngqpt&quot;</span><span class="default">,</span>
<a name="9830"><font size=-1>9830     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="9831"><font size=-1>9831     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9832"><font size=-1>9832     </font></a><span class="default">    topics=[</span><span class="string">'q-points_basic'</span><span class="default">],</span>
<a name="9833"><font size=-1>9833     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="9834"><font size=-1>9834     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="9835"><font size=-1>9835     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Grid points for Q PoinTs generation&quot;</span><span class="default">,</span>
<a name="9836"><font size=-1>9836     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="9837"><font size=-1>9837     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[qptrlatt]]&quot;</span><span class="default">,</span>
<a name="9838"><font size=-1>9838     </font></a><span class="default">    requires=</span><span class="string">&quot;[[nqpt]] == 1 and [[kptopt]] &gt;= 0&quot;</span><span class="default">,</span>
<a name="9839"><font size=-1>9839     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9840"><font size=-1>9840     </font></a><span class="string">At variance with [[ngkpt]], note that only one q point is selected per dataset</span>
<a name="9841"><font size=-1>9841     </font></a><span class="string">(see [[iqpt]]).</span>
<a name="9842"><font size=-1>9842     </font></a><span class="string">Its three positive components give the number of q points of Monkhorst-Pack</span>
<a name="9843"><font size=-1>9843     </font></a><span class="string">grids (defined with respect to primitive axis in reciprocal space) in each of</span>
<a name="9844"><font size=-1>9844     </font></a><span class="string">the three dimensions. The use of [[nshiftq]] and [[shiftq]], allows one to</span>
<a name="9845"><font size=-1>9845     </font></a><span class="string">generate shifted grids, or Monkhorst-Pack grids defined with respect to</span>
<a name="9846"><font size=-1>9846     </font></a><span class="string">conventional unit cells.</span>
<a name="9847"><font size=-1>9847     </font></a><span class="string"></span>
<a name="9848"><font size=-1>9848     </font></a><span class="string">For more information on Monkhorst-Pack grids, see [[ngkpt]].</span>
<a name="9849"><font size=-1>9849     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9850"><font size=-1>9850     </font></a><span class="default">),</span>
<a name="9851"><font size=-1>9851     </font></a><span class="default"></span>
<a name="9852"><font size=-1>9852     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9853"><font size=-1>9853     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nimage&quot;</span><span class="default">,</span>
<a name="9854"><font size=-1>9854     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="9855"><font size=-1>9855     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9856"><font size=-1>9856     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_compulsory'</span><span class="default">, </span><span class="string">'TransPath_compulsory'</span><span class="default">],</span>
<a name="9857"><font size=-1>9857     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9858"><font size=-1>9858     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="9859"><font size=-1>9859     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of IMAGEs&quot;</span><span class="default">,</span>
<a name="9860"><font size=-1>9860     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9861"><font size=-1>9861     </font></a><span class="string">Give the number of images (or replicas) of the system, for which the forces</span>
<a name="9862"><font size=-1>9862     </font></a><span class="string">and stresses might be computed independently, in the context of the string</span>
<a name="9863"><font size=-1>9863     </font></a><span class="string">method, the genetic algorithm, hyperdynamics or Path-Integral Molecular</span>
<a name="9864"><font size=-1>9864     </font></a><span class="string">Dynamics depending on the value of [[imgmov]]). Related input variables:</span>
<a name="9865"><font size=-1>9865     </font></a><span class="string">[[dynimage]], [[npimage]], [[ntimimage]] and [[prtvolimg]].</span>
<a name="9866"><font size=-1>9866     </font></a><span class="string">Images might differ by the position of atoms in the unit cell, their velocity,</span>
<a name="9867"><font size=-1>9867     </font></a><span class="string">as well as by their cell geometry. The following input variables might be used</span>
<a name="9868"><font size=-1>9868     </font></a><span class="string">to define the images:</span>
<a name="9869"><font size=-1>9869     </font></a><span class="string"></span>
<a name="9870"><font size=-1>9870     </font></a><span class="string">  * [[acell]]</span>
<a name="9871"><font size=-1>9871     </font></a><span class="string">  * [[amu]]</span>
<a name="9872"><font size=-1>9872     </font></a><span class="string">  * [[angdeg]]</span>
<a name="9873"><font size=-1>9873     </font></a><span class="string">  * [[dmatpawu]]</span>
<a name="9874"><font size=-1>9874     </font></a><span class="string">  * [[jpawu]]</span>
<a name="9875"><font size=-1>9875     </font></a><span class="string">  * [[mixalch]]</span>
<a name="9876"><font size=-1>9876     </font></a><span class="string">  * [[rprim]]</span>
<a name="9877"><font size=-1>9877     </font></a><span class="string">  * [[upawu]]</span>
<a name="9878"><font size=-1>9878     </font></a><span class="string">  * [[vel]]</span>
<a name="9879"><font size=-1>9879     </font></a><span class="string">  * [[vel_cell]]</span>
<a name="9880"><font size=-1>9880     </font></a><span class="string">  * [[xangst]]</span>
<a name="9881"><font size=-1>9881     </font></a><span class="string">  * [[xcart]]</span>
<a name="9882"><font size=-1>9882     </font></a><span class="string">  * [[xred]]</span>
<a name="9883"><font size=-1>9883     </font></a><span class="string"></span>
<a name="9884"><font size=-1>9884     </font></a><span class="string">These input variables, non-modified, will be used to define the image with</span>
<a name="9885"><font size=-1>9885     </font></a><span class="string">index 1. For the image with the last index, the input file might specify the</span>
<a name="9886"><font size=-1>9886     </font></a><span class="string">values of such input variables, appended with &quot;_lastimg&quot;, e.g.:</span>
<a name="9887"><font size=-1>9887     </font></a><span class="string"></span>
<a name="9888"><font size=-1>9888     </font></a><span class="string">  * acell_lastimg</span>
<a name="9889"><font size=-1>9889     </font></a><span class="string">  * rprim_lastimg</span>
<a name="9890"><font size=-1>9890     </font></a><span class="string">  * xcart_lastimg</span>
<a name="9891"><font size=-1>9891     </font></a><span class="string">  * ...</span>
<a name="9892"><font size=-1>9892     </font></a><span class="string"></span>
<a name="9893"><font size=-1>9893     </font></a><span class="string">By default, these values will be interpolated linearly to define values for</span>
<a name="9894"><font size=-1>9894     </font></a><span class="string">the other images, unless there exist specific values for some images, for</span>
<a name="9895"><font size=-1>9895     </font></a><span class="string">which the string &quot;last&quot; has to be replaced by the index of the image, e.g. for</span>
<a name="9896"><font size=-1>9896     </font></a><span class="string">the image number 4:</span>
<a name="9897"><font size=-1>9897     </font></a><span class="string"></span>
<a name="9898"><font size=-1>9898     </font></a><span class="string">  * acell_4img</span>
<a name="9899"><font size=-1>9899     </font></a><span class="string">  * rprim_4img</span>
<a name="9900"><font size=-1>9900     </font></a><span class="string">  * xcart_4img</span>
<a name="9901"><font size=-1>9901     </font></a><span class="string">  * ...</span>
<a name="9902"><font size=-1>9902     </font></a><span class="string"></span>
<a name="9903"><font size=-1>9903     </font></a><span class="string">It is notably possible to specify the starting point and the end point of the</span>
<a name="9904"><font size=-1>9904     </font></a><span class="string">path (of images), while specifying intermediate points.</span>
<a name="9905"><font size=-1>9905     </font></a><span class="string"></span>
<a name="9906"><font size=-1>9906     </font></a><span class="string">It usually happen that the images do not have the same symmetries and space</span>
<a name="9907"><font size=-1>9907     </font></a><span class="string">group. ABINIT has not been designed to use different set of symmetries for</span>
<a name="9908"><font size=-1>9908     </font></a><span class="string">different images. ABINIT will use the symmetry and space group of the image</span>
<a name="9909"><font size=-1>9909     </font></a><span class="string">number 2, that is expected to have a low number of symmetries. This might lead</span>
<a name="9910"><font size=-1>9910     </font></a><span class="string">to erroneous calculations, in case some image has even less symmetry. By</span>
<a name="9911"><font size=-1>9911     </font></a><span class="string">contrast, there is no problem if some other image has more symmetries than</span>
<a name="9912"><font size=-1>9912     </font></a><span class="string">those of the second image.</span>
<a name="9913"><font size=-1>9913     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9914"><font size=-1>9914     </font></a><span class="default">),</span>
<a name="9915"><font size=-1>9915     </font></a><span class="default"></span>
<a name="9916"><font size=-1>9916     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9917"><font size=-1>9917     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nkpath&quot;</span><span class="default">,</span>
<a name="9918"><font size=-1>9918     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9919"><font size=-1>9919     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9920"><font size=-1>9920     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="9921"><font size=-1>9921     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9922"><font size=-1>9922     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9923"><font size=-1>9923     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of K-points defining the PATH&quot;</span><span class="default">,</span>
<a name="9924"><font size=-1>9924     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9925"><font size=-1>9925     </font></a><span class="string">This variable is used to define the number of high-symmetry k-points in the</span>
<a name="9926"><font size=-1>9926     </font></a><span class="string">[[kptbounds]] array when [[kptopt]] &gt; 0. Historically, [[kptbounds]] is used</span>
<a name="9927"><font size=-1>9927     </font></a><span class="string">in conjuction with a negative value of [[kptopt]] when performing a NSCF band</span>
<a name="9928"><font size=-1>9928     </font></a><span class="string">structure calculation. In this case, the number of k-points in kptbounds is</span>
<a name="9929"><font size=-1>9929     </font></a><span class="string">given by abs(kptopt) + 1. There are, however, other cases in which one has to</span>
<a name="9930"><font size=-1>9930     </font></a><span class="string">specify a k-path in the input file in order to activate some kind of post-</span>
<a name="9931"><font size=-1>9931     </font></a><span class="string">processing tool. Typical examples are the interpolation of the GW corrections</span>
<a name="9932"><font size=-1>9932     </font></a><span class="string">at the end of the sigma run or the interpolation of the KS eigenvalues along a</span>
<a name="9933"><font size=-1>9933     </font></a><span class="string">path at the end of the SCF run (see also [[einterp]]) In a nutshell, nkpath</span>
<a name="9934"><font size=-1>9934     </font></a><span class="string">replaces [[kptopt]] when we are not performing a NSCF calculation. Note that,</span>
<a name="9935"><font size=-1>9935     </font></a><span class="string">unlike [[kptopt]], nkpath represents the total number of points in the</span>
<a name="9936"><font size=-1>9936     </font></a><span class="string">[[kptbounds]] array.</span>
<a name="9937"><font size=-1>9937     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9938"><font size=-1>9938     </font></a><span class="default">),</span>
<a name="9939"><font size=-1>9939     </font></a><span class="default"></span>
<a name="9940"><font size=-1>9940     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9941"><font size=-1>9941     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nkpt&quot;</span><span class="default">,</span>
<a name="9942"><font size=-1>9942     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9943"><font size=-1>9943     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9944"><font size=-1>9944     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="9945"><font size=-1>9945     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9946"><font size=-1>9946     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[kptopt]] == 0'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="9947"><font size=-1>9947     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of K - Points&quot;</span><span class="default">,</span>
<a name="9948"><font size=-1>9948     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9949"><font size=-1>9949     </font></a><span class="string">If non-zero, [[nkpt]] gives the number of k points in the k point array</span>
<a name="9950"><font size=-1>9950     </font></a><span class="string">[[kpt]]. These points are used either to sample the Brillouin zone, or to</span>
<a name="9951"><font size=-1>9951     </font></a><span class="string">build a band structure along specified lines.</span>
<a name="9952"><font size=-1>9952     </font></a><span class="string"></span>
<a name="9953"><font size=-1>9953     </font></a><span class="string">If [[nkpt]] is zero, the code deduces from other input variables (see the list</span>
<a name="9954"><font size=-1>9954     </font></a><span class="string">in the description of [[kptopt]]) the number of k points, which is possible</span>
<a name="9955"><font size=-1>9955     </font></a><span class="string">only when [[kptopt]]/=0. If [[kptopt]]/=0 and the input value of [[nkpt]]/=0,</span>
<a name="9956"><font size=-1>9956     </font></a><span class="string">then ABINIT will check that the number of k points generated from the other</span>
<a name="9957"><font size=-1>9957     </font></a><span class="string">input variables is exactly the same than [[nkpt]].</span>
<a name="9958"><font size=-1>9958     </font></a><span class="string"></span>
<a name="9959"><font size=-1>9959     </font></a><span class="string">If [[kptopt]] is positive, [[nkpt]] must be coherent with the values of</span>
<a name="9960"><font size=-1>9960     </font></a><span class="string">[[kptrlatt]], [[nshiftk]] and [[shiftk]].</span>
<a name="9961"><font size=-1>9961     </font></a><span class="string">For ground state calculations, one should select the k point in the</span>
<a name="9962"><font size=-1>9962     </font></a><span class="string">irreducible Brillouin Zone (obtained by taking into account point symmetries</span>
<a name="9963"><font size=-1>9963     </font></a><span class="string">and the time-reversal symmetry).</span>
<a name="9964"><font size=-1>9964     </font></a><span class="string">For response function calculations, one should select k points in the full</span>
<a name="9965"><font size=-1>9965     </font></a><span class="string">Brillouin zone, if the wavevector of the perturbation does not vanish, or in a</span>
<a name="9966"><font size=-1>9966     </font></a><span class="string">half of the Brillouin Zone if q=0. The code will automatically decrease the</span>
<a name="9967"><font size=-1>9967     </font></a><span class="string">number of k points to the minimal set needed for each particular perturbation.</span>
<a name="9968"><font size=-1>9968     </font></a><span class="string"></span>
<a name="9969"><font size=-1>9969     </font></a><span class="string">If [[kptopt]] is negative, [[nkpt]] will be the sum of the number of points on</span>
<a name="9970"><font size=-1>9970     </font></a><span class="string">the different lines of the band structure. For example, if [[kptopt]] = -3, one</span>
<a name="9971"><font size=-1>9971     </font></a><span class="string">will have three segments; supposing [[ndivk]] is 10 12 17, the total number of</span>
<a name="9972"><font size=-1>9972     </font></a><span class="string">k points of the circuit will be 10+12+17+1(for the final point)=40.</span>
<a name="9973"><font size=-1>9973     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9974"><font size=-1>9974     </font></a><span class="default">),</span>
<a name="9975"><font size=-1>9975     </font></a><span class="default"></span>
<a name="9976"><font size=-1>9976     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9977"><font size=-1>9977     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nkptgw&quot;</span><span class="default">,</span>
<a name="9978"><font size=-1>9978     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="9979"><font size=-1>9979     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9980"><font size=-1>9980     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="9981"><font size=-1>9981     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9982"><font size=-1>9982     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="9983"><font size=-1>9983     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of K-PoinTs for GW corrections&quot;</span><span class="default">,</span>
<a name="9984"><font size=-1>9984     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="9985"><font size=-1>9985     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9986"><font size=-1>9986     </font></a><span class="string">[[nkptgw]] gives the number of k-points for which the GW calculation must be</span>
<a name="9987"><font size=-1>9987     </font></a><span class="string">done. It is used to dimension [[kptgw]].</span>
<a name="9988"><font size=-1>9988     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="9989"><font size=-1>9989     </font></a><span class="default">),</span>
<a name="9990"><font size=-1>9990     </font></a><span class="default"></span>
<a name="9991"><font size=-1>9991     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="9992"><font size=-1>9992     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nkpthf&quot;</span><span class="default">,</span>
<a name="9993"><font size=-1>9993     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="9994"><font size=-1>9994     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="9995"><font size=-1>9995     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_expert'</span><span class="default">],</span>
<a name="9996"><font size=-1>9996     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="9997"><font size=-1>9997     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of K - Points for (Hartree) Fock exact exchange&quot;</span><span class="default">,</span>
<a name="9998"><font size=-1>9998     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="9999"><font size=-1>9999     </font></a><span class="string">[[nkpthf]] gives the number of k points used to sample the full Brillouin zone</span>
<a name="10000"><font size=-1>10000     </font></a><span class="string">for the Fock exact exchange contribution. It is obtained from the</span>
<a name="10001"><font size=-1>10001     </font></a><span class="string">specification of the wavefunction k point grid (see [[kptopt]]), possibly</span>
<a name="10002"><font size=-1>10002     </font></a><span class="string">downfolded as specified by [[fockdownsampling]].</span>
<a name="10003"><font size=-1>10003     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10004"><font size=-1>10004     </font></a><span class="default">),</span>
<a name="10005"><font size=-1>10005     </font></a><span class="default"></span>
<a name="10006"><font size=-1>10006     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10007"><font size=-1>10007     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nline&quot;</span><span class="default">,</span>
<a name="10008"><font size=-1>10008     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10009"><font size=-1>10009     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10010"><font size=-1>10010     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_expert'</span><span class="default">],</span>
<a name="10011"><font size=-1>10011     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10012"><font size=-1>10012     </font></a><span class="default">    defaultval=</span><span class="number">4</span><span class="default">,</span>
<a name="10013"><font size=-1>10013     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of LINE minimisations&quot;</span><span class="default">,</span>
<a name="10014"><font size=-1>10014     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10015"><font size=-1>10015     </font></a><span class="string">Gives maximum number of line minimizations allowed in preconditioned conjugate</span>
<a name="10016"><font size=-1>10016     </font></a><span class="string">gradient minimization for each band. The default, 4, is fine.</span>
<a name="10017"><font size=-1>10017     </font></a><span class="string">Special cases, with degeneracies or near-degeneracies of levels at the Fermi</span>
<a name="10018"><font size=-1>10018     </font></a><span class="string">energy may require a larger value of [[nline]] (5 or 6 ?). Line minimizations</span>
<a name="10019"><font size=-1>10019     </font></a><span class="string">will be stopped anyway when improvement gets small (governed by [[tolrde]]).</span>
<a name="10020"><font size=-1>10020     </font></a><span class="string">With the input variable [[nnsclo]], governs the convergence of the</span>
<a name="10021"><font size=-1>10021     </font></a><span class="string">wavefunctions for fixed potential.</span>
<a name="10022"><font size=-1>10022     </font></a><span class="string">Note that [[nline]] = 0 can be used to diagonalize the Hamiltonian matrix in the</span>
<a name="10023"><font size=-1>10023     </font></a><span class="string">subspace spanned by the input wavefunctions.</span>
<a name="10024"><font size=-1>10024     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10025"><font size=-1>10025     </font></a><span class="default">),</span>
<a name="10026"><font size=-1>10026     </font></a><span class="default"></span>
<a name="10027"><font size=-1>10027     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10028"><font size=-1>10028     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nloc_alg&quot;</span><span class="default">,</span>
<a name="10029"><font size=-1>10029     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="10030"><font size=-1>10030     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10031"><font size=-1>10031     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="10032"><font size=-1>10032     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10033"><font size=-1>10033     </font></a><span class="default">    defaultval=</span><span class="number">4</span><span class="default">,</span>
<a name="10034"><font size=-1>10034     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Non LOCal ALGorithm&quot;</span><span class="default">,</span>
<a name="10035"><font size=-1>10035     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="10036"><font size=-1>10036     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="10037"><font size=-1>10037     </font></a><span class="string">Allows to choose the algorithm for non-local operator application. On super-</span>
<a name="10038"><font size=-1>10038     </font></a><span class="string">scalar architectures, the default [[nloc_alg]] = 4 is the best.</span>
<a name="10039"><font size=-1>10039     </font></a><span class="string">More detailed explanations:</span>
<a name="10040"><font size=-1>10040     </font></a><span class="string"></span>
<a name="10041"><font size=-1>10041     </font></a><span class="string">- [[nloc_alg]] = 2: Should be efficient on vector machines. It is indeed the</span>
<a name="10042"><font size=-1>10042     </font></a><span class="string">  fastest algorithm for the NEC, but actual tests on Fujitsu machine did not</span>
<a name="10043"><font size=-1>10043     </font></a><span class="string">  gave better performances than the other options.</span>
<a name="10044"><font size=-1>10044     </font></a><span class="string">- [[nloc_alg]] = 3: same as [[nloc_alg]] == 2, but the loop order is inverted.</span>
<a name="10045"><font size=-1>10045     </font></a><span class="string">- [[nloc_alg]] = 4: same as [[nloc_alg]] == 3, but maximal use of registers has</span>
<a name="10046"><font size=-1>10046     </font></a><span class="string">   been coded. This should be especially efficient on scalar and super-scalar</span>
<a name="10047"><font size=-1>10047     </font></a><span class="string">   machines. This has been confirmed by tests.</span>
<a name="10048"><font size=-1>10048     </font></a><span class="string"></span>
<a name="10049"><font size=-1>10049     </font></a><span class="string">Note: internally, [[nloc_alg]] is stored in `dtset%nloalg(1)`. See also</span>
<a name="10050"><font size=-1>10050     </font></a><span class="string">[[nloc_mem]] for the tuning of the memory used in the non-local operator application.</span>
<a name="10051"><font size=-1>10051     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10052"><font size=-1>10052     </font></a><span class="default">),</span>
<a name="10053"><font size=-1>10053     </font></a><span class="default"></span>
<a name="10054"><font size=-1>10054     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10055"><font size=-1>10055     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nloc_mem&quot;</span><span class="default">,</span>
<a name="10056"><font size=-1>10056     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="10057"><font size=-1>10057     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10058"><font size=-1>10058     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="10059"><font size=-1>10059     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10060"><font size=-1>10060     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[usepaw]] == 1'</span><span class="default">: </span><span class="number">2</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="10061"><font size=-1>10061     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Non LOCal MEMOry&quot;</span><span class="default">,</span>
<a name="10062"><font size=-1>10062     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="10063"><font size=-1>10063     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="10064"><font size=-1>10064     </font></a><span class="string">Controls the memory use for the application of the non-local operator.</span>
<a name="10065"><font size=-1>10065     </font></a><span class="string">More detailed explanations:</span>
<a name="10066"><font size=-1>10066     </font></a><span class="string"></span>
<a name="10067"><font size=-1>10067     </font></a><span class="string">- [[nloc_mem]] == 1: (k+G) vectors are not precomputed, in order to save memory space.</span>
<a name="10068"><font size=-1>10068     </font></a><span class="string">- [[nloc_mem]] == 2: (k+G) vectors are precomputed, once per k-point.</span>
<a name="10069"><font size=-1>10069     </font></a><span class="string">- [[nloc_mem]] == -1 or -2: Negative values of [[nloc_mem]] correspond</span>
<a name="10070"><font size=-1>10070     </font></a><span class="string">  positive ones, where the phase precomputation has been suppressed, in order to</span>
<a name="10071"><font size=-1>10071     </font></a><span class="string">  save memory space, as an array `double precision: ph3d(2,npw,[[natom]])` is</span>
<a name="10072"><font size=-1>10072     </font></a><span class="string">  saved (typically half the space needed for the wavefunctions at 1 k point -</span>
<a name="10073"><font size=-1>10073     </font></a><span class="string">  this corresponds to the silicon case). However, the computation of phases</span>
<a name="10074"><font size=-1>10074     </font></a><span class="string">  inside nonlop is somehow time-consuming.</span>
<a name="10075"><font size=-1>10075     </font></a><span class="string"></span>
<a name="10076"><font size=-1>10076     </font></a><span class="string">Note: internally, sign([[nloc_mem]]) is stored in `dtset%nloalg(2)` and</span>
<a name="10077"><font size=-1>10077     </font></a><span class="string">abs([[nloc_mem]])-1 is stored in `dtset%nloalg(3)`. See also [[nloc_alg]] for the</span>
<a name="10078"><font size=-1>10078     </font></a><span class="string">algorithm for the non-local operator application.</span>
<a name="10079"><font size=-1>10079     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10080"><font size=-1>10080     </font></a><span class="default">),</span>
<a name="10081"><font size=-1>10081     </font></a><span class="default"></span>
<a name="10082"><font size=-1>10082     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10083"><font size=-1>10083     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nnos&quot;</span><span class="default">,</span>
<a name="10084"><font size=-1>10084     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="10085"><font size=-1>10085     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10086"><font size=-1>10086     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_basic'</span><span class="default">, </span><span class="string">'MolecularDynamics_basic'</span><span class="default">],</span>
<a name="10087"><font size=-1>10087     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10088"><font size=-1>10088     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10089"><font size=-1>10089     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of NOSe masses&quot;</span><span class="default">,</span>
<a name="10090"><font size=-1>10090     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10091"><font size=-1>10091     </font></a><span class="string">Gives the number of thermostats in the chain of oscillators</span>
<a name="10092"><font size=-1>10092     </font></a><span class="string">thermostats as proposed in [[cite:Martyna1996]]. The thermostat chains can be used either to perform Molecular Dynamics (MD) ([[ionmov]] = 13) or to perform Path Integral Molecular Dynamics</span>
<a name="10093"><font size=-1>10093     </font></a><span class="string">(PIMD) ([[imgmov]] = 13).</span>
<a name="10094"><font size=-1>10094     </font></a><span class="string">The mass of these thermostats is given by [[qmass]].</span>
<a name="10095"><font size=-1>10095     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10096"><font size=-1>10096     </font></a><span class="default">),</span>
<a name="10097"><font size=-1>10097     </font></a><span class="default"></span>
<a name="10098"><font size=-1>10098     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10099"><font size=-1>10099     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nnsclo&quot;</span><span class="default">,</span>
<a name="10100"><font size=-1>10100     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="10101"><font size=-1>10101     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10102"><font size=-1>10102     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_expert'</span><span class="default">],</span>
<a name="10103"><font size=-1>10103     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10104"><font size=-1>10104     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10105"><font size=-1>10105     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Non-Self Consistent LOops&quot;</span><span class="default">,</span>
<a name="10106"><font size=-1>10106     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="10107"><font size=-1>10107     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10108"><font size=-1>10108     </font></a><span class="string">Gives the maximum number of non-self-consistent loops of [[nline]] line</span>
<a name="10109"><font size=-1>10109     </font></a><span class="string">minimisations, in the SCF case (when [[iscf]] &gt;0). In the case [[iscf]] &lt;=0,</span>
<a name="10110"><font size=-1>10110     </font></a><span class="string">the number of non-self-consistent loops is determined by [[nstep]].</span>
<a name="10111"><font size=-1>10111     </font></a><span class="string"></span>
<a name="10112"><font size=-1>10112     </font></a><span class="string">    * The Default value of 0 -- for standard plane-wave calculations -- corresponds</span>
<a name="10113"><font size=-1>10113     </font></a><span class="string">    to make the two first fixed potential determinations of wavefunctions have 2</span>
<a name="10114"><font size=-1>10114     </font></a><span class="string">    non-self consistent loops, and the next ones to have only 1 non-self</span>
<a name="10115"><font size=-1>10115     </font></a><span class="string">    consistent loop.</span>
<a name="10116"><font size=-1>10116     </font></a><span class="string"></span>
<a name="10117"><font size=-1>10117     </font></a><span class="string">    * The Default value of 0 -- for wavelets calculations ([[usewvl]] = 1) --</span>
<a name="10118"><font size=-1>10118     </font></a><span class="string">    corresponds to make 2 steps with 3 non-self consistent loops, 2 steps with 2</span>
<a name="10119"><font size=-1>10119     </font></a><span class="string">    non-self consistent loops, then the next ones with 1 non-self consistent loop.</span>
<a name="10120"><font size=-1>10120     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10121"><font size=-1>10121     </font></a><span class="default">),</span>
<a name="10122"><font size=-1>10122     </font></a><span class="default"></span>
<a name="10123"><font size=-1>10123     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10124"><font size=-1>10124     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nnsclohf&quot;</span><span class="default">,</span>
<a name="10125"><font size=-1>10125     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="10126"><font size=-1>10126     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10127"><font size=-1>10127     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_expert'</span><span class="default">],</span>
<a name="10128"><font size=-1>10128     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10129"><font size=-1>10129     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[usefock]] == 1'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="10130"><font size=-1>10130     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Non-Self Consistent LOops for (Hartree)-Fock exact exchange&quot;</span><span class="default">,</span>
<a name="10131"><font size=-1>10131     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="10132"><font size=-1>10132     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10133"><font size=-1>10133     </font></a><span class="string">Gives the maximum number of loops with non-self-consistent occupied states</span>
<a name="10134"><font size=-1>10134     </font></a><span class="string">used to calculate Fock exact exchange, in the SCF case.</span>
<a name="10135"><font size=-1>10135     </font></a><span class="string">The Default value is 0 when [[usefock]] = 0. Default value is 1 when</span>
<a name="10136"><font size=-1>10136     </font></a><span class="string">[[usefock]] = 1 and correspond to update occupied wavefunctions at each self-</span>
<a name="10137"><font size=-1>10137     </font></a><span class="string">consistent loop.</span>
<a name="10138"><font size=-1>10138     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10139"><font size=-1>10139     </font></a><span class="default">),</span>
<a name="10140"><font size=-1>10140     </font></a><span class="default"></span>
<a name="10141"><font size=-1>10141     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10142"><font size=-1>10142     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nobj&quot;</span><span class="default">,</span>
<a name="10143"><font size=-1>10143     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="10144"><font size=-1>10144     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10145"><font size=-1>10145     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_compulsory'</span><span class="default">],</span>
<a name="10146"><font size=-1>10146     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10147"><font size=-1>10147     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10148"><font size=-1>10148     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of OBJects&quot;</span><span class="default">,</span>
<a name="10149"><font size=-1>10149     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="10150"><font size=-1>10150     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10151"><font size=-1>10151     </font></a><span class="string">Gives the number of 'objects' to be used by the atom manipulator in order to</span>
<a name="10152"><font size=-1>10152     </font></a><span class="string">find the full set of atoms. At present, only one or two objects can be</span>
<a name="10153"><font size=-1>10153     </font></a><span class="string">defined, identified as objects 'a' and 'b'.</span>
<a name="10154"><font size=-1>10154     </font></a><span class="string">Related variables for object 'a' are: [[objan]], [[objaat]], [[objarf]],</span>
<a name="10155"><font size=-1>10155     </font></a><span class="string">[[objatr]], [[objaro]], [[objaax]]. Related variables for object 'b' are:</span>
<a name="10156"><font size=-1>10156     </font></a><span class="string">[[objbn]], [[objbat]], [[objbrf]], [[objbtr]], [[objbro]], [[objbax]].</span>
<a name="10157"><font size=-1>10157     </font></a><span class="string"></span>
<a name="10158"><font size=-1>10158     </font></a><span class="string">More detailed explanation: when the atom manipulator is used (i.e. when</span>
<a name="10159"><font size=-1>10159     </font></a><span class="string">[[nobj]] == 1 or [[nobj]] == 2), the code will be given a primitive set of atoms,</span>
<a name="10160"><font size=-1>10160     </font></a><span class="string">from which it will have to deduce the full set of atoms.</span>
<a name="10161"><font size=-1>10161     </font></a><span class="string">An object will be specified by the number of atoms it includes ([[objan]] or</span>
<a name="10162"><font size=-1>10162     </font></a><span class="string">[[objbn]] ), and the list of these atoms ([[objaat]] or [[objbat]] ).</span>
<a name="10163"><font size=-1>10163     </font></a><span class="string">Examples of physical realisation of an object can be a molecule, or a group of</span>
<a name="10164"><font size=-1>10164     </font></a><span class="string">atom to be repeated, or a part of a molecule to be rotated. The atom</span>
<a name="10165"><font size=-1>10165     </font></a><span class="string">amnipulator can indeed repeat these objects ([[objarf]] or [[objbrf]] ),</span>
<a name="10166"><font size=-1>10166     </font></a><span class="string">rotate them ([[objaro]] or [[objbro]] ) with respect to an axis ([[objaax]] or</span>
<a name="10167"><font size=-1>10167     </font></a><span class="string">[[objbax]] ), and translate them ([[objatr]] or [[objbtr]] ). After having</span>
<a name="10168"><font size=-1>10168     </font></a><span class="string">generated a geometry thanks to rotation, translation and repetition of</span>
<a name="10169"><font size=-1>10169     </font></a><span class="string">objects, it is possible to remove some atoms, in order to create vacancies</span>
<a name="10170"><font size=-1>10170     </font></a><span class="string">([[vacnum]] and [[vaclst]]). The number of atoms in the primitive set, those</span>
<a name="10171"><font size=-1>10171     </font></a><span class="string">that will be read from the input file, is specified by the variable [[natrd]].</span>
<a name="10172"><font size=-1>10172     </font></a><span class="string">It will be always smaller than the final number of atoms, given by the</span>
<a name="10173"><font size=-1>10173     </font></a><span class="string">variable [[natom]]. The code checks whether the primitive number of atoms plus</span>
<a name="10174"><font size=-1>10174     </font></a><span class="string">those obtained by the repetition operation is coherent with the variable</span>
<a name="10175"><font size=-1>10175     </font></a><span class="string">[[natom]], taking into account possible vacancies.</span>
<a name="10176"><font size=-1>10176     </font></a><span class="string">You should look at the other variables for more information.</span>
<a name="10177"><font size=-1>10177     </font></a><span class="string">Go to [[objan]], for example.</span>
<a name="10178"><font size=-1>10178     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10179"><font size=-1>10179     </font></a><span class="default">),</span>
<a name="10180"><font size=-1>10180     </font></a><span class="default"></span>
<a name="10181"><font size=-1>10181     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10182"><font size=-1>10182     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nomegasf&quot;</span><span class="default">,</span>
<a name="10183"><font size=-1>10183     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="10184"><font size=-1>10184     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10185"><font size=-1>10185     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_basic'</span><span class="default">],</span>
<a name="10186"><font size=-1>10186     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10187"><font size=-1>10187     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10188"><font size=-1>10188     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of OMEGA to evaluate the Spectral Function&quot;</span><span class="default">,</span>
<a name="10189"><font size=-1>10189     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="10190"><font size=-1>10190     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[spmeth]]!=0&quot;</span><span class="default">,</span>
<a name="10191"><font size=-1>10191     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="10192"><font size=-1>10192     </font></a><span class="string">[[nomegasf]] defines the number of real frequencies used to describe the</span>
<a name="10193"><font size=-1>10193     </font></a><span class="string">spectral function associated to the irreducible polarizability</span>
<a name="10194"><font size=-1>10194     </font></a><span class="string">$\chi^{(0)}_{KS}$. The frequency mesh will cover the interval between 0 and</span>
<a name="10195"><font size=-1>10195     </font></a><span class="string">the maximum (positive) transition energy between occupied and empty states.</span>
<a name="10196"><font size=-1>10196     </font></a><span class="string">The delta function entering the expression defining the spectral function is</span>
<a name="10197"><font size=-1>10197     </font></a><span class="string">approximated using two different methods according to the value of the</span>
<a name="10198"><font size=-1>10198     </font></a><span class="string">[[spmeth]] input variable.</span>
<a name="10199"><font size=-1>10199     </font></a><span class="string"></span>
<a name="10200"><font size=-1>10200     </font></a><span class="string">It is important to notice that an accurate description of the imaginary part</span>
<a name="10201"><font size=-1>10201     </font></a><span class="string">of $\chi^{(0)}_{KS}$ requires an extremely dense frequency mesh. It should be</span>
<a name="10202"><font size=-1>10202     </font></a><span class="string">kept in mind, however, that the memory required grows fast with the value of [[nomegasf]].</span>
<a name="10203"><font size=-1>10203     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10204"><font size=-1>10204     </font></a><span class="default">),</span>
<a name="10205"><font size=-1>10205     </font></a><span class="default"></span>
<a name="10206"><font size=-1>10206     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10207"><font size=-1>10207     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nomegasi&quot;</span><span class="default">,</span>
<a name="10208"><font size=-1>10208     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="10209"><font size=-1>10209     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10210"><font size=-1>10210     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="10211"><font size=-1>10211     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10212"><font size=-1>10212     </font></a><span class="default">    defaultval=</span><span class="number">12</span><span class="default">,</span>
<a name="10213"><font size=-1>10213     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of OMEGA(S) along the Imaginary axis&quot;</span><span class="default">,</span>
<a name="10214"><font size=-1>10214     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4 and [[gwcalctyp]] == 1&quot;</span><span class="default">,</span>
<a name="10215"><font size=-1>10215     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10216"><font size=-1>10216     </font></a><span class="string">[[nomegasi]] defines the number of frequency points used to sample the self-</span>
<a name="10217"><font size=-1>10217     </font></a><span class="string">energy along the imaginary axis. The frequency mesh is linear and covers the</span>
<a name="10218"><font size=-1>10218     </font></a><span class="string">interval between `omegasimin`=0.01 Hartree and [[omegasimax]].</span>
<a name="10219"><font size=-1>10219     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10220"><font size=-1>10220     </font></a><span class="default">),</span>
<a name="10221"><font size=-1>10221     </font></a><span class="default"></span>
<a name="10222"><font size=-1>10222     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10223"><font size=-1>10223     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nomegasrd&quot;</span><span class="default">,</span>
<a name="10224"><font size=-1>10224     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="10225"><font size=-1>10225     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10226"><font size=-1>10226     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="10227"><font size=-1>10227     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10228"><font size=-1>10228     </font></a><span class="default">    defaultval=</span><span class="number">9</span><span class="default">,</span>
<a name="10229"><font size=-1>10229     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of OMEGA to evaluate the Sigma Real axis Derivative&quot;</span><span class="default">,</span>
<a name="10230"><font size=-1>10230     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="10231"><font size=-1>10231     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10232"><font size=-1>10232     </font></a><span class="string">The number of real frequencies around the KS energy where the self-energy</span>
<a name="10233"><font size=-1>10233     </font></a><span class="string">$\Sigma$ is evaluated. From these values, the derivative of $\Sigma$ at the KS</span>
<a name="10234"><font size=-1>10234     </font></a><span class="string">energy is numerically estimated through linear interpolation.</span>
<a name="10235"><font size=-1>10235     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10236"><font size=-1>10236     </font></a><span class="default">),</span>
<a name="10237"><font size=-1>10237     </font></a><span class="default"></span>
<a name="10238"><font size=-1>10238     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10239"><font size=-1>10239     </font></a><span class="default">    abivarname=</span><span class="string">&quot;normpawu&quot;</span><span class="default">,</span>
<a name="10240"><font size=-1>10240     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="10241"><font size=-1>10241     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10242"><font size=-1>10242     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="10243"><font size=-1>10243     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="10244"><font size=-1>10244     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10245"><font size=-1>10245     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;NORMalize atomic PAW+U projector&quot;</span><span class="default">,</span>
<a name="10246"><font size=-1>10246     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="10247"><font size=-1>10247     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10248"><font size=-1>10248     </font></a><span class="string">Defines whether the atomic wave function (used as projectors in PAW+U) should</span>
<a name="10249"><font size=-1>10249     </font></a><span class="string">be renormalized to 1 within PAW sphere.</span>
<a name="10250"><font size=-1>10250     </font></a><span class="string"></span>
<a name="10251"><font size=-1>10251     </font></a><span class="string">  * [[normpawu]] = 0: leave projector</span>
<a name="10252"><font size=-1>10252     </font></a><span class="string">  * [[normpawu]] = 1: renormalize</span>
<a name="10253"><font size=-1>10253     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10254"><font size=-1>10254     </font></a><span class="default">),</span>
<a name="10255"><font size=-1>10255     </font></a><span class="default"></span>
<a name="10256"><font size=-1>10256     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10257"><font size=-1>10257     </font></a><span class="default">    abivarname=</span><span class="string">&quot;noseinert&quot;</span><span class="default">,</span>
<a name="10258"><font size=-1>10258     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="10259"><font size=-1>10259     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="10260"><font size=-1>10260     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_useful'</span><span class="default">],</span>
<a name="10261"><font size=-1>10261     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10262"><font size=-1>10262     </font></a><span class="default">    defaultval=</span><span class="number">100000</span><span class="default">,</span>
<a name="10263"><font size=-1>10263     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;NOSE thermostat INERTia factor&quot;</span><span class="default">,</span>
<a name="10264"><font size=-1>10264     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ionmov]] == 8&quot;</span><span class="default">,</span>
<a name="10265"><font size=-1>10265     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10266"><font size=-1>10266     </font></a><span class="string">Give the inertia factor WT of the Nose-Hoover thermostat (when [[ionmov]] = 8),</span>
<a name="10267"><font size=-1>10267     </font></a><span class="string">in atomic units of weight*length2, that is (electron mass)*(Bohr)2. The</span>
<a name="10268"><font size=-1>10268     </font></a><span class="string">equations of motion are: MI d2RI/dt2= FI - dX/dt MI dRI/dt and WT d2X/dt2=</span>
<a name="10269"><font size=-1>10269     </font></a><span class="string">Sum(I) MI (dRI/dt)2 - 3NkBT where I represent each nucleus, MI is the mass of</span>
<a name="10270"><font size=-1>10270     </font></a><span class="string">each nucleus (see [[amu]]), RI is the coordinate of each nucleus (see</span>
<a name="10271"><font size=-1>10271     </font></a><span class="string">[[xcart]]), dX/dt is a dynamical friction coefficient, and T is the</span>
<a name="10272"><font size=-1>10272     </font></a><span class="string">temperature of the thermostat (see [[mdtemp]]).</span>
<a name="10273"><font size=-1>10273     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10274"><font size=-1>10274     </font></a><span class="default">),</span>
<a name="10275"><font size=-1>10275     </font></a><span class="default"></span>
<a name="10276"><font size=-1>10276     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10277"><font size=-1>10277     </font></a><span class="default">    abivarname=</span><span class="string">&quot;np_slk&quot;</span><span class="default">,</span>
<a name="10278"><font size=-1>10278     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10279"><font size=-1>10279     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10280"><font size=-1>10280     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="10281"><font size=-1>10281     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10282"><font size=-1>10282     </font></a><span class="default">    defaultval=</span><span class="number">1000000</span><span class="default">,</span>
<a name="10283"><font size=-1>10283     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of mpi Processors used for ScaLapacK calls&quot;</span><span class="default">,</span>
<a name="10284"><font size=-1>10284     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="10285"><font size=-1>10285     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 1 and [[paral_kgb]] == 1 (Ground-state calculations with LOBPCG algorithm)&quot;</span><span class="default">,</span>
<a name="10286"><font size=-1>10286     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10287"><font size=-1>10287     </font></a><span class="string">When using Scalapack (or any similar Matrix Algebra library), the efficiency</span>
<a name="10288"><font size=-1>10288     </font></a><span class="string">of the eigenproblem resolution saturates as the number of CPU cores increases.</span>
<a name="10289"><font size=-1>10289     </font></a><span class="string">It is better to use a smaller number of CPU cores for the LINALG calls.</span>
<a name="10290"><font size=-1>10290     </font></a><span class="string">This maximum number of cores can be set with [[np_slk]].</span>
<a name="10291"><font size=-1>10291     </font></a><span class="string">A large number for [[np_slk]] (i.e. 1000000) means that all cores are used for</span>
<a name="10292"><font size=-1>10292     </font></a><span class="string">the Linear Algebra calls.</span>
<a name="10293"><font size=-1>10293     </font></a><span class="string">np_slk must divide the number of processors involved in diagonalizations</span>
<a name="10294"><font size=-1>10294     </font></a><span class="string">([[npband]] $\\times$ [[npfft]] $\\times$ [[npspinor]]).</span>
<a name="10295"><font size=-1>10295     </font></a><span class="string">Note (bef v8.8): an optimal value for this parameter can be automatically found by using</span>
<a name="10296"><font size=-1>10296     </font></a><span class="string">the [[autoparal]] input keyword.</span>
<a name="10297"><font size=-1>10297     </font></a><span class="string">Note (since v8.8 and only for LOBPCG ([[wfoptalg]] == 114) with [[paral_kgb]] = 1):</span>
<a name="10298"><font size=-1>10298     </font></a><span class="string">* If set to ***0*** then scalapack is disabled.</span>
<a name="10299"><font size=-1>10299     </font></a><span class="string">* If set to its ***default value***, then abinit uses between 2 and [[npband]]*[[npfft]]*[[npspinor]] cpus according to the system size (default auto behaviour).</span>
<a name="10300"><font size=-1>10300     </font></a><span class="string">  See [[slk_rankpp]] for more customization.</span>
<a name="10301"><font size=-1>10301     </font></a><span class="string">* If set to a number ***&gt;1** then forces abinit to use exactly this number of cpus.</span>
<a name="10302"><font size=-1>10302     </font></a><span class="string">  Due to legacy behaviour, although it is not mandatory in theory, this value *must* divide [[npband]]*[[npfft]]*[[npspinor]].</span>
<a name="10303"><font size=-1>10303     </font></a><span class="string">See also [[slk_rankpp]] for a better tuning instead of this variable.</span>
<a name="10304"><font size=-1>10304     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10305"><font size=-1>10305     </font></a><span class="default">),</span>
<a name="10306"><font size=-1>10306     </font></a><span class="default"></span>
<a name="10307"><font size=-1>10307     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10308"><font size=-1>10308     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npband&quot;</span><span class="default">,</span>
<a name="10309"><font size=-1>10309     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10310"><font size=-1>10310     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10311"><font size=-1>10311     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="10312"><font size=-1>10312     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10313"><font size=-1>10313     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10314"><font size=-1>10314     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Processors at the BAND level&quot;</span><span class="default">,</span>
<a name="10315"><font size=-1>10315     </font></a><span class="default">    requires=</span><span class="string">&quot;[[paral_kgb]] == 1&quot;</span><span class="default">,</span>
<a name="10316"><font size=-1>10316     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10317"><font size=-1>10317     </font></a><span class="string">Relevant only for the band/FFT parallelisation (see the [[paral_kgb]] input</span>
<a name="10318"><font size=-1>10318     </font></a><span class="string">variable).</span>
<a name="10319"><font size=-1>10319     </font></a><span class="string">[[npband]] gives the number of processors among which the work load over the</span>
<a name="10320"><font size=-1>10320     </font></a><span class="string">band level is shared. [[npband]], [[npfft]], [[npkpt]] and [[npspinor]] are</span>
<a name="10321"><font size=-1>10321     </font></a><span class="string">combined to give the total number of processors (nproc) working on the</span>
<a name="10322"><font size=-1>10322     </font></a><span class="string">band/FFT/k-point parallelisation.</span>
<a name="10323"><font size=-1>10323     </font></a><span class="string">See [[npfft]], [[npkpt]], [[npspinor]] and [[paral_kgb]] for the additional</span>
<a name="10324"><font size=-1>10324     </font></a><span class="string">information on the use of band/FFT/k-point parallelisation. [[npband]] has to</span>
<a name="10325"><font size=-1>10325     </font></a><span class="string">be a divisor or equal to [[nband]]</span>
<a name="10326"><font size=-1>10326     </font></a><span class="string">Note: an optimal value for this parameter can be automatically found by using</span>
<a name="10327"><font size=-1>10327     </font></a><span class="string">the [[autoparal]] input keyword.</span>
<a name="10328"><font size=-1>10328     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10329"><font size=-1>10329     </font></a><span class="default">),</span>
<a name="10330"><font size=-1>10330     </font></a><span class="default"></span>
<a name="10331"><font size=-1>10331     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10332"><font size=-1>10332     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npfft&quot;</span><span class="default">,</span>
<a name="10333"><font size=-1>10333     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10334"><font size=-1>10334     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10335"><font size=-1>10335     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="10336"><font size=-1>10336     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10337"><font size=-1>10337     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10338"><font size=-1>10338     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Processors at the FFT level&quot;</span><span class="default">,</span>
<a name="10339"><font size=-1>10339     </font></a><span class="default">    requires=</span><span class="string">&quot;[[paral_kgb]] == 1&quot;</span><span class="default">,</span>
<a name="10340"><font size=-1>10340     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10341"><font size=-1>10341     </font></a><span class="string">Relevant only for the band/FFT/k-point parallelisation (see the [[paral_kgb]]</span>
<a name="10342"><font size=-1>10342     </font></a><span class="string">input variable).</span>
<a name="10343"><font size=-1>10343     </font></a><span class="string">[[npfft]] gives the number of processors among which the work load over the</span>
<a name="10344"><font size=-1>10344     </font></a><span class="string">FFT level is shared. [[npfft]], [[npkpt]], [[npband]] and [[npspinor]] are</span>
<a name="10345"><font size=-1>10345     </font></a><span class="string">combined to give the total number of processors (nproc) working on the</span>
<a name="10346"><font size=-1>10346     </font></a><span class="string">band/FFT/k-point parallelisation.</span>
<a name="10347"><font size=-1>10347     </font></a><span class="string">See [[npband]], [[npkpt]], [[npspinor]], and [[paral_kgb]] for the additional</span>
<a name="10348"><font size=-1>10348     </font></a><span class="string">information on the use of band/FFT/k-point parallelisation.</span>
<a name="10349"><font size=-1>10349     </font></a><span class="string"></span>
<a name="10350"><font size=-1>10350     </font></a><span class="string">Note: [[ngfft]] is automatically adjusted to [[npfft]]. If the number of</span>
<a name="10351"><font size=-1>10351     </font></a><span class="string">processor is changed from a calculation to another one, [[npfft]] may change,</span>
<a name="10352"><font size=-1>10352     </font></a><span class="string">and then [[ngfft]] also.</span>
<a name="10353"><font size=-1>10353     </font></a><span class="string">Note: an optimal value for this parameter can be automatically found by using</span>
<a name="10354"><font size=-1>10354     </font></a><span class="string">the [[autoparal]] input keyword.</span>
<a name="10355"><font size=-1>10355     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10356"><font size=-1>10356     </font></a><span class="default">),</span>
<a name="10357"><font size=-1>10357     </font></a><span class="default"></span>
<a name="10358"><font size=-1>10358     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10359"><font size=-1>10359     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nphf&quot;</span><span class="default">,</span>
<a name="10360"><font size=-1>10360     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10361"><font size=-1>10361     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10362"><font size=-1>10362     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_useful'</span><span class="default">, </span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="10363"><font size=-1>10363     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10364"><font size=-1>10364     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10365"><font size=-1>10365     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Processors for (Hartree)-Fock exact exchange&quot;</span><span class="default">,</span>
<a name="10366"><font size=-1>10366     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10367"><font size=-1>10367     </font></a><span class="string">Relevant only for the k-point/fock parallelisation (option [[paral_kgb]] input</span>
<a name="10368"><font size=-1>10368     </font></a><span class="string">variable).</span>
<a name="10369"><font size=-1>10369     </font></a><span class="string">[[nphf]] gives the number of processors among which the work load over the</span>
<a name="10370"><font size=-1>10370     </font></a><span class="string">occupied states level is shared. [[nphf]] and [[npkpt]] are combined to give</span>
<a name="10371"><font size=-1>10371     </font></a><span class="string">the total number of processors (nproc) working on the parallelisation.</span>
<a name="10372"><font size=-1>10372     </font></a><span class="string"></span>
<a name="10373"><font size=-1>10373     </font></a><span class="string">Note: [[nphf]] should be a divisor or equal to the number of k-point times</span>
<a name="10374"><font size=-1>10374     </font></a><span class="string">the number of bands for exact exchange ([[nkpthf]] $\\times$ [[nbandhf]]) in order to</span>
<a name="10375"><font size=-1>10375     </font></a><span class="string">have the better load-balancing and efficiency.</span>
<a name="10376"><font size=-1>10376     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10377"><font size=-1>10377     </font></a><span class="default">),</span>
<a name="10378"><font size=-1>10378     </font></a><span class="default"></span>
<a name="10379"><font size=-1>10379     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10380"><font size=-1>10380     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npimage&quot;</span><span class="default">,</span>
<a name="10381"><font size=-1>10381     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10382"><font size=-1>10382     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10383"><font size=-1>10383     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">, </span><span class="string">'PIMD_useful'</span><span class="default">, </span><span class="string">'TransPath_useful'</span><span class="default">],</span>
<a name="10384"><font size=-1>10384     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10385"><font size=-1>10385     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10386"><font size=-1>10386     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Processors at the IMAGE level&quot;</span><span class="default">,</span>
<a name="10387"><font size=-1>10387     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10388"><font size=-1>10388     </font></a><span class="string">Relevant only when sets of images are activated (see [[imgmov]] and [[nimage]]</span>
<a name="10389"><font size=-1>10389     </font></a><span class="string">).</span>
<a name="10390"><font size=-1>10390     </font></a><span class="string">[[npimage]] gives the number of processors among which the work load over the</span>
<a name="10391"><font size=-1>10391     </font></a><span class="string">image level is shared. It is compatible with all other parallelization levels</span>
<a name="10392"><font size=-1>10392     </font></a><span class="string">available for ground-state calculations.</span>
<a name="10393"><font size=-1>10393     </font></a><span class="string">Note: an optimal value for this parameter can be automatically found by using</span>
<a name="10394"><font size=-1>10394     </font></a><span class="string">the [[autoparal]] input keyword.</span>
<a name="10395"><font size=-1>10395     </font></a><span class="string"></span>
<a name="10396"><font size=-1>10396     </font></a><span class="string">_See [[paral_kgb]], [[npkpt]], [[npband]], [[npfft]] and [[npspinor]] for the</span>
<a name="10397"><font size=-1>10397     </font></a><span class="string">additional information on the use of k-point/band/FFT parallelisation._</span>
<a name="10398"><font size=-1>10398     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10399"><font size=-1>10399     </font></a><span class="default">),</span>
<a name="10400"><font size=-1>10400     </font></a><span class="default"></span>
<a name="10401"><font size=-1>10401     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10402"><font size=-1>10402     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npkpt&quot;</span><span class="default">,</span>
<a name="10403"><font size=-1>10403     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10404"><font size=-1>10404     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10405"><font size=-1>10405     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="10406"><font size=-1>10406     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10407"><font size=-1>10407     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10408"><font size=-1>10408     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Processors at the K-Point Level&quot;</span><span class="default">,</span>
<a name="10409"><font size=-1>10409     </font></a><span class="default">    requires=</span><span class="string">&quot;[[paral_kgb]] == 1&quot;</span><span class="default">,</span>
<a name="10410"><font size=-1>10410     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10411"><font size=-1>10411     </font></a><span class="string">Relevant only for the band/FFT/k-point parallelisation (see the [[paral_kgb]]</span>
<a name="10412"><font size=-1>10412     </font></a><span class="string">input variable).</span>
<a name="10413"><font size=-1>10413     </font></a><span class="string">[[npkpt]] gives the number of processors among which the work load over the</span>
<a name="10414"><font size=-1>10414     </font></a><span class="string">k-point/spin-component level is shared. [[npkpt]], [[npfft]], [[npband]] and</span>
<a name="10415"><font size=-1>10415     </font></a><span class="string">[[npspinor]] are combined to give the total number of processors (nproc)</span>
<a name="10416"><font size=-1>10416     </font></a><span class="string">working on the band/FFT/k-point parallelisation.</span>
<a name="10417"><font size=-1>10417     </font></a><span class="string">See [[npband]], [[npfft]], [[npspinor]] and [[paral_kgb]] for the additional</span>
<a name="10418"><font size=-1>10418     </font></a><span class="string">information on the use of band/FFT/k-point parallelisation.</span>
<a name="10419"><font size=-1>10419     </font></a><span class="string"></span>
<a name="10420"><font size=-1>10420     </font></a><span class="string">[[npkpt]] should be a divisor or equal to with the number of k-point/spin-</span>
<a name="10421"><font size=-1>10421     </font></a><span class="string">components ([[nkpt]] $\\times$ [[nsppol]]) in order to have the better load-balancing</span>
<a name="10422"><font size=-1>10422     </font></a><span class="string">and efficiency.</span>
<a name="10423"><font size=-1>10423     </font></a><span class="string">Note: an optimal value for this parameter can be automatically found by using</span>
<a name="10424"><font size=-1>10424     </font></a><span class="string">the [[autoparal]] input keyword.</span>
<a name="10425"><font size=-1>10425     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10426"><font size=-1>10426     </font></a><span class="default">),</span>
<a name="10427"><font size=-1>10427     </font></a><span class="default"></span>
<a name="10428"><font size=-1>10428     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10429"><font size=-1>10429     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nppert&quot;</span><span class="default">,</span>
<a name="10430"><font size=-1>10430     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10431"><font size=-1>10431     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10432"><font size=-1>10432     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="10433"><font size=-1>10433     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10434"><font size=-1>10434     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10435"><font size=-1>10435     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Processors at the PERTurbation level&quot;</span><span class="default">,</span>
<a name="10436"><font size=-1>10436     </font></a><span class="default">    requires=</span><span class="string">&quot;[[paral_rf]] == 1&quot;</span><span class="default">,</span>
<a name="10437"><font size=-1>10437     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10438"><font size=-1>10438     </font></a><span class="string">This parameter is used in connection to the parallelization over</span>
<a name="10439"><font size=-1>10439     </font></a><span class="string">perturbations (see [[paral_rf]] ), for a linear response calculation.</span>
<a name="10440"><font size=-1>10440     </font></a><span class="string">[[nppert]] gives the number of processors among which the work load over the</span>
<a name="10441"><font size=-1>10441     </font></a><span class="string">perturbation level is shared. It can even be specified separately for each</span>
<a name="10442"><font size=-1>10442     </font></a><span class="string">dataset.</span>
<a name="10443"><font size=-1>10443     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10444"><font size=-1>10444     </font></a><span class="default">),</span>
<a name="10445"><font size=-1>10445     </font></a><span class="default"></span>
<a name="10446"><font size=-1>10446     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10447"><font size=-1>10447     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npsp&quot;</span><span class="default">,</span>
<a name="10448"><font size=-1>10448     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10449"><font size=-1>10449     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10450"><font size=-1>10450     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_useful'</span><span class="default">, </span><span class="string">'PseudosPAW_expert'</span><span class="default">],</span>
<a name="10451"><font size=-1>10451     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10452"><font size=-1>10452     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[ntypat]]&quot;</span><span class="default">,</span>
<a name="10453"><font size=-1>10453     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of PSeudoPotentials&quot;</span><span class="default">,</span>
<a name="10454"><font size=-1>10454     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="10455"><font size=-1>10455     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10456"><font size=-1>10456     </font></a><span class="string">Usually, the number of pseudopotentials to be read is equal to the number of</span>
<a name="10457"><font size=-1>10457     </font></a><span class="string">type of atoms. However, in the case an alchemical mixing of pseudopotential is</span>
<a name="10458"><font size=-1>10458     </font></a><span class="string">to be used, often the number of pseudopotentials to be read will not equal the</span>
<a name="10459"><font size=-1>10459     </font></a><span class="string">number of types of atoms.</span>
<a name="10460"><font size=-1>10460     </font></a><span class="string"></span>
<a name="10461"><font size=-1>10461     </font></a><span class="string">Alchemical pseudopotentials will be present when [[ntypalch]] is non-zero. See</span>
<a name="10462"><font size=-1>10462     </font></a><span class="string">[[ntypalch]] to understand how to use alchemical potentials in ABINIT. The</span>
<a name="10463"><font size=-1>10463     </font></a><span class="string">input variables ([[ntypalch]], [[algalch]], [[mixalch]]) are active, and</span>
<a name="10464"><font size=-1>10464     </font></a><span class="string">generate alchemical potentials from the available pseudopotentials. Also, the</span>
<a name="10465"><font size=-1>10465     </font></a><span class="string">inner variables ([[ntyppure]], [[npspalch]]) become active. See these input</span>
<a name="10466"><font size=-1>10466     </font></a><span class="string">variables, especially [[mixalch]], to understand how to use alchemical</span>
<a name="10467"><font size=-1>10467     </font></a><span class="string">potentials in ABINIT.</span>
<a name="10468"><font size=-1>10468     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10469"><font size=-1>10469     </font></a><span class="default">),</span>
<a name="10470"><font size=-1>10470     </font></a><span class="default"></span>
<a name="10471"><font size=-1>10471     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10472"><font size=-1>10472     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npspalch&quot;</span><span class="default">,</span>
<a name="10473"><font size=-1>10473     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10474"><font size=-1>10474     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10475"><font size=-1>10475     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_internal'</span><span class="default">],</span>
<a name="10476"><font size=-1>10476     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10477"><font size=-1>10477     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[npsp]]-[[ntyppure]]&quot;</span><span class="default">,</span>
<a name="10478"><font size=-1>10478     </font></a><span class="default">    mnemonics=</span><span class="string">'Number of PSeudoPotentials that are &quot;ALCHemical&quot;'</span><span class="default">,</span>
<a name="10479"><font size=-1>10479     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="10480"><font size=-1>10480     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ntypalch]]/=0&quot;</span><span class="default">,</span>
<a name="10481"><font size=-1>10481     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10482"><font size=-1>10482     </font></a><span class="string">Gives the number of pseudopotentials that are used for alchemical mixing (when</span>
<a name="10483"><font size=-1>10483     </font></a><span class="string">[[ntypalch]] is non-zero):</span>
<a name="10484"><font size=-1>10484     </font></a><span class="string"></span>
<a name="10485"><font size=-1>10485     </font></a><span class="string">[[npspalch]] = [[npsp]]-[[ntyppure]]</span>
<a name="10486"><font size=-1>10486     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10487"><font size=-1>10487     </font></a><span class="default">),</span>
<a name="10488"><font size=-1>10488     </font></a><span class="default"></span>
<a name="10489"><font size=-1>10489     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10490"><font size=-1>10490     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npspinor&quot;</span><span class="default">,</span>
<a name="10491"><font size=-1>10491     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="10492"><font size=-1>10492     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10493"><font size=-1>10493     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_useful'</span><span class="default">],</span>
<a name="10494"><font size=-1>10494     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10495"><font size=-1>10495     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10496"><font size=-1>10496     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Processors at the SPINOR level&quot;</span><span class="default">,</span>
<a name="10497"><font size=-1>10497     </font></a><span class="default">    requires=</span><span class="string">&quot;[[paral_kgb]] == 1&quot;</span><span class="default">,</span>
<a name="10498"><font size=-1>10498     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10499"><font size=-1>10499     </font></a><span class="string">Can be 1 or 2 (if [[nspinor]] = 2).</span>
<a name="10500"><font size=-1>10500     </font></a><span class="string">Relevant only for the band/FFT/k-point parallelisation (see the [[paral_kgb]]</span>
<a name="10501"><font size=-1>10501     </font></a><span class="string">input variable).</span>
<a name="10502"><font size=-1>10502     </font></a><span class="string">[[npspinor]] gives the number of processors among which the work load over the</span>
<a name="10503"><font size=-1>10503     </font></a><span class="string">spinorial components of wave-functions is shared. [[npspinor]], [[npfft]],</span>
<a name="10504"><font size=-1>10504     </font></a><span class="string">[[npband]] and [[npkpt]] are combined to give the total number of processors</span>
<a name="10505"><font size=-1>10505     </font></a><span class="string">(nproc) working on the band/FFT/k-point parallelisation.</span>
<a name="10506"><font size=-1>10506     </font></a><span class="string">Note: an optimal value for this parameter can be automatically found by using</span>
<a name="10507"><font size=-1>10507     </font></a><span class="string">the [[autoparal]] input keyword.</span>
<a name="10508"><font size=-1>10508     </font></a><span class="string"></span>
<a name="10509"><font size=-1>10509     </font></a><span class="string">_See [[npkpt]], [[npband]], [[npfft]], and [[paral_kgb]] for the additional</span>
<a name="10510"><font size=-1>10510     </font></a><span class="string">information on the use of band/FFT/k-point parallelisation._</span>
<a name="10511"><font size=-1>10511     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10512"><font size=-1>10512     </font></a><span class="default">),</span>
<a name="10513"><font size=-1>10513     </font></a><span class="default"></span>
<a name="10514"><font size=-1>10514     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10515"><font size=-1>10515     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npulayit&quot;</span><span class="default">,</span>
<a name="10516"><font size=-1>10516     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="10517"><font size=-1>10517     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10518"><font size=-1>10518     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_useful'</span><span class="default">],</span>
<a name="10519"><font size=-1>10519     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10520"><font size=-1>10520     </font></a><span class="default">    defaultval=</span><span class="number">7</span><span class="default">,</span>
<a name="10521"><font size=-1>10521     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of PULAY ITerations for SC mixing&quot;</span><span class="default">,</span>
<a name="10522"><font size=-1>10522     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="10523"><font size=-1>10523     </font></a><span class="default">    requires=</span><span class="string">&quot;[[iscf]] in [7,17]&quot;</span><span class="default">,</span>
<a name="10524"><font size=-1>10524     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10525"><font size=-1>10525     </font></a><span class="string">Gives the number of previous iterations involved in Pulay mixing (mixing</span>
<a name="10526"><font size=-1>10526     </font></a><span class="string">during electronic SC iterations).</span>
<a name="10527"><font size=-1>10527     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10528"><font size=-1>10528     </font></a><span class="default">),</span>
<a name="10529"><font size=-1>10529     </font></a><span class="default"></span>
<a name="10530"><font size=-1>10530     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10531"><font size=-1>10531     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npvel&quot;</span><span class="default">,</span>
<a name="10532"><font size=-1>10532     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="10533"><font size=-1>10533     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10534"><font size=-1>10534     </font></a><span class="default">    topics=[</span><span class="string">'RandStopPow_compulsory'</span><span class="default">],</span>
<a name="10535"><font size=-1>10535     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10536"><font size=-1>10536     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10537"><font size=-1>10537     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Particle VELocities&quot;</span><span class="default">,</span>
<a name="10538"><font size=-1>10538     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3&quot;</span><span class="default">,</span>
<a name="10539"><font size=-1>10539     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10540"><font size=-1>10540     </font></a><span class="string">In the context of the electronic stopping power of impinging ion in matter,</span>
<a name="10541"><font size=-1>10541     </font></a><span class="string">[[npvel]] sets the number of the ion velocities to be calculated via linear response.</span>
<a name="10542"><font size=-1>10542     </font></a><span class="string">When [[npvel]] = 0, no stopping power calculation is performed.</span>
<a name="10543"><font size=-1>10543     </font></a><span class="string">The direction and the velocity maximum are set with the input variable</span>
<a name="10544"><font size=-1>10544     </font></a><span class="string">[[pvelmax]]. Note that the results are output for a $Z=1$ impinging ion, i.e. a proton.</span>
<a name="10545"><font size=-1>10545     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10546"><font size=-1>10546     </font></a><span class="default">),</span>
<a name="10547"><font size=-1>10547     </font></a><span class="default"></span>
<a name="10548"><font size=-1>10548     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10549"><font size=-1>10549     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npweps&quot;</span><span class="default">,</span>
<a name="10550"><font size=-1>10550     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="10551"><font size=-1>10551     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10552"><font size=-1>10552     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_internal'</span><span class="default">],</span>
<a name="10553"><font size=-1>10553     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10554"><font size=-1>10554     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of PlaneWaves for EPSilon (the dielectric matrix)&quot;</span><span class="default">,</span>
<a name="10555"><font size=-1>10555     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="10556"><font size=-1>10556     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="10557"><font size=-1>10557     </font></a><span class="string">[[npweps]] determines the size of the planewave set used to represent the</span>
<a name="10558"><font size=-1>10558     </font></a><span class="string">independent-particle susceptibility $\chi^{(0)}_{KS}$, the dielectric matrix</span>
<a name="10559"><font size=-1>10559     </font></a><span class="string">$\epsilon$ and its inverse.</span>
<a name="10560"><font size=-1>10560     </font></a><span class="string">It is an internal variable, determined from [[ecuteps]].</span>
<a name="10561"><font size=-1>10561     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10562"><font size=-1>10562     </font></a><span class="default">),</span>
<a name="10563"><font size=-1>10563     </font></a><span class="default"></span>
<a name="10564"><font size=-1>10564     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10565"><font size=-1>10565     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npwkss&quot;</span><span class="default">,</span>
<a name="10566"><font size=-1>10566     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="10567"><font size=-1>10567     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10568"><font size=-1>10568     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="10569"><font size=-1>10569     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10570"><font size=-1>10570     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10571"><font size=-1>10571     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of PlaneWaves in the KSS file&quot;</span><span class="default">,</span>
<a name="10572"><font size=-1>10572     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10573"><font size=-1>10573     </font></a><span class="string">This input variable is used for the preparation of a GW calculation: the GS</span>
<a name="10574"><font size=-1>10574     </font></a><span class="string">run (where [[optdriver]] = 1 and [[nbandkss]]/=0) should be followed with a run</span>
<a name="10575"><font size=-1>10575     </font></a><span class="string">where [[optdriver]] = 3. Also, if [[nbandkss]] = 0, no use of [[npwkss]].</span>
<a name="10576"><font size=-1>10576     </font></a><span class="string"></span>
<a name="10577"><font size=-1>10577     </font></a><span class="string">[[npwkss]] defines the number of planewave components of the Kohn-Sham states</span>
<a name="10578"><font size=-1>10578     </font></a><span class="string">to build the Hamiltonian, in the routine outkss.F90, and so, the size of the</span>
<a name="10579"><font size=-1>10579     </font></a><span class="string">matrix, the size of eigenvectors, and the number of available states, to be</span>
<a name="10580"><font size=-1>10580     </font></a><span class="string">stored in the abo_KSS file. If it is set to 0, then, the planewave basis set</span>
<a name="10581"><font size=-1>10581     </font></a><span class="string">defined by the usual Ground State input variable [[ecut]] is used to generate</span>
<a name="10582"><font size=-1>10582     </font></a><span class="string">the superset of all planewaves used for all k points. Note that this (large)</span>
<a name="10583"><font size=-1>10583     </font></a><span class="string">planewave basis is the same for all k points.</span>
<a name="10584"><font size=-1>10584     </font></a><span class="string"></span>
<a name="10585"><font size=-1>10585     </font></a><span class="string">!!! warning</span>
<a name="10586"><font size=-1>10586     </font></a><span class="string"></span>
<a name="10587"><font size=-1>10587     </font></a><span class="string">    For the time being, [[istwfk]] must be 1 for all the k points.</span>
<a name="10588"><font size=-1>10588     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10589"><font size=-1>10589     </font></a><span class="default">),</span>
<a name="10590"><font size=-1>10590     </font></a><span class="default"></span>
<a name="10591"><font size=-1>10591     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10592"><font size=-1>10592     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npwsigx&quot;</span><span class="default">,</span>
<a name="10593"><font size=-1>10593     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="10594"><font size=-1>10594     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10595"><font size=-1>10595     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_internal'</span><span class="default">],</span>
<a name="10596"><font size=-1>10596     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10597"><font size=-1>10597     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of PlaneWaves for SIGma eXchange&quot;</span><span class="default">,</span>
<a name="10598"><font size=-1>10598     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="10599"><font size=-1>10599     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10600"><font size=-1>10600     </font></a><span class="string">[[npwsigx]] determines the cut-off energy of the planewave set used to</span>
<a name="10601"><font size=-1>10601     </font></a><span class="string">generate the exchange part of the self-energy operator.</span>
<a name="10602"><font size=-1>10602     </font></a><span class="string">It is an internal variable, determined from [[ecutsigx]].</span>
<a name="10603"><font size=-1>10603     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10604"><font size=-1>10604     </font></a><span class="default">),</span>
<a name="10605"><font size=-1>10605     </font></a><span class="default"></span>
<a name="10606"><font size=-1>10606     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10607"><font size=-1>10607     </font></a><span class="default">    abivarname=</span><span class="string">&quot;npwwfn&quot;</span><span class="default">,</span>
<a name="10608"><font size=-1>10608     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="10609"><font size=-1>10609     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10610"><font size=-1>10610     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_internal'</span><span class="default">, </span><span class="string">'SelfEnergy_internal'</span><span class="default">],</span>
<a name="10611"><font size=-1>10611     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10612"><font size=-1>10612     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of PlaneWaves for WaveFunctioNs&quot;</span><span class="default">,</span>
<a name="10613"><font size=-1>10613     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="10614"><font size=-1>10614     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="10615"><font size=-1>10615     </font></a><span class="string">[[npwwfn]] is the size of the planewave set used to represent the</span>
<a name="10616"><font size=-1>10616     </font></a><span class="string">wavefunctions in the formula that generates the independent-particle</span>
<a name="10617"><font size=-1>10617     </font></a><span class="string">susceptibility $\chi^{(0)}_{KS}$. It is an internal variable, determined from [[ecutwfn]].</span>
<a name="10618"><font size=-1>10618     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10619"><font size=-1>10619     </font></a><span class="default">),</span>
<a name="10620"><font size=-1>10620     </font></a><span class="default"></span>
<a name="10621"><font size=-1>10621     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10622"><font size=-1>10622     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nqpt&quot;</span><span class="default">,</span>
<a name="10623"><font size=-1>10623     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10624"><font size=-1>10624     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10625"><font size=-1>10625     </font></a><span class="default">    topics=[</span><span class="string">'q-points_basic'</span><span class="default">],</span>
<a name="10626"><font size=-1>10626     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10627"><font size=-1>10627     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10628"><font size=-1>10628     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Q - POINTs&quot;</span><span class="default">,</span>
<a name="10629"><font size=-1>10629     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10630"><font size=-1>10630     </font></a><span class="string">Determines whether one q point must be read (See the variable [[qptn]]).</span>
<a name="10631"><font size=-1>10631     </font></a><span class="string">Can be either 0 or 1.</span>
<a name="10632"><font size=-1>10632     </font></a><span class="string"></span>
<a name="10633"><font size=-1>10633     </font></a><span class="string">If 1 and used in ground-state calculation, a global shift of all the k-points</span>
<a name="10634"><font size=-1>10634     </font></a><span class="string">is applied, to give calculation at k+q. In this case, the output wavefunction</span>
<a name="10635"><font size=-1>10635     </font></a><span class="string">will be appended by _WFQ instead of _WFK</span>
<a name="10636"><font size=-1>10636     </font></a><span class="string">Also, if 1 and a RF calculation is done, defines the wavevector of the perturbation.</span>
<a name="10637"><font size=-1>10637     </font></a><span class="string"></span>
<a name="10638"><font size=-1>10638     </font></a><span class="string">For further information about the *files file*, consult the [[help:abinit#files-file]].</span>
<a name="10639"><font size=-1>10639     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10640"><font size=-1>10640     </font></a><span class="default">),</span>
<a name="10641"><font size=-1>10641     </font></a><span class="default"></span>
<a name="10642"><font size=-1>10642     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10643"><font size=-1>10643     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nqptdm&quot;</span><span class="default">,</span>
<a name="10644"><font size=-1>10644     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="10645"><font size=-1>10645     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10646"><font size=-1>10646     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_useful'</span><span class="default">],</span>
<a name="10647"><font size=-1>10647     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10648"><font size=-1>10648     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10649"><font size=-1>10649     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Q-PoinTs for the Dielectric Matrix&quot;</span><span class="default">,</span>
<a name="10650"><font size=-1>10650     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3&quot;</span><span class="default">,</span>
<a name="10651"><font size=-1>10651     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10652"><font size=-1>10652     </font></a><span class="string">If [[nqptdm]] is equal to 0, the set of q points for computing the dielectric</span>
<a name="10653"><font size=-1>10653     </font></a><span class="string">matrix is determined automatically considering all the possible differences</span>
<a name="10654"><font size=-1>10654     </font></a><span class="string">between the k-points contained in the _KSS file. When [[nqptdm]] is non-zero,</span>
<a name="10655"><font size=-1>10655     </font></a><span class="string">the list of q points is read from [[qptdm]]. This allows one to split the big</span>
<a name="10656"><font size=-1>10656     </font></a><span class="string">calculation of all the dielectric matrices into smaller calculations that can</span>
<a name="10657"><font size=-1>10657     </font></a><span class="string">be performed independently. The _SCR files generated in different runs can be</span>
<a name="10658"><font size=-1>10658     </font></a><span class="string">merged thanks to the **Mrgscr** utility. If [[nqptdm]] is equal to -1, the</span>
<a name="10659"><font size=-1>10659     </font></a><span class="string">code reports the list of q-points in the log file (YAML format) and then stops.</span>
<a name="10660"><font size=-1>10660     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10661"><font size=-1>10661     </font></a><span class="default">),</span>
<a name="10662"><font size=-1>10662     </font></a><span class="default"></span>
<a name="10663"><font size=-1>10663     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10664"><font size=-1>10664     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nscforder&quot;</span><span class="default">,</span>
<a name="10665"><font size=-1>10665     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="10666"><font size=-1>10666     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10667"><font size=-1>10667     </font></a><span class="default">    topics=[</span><span class="string">'Coulomb_expert'</span><span class="default">],</span>
<a name="10668"><font size=-1>10668     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10669"><font size=-1>10669     </font></a><span class="default">    defaultval=</span><span class="number">16</span><span class="default">,</span>
<a name="10670"><font size=-1>10670     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Nth - SCaling Function ORDER&quot;</span><span class="default">,</span>
<a name="10671"><font size=-1>10671     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10672"><font size=-1>10672     </font></a><span class="string">This variable controls the order of used scaling functions when the Hartree</span>
<a name="10673"><font size=-1>10673     </font></a><span class="string">potential is computed using the Poisson solver (see [[icoulomb]] input</span>
<a name="10674"><font size=-1>10674     </font></a><span class="string">variable). This variable is of seldom use since the default value is large</span>
<a name="10675"><font size=-1>10675     </font></a><span class="string">enough. Nonetheless, possible values are 8, 14, 16, 20, 24, 30, 40, 50, 60,</span>
<a name="10676"><font size=-1>10676     </font></a><span class="string">100. Values greater than 20 are included in ABINIT for test purposes only.</span>
<a name="10677"><font size=-1>10677     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10678"><font size=-1>10678     </font></a><span class="default">),</span>
<a name="10679"><font size=-1>10679     </font></a><span class="default"></span>
<a name="10680"><font size=-1>10680     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10681"><font size=-1>10681     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nshiftk&quot;</span><span class="default">,</span>
<a name="10682"><font size=-1>10682     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="10683"><font size=-1>10683     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10684"><font size=-1>10684     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="10685"><font size=-1>10685     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10686"><font size=-1>10686     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10687"><font size=-1>10687     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of SHIFTs for K point grids&quot;</span><span class="default">,</span>
<a name="10688"><font size=-1>10688     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10689"><font size=-1>10689     </font></a><span class="string">This parameter gives the number of shifted grids to be used concurrently to</span>
<a name="10690"><font size=-1>10690     </font></a><span class="string">generate the full grid of k points. It can be used with primitive grids</span>
<a name="10691"><font size=-1>10691     </font></a><span class="string">defined either from [[ngkpt]] or [[kptrlatt]]. The maximum allowed value of</span>
<a name="10692"><font size=-1>10692     </font></a><span class="string">[[nshiftk]] is 8. The values of the shifts are given by [[shiftk]].</span>
<a name="10693"><font size=-1>10693     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10694"><font size=-1>10694     </font></a><span class="default">),</span>
<a name="10695"><font size=-1>10695     </font></a><span class="default"></span>
<a name="10696"><font size=-1>10696     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10697"><font size=-1>10697     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nshiftq&quot;</span><span class="default">,</span>
<a name="10698"><font size=-1>10698     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10699"><font size=-1>10699     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10700"><font size=-1>10700     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="10701"><font size=-1>10701     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10702"><font size=-1>10702     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10703"><font size=-1>10703     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of SHIFTs for Q point grids&quot;</span><span class="default">,</span>
<a name="10704"><font size=-1>10704     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="10705"><font size=-1>10705     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10706"><font size=-1>10706     </font></a><span class="string">This parameter gives the number of shifted grids to be used concurrently to</span>
<a name="10707"><font size=-1>10707     </font></a><span class="string">generate the full grid of q points. It can be used with primitive grids</span>
<a name="10708"><font size=-1>10708     </font></a><span class="string">defined either from [[ngqpt]] or [[qptrlatt]]. The maximum allowed value of</span>
<a name="10709"><font size=-1>10709     </font></a><span class="string">[[nshiftq]] is 8. The values of the shifts are given by [[shiftq]].</span>
<a name="10710"><font size=-1>10710     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10711"><font size=-1>10711     </font></a><span class="default">),</span>
<a name="10712"><font size=-1>10712     </font></a><span class="default"></span>
<a name="10713"><font size=-1>10713     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10714"><font size=-1>10714     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nspden&quot;</span><span class="default">,</span>
<a name="10715"><font size=-1>10715     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10716"><font size=-1>10716     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10717"><font size=-1>10717     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_basic'</span><span class="default">],</span>
<a name="10718"><font size=-1>10718     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10719"><font size=-1>10719     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[nsppol]]&quot;</span><span class="default">,</span>
<a name="10720"><font size=-1>10720     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of SPin-DENsity components&quot;</span><span class="default">,</span>
<a name="10721"><font size=-1>10721     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10722"><font size=-1>10722     </font></a><span class="string">If [[nspden]] = 1, no spin-magnetization the density matrix is diagonal, with</span>
<a name="10723"><font size=-1>10723     </font></a><span class="string">same values spin-up and spin-down (compatible with [[nsppol]] = 1 only, for both</span>
<a name="10724"><font size=-1>10724     </font></a><span class="string">[[nspinor]] = 1 or 2)</span>
<a name="10725"><font size=-1>10725     </font></a><span class="string"></span>
<a name="10726"><font size=-1>10726     </font></a><span class="string">If [[nspden]] = 2, scalar magnetization (the axis is arbitrarily fixed in the z</span>
<a name="10727"><font size=-1>10727     </font></a><span class="string">direction) the density matrix is diagonal, with different values for spin-up</span>
<a name="10728"><font size=-1>10728     </font></a><span class="string">and spin-down (compatible with [[nspinor]] = 1, either with [[nsppol]] = 2</span>
<a name="10729"><font size=-1>10729     </font></a><span class="string">-general collinear magnetization- or [[nsppol]] = 1 -antiferromagnetism)</span>
<a name="10730"><font size=-1>10730     </font></a><span class="string"></span>
<a name="10731"><font size=-1>10731     </font></a><span class="string">If [[nspden]] = 4, vector magnetization: the density matrix is full, with</span>
<a name="10732"><font size=-1>10732     </font></a><span class="string">allowed x, y and z magnetization (useful only with [[nspinor]] = 2 and</span>
<a name="10733"><font size=-1>10733     </font></a><span class="string">[[nsppol]] = 1, either because there is spin-orbit without time-reversal</span>
<a name="10734"><font size=-1>10734     </font></a><span class="string">symmetry - and thus spontaneous magnetization, or with spin-orbit, if one</span>
<a name="10735"><font size=-1>10735     </font></a><span class="string">allows for spontaneous non-collinear magnetism). Not yet available for</span>
<a name="10736"><font size=-1>10736     </font></a><span class="string">response functions. Also note that, with [[nspden]] = 4, time-reversal symmetry</span>
<a name="10737"><font size=-1>10737     </font></a><span class="string">is not taken into account (at present; this has to be checked) and thus</span>
<a name="10738"><font size=-1>10738     </font></a><span class="string">[[kptopt]] has to be different from 1 or 2.</span>
<a name="10739"><font size=-1>10739     </font></a><span class="string"></span>
<a name="10740"><font size=-1>10740     </font></a><span class="string">The default ([[nspden]] = [[nsppol]]) does not suit the case of vector magnetization.</span>
<a name="10741"><font size=-1>10741     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10742"><font size=-1>10742     </font></a><span class="default">),</span>
<a name="10743"><font size=-1>10743     </font></a><span class="default"></span>
<a name="10744"><font size=-1>10744     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10745"><font size=-1>10745     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nspinor&quot;</span><span class="default">,</span>
<a name="10746"><font size=-1>10746     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10747"><font size=-1>10747     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10748"><font size=-1>10748     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_basic'</span><span class="default">],</span>
<a name="10749"><font size=-1>10749     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10750"><font size=-1>10750     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[pawspnorb]] == 1'</span><span class="default">: </span><span class="number">2</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="10751"><font size=-1>10751     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of SPINORial components of the wavefunctions&quot;</span><span class="default">,</span>
<a name="10752"><font size=-1>10752     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10753"><font size=-1>10753     </font></a><span class="string">If [[nspinor]] = 1, usual case: scalar wavefunction (compatible with</span>
<a name="10754"><font size=-1>10754     </font></a><span class="string">([[nsppol]] = 1, [[nspden]] = 1) as well as ([[nsppol]] = 2, [[nspden]] = 2) )</span>
<a name="10755"><font size=-1>10755     </font></a><span class="string"></span>
<a name="10756"><font size=-1>10756     </font></a><span class="string">If [[nspinor]] = 2, the wavefunction is a spinor (compatible with [[nsppol]] = 1,</span>
<a name="10757"><font size=-1>10757     </font></a><span class="string">with [[nspden]] = 1 or 4, but not with [[nsppol]] = 2)</span>
<a name="10758"><font size=-1>10758     </font></a><span class="string"></span>
<a name="10759"><font size=-1>10759     </font></a><span class="string">When [[nspinor]] is 2, the values of [[istwfk]] are automatically set to 1.</span>
<a name="10760"><font size=-1>10760     </font></a><span class="string">Also, the number of bands, for each k-point, should be even.</span>
<a name="10761"><font size=-1>10761     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10762"><font size=-1>10762     </font></a><span class="default">),</span>
<a name="10763"><font size=-1>10763     </font></a><span class="default"></span>
<a name="10764"><font size=-1>10764     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10765"><font size=-1>10765     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nsppol&quot;</span><span class="default">,</span>
<a name="10766"><font size=-1>10766     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="10767"><font size=-1>10767     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10768"><font size=-1>10768     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_basic'</span><span class="default">],</span>
<a name="10769"><font size=-1>10769     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10770"><font size=-1>10770     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10771"><font size=-1>10771     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of SPin POLarization&quot;</span><span class="default">,</span>
<a name="10772"><font size=-1>10772     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10773"><font size=-1>10773     </font></a><span class="string">Give the number of INDEPENDENT spin polarisations, for which there are non-</span>
<a name="10774"><font size=-1>10774     </font></a><span class="string">related wavefunctions. Can take the values 1 or 2.</span>
<a name="10775"><font size=-1>10775     </font></a><span class="string"></span>
<a name="10776"><font size=-1>10776     </font></a><span class="string">If [[nsppol]] = 1, one has an unpolarized calculation ([[nspinor]] = 1,</span>
<a name="10777"><font size=-1>10777     </font></a><span class="string">[[nspden]] = 1) or an antiferromagnetic system ([[nspinor]] = 1, [[nspden]] = 2), or</span>
<a name="10778"><font size=-1>10778     </font></a><span class="string">a calculation in which spin up and spin down cannot be disentangled</span>
<a name="10779"><font size=-1>10779     </font></a><span class="string">([[nspinor]] = 2), that is, either non-collinear magnetism or presence of spin-</span>
<a name="10780"><font size=-1>10780     </font></a><span class="string">orbit coupling, for which one needs spinor wavefunctions.</span>
<a name="10781"><font size=-1>10781     </font></a><span class="string"></span>
<a name="10782"><font size=-1>10782     </font></a><span class="string">If [[nsppol]] = 2, one has a spin-polarized (collinear) calculation with</span>
<a name="10783"><font size=-1>10783     </font></a><span class="string">separate and different wavefunctions for up and down spin electrons for each</span>
<a name="10784"><font size=-1>10784     </font></a><span class="string">band and k point. Compatible only with [[nspinor]] == 1, [[nspden]] == 2. If</span>
<a name="10785"><font size=-1>10785     </font></a><span class="string">[[nsppol]] = 2, one usually uses a metallic value for [[occopt]], in order to</span>
<a name="10786"><font size=-1>10786     </font></a><span class="string">let ABINIT find the magnetization. On the contrary, if [[occopt]] == 1 is used,</span>
<a name="10787"><font size=-1>10787     </font></a><span class="string">the user has to impose the magnetization, using [[spinmagntarget]], except for</span>
<a name="10788"><font size=-1>10788     </font></a><span class="string">the case of a single isolated Hydrogen atom.</span>
<a name="10789"><font size=-1>10789     </font></a><span class="string"></span>
<a name="10790"><font size=-1>10790     </font></a><span class="string">In the present status of development, with [[nsppol]] = 1, all values of [[ixc]]</span>
<a name="10791"><font size=-1>10791     </font></a><span class="string">are allowed, while with [[nsppol]] = 2, some values of [[ixc]] might not be</span>
<a name="10792"><font size=-1>10792     </font></a><span class="string">allowed (e.g. 2, 3, 4, 5, 6, 20, 21, 22 are not allowed).</span>
<a name="10793"><font size=-1>10793     </font></a><span class="string"></span>
<a name="10794"><font size=-1>10794     </font></a><span class="string">See also the input variable [[nspden]] for the components of the density</span>
<a name="10795"><font size=-1>10795     </font></a><span class="string">matrix with respect to the spin-polarization.</span>
<a name="10796"><font size=-1>10796     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10797"><font size=-1>10797     </font></a><span class="default">),</span>
<a name="10798"><font size=-1>10798     </font></a><span class="default"></span>
<a name="10799"><font size=-1>10799     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10800"><font size=-1>10800     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nstep&quot;</span><span class="default">,</span>
<a name="10801"><font size=-1>10801     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="10802"><font size=-1>10802     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10803"><font size=-1>10803     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_basic'</span><span class="default">],</span>
<a name="10804"><font size=-1>10804     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10805"><font size=-1>10805     </font></a><span class="default">    defaultval=</span><span class="number">30</span><span class="default">,</span>
<a name="10806"><font size=-1>10806     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of (non-)self-consistent field STEPS&quot;</span><span class="default">,</span>
<a name="10807"><font size=-1>10807     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10808"><font size=-1>10808     </font></a><span class="string">Gives the maximum number of cycles (or &quot;iterations&quot;) in a SCF or non-SCF run.</span>
<a name="10809"><font size=-1>10809     </font></a><span class="string">Full convergence from random numbers is usually achieved in 12-20 SCF</span>
<a name="10810"><font size=-1>10810     </font></a><span class="string">iterations. Each can take from minutes to hours. In certain difficult cases,</span>
<a name="10811"><font size=-1>10811     </font></a><span class="string">usually related to a small or zero bandgap or magnetism, convergence</span>
<a name="10812"><font size=-1>10812     </font></a><span class="string">performance may be much worse. When the convergence tolerance [[tolwfr]] on</span>
<a name="10813"><font size=-1>10813     </font></a><span class="string">the wavefunctions is satisfied, iterations will stop, so for well converged</span>
<a name="10814"><font size=-1>10814     </font></a><span class="string">calculations you should set [[nstep]] to a value larger than you think will be</span>
<a name="10815"><font size=-1>10815     </font></a><span class="string">needed for full convergence, e.g. if using 20 steps usually converges the</span>
<a name="10816"><font size=-1>10816     </font></a><span class="string">system, set [[nstep]] to 30.</span>
<a name="10817"><font size=-1>10817     </font></a><span class="string">For non-self-consistent runs ( [[iscf]] &lt; 0) nstep governs the number of</span>
<a name="10818"><font size=-1>10818     </font></a><span class="string">cycles of convergence for the wavefunctions for a fixed density and Hamiltonian.</span>
<a name="10819"><font size=-1>10819     </font></a><span class="string"></span>
<a name="10820"><font size=-1>10820     </font></a><span class="string">NOTE that a choice of [[nstep]] = 0 is permitted; this will either read</span>
<a name="10821"><font size=-1>10821     </font></a><span class="string">wavefunctions from disk (with [[irdwfk]] = 1 or [[irdwfq]] = 1, or non-zero</span>
<a name="10822"><font size=-1>10822     </font></a><span class="string">[[getwfk]] or [[getwfq]] in the case of multi-dataset) and compute the</span>
<a name="10823"><font size=-1>10823     </font></a><span class="string">density, the total energy and stop, or else (with all of the above vanishing)</span>
<a name="10824"><font size=-1>10824     </font></a><span class="string">will initialize randomly the wavefunctions and compute the resulting density</span>
<a name="10825"><font size=-1>10825     </font></a><span class="string">and total energy. This is provided for testing purposes.</span>
<a name="10826"><font size=-1>10826     </font></a><span class="string">Also NOTE that [[nstep]] = 0 with [[irdwfk]] = 1 will exactly give the same result</span>
<a name="10827"><font size=-1>10827     </font></a><span class="string">as the previous run only if the latter is done with [[iscf]]&lt;10 (potential</span>
<a name="10828"><font size=-1>10828     </font></a><span class="string">mixing).</span>
<a name="10829"><font size=-1>10829     </font></a><span class="string">One can output the density by using [[prtden]].</span>
<a name="10830"><font size=-1>10830     </font></a><span class="string">The forces and stress tensor are computed with [[nstep]] = 0.</span>
<a name="10831"><font size=-1>10831     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10832"><font size=-1>10832     </font></a><span class="default">),</span>
<a name="10833"><font size=-1>10833     </font></a><span class="default"></span>
<a name="10834"><font size=-1>10834     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10835"><font size=-1>10835     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nsym&quot;</span><span class="default">,</span>
<a name="10836"><font size=-1>10836     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="10837"><font size=-1>10837     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10838"><font size=-1>10838     </font></a><span class="default">    topics=[</span><span class="string">'crystal_useful'</span><span class="default">, </span><span class="string">'GW_useful'</span><span class="default">],</span>
<a name="10839"><font size=-1>10839     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10840"><font size=-1>10840     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10841"><font size=-1>10841     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of SYMmetry operations&quot;</span><span class="default">,</span>
<a name="10842"><font size=-1>10842     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10843"><font size=-1>10843     </font></a><span class="string">Gives number of space group symmetries to be applied in this problem.</span>
<a name="10844"><font size=-1>10844     </font></a><span class="string">Symmetries will be input in array &quot;[[symrel]]&quot; and (nonsymmorphic)</span>
<a name="10845"><font size=-1>10845     </font></a><span class="string">translations vectors will be input in array &quot;[[tnons]]&quot;. If there is no</span>
<a name="10846"><font size=-1>10846     </font></a><span class="string">symmetry in the problem then set [[nsym]] to 1, because the identity is still</span>
<a name="10847"><font size=-1>10847     </font></a><span class="string">a symmetry.</span>
<a name="10848"><font size=-1>10848     </font></a><span class="string">In case of a RF calculation, the code is able to use the symmetries of the</span>
<a name="10849"><font size=-1>10849     </font></a><span class="string">system to decrease the number of perturbations to be calculated, and to</span>
<a name="10850"><font size=-1>10850     </font></a><span class="string">decrease of the number of special k points to be used for the sampling of the</span>
<a name="10851"><font size=-1>10851     </font></a><span class="string">Brillouin zone. After the response to the perturbations have been calculated,</span>
<a name="10852"><font size=-1>10852     </font></a><span class="string">the symmetries are used to generate as many as possible elements of the 2DTE</span>
<a name="10853"><font size=-1>10853     </font></a><span class="string">from those already computed.</span>
<a name="10854"><font size=-1>10854     </font></a><span class="string"></span>
<a name="10855"><font size=-1>10855     </font></a><span class="string">**Symmetry finder mode** (Default mode).</span>
<a name="10856"><font size=-1>10856     </font></a><span class="string">If [[nsym]] is 0, all the atomic coordinates must be explicitly given (one</span>
<a name="10857"><font size=-1>10857     </font></a><span class="string">cannot use the atom manipulator neither the smart symmetrizer): the code will</span>
<a name="10858"><font size=-1>10858     </font></a><span class="string">then find automatically the symmetry operations that leave the lattice and</span>
<a name="10859"><font size=-1>10859     </font></a><span class="string">each atomic sublattice invariant. It also checks whether the cell is primitive</span>
<a name="10860"><font size=-1>10860     </font></a><span class="string">(see [[chkprim]]).</span>
<a name="10861"><font size=-1>10861     </font></a><span class="string">Note that the tolerance on symmetric atomic positions and lattice is rather</span>
<a name="10862"><font size=-1>10862     </font></a><span class="string">stringent: for a symmetry operation to be admitted, the lattice and atomic</span>
<a name="10863"><font size=-1>10863     </font></a><span class="string">positions must map on themselves within 1.0e-8.</span>
<a name="10864"><font size=-1>10864     </font></a><span class="string"></span>
<a name="10865"><font size=-1>10865     </font></a><span class="string">The user is allowed to set up systems with non-primitive unit cells (i.e.</span>
<a name="10866"><font size=-1>10866     </font></a><span class="string">conventional FCC or BCC cells, or supercells without any distortion). In this</span>
<a name="10867"><font size=-1>10867     </font></a><span class="string">case, pure translations will be identified as symmetries of the system by the</span>
<a name="10868"><font size=-1>10868     </font></a><span class="string">symmetry finder. Then, the combined &quot;pure translation + usual rotation and</span>
<a name="10869"><font size=-1>10869     </font></a><span class="string">inversion&quot; symmetry operations can be very numerous. For example, a</span>
<a name="10870"><font size=-1>10870     </font></a><span class="string">conventional FCC cell has 192 symmetry operations, instead of the 48 ones of</span>
<a name="10871"><font size=-1>10871     </font></a><span class="string">the primitive cell. A maximum limit of 384 symmetry operations is hard-coded.</span>
<a name="10872"><font size=-1>10872     </font></a><span class="string">This corresponds to the maximum number of symmetry operations of a 2x2x2</span>
<a name="10873"><font size=-1>10873     </font></a><span class="string">undistorted supercell. Going beyond that number will make the code stop very</span>
<a name="10874"><font size=-1>10874     </font></a><span class="string">rapidly. If you want nevertheless, for testing purposes, to treat a larger</span>
<a name="10875"><font size=-1>10875     </font></a><span class="string">number of symmetries, change [[maxnsym]].</span>
<a name="10876"><font size=-1>10876     </font></a><span class="string"></span>
<a name="10877"><font size=-1>10877     </font></a><span class="string">For GW calculation, the user might want to select only the symmetry operations</span>
<a name="10878"><font size=-1>10878     </font></a><span class="string">whose non-symmorphic translation vector [[tnons]] is zero. This can be done</span>
<a name="10879"><font size=-1>10879     </font></a><span class="string">with the help of the input variable [[symmorphi]]</span>
<a name="10880"><font size=-1>10880     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10881"><font size=-1>10881     </font></a><span class="default">),</span>
<a name="10882"><font size=-1>10882     </font></a><span class="default"></span>
<a name="10883"><font size=-1>10883     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10884"><font size=-1>10884     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ntime&quot;</span><span class="default">,</span>
<a name="10885"><font size=-1>10885     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="10886"><font size=-1>10886     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10887"><font size=-1>10887     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_basic'</span><span class="default">, </span><span class="string">'GeoOpt_basic'</span><span class="default">],</span>
<a name="10888"><font size=-1>10888     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10889"><font size=-1>10889     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10890"><font size=-1>10890     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of TIME steps&quot;</span><span class="default">,</span>
<a name="10891"><font size=-1>10891     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10892"><font size=-1>10892     </font></a><span class="string">Gives the number of molecular dynamics time steps or Broyden structural</span>
<a name="10893"><font size=-1>10893     </font></a><span class="string">optimization steps to be done if [[ionmov]] is non-zero.</span>
<a name="10894"><font size=-1>10894     </font></a><span class="string">Note that at the present the option [[ionmov]] = 1 is initialized with four</span>
<a name="10895"><font size=-1>10895     </font></a><span class="string">Runge-Kutta steps which costs some overhead in the startup. By contrast, the</span>
<a name="10896"><font size=-1>10896     </font></a><span class="string">initialisation of other [[ionmov]] values is only one SCF call.</span>
<a name="10897"><font size=-1>10897     </font></a><span class="string">[[ntime]] is ignored if [[ionmov]] = 0.</span>
<a name="10898"><font size=-1>10898     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10899"><font size=-1>10899     </font></a><span class="default">),</span>
<a name="10900"><font size=-1>10900     </font></a><span class="default"></span>
<a name="10901"><font size=-1>10901     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10902"><font size=-1>10902     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ntimimage&quot;</span><span class="default">,</span>
<a name="10903"><font size=-1>10903     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="10904"><font size=-1>10904     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10905"><font size=-1>10905     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_compulsory'</span><span class="default">, </span><span class="string">'TransPath_compulsory'</span><span class="default">],</span>
<a name="10906"><font size=-1>10906     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10907"><font size=-1>10907     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10908"><font size=-1>10908     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of TIME steps for IMAGE propagation&quot;</span><span class="default">,</span>
<a name="10909"><font size=-1>10909     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10910"><font size=-1>10910     </font></a><span class="string">Gives the maximal number of molecular dynamics time steps or structural</span>
<a name="10911"><font size=-1>10911     </font></a><span class="string">optimization steps to be done for the set of images, referred to as 'image-</span>
<a name="10912"><font size=-1>10912     </font></a><span class="string">timesteps'. At each image-timestep, all the images are propagated</span>
<a name="10913"><font size=-1>10913     </font></a><span class="string">simultaneously, each according to the algorithm determined by [[imgmov]] and</span>
<a name="10914"><font size=-1>10914     </font></a><span class="string">the usual accompanying input variables, and then the next positions and</span>
<a name="10915"><font size=-1>10915     </font></a><span class="string">velocities for each image are determined from the set of results obtained for</span>
<a name="10916"><font size=-1>10916     </font></a><span class="string">all images.</span>
<a name="10917"><font size=-1>10917     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10918"><font size=-1>10918     </font></a><span class="default">),</span>
<a name="10919"><font size=-1>10919     </font></a><span class="default"></span>
<a name="10920"><font size=-1>10920     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10921"><font size=-1>10921     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ntypalch&quot;</span><span class="default">,</span>
<a name="10922"><font size=-1>10922     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10923"><font size=-1>10923     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10924"><font size=-1>10924     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_useful'</span><span class="default">],</span>
<a name="10925"><font size=-1>10925     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10926"><font size=-1>10926     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="10927"><font size=-1>10927     </font></a><span class="default">    mnemonics=</span><span class="string">'Number of TYPe of atoms that are &quot;ALCHemical&quot;'</span><span class="default">,</span>
<a name="10928"><font size=-1>10928     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10929"><font size=-1>10929     </font></a><span class="string">Used for the generation of alchemical pseudopotentials: when [[ntypalch]] is</span>
<a name="10930"><font size=-1>10930     </font></a><span class="string">non-zero, alchemical mixing will be used.</span>
<a name="10931"><font size=-1>10931     </font></a><span class="string"></span>
<a name="10932"><font size=-1>10932     </font></a><span class="string">Among the [[ntypat]] types of atoms, the last [[ntypalch]] will be</span>
<a name="10933"><font size=-1>10933     </font></a><span class="string">&quot;alchemical&quot; pseudoatoms, while only the first [[ntyppure]] will be uniquely</span>
<a name="10934"><font size=-1>10934     </font></a><span class="string">associated with a pseudopotential (the [[ntyppure]] first of these, actually).</span>
<a name="10935"><font size=-1>10935     </font></a><span class="string">The [[ntypalch]] types of alchemical pseudoatoms are to be made from the</span>
<a name="10936"><font size=-1>10936     </font></a><span class="string">remaining [[npspalch]] pseudopotentials.</span>
<a name="10937"><font size=-1>10937     </font></a><span class="string"></span>
<a name="10938"><font size=-1>10938     </font></a><span class="string">In this case, the input variables [[algalch]], [[mixalch]] are active, and</span>
<a name="10939"><font size=-1>10939     </font></a><span class="string">generate alchemical potentials from the available pseudopotentials. See these</span>
<a name="10940"><font size=-1>10940     </font></a><span class="string">input variables, especially [[mixalch]], to understand how to use alchemical</span>
<a name="10941"><font size=-1>10941     </font></a><span class="string">potentials in ABINIT.</span>
<a name="10942"><font size=-1>10942     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10943"><font size=-1>10943     </font></a><span class="default">),</span>
<a name="10944"><font size=-1>10944     </font></a><span class="default"></span>
<a name="10945"><font size=-1>10945     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10946"><font size=-1>10946     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ntypat&quot;</span><span class="default">,</span>
<a name="10947"><font size=-1>10947     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="10948"><font size=-1>10948     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10949"><font size=-1>10949     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_compulsory'</span><span class="default">, </span><span class="string">'PseudosPAW_compulsory'</span><span class="default">, </span><span class="string">'crystal_basic'</span><span class="default">],</span>
<a name="10950"><font size=-1>10950     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10951"><font size=-1>10951     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="10952"><font size=-1>10952     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of TYPes of AToms&quot;</span><span class="default">,</span>
<a name="10953"><font size=-1>10953     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="10954"><font size=-1>10954     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10955"><font size=-1>10955     </font></a><span class="string">Gives the number of types of atoms.</span>
<a name="10956"><font size=-1>10956     </font></a><span class="string">E.g. for a homopolar system (e.g. pure Si) [[ntypat]] is 1.</span>
<a name="10957"><font size=-1>10957     </font></a><span class="string"></span>
<a name="10958"><font size=-1>10958     </font></a><span class="string">The code tries to read the same number of pseudopotential files. The first</span>
<a name="10959"><font size=-1>10959     </font></a><span class="string">pseudopotential is assigned type number 1, and so on...</span>
<a name="10960"><font size=-1>10960     </font></a><span class="string"></span>
<a name="10961"><font size=-1>10961     </font></a><span class="string">There is an exception in the case of alchemical mixing of potentials, for</span>
<a name="10962"><font size=-1>10962     </font></a><span class="string">which there is a different number of pseudopotentials atomic types. See</span>
<a name="10963"><font size=-1>10963     </font></a><span class="string">[[mixalch]].</span>
<a name="10964"><font size=-1>10964     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10965"><font size=-1>10965     </font></a><span class="default">),</span>
<a name="10966"><font size=-1>10966     </font></a><span class="default"></span>
<a name="10967"><font size=-1>10967     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10968"><font size=-1>10968     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ntyppure&quot;</span><span class="default">,</span>
<a name="10969"><font size=-1>10969     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10970"><font size=-1>10970     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="10971"><font size=-1>10971     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_internal'</span><span class="default">],</span>
<a name="10972"><font size=-1>10972     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="10973"><font size=-1>10973     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[ntypat]]-[[ntypalch]]&quot;</span><span class="default">,</span>
<a name="10974"><font size=-1>10974     </font></a><span class="default">    mnemonics=</span><span class="string">'Number of TYPe of atoms that are &quot;PURE&quot;'</span><span class="default">,</span>
<a name="10975"><font size=-1>10975     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="10976"><font size=-1>10976     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10977"><font size=-1>10977     </font></a><span class="string">Gives the number of type of atoms that are &quot;pure&quot; when alchemical mixing is</span>
<a name="10978"><font size=-1>10978     </font></a><span class="string">used ([[ntypalch]] /= 0):</span>
<a name="10979"><font size=-1>10979     </font></a><span class="string"></span>
<a name="10980"><font size=-1>10980     </font></a><span class="string">[[ntyppure]] = [[ntypat]] - [[ntypalch]]</span>
<a name="10981"><font size=-1>10981     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10982"><font size=-1>10982     </font></a><span class="default">),</span>
<a name="10983"><font size=-1>10983     </font></a><span class="default"></span>
<a name="10984"><font size=-1>10984     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="10985"><font size=-1>10985     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nucdipmom&quot;</span><span class="default">,</span>
<a name="10986"><font size=-1>10986     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="10987"><font size=-1>10987     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="10988"><font size=-1>10988     </font></a><span class="default">    topics=[</span><span class="string">'MagField_expert'</span><span class="default">],</span>
<a name="10989"><font size=-1>10989     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[natom]]'</span><span class="default">],</span>
<a name="10990"><font size=-1>10990     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="10991"><font size=-1>10991     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;NUClear DIPole MOMents&quot;</span><span class="default">,</span>
<a name="10992"><font size=-1>10992     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] = 1; [[pawcpxocc]] = 2; [[kptopt]] &gt; 2&quot;</span><span class="default">,</span>
<a name="10993"><font size=-1>10993     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="10994"><font size=-1>10994     </font></a><span class="string">Places an array of nuclear magnetic dipole moments on the atomic positions,</span>
<a name="10995"><font size=-1>10995     </font></a><span class="string">useful for computing the magnetization in the presence of nuclear dipoles and</span>
<a name="10996"><font size=-1>10996     </font></a><span class="string">thus the chemical shielding by the converse method. The presence of these</span>
<a name="10997"><font size=-1>10997     </font></a><span class="string">dipoles breaks time reversal symmetry and lowers the overall spatial symmetry.</span>
<a name="10998"><font size=-1>10998     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="10999"><font size=-1>10999     </font></a><span class="default">),</span>
<a name="11000"><font size=-1>11000     </font></a><span class="default"></span>
<a name="11001"><font size=-1>11001     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11002"><font size=-1>11002     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nwfshist&quot;</span><span class="default">,</span>
<a name="11003"><font size=-1>11003     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="11004"><font size=-1>11004     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11005"><font size=-1>11005     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_useful'</span><span class="default">],</span>
<a name="11006"><font size=-1>11006     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11007"><font size=-1>11007     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11008"><font size=-1>11008     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of WaveFunctionS HISTory&quot;</span><span class="default">,</span>
<a name="11009"><font size=-1>11009     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11010"><font size=-1>11010     </font></a><span class="string">In the wavelet basis set, the ground state is found by direct minimisation.</span>
<a name="11011"><font size=-1>11011     </font></a><span class="string">The algorithm used can be either the steepest descent or the DIIS (Direct</span>
<a name="11012"><font size=-1>11012     </font></a><span class="string">Inversion of Iteration Space). \n</span>
<a name="11013"><font size=-1>11013     </font></a><span class="string">When [[nwfshist]] = 0, the steepest descent is</span>
<a name="11014"><font size=-1>11014     </font></a><span class="string">used ( _i.e._ there is no history storage of the previous iterations). \n</span>
<a name="11015"><font size=-1>11015     </font></a><span class="string">If [[nwfshist]] is strictly positive, a DIIS is used. A typical value is 6. Using</span>
<a name="11016"><font size=-1>11016     </font></a><span class="string">a DIIS increases the memory required by the program since N previous</span>
<a name="11017"><font size=-1>11017     </font></a><span class="string">wavefunctions are stored during the electronic minimisation.</span>
<a name="11018"><font size=-1>11018     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11019"><font size=-1>11019     </font></a><span class="default">),</span>
<a name="11020"><font size=-1>11020     </font></a><span class="default"></span>
<a name="11021"><font size=-1>11021     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11022"><font size=-1>11022     </font></a><span class="default">    abivarname=</span><span class="string">&quot;nzchempot&quot;</span><span class="default">,</span>
<a name="11023"><font size=-1>11023     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11024"><font size=-1>11024     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11025"><font size=-1>11025     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_expert'</span><span class="default">],</span>
<a name="11026"><font size=-1>11026     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11027"><font size=-1>11027     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Number of Z reduced coordinates that define the spatial CHEMical POTential&quot;</span><span class="default">,</span>
<a name="11028"><font size=-1>11028     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11029"><font size=-1>11029     </font></a><span class="string">Defines the number of z reduced coordinates that defines the spatially varying</span>
<a name="11030"><font size=-1>11030     </font></a><span class="string">chemical potential. See the input variable [[chempot]], of which [[nzchempot]]</span>
<a name="11031"><font size=-1>11031     </font></a><span class="string">is the second dimension.</span>
<a name="11032"><font size=-1>11032     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11033"><font size=-1>11033     </font></a><span class="default">),</span>
<a name="11034"><font size=-1>11034     </font></a><span class="default"></span>
<a name="11035"><font size=-1>11035     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11036"><font size=-1>11036     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objaat&quot;</span><span class="default">,</span>
<a name="11037"><font size=-1>11037     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11038"><font size=-1>11038     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11039"><font size=-1>11039     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_basic'</span><span class="default">],</span>
<a name="11040"><font size=-1>11040     </font></a><span class="default">    dimensions=[</span><span class="string">'[[objan]]'</span><span class="default">],</span>
<a name="11041"><font size=-1>11041     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect A: list of AToms&quot;</span><span class="default">,</span>
<a name="11042"><font size=-1>11042     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11043"><font size=-1>11043     </font></a><span class="default">    requires=</span><span class="string">&quot;'[[nobj]] == 1'&quot;</span><span class="default">,</span>
<a name="11044"><font size=-1>11044     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11045"><font size=-1>11045     </font></a><span class="string">Gives the list of atoms in object a. This list is specified by giving, for</span>
<a name="11046"><font size=-1>11046     </font></a><span class="string">each atom, its index in the list of coordinates ([[xred]], [[xangst]] or</span>
<a name="11047"><font size=-1>11047     </font></a><span class="string">[[xcart]]), that also corresponds to a type of atom (given by the array type).</span>
<a name="11048"><font size=-1>11048     </font></a><span class="string">These objects can be thought as molecules, or groups of atoms, or parts of</span>
<a name="11049"><font size=-1>11049     </font></a><span class="string">molecules, to be repeated, rotated and translated to generate the full set of atoms.</span>
<a name="11050"><font size=-1>11050     </font></a><span class="string">Look at [[objarf]] for further explanations.</span>
<a name="11051"><font size=-1>11051     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11052"><font size=-1>11052     </font></a><span class="default">),</span>
<a name="11053"><font size=-1>11053     </font></a><span class="default"></span>
<a name="11054"><font size=-1>11054     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11055"><font size=-1>11055     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objaax&quot;</span><span class="default">,</span>
<a name="11056"><font size=-1>11056     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11057"><font size=-1>11057     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11058"><font size=-1>11058     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11059"><font size=-1>11059     </font></a><span class="default">    dimensions=[</span><span class="number">6</span><span class="default">],</span>
<a name="11060"><font size=-1>11060     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect A: AXis&quot;</span><span class="default">,</span>
<a name="11061"><font size=-1>11061     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">, </span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="11062"><font size=-1>11062     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;&quot;&quot;[[objaax]] must be provided if ([[nobj]] == 1 and one component of [[objaro]] != 0). Moreover,</span>
<a name="11063"><font size=-1>11063     </font></a><span class="string">[[objaax]] AND [[objbax]] must be provided if ( [[nobj]] == 2 and one component of [[objbro]] != 0 ).&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11064"><font size=-1>11064     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11065"><font size=-1>11065     </font></a><span class="string">Gives, for each object, the cartesian coordinates of two points (first point:</span>
<a name="11066"><font size=-1>11066     </font></a><span class="string">[[objaax]](1:3) second point: [[objaax]](4:6). By default, given in Bohr</span>
<a name="11067"><font size=-1>11067     </font></a><span class="string">atomic units (1 Bohr=0.5291772108 Angstroms), although Angstrom can be</span>
<a name="11068"><font size=-1>11068     </font></a><span class="string">specified, if preferred, since these variables have the '[[LENGTH]]'</span>
<a name="11069"><font size=-1>11069     </font></a><span class="string">characteristics.</span>
<a name="11070"><font size=-1>11070     </font></a><span class="string">The two points define an axis of rotation of the corresponding object.</span>
<a name="11071"><font size=-1>11071     </font></a><span class="string">Note that the rotation of the object is done BEFORE the object is translated.</span>
<a name="11072"><font size=-1>11072     </font></a><span class="string">The sign of the rotation angle is positive if the object is to be rotated</span>
<a name="11073"><font size=-1>11073     </font></a><span class="string">clockwise when looking to it along the axis, from point 1 (coordinates 1:3)</span>
<a name="11074"><font size=-1>11074     </font></a><span class="string">toward point 2 (coordinates 4:6).</span>
<a name="11075"><font size=-1>11075     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11076"><font size=-1>11076     </font></a><span class="default">),</span>
<a name="11077"><font size=-1>11077     </font></a><span class="default"></span>
<a name="11078"><font size=-1>11078     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11079"><font size=-1>11079     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objan&quot;</span><span class="default">,</span>
<a name="11080"><font size=-1>11080     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11081"><font size=-1>11081     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11082"><font size=-1>11082     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_basic'</span><span class="default">],</span>
<a name="11083"><font size=-1>11083     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11084"><font size=-1>11084     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect A: Number of atoms&quot;</span><span class="default">,</span>
<a name="11085"><font size=-1>11085     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11086"><font size=-1>11086     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;&quot;&quot; [[objan]] MUST be provided if [[nobj]] == 1.</span>
<a name="11087"><font size=-1>11087     </font></a><span class="string"> [[objan]] and [[objbn]] MUST be provided if [[nobj]] == 2.&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11088"><font size=-1>11088     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11089"><font size=-1>11089     </font></a><span class="string">Gives the number of atoms in object a. The list of atoms is given by the variables [[objaat]].</span>
<a name="11090"><font size=-1>11090     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11091"><font size=-1>11091     </font></a><span class="default">),</span>
<a name="11092"><font size=-1>11092     </font></a><span class="default"></span>
<a name="11093"><font size=-1>11093     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11094"><font size=-1>11094     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objarf&quot;</span><span class="default">,</span>
<a name="11095"><font size=-1>11095     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11096"><font size=-1>11096     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11097"><font size=-1>11097     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_basic'</span><span class="default">],</span>
<a name="11098"><font size=-1>11098     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="11099"><font size=-1>11099     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">],</span>
<a name="11100"><font size=-1>11100     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect A: Repetition Factors&quot;</span><span class="default">,</span>
<a name="11101"><font size=-1>11101     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11102"><font size=-1>11102     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11103"><font size=-1>11103     </font></a><span class="string">Gives three repetition factors of the objects a.</span>
<a name="11104"><font size=-1>11104     </font></a><span class="string">This gives the opportunity to generate a three-dimensional set of repeated</span>
<a name="11105"><font size=-1>11105     </font></a><span class="string">objects, although a simple one-dimensional repetition will be easily obtained</span>
<a name="11106"><font size=-1>11106     </font></a><span class="string">through the specification of `nrep 1 1`</span>
<a name="11107"><font size=-1>11107     </font></a><span class="string">where `nrep` is the 1D repetition factor.</span>
<a name="11108"><font size=-1>11108     </font></a><span class="string">The initial rotation and translation of the object, as well as the increment</span>
<a name="11109"><font size=-1>11109     </font></a><span class="string">of rotation or translation from one object to the next are specified by the</span>
<a name="11110"><font size=-1>11110     </font></a><span class="string">variable [[objaro]].</span>
<a name="11111"><font size=-1>11111     </font></a><span class="string">Note that the atom manipulator will generate the full set of atoms from the</span>
<a name="11112"><font size=-1>11112     </font></a><span class="string">primitive set of atoms using the following order: it will process each atom</span>
<a name="11113"><font size=-1>11113     </font></a><span class="string">in the primitive list one by one, determine whether it belongs to either</span>
<a name="11114"><font size=-1>11114     </font></a><span class="string">object a or object b, and then repeat it taking into account the proper</span>
<a name="11115"><font size=-1>11115     </font></a><span class="string">rotation and translation, with the fastest varying repetition factor being the</span>
<a name="11116"><font size=-1>11116     </font></a><span class="string">first, then the second, then the third.</span>
<a name="11117"><font size=-1>11117     </font></a><span class="string">In the final list of atoms, one will first find the atoms generated from atom</span>
<a name="11118"><font size=-1>11118     </font></a><span class="string">1 in the primitive list, then those generated from atom 2 in the primitive</span>
<a name="11119"><font size=-1>11119     </font></a><span class="string">list, and so on.</span>
<a name="11120"><font size=-1>11120     </font></a><span class="string">If the atom manipulator is only used to rotate or translate an object, without</span>
<a name="11121"><font size=-1>11121     </font></a><span class="string">repeating it, simply use `1 1 1`, which is also the Default value.</span>
<a name="11122"><font size=-1>11122     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11123"><font size=-1>11123     </font></a><span class="default">),</span>
<a name="11124"><font size=-1>11124     </font></a><span class="default"></span>
<a name="11125"><font size=-1>11125     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11126"><font size=-1>11126     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objaro&quot;</span><span class="default">,</span>
<a name="11127"><font size=-1>11127     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11128"><font size=-1>11128     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11129"><font size=-1>11129     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11130"><font size=-1>11130     </font></a><span class="default">    dimensions=[</span><span class="number">4</span><span class="default">],</span>
<a name="11131"><font size=-1>11131     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">4</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="11132"><font size=-1>11132     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect A: ROtations&quot;</span><span class="default">,</span>
<a name="11133"><font size=-1>11133     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11134"><font size=-1>11134     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;(no rotation)&quot;</span><span class="default">,</span>
<a name="11135"><font size=-1>11135     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11136"><font size=-1>11136     </font></a><span class="string">Give, for each object, the angles of rotation in degrees to be applied to the</span>
<a name="11137"><font size=-1>11137     </font></a><span class="string">corresponding object.</span>
<a name="11138"><font size=-1>11138     </font></a><span class="string">The rotation is applied before the translation, and the axis is defined by the</span>
<a name="11139"><font size=-1>11139     </font></a><span class="string">variable [[objaax]]. See the latter variable for the</span>
<a name="11140"><font size=-1>11140     </font></a><span class="string">definition of the sign of the rotation.</span>
<a name="11141"><font size=-1>11141     </font></a><span class="string">The first component [[objaro]](1) gives the angle of</span>
<a name="11142"><font size=-1>11142     </font></a><span class="string">rotation to be applied to the first instance of the object. The second, third</span>
<a name="11143"><font size=-1>11143     </font></a><span class="string">or fourth component (resp.) gives the increment of rotation angle from one</span>
<a name="11144"><font size=-1>11144     </font></a><span class="string">instance to the next instance, defined by the first, second or third</span>
<a name="11145"><font size=-1>11145     </font></a><span class="string">repetition factor (resp.). This allows one to generate 3D arrays of molecules</span>
<a name="11146"><font size=-1>11146     </font></a><span class="string">with different rotation angles.</span>
<a name="11147"><font size=-1>11147     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11148"><font size=-1>11148     </font></a><span class="default">),</span>
<a name="11149"><font size=-1>11149     </font></a><span class="default"></span>
<a name="11150"><font size=-1>11150     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11151"><font size=-1>11151     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objatr&quot;</span><span class="default">,</span>
<a name="11152"><font size=-1>11152     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11153"><font size=-1>11153     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11154"><font size=-1>11154     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11155"><font size=-1>11155     </font></a><span class="default">    dimensions=[</span><span class="number">12</span><span class="default">],</span>
<a name="11156"><font size=-1>11156     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">12</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="11157"><font size=-1>11157     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect A: TRanslations&quot;</span><span class="default">,</span>
<a name="11158"><font size=-1>11158     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">, </span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="11159"><font size=-1>11159     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;(no translation)&quot;</span><span class="default">,</span>
<a name="11160"><font size=-1>11160     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11161"><font size=-1>11161     </font></a><span class="string">Give, for each object, the vectors of translations, in cartesian coordinates,</span>
<a name="11162"><font size=-1>11162     </font></a><span class="string">to be applied to the corresponding object. By default, given in Bohr atomic</span>
<a name="11163"><font size=-1>11163     </font></a><span class="string">units (1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified, if</span>
<a name="11164"><font size=-1>11164     </font></a><span class="string">preferred, since these variables have the '[[LENGTH]]' characteristics.</span>
<a name="11165"><font size=-1>11165     </font></a><span class="string">The translation is applied after the rotation.</span>
<a name="11166"><font size=-1>11166     </font></a><span class="string">The first vector [[objatr]](3,1) gives the translation to</span>
<a name="11167"><font size=-1>11167     </font></a><span class="string">be applied to the first instance of the object. The second, third or fourth</span>
<a name="11168"><font size=-1>11168     </font></a><span class="string">component (resp.) gives the increment of translation from one instance to the</span>
<a name="11169"><font size=-1>11169     </font></a><span class="string">next instance, defined by the first, second or third repetition factor (resp.).</span>
<a name="11170"><font size=-1>11170     </font></a><span class="string">This allows one to generate 3D arrays of molecules.</span>
<a name="11171"><font size=-1>11171     </font></a><span class="string">In general, when the objects are repeated, a translation vector must be given,</span>
<a name="11172"><font size=-1>11172     </font></a><span class="string">since otherwise, the repeated objects pack in the same region of space. As an</span>
<a name="11173"><font size=-1>11173     </font></a><span class="string">exception, one can have a set of molecules regularly spaced on a circle, in</span>
<a name="11174"><font size=-1>11174     </font></a><span class="string">which case, only rotations are needed.</span>
<a name="11175"><font size=-1>11175     </font></a><span class="string">Not present in the dtset array (no internal).</span>
<a name="11176"><font size=-1>11176     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11177"><font size=-1>11177     </font></a><span class="default">),</span>
<a name="11178"><font size=-1>11178     </font></a><span class="default"></span>
<a name="11179"><font size=-1>11179     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11180"><font size=-1>11180     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objbat&quot;</span><span class="default">,</span>
<a name="11181"><font size=-1>11181     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11182"><font size=-1>11182     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11183"><font size=-1>11183     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11184"><font size=-1>11184     </font></a><span class="default">    dimensions=[</span><span class="string">'[[objbn]]'</span><span class="default">],</span>
<a name="11185"><font size=-1>11185     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect B: list of AToms&quot;</span><span class="default">,</span>
<a name="11186"><font size=-1>11186     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11187"><font size=-1>11187     </font></a><span class="default">    requires=</span><span class="string">&quot;[[nobj]] == 2&quot;</span><span class="default">,</span>
<a name="11188"><font size=-1>11188     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11189"><font size=-1>11189     </font></a><span class="string">Gives the list of atoms in object b. This list is specified by giving, for</span>
<a name="11190"><font size=-1>11190     </font></a><span class="string">each atom, its index in the list of coordinates ([[xred]], [[xangst]] or</span>
<a name="11191"><font size=-1>11191     </font></a><span class="string">[[xcart]]), that also corresponds to a type of atom (given by the array type).</span>
<a name="11192"><font size=-1>11192     </font></a><span class="string">These objects can be thought as molecules, or groups of atoms, or parts of</span>
<a name="11193"><font size=-1>11193     </font></a><span class="string">molecules, to be repeated, rotated and translated to generate the full set of</span>
<a name="11194"><font size=-1>11194     </font></a><span class="string">atoms.</span>
<a name="11195"><font size=-1>11195     </font></a><span class="string">Look at [[objbrf]] for further explanations.</span>
<a name="11196"><font size=-1>11196     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11197"><font size=-1>11197     </font></a><span class="default">),</span>
<a name="11198"><font size=-1>11198     </font></a><span class="default"></span>
<a name="11199"><font size=-1>11199     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11200"><font size=-1>11200     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objbax&quot;</span><span class="default">,</span>
<a name="11201"><font size=-1>11201     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11202"><font size=-1>11202     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11203"><font size=-1>11203     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11204"><font size=-1>11204     </font></a><span class="default">    dimensions=[</span><span class="number">6</span><span class="default">],</span>
<a name="11205"><font size=-1>11205     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect B: AXis&quot;</span><span class="default">,</span>
<a name="11206"><font size=-1>11206     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">, </span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="11207"><font size=-1>11207     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;&quot;&quot;[[objbax]] must be provided if ([[nobj]] == 1 and one component of [[objaro]] != 0). Moreover,</span>
<a name="11208"><font size=-1>11208     </font></a><span class="string">[[objaax]] AND [[objbax]] must be provided if ( [[nobj]] == 2 and one component of [[objbro]] != 0 ).&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11209"><font size=-1>11209     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11210"><font size=-1>11210     </font></a><span class="string">Gives, for each object, the cartesian coordinates of two points (first point:</span>
<a name="11211"><font size=-1>11211     </font></a><span class="string">[[objbax]](1:3) second point: [[objbax]](4:6). By default, given in Bohr</span>
<a name="11212"><font size=-1>11212     </font></a><span class="string">atomic units (1 Bohr=0.5291772108 Angstroms), although Angstrom can be</span>
<a name="11213"><font size=-1>11213     </font></a><span class="string">specified, if preferred, since these variables have the '[[LENGTH]]'</span>
<a name="11214"><font size=-1>11214     </font></a><span class="string">characteristics.</span>
<a name="11215"><font size=-1>11215     </font></a><span class="string">The two points define an axis of rotation of the corresponding object.</span>
<a name="11216"><font size=-1>11216     </font></a><span class="string">Note that the rotation of the object is done BEFORE the object is translated.</span>
<a name="11217"><font size=-1>11217     </font></a><span class="string">The sign of the rotation angle is positive if the object is to be rotated</span>
<a name="11218"><font size=-1>11218     </font></a><span class="string">clockwise when looking to it along the axis, from point 1 (coordinates 1:3)</span>
<a name="11219"><font size=-1>11219     </font></a><span class="string">toward point 2 (coordinates 4:6).</span>
<a name="11220"><font size=-1>11220     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11221"><font size=-1>11221     </font></a><span class="default">),</span>
<a name="11222"><font size=-1>11222     </font></a><span class="default"></span>
<a name="11223"><font size=-1>11223     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11224"><font size=-1>11224     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objbn&quot;</span><span class="default">,</span>
<a name="11225"><font size=-1>11225     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11226"><font size=-1>11226     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11227"><font size=-1>11227     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11228"><font size=-1>11228     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11229"><font size=-1>11229     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect B: Number of atoms&quot;</span><span class="default">,</span>
<a name="11230"><font size=-1>11230     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11231"><font size=-1>11231     </font></a><span class="default">    commentdefault=</span><span class="string">&quot; [[objan]] and [[objbn]] MUST be provided if [[nobj]] == 2.&quot;</span><span class="default">,</span>
<a name="11232"><font size=-1>11232     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11233"><font size=-1>11233     </font></a><span class="string">Gives the number of atoms in either object b. The list of atoms is given by</span>
<a name="11234"><font size=-1>11234     </font></a><span class="string">the variables [[objbat]].</span>
<a name="11235"><font size=-1>11235     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11236"><font size=-1>11236     </font></a><span class="default">),</span>
<a name="11237"><font size=-1>11237     </font></a><span class="default"></span>
<a name="11238"><font size=-1>11238     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11239"><font size=-1>11239     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objbrf&quot;</span><span class="default">,</span>
<a name="11240"><font size=-1>11240     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11241"><font size=-1>11241     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11242"><font size=-1>11242     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11243"><font size=-1>11243     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="11244"><font size=-1>11244     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">],</span>
<a name="11245"><font size=-1>11245     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect B: Repetition Factors&quot;</span><span class="default">,</span>
<a name="11246"><font size=-1>11246     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11247"><font size=-1>11247     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11248"><font size=-1>11248     </font></a><span class="string">Gives three repetition factors of the objects a or b.</span>
<a name="11249"><font size=-1>11249     </font></a><span class="string">This gives the opportunity to generate a three-dimensional set of repeated</span>
<a name="11250"><font size=-1>11250     </font></a><span class="string">objects, although a simple one-dimensional repetition will be easily obtained</span>
<a name="11251"><font size=-1>11251     </font></a><span class="string">through the specification of</span>
<a name="11252"><font size=-1>11252     </font></a><span class="string">`nrep 1 1` where `nrep` is the 1D repetition factor.</span>
<a name="11253"><font size=-1>11253     </font></a><span class="string">The initial rotation and translation of the object, as well as the increment</span>
<a name="11254"><font size=-1>11254     </font></a><span class="string">of rotation or translation from one object to the next are specified by the</span>
<a name="11255"><font size=-1>11255     </font></a><span class="string">variables [[objbro]] and [[objbtr]], for object b.</span>
<a name="11256"><font size=-1>11256     </font></a><span class="string">Note that the atom manipulator will generate the full set of atoms from the</span>
<a name="11257"><font size=-1>11257     </font></a><span class="string">primitive set of atoms using the following order: it will process each atom</span>
<a name="11258"><font size=-1>11258     </font></a><span class="string">in the primitive list one by one, determine whether it belongs to either</span>
<a name="11259"><font size=-1>11259     </font></a><span class="string">object a or object b, and then repeat it taking into account the proper</span>
<a name="11260"><font size=-1>11260     </font></a><span class="string">rotation and translation, with the fastest varying repetition factor being the</span>
<a name="11261"><font size=-1>11261     </font></a><span class="string">first, then the second, then the third.</span>
<a name="11262"><font size=-1>11262     </font></a><span class="string">In the final list of atoms, one will first find the atoms generated from atom</span>
<a name="11263"><font size=-1>11263     </font></a><span class="string">1 in the primitive list, then those generated from atom 2 in the primitive</span>
<a name="11264"><font size=-1>11264     </font></a><span class="string">list, and so on.</span>
<a name="11265"><font size=-1>11265     </font></a><span class="string">If the atom manipulator is only used to rotate or translate an object, without</span>
<a name="11266"><font size=-1>11266     </font></a><span class="string">repeating it, simply use `1 1 1`, which is also the Default value.</span>
<a name="11267"><font size=-1>11267     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11268"><font size=-1>11268     </font></a><span class="default">),</span>
<a name="11269"><font size=-1>11269     </font></a><span class="default"></span>
<a name="11270"><font size=-1>11270     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11271"><font size=-1>11271     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objbro&quot;</span><span class="default">,</span>
<a name="11272"><font size=-1>11272     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11273"><font size=-1>11273     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11274"><font size=-1>11274     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11275"><font size=-1>11275     </font></a><span class="default">    dimensions=[</span><span class="number">4</span><span class="default">],</span>
<a name="11276"><font size=-1>11276     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">4</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="11277"><font size=-1>11277     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect B: ROtations&quot;</span><span class="default">,</span>
<a name="11278"><font size=-1>11278     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="11279"><font size=-1>11279     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;(no rotation)&quot;</span><span class="default">,</span>
<a name="11280"><font size=-1>11280     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11281"><font size=-1>11281     </font></a><span class="string">Give, for each object, the angles of rotation in degrees to be applied to the</span>
<a name="11282"><font size=-1>11282     </font></a><span class="string">corresponding object.</span>
<a name="11283"><font size=-1>11283     </font></a><span class="string">The rotation is applied before the translation, and the axis is defined by the</span>
<a name="11284"><font size=-1>11284     </font></a><span class="string">variable [[objbax]]. See the latter variable for the</span>
<a name="11285"><font size=-1>11285     </font></a><span class="string">definition of the sign of the rotation.</span>
<a name="11286"><font size=-1>11286     </font></a><span class="string">The first component [[objbro]](1) gives the angle of</span>
<a name="11287"><font size=-1>11287     </font></a><span class="string">rotation to be applied to the first instance of the object. The second, third</span>
<a name="11288"><font size=-1>11288     </font></a><span class="string">or fourth component (resp.) gives the increment of rotation angle from one</span>
<a name="11289"><font size=-1>11289     </font></a><span class="string">instance to the next instance, defined by the first, second or third</span>
<a name="11290"><font size=-1>11290     </font></a><span class="string">repetition factor (resp.). This allows one to generate 3D arrays of molecules</span>
<a name="11291"><font size=-1>11291     </font></a><span class="string">with different rotation angles.</span>
<a name="11292"><font size=-1>11292     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11293"><font size=-1>11293     </font></a><span class="default">),</span>
<a name="11294"><font size=-1>11294     </font></a><span class="default"></span>
<a name="11295"><font size=-1>11295     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11296"><font size=-1>11296     </font></a><span class="default">    abivarname=</span><span class="string">&quot;objbtr&quot;</span><span class="default">,</span>
<a name="11297"><font size=-1>11297     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="11298"><font size=-1>11298     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11299"><font size=-1>11299     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="11300"><font size=-1>11300     </font></a><span class="default">    dimensions=[</span><span class="number">12</span><span class="default">],</span>
<a name="11301"><font size=-1>11301     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">12</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="11302"><font size=-1>11302     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OBJect B: TRanslations&quot;</span><span class="default">,</span>
<a name="11303"><font size=-1>11303     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">, </span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="11304"><font size=-1>11304     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;(no translation)&quot;</span><span class="default">,</span>
<a name="11305"><font size=-1>11305     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11306"><font size=-1>11306     </font></a><span class="string">Give, for each object, the vectors of translations, in cartesian coordinates,</span>
<a name="11307"><font size=-1>11307     </font></a><span class="string">to be applied to the corresponding object. By default, given in Bohr atomic</span>
<a name="11308"><font size=-1>11308     </font></a><span class="string">units (1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified, if</span>
<a name="11309"><font size=-1>11309     </font></a><span class="string">preferred, since these variables have the '[[LENGTH]]' characteristics.</span>
<a name="11310"><font size=-1>11310     </font></a><span class="string">The translation is applied after the rotation.</span>
<a name="11311"><font size=-1>11311     </font></a><span class="string">The first vector [[objatr]](3,1) and [[objbtr]](3,1) gives the translation to</span>
<a name="11312"><font size=-1>11312     </font></a><span class="string">be applied to the first instance of the object. The second, third or fourth</span>
<a name="11313"><font size=-1>11313     </font></a><span class="string">component (resp.) gives the increment of translation from one instance to the</span>
<a name="11314"><font size=-1>11314     </font></a><span class="string">next instance, defined by the first, second or third repetition factor (resp.).</span>
<a name="11315"><font size=-1>11315     </font></a><span class="string">This allows one to generate 3D arrays of molecules.</span>
<a name="11316"><font size=-1>11316     </font></a><span class="string">In general, when the objects are repeated, a translation vector must be given,</span>
<a name="11317"><font size=-1>11317     </font></a><span class="string">since otherwise, the repeated objects pack in the same region of space. As an</span>
<a name="11318"><font size=-1>11318     </font></a><span class="string">exception, one can have a set of molecules regularly spaced on a circle, in</span>
<a name="11319"><font size=-1>11319     </font></a><span class="string">which case, only rotations are needed.</span>
<a name="11320"><font size=-1>11320     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11321"><font size=-1>11321     </font></a><span class="default">),</span>
<a name="11322"><font size=-1>11322     </font></a><span class="default"></span>
<a name="11323"><font size=-1>11323     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11324"><font size=-1>11324     </font></a><span class="default">    abivarname=</span><span class="string">&quot;occ&quot;</span><span class="default">,</span>
<a name="11325"><font size=-1>11325     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="11326"><font size=-1>11326     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11327"><font size=-1>11327     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_basic'</span><span class="default">],</span>
<a name="11328"><font size=-1>11328     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nband]]'</span><span class="default">, </span><span class="string">&quot;[[mband]]&quot;</span><span class="default">, </span><span class="string">&quot;[[nsppol]]&quot;</span><span class="default">],</span>
<a name="11329"><font size=-1>11329     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="11330"><font size=-1>11330     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OCCupation numbers&quot;</span><span class="default">,</span>
<a name="11331"><font size=-1>11331     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="11332"><font size=-1>11332     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11333"><font size=-1>11333     </font></a><span class="string">Gives occupation numbers for all bands in the problem. Needed if [[occopt]] == 0</span>
<a name="11334"><font size=-1>11334     </font></a><span class="string">or [[occopt]] == 2. Ignored otherwise. Also ignored when [[iscf]] = -2.</span>
<a name="11335"><font size=-1>11335     </font></a><span class="string">Typical band occupancy is either 2 or 0, but can be 1 for half-occupied band</span>
<a name="11336"><font size=-1>11336     </font></a><span class="string">or other choices in special circumstances.</span>
<a name="11337"><font size=-1>11337     </font></a><span class="string"></span>
<a name="11338"><font size=-1>11338     </font></a><span class="string">If [[occopt]] is not 2, then the occupancies must be the same for each k point.</span>
<a name="11339"><font size=-1>11339     </font></a><span class="string"></span>
<a name="11340"><font size=-1>11340     </font></a><span class="string">If [[occopt]] = 2, then the band occupancies must be provided explicitly for</span>
<a name="11341"><font size=-1>11341     </font></a><span class="string">each band, EACH k POINT, and EACH SPIN-POLARIZATION, in an array which runs</span>
<a name="11342"><font size=-1>11342     </font></a><span class="string">over all bands, k points, and spin-polarizations.</span>
<a name="11343"><font size=-1>11343     </font></a><span class="string">The order of entries in the array would correspond to all bands at the first k</span>
<a name="11344"><font size=-1>11344     </font></a><span class="string">point (spin up), then all bands at the second k point (spin up), etc, then all</span>
<a name="11345"><font size=-1>11345     </font></a><span class="string">k-points spin down.</span>
<a name="11346"><font size=-1>11346     </font></a><span class="string">The total number of array elements which must be provided is</span>
<a name="11347"><font size=-1>11347     </font></a><span class="string">( [[nband]](1)+[[nband]](2)+...+ [[nband]]([[nkpt]]) ) * [[nsppol]].</span>
<a name="11348"><font size=-1>11348     </font></a><span class="string">The occupation numbers evolve only for metallic occupations, that is, [[occopt]]  3.</span>
<a name="11349"><font size=-1>11349     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11350"><font size=-1>11350     </font></a><span class="default">),</span>
<a name="11351"><font size=-1>11351     </font></a><span class="default"></span>
<a name="11352"><font size=-1>11352     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11353"><font size=-1>11353     </font></a><span class="default">    abivarname=</span><span class="string">&quot;occopt&quot;</span><span class="default">,</span>
<a name="11354"><font size=-1>11354     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="11355"><font size=-1>11355     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11356"><font size=-1>11356     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_basic'</span><span class="default">, </span><span class="string">'STM_compulsory'</span><span class="default">],</span>
<a name="11357"><font size=-1>11357     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11358"><font size=-1>11358     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="11359"><font size=-1>11359     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OCCupation OPTion&quot;</span><span class="default">,</span>
<a name="11360"><font size=-1>11360     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11361"><font size=-1>11361     </font></a><span class="string">Controls how input parameters [[nband]], [[occ]], and [[wtk]] are handled.</span>
<a name="11362"><font size=-1>11362     </font></a><span class="string"></span>
<a name="11363"><font size=-1>11363     </font></a><span class="string">  * [[occopt]] = 0:</span>
<a name="11364"><font size=-1>11364     </font></a><span class="string">All k points and spins have the same number of bands. All k points have the same occupancies of bands for a given spin</span>
<a name="11365"><font size=-1>11365     </font></a><span class="string">(but these occupancies may differ for spin up and spin down - typical for ferromagnetic insulators).</span>
<a name="11366"><font size=-1>11366     </font></a><span class="string">[[nband]] is given as a single number, and [[occ]]([[nband]] * [[nsppol]]) is an array of</span>
<a name="11367"><font size=-1>11367     </font></a><span class="string">[[nband]] * [[nsppol]] elements, read in by the code.</span>
<a name="11368"><font size=-1>11368     </font></a><span class="string">The k point weights in array [[wtk]]([[nkpt]]) are automatically normalized by</span>
<a name="11369"><font size=-1>11369     </font></a><span class="string">the code to add to 1. They cannot differ for differing spins.</span>
<a name="11370"><font size=-1>11370     </font></a><span class="string"></span>
<a name="11371"><font size=-1>11371     </font></a><span class="string">  * [[occopt]] = 1:</span>
<a name="11372"><font size=-1>11372     </font></a><span class="string">Same as [[occopt]] = 0, except that the array [[occ]] is automatically generated</span>
<a name="11373"><font size=-1>11373     </font></a><span class="string">by the code, to give a semiconductor.</span>
<a name="11374"><font size=-1>11374     </font></a><span class="string">An error occurs when filling cannot be done with occupation numbers equal to 2</span>
<a name="11375"><font size=-1>11375     </font></a><span class="string">or 0 in each k-point (non-spin-polarized case), or with occupation numbers</span>
<a name="11376"><font size=-1>11376     </font></a><span class="string">equal to 1 or 0 in each k-point (spin-polarized case). If [[nsppol]] = 2 and</span>
<a name="11377"><font size=-1>11377     </font></a><span class="string">[[occopt]] == 1 is used, the user has to impose the magnetization, using</span>
<a name="11378"><font size=-1>11378     </font></a><span class="string">[[spinmagntarget]], except for the case of a single isolated Hydrogen atom.</span>
<a name="11379"><font size=-1>11379     </font></a><span class="string"></span>
<a name="11380"><font size=-1>11380     </font></a><span class="string">  * [[occopt]] = 2:</span>
<a name="11381"><font size=-1>11381     </font></a><span class="string">k points may optionally have different numbers of bands and different</span>
<a name="11382"><font size=-1>11382     </font></a><span class="string">occupancies. [[nband]]([[nkpt]] * [[nsppol]]) is given explicitly as an array of</span>
<a name="11383"><font size=-1>11383     </font></a><span class="string">[[nkpt]] * [[nsppol]] elements. [[occ]]() is given explicitly for all bands at</span>
<a name="11384"><font size=-1>11384     </font></a><span class="string">each k point, and eventually for each spin -- the total number of elements is</span>
<a name="11385"><font size=-1>11385     </font></a><span class="string">the sum of [[nband]](ikpt) over all k points and spins. The k point weights</span>
<a name="11386"><font size=-1>11386     </font></a><span class="string">[[wtk]] ([[nkpt]]) are NOT automatically normalized under this option.</span>
<a name="11387"><font size=-1>11387     </font></a><span class="string"></span>
<a name="11388"><font size=-1>11388     </font></a><span class="string">  * [[occopt]] = 3, 4, 5, 6 and 7:</span>
<a name="11389"><font size=-1>11389     </font></a><span class="string">Metallic occupation of levels, using different occupation schemes (see below).</span>
<a name="11390"><font size=-1>11390     </font></a><span class="string">The corresponding thermal broadening, or cold smearing, is defined by the</span>
<a name="11391"><font size=-1>11391     </font></a><span class="string">input variable [[tsmear]] (see below: the variable xx is the energy in Ha,</span>
<a name="11392"><font size=-1>11392     </font></a><span class="string">divided by [[tsmear]])</span>
<a name="11393"><font size=-1>11393     </font></a><span class="string">Like for [[occopt]] = 1, the variable [[occ]] is not read.</span>
<a name="11394"><font size=-1>11394     </font></a><span class="string">All k points have the same number of bands, [[nband]] is given as a single</span>
<a name="11395"><font size=-1>11395     </font></a><span class="string">number, read by the code.</span>
<a name="11396"><font size=-1>11396     </font></a><span class="string">The k point weights in array [[wtk]]([[nkpt]]) are automatically normalized by</span>
<a name="11397"><font size=-1>11397     </font></a><span class="string">the code to add to 1.</span>
<a name="11398"><font size=-1>11398     </font></a><span class="string"></span>
<a name="11399"><font size=-1>11399     </font></a><span class="string">    * [[occopt]] = 3:</span>
<a name="11400"><font size=-1>11400     </font></a><span class="string">Fermi-Dirac smearing (finite-temperature metal) Smeared delta function:</span>
<a name="11401"><font size=-1>11401     </font></a><span class="string">0.25d0/(cosh(xx/2.0d0)**2)</span>
<a name="11402"><font size=-1>11402     </font></a><span class="string"></span>
<a name="11403"><font size=-1>11403     </font></a><span class="string">    * [[occopt]] = 4:</span>
<a name="11404"><font size=-1>11404     </font></a><span class="string">&quot;Cold smearing&quot; of N. Marzari (see his thesis work), with a=-.5634</span>
<a name="11405"><font size=-1>11405     </font></a><span class="string">(minimization of the bump)</span>
<a name="11406"><font size=-1>11406     </font></a><span class="string">Smeared delta function:</span>
<a name="11407"><font size=-1>11407     </font></a><span class="string">exp(-xx  2  )/sqrt(pi) * (1.5d0+xx*(-a*1.5d0+xx*(-1.0d0+a*xx)))</span>
<a name="11408"><font size=-1>11408     </font></a><span class="string"></span>
<a name="11409"><font size=-1>11409     </font></a><span class="string">    * [[occopt]] = 5:</span>
<a name="11410"><font size=-1>11410     </font></a><span class="string">&quot;Cold smearing&quot; of N. Marzari (see his thesis work), with a=-.8165 (monotonic</span>
<a name="11411"><font size=-1>11411     </font></a><span class="string">function in the tail)</span>
<a name="11412"><font size=-1>11412     </font></a><span class="string">Same smeared delta function as [[occopt]] = 4, with different a.</span>
<a name="11413"><font size=-1>11413     </font></a><span class="string"></span>
<a name="11414"><font size=-1>11414     </font></a><span class="string">    * [[occopt]] = 6:</span>
<a name="11415"><font size=-1>11415     </font></a><span class="string">Smearing of Methfessel and Paxton [[cite:Methfessel1989]] with Hermite polynomial</span>
<a name="11416"><font size=-1>11416     </font></a><span class="string">of degree 2, corresponding to &quot;Cold smearing&quot; of N. Marzari with a=0 (so, same</span>
<a name="11417"><font size=-1>11417     </font></a><span class="string">smeared delta function as [[occopt]] = 4, with different a).</span>
<a name="11418"><font size=-1>11418     </font></a><span class="string"></span>
<a name="11419"><font size=-1>11419     </font></a><span class="string">    * [[occopt]] = 7:</span>
<a name="11420"><font size=-1>11420     </font></a><span class="string">Gaussian smearing, corresponding to the 0 order Hermite polynomial of</span>
<a name="11421"><font size=-1>11421     </font></a><span class="string">Methfessel and Paxton.</span>
<a name="11422"><font size=-1>11422     </font></a><span class="string">Smeared delta function: 1.0d0*exp(-xx**2)/sqrt(pi)</span>
<a name="11423"><font size=-1>11423     </font></a><span class="string"></span>
<a name="11424"><font size=-1>11424     </font></a><span class="string">    * [[occopt]] = 8:</span>
<a name="11425"><font size=-1>11425     </font></a><span class="string">Uniform smearing (the delta function is replaced by a constant function of</span>
<a name="11426"><font size=-1>11426     </font></a><span class="string">value one over ]-1/2,1/2[ (with one-half value at the boundaries). Used for</span>
<a name="11427"><font size=-1>11427     </font></a><span class="string">testing purposes only.</span>
<a name="11428"><font size=-1>11428     </font></a><span class="string"></span>
<a name="11429"><font size=-1>11429     </font></a><span class="string">!!! warning</span>
<a name="11430"><font size=-1>11430     </font></a><span class="string">    One can use metallic occupation of levels in the case of a molecule,</span>
<a name="11431"><font size=-1>11431     </font></a><span class="string">    in order to avoid any problem with degenerate levels. However, it is advised</span>
<a name="11432"><font size=-1>11432     </font></a><span class="string">    NOT to use [[occopt]] = 6 (and to a lesser extent [[occopt]] = 4 and 5), since the</span>
<a name="11433"><font size=-1>11433     </font></a><span class="string">    associated number of electron versus the Fermi energy is NOT guaranteed to be</span>
<a name="11434"><font size=-1>11434     </font></a><span class="string">    a monotonic function. For true metals, AND a sufficiently dense sampling of</span>
<a name="11435"><font size=-1>11435     </font></a><span class="string">    the Brillouin zone, this should not happen, but be cautious ! As an indication</span>
<a name="11436"><font size=-1>11436     </font></a><span class="string">    of this problem, a small variation of input parameters might lead to a jump of</span>
<a name="11437"><font size=-1>11437     </font></a><span class="string">    total energy, because there might be two or even three possible values of the</span>
<a name="11438"><font size=-1>11438     </font></a><span class="string">    Fermi energy, and the bisection algorithm finds one or the other.</span>
<a name="11439"><font size=-1>11439     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11440"><font size=-1>11440     </font></a><span class="default">),</span>
<a name="11441"><font size=-1>11441     </font></a><span class="default"></span>
<a name="11442"><font size=-1>11442     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11443"><font size=-1>11443     </font></a><span class="default">    abivarname=</span><span class="string">&quot;omegasimax&quot;</span><span class="default">,</span>
<a name="11444"><font size=-1>11444     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="11445"><font size=-1>11445     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11446"><font size=-1>11446     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="11447"><font size=-1>11447     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11448"><font size=-1>11448     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'eV'</span><span class="default">, value=</span><span class="number">50</span><span class="default">),</span>
<a name="11449"><font size=-1>11449     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OMEGA to evaluate Sigma along the Imaginary axis D: MAXimal value&quot;</span><span class="default">,</span>
<a name="11450"><font size=-1>11450     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="11451"><font size=-1>11451     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4 and [[gwcalctyp]] == 1&quot;</span><span class="default">,</span>
<a name="11452"><font size=-1>11452     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11453"><font size=-1>11453     </font></a><span class="string">[[omegasimax]] defines the maximum frequency along the imaginary the axis. In</span>
<a name="11454"><font size=-1>11454     </font></a><span class="string">conjunction with [[nomegasi]], [[omegasimax]] uniquely defines the linear mesh</span>
<a name="11455"><font size=-1>11455     </font></a><span class="string">employed to sample the self-energy along the imaginary axis.</span>
<a name="11456"><font size=-1>11456     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11457"><font size=-1>11457     </font></a><span class="default">),</span>
<a name="11458"><font size=-1>11458     </font></a><span class="default"></span>
<a name="11459"><font size=-1>11459     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11460"><font size=-1>11460     </font></a><span class="default">    abivarname=</span><span class="string">&quot;omegasrdmax&quot;</span><span class="default">,</span>
<a name="11461"><font size=-1>11461     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="11462"><font size=-1>11462     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11463"><font size=-1>11463     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="11464"><font size=-1>11464     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11465"><font size=-1>11465     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'eV'</span><span class="default">, value=</span><span class="number">1.0</span><span class="default">),</span>
<a name="11466"><font size=-1>11466     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OMEGA to evaluate the Sigma Real axis Derivative: MAXimal value&quot;</span><span class="default">,</span>
<a name="11467"><font size=-1>11467     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="11468"><font size=-1>11468     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="11469"><font size=-1>11469     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11470"><font size=-1>11470     </font></a><span class="string">The maximum distance from the KS energy where to evaluate Sigma. Sigma is</span>
<a name="11471"><font size=-1>11471     </font></a><span class="string">evaluated at [ KS_energy - [[omegasrdmax]], KS_energy + [[omegasrdmax]] ]</span>
<a name="11472"><font size=-1>11472     </font></a><span class="string">sampled [[nomegasrd]] times.</span>
<a name="11473"><font size=-1>11473     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11474"><font size=-1>11474     </font></a><span class="default">),</span>
<a name="11475"><font size=-1>11475     </font></a><span class="default"></span>
<a name="11476"><font size=-1>11476     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11477"><font size=-1>11477     </font></a><span class="default">    abivarname=</span><span class="string">&quot;optcell&quot;</span><span class="default">,</span>
<a name="11478"><font size=-1>11478     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="11479"><font size=-1>11479     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11480"><font size=-1>11480     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_basic'</span><span class="default">, </span><span class="string">'GeoOpt_compulsory'</span><span class="default">],</span>
<a name="11481"><font size=-1>11481     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11482"><font size=-1>11482     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11483"><font size=-1>11483     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OPTimize the CELL shape and dimensions&quot;</span><span class="default">,</span>
<a name="11484"><font size=-1>11484     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="11485"><font size=-1>11485     </font></a><span class="string">Allows to optimize the unit cell shape and dimensions, when [[ionmov]] &gt;= 2 or</span>
<a name="11486"><font size=-1>11486     </font></a><span class="string">3. The configuration for which the stress almost vanishes is iteratively</span>
<a name="11487"><font size=-1>11487     </font></a><span class="string">determined, by using the same algorithms as for the nuclei positions. Will</span>
<a name="11488"><font size=-1>11488     </font></a><span class="string">eventually modify [[acell]] and/or [[rprim]]. The ionic positions are ALWAYS</span>
<a name="11489"><font size=-1>11489     </font></a><span class="string">updated, according to the forces. A target stress tensor might be defined, see</span>
<a name="11490"><font size=-1>11490     </font></a><span class="string">[[strtarget]].</span>
<a name="11491"><font size=-1>11491     </font></a><span class="string"></span>
<a name="11492"><font size=-1>11492     </font></a><span class="string">  * [[optcell]] = 0: modify nuclear positions, since [[ionmov]] = 2 or 3, but no cell shape and dimension optimisation.</span>
<a name="11493"><font size=-1>11493     </font></a><span class="string">  * [[optcell]] = 1: optimisation of volume only (do not modify [[rprim]], and allow an homogeneous dilatation of the three components of [[acell]])</span>
<a name="11494"><font size=-1>11494     </font></a><span class="string">  * [[optcell]] = 2: full optimization of cell geometry (modify [[acell]] and [[rprim]] \- normalize the vectors of [[rprim]] to generate the [[acell]]). This is the usual mode for cell shape and volume optimization. It takes into account the symmetry of the system, so that only the effectively relevant degrees of freedom are optimized.</span>
<a name="11495"><font size=-1>11495     </font></a><span class="string">  * [[optcell]] = 3: constant-volume optimization of cell geometry (modify [[acell]] and [[rprim]] under constraint \- normalize the vectors of [[rprim]] to generate the [[acell]])</span>
<a name="11496"><font size=-1>11496     </font></a><span class="string">  * [[optcell]] = 4, 5 or 6: optimize [[acell]](1), [[acell]](2), or [[acell]](3), respectively (only works if the two other vectors are orthogonal to the optimized one, the latter being along its cartesian axis).</span>
<a name="11497"><font size=-1>11497     </font></a><span class="string">  * [[optcell]] = 7, 8 or 9: optimize the cell geometry while keeping the first, second or third vector unchanged (only works if the two other vectors are orthogonal to the one left unchanged, the latter being along its cartesian axis).</span>
<a name="11498"><font size=-1>11498     </font></a><span class="string"></span>
<a name="11499"><font size=-1>11499     </font></a><span class="string">A few details require attention when performing unit cell optimisation:</span>
<a name="11500"><font size=-1>11500     </font></a><span class="string"></span>
<a name="11501"><font size=-1>11501     </font></a><span class="string">  * one has to get rid of the discontinuities due to discrete changes of plane wave number with cell size, by using a suitable value of [[ecutsm]];</span>
<a name="11502"><font size=-1>11502     </font></a><span class="string">  * one has to allow for the possibility of a larger sphere of plane waves, by using [[dilatmx]];</span>
<a name="11503"><font size=-1>11503     </font></a><span class="string">  * one might have to adjust the scale of stresses to the scale of forces, by using [[strfact]].</span>
<a name="11504"><font size=-1>11504     </font></a><span class="string">  * if all the reduced coordinates of atoms are fixed by symmetry, one cannot use [[toldff]] to stop the SCF cycle. (Suggestion: use [[toldfe]] with a small value, like 1.0d-10)</span>
<a name="11505"><font size=-1>11505     </font></a><span class="string"></span>
<a name="11506"><font size=-1>11506     </font></a><span class="string">It is STRONGLY suggested first to optimize the ionic positions without cell</span>
<a name="11507"><font size=-1>11507     </font></a><span class="string">shape and size optimization ([[optcell]] = 0), then start the cell shape and</span>
<a name="11508"><font size=-1>11508     </font></a><span class="string">size optimization from the cell with relaxed ionic positions. Presently</span>
<a name="11509"><font size=-1>11509     </font></a><span class="string">(v3.1), one cannot restart ([[restartxf]]) a calculation with a non-zero</span>
<a name="11510"><font size=-1>11510     </font></a><span class="string">[[optcell]] value from the (x,f) history of another run with a different non-</span>
<a name="11511"><font size=-1>11511     </font></a><span class="string">zero [[optcell]] value. There are still a few problems at that level.</span>
<a name="11512"><font size=-1>11512     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11513"><font size=-1>11513     </font></a><span class="default">),</span>
<a name="11514"><font size=-1>11514     </font></a><span class="default"></span>
<a name="11515"><font size=-1>11515     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11516"><font size=-1>11516     </font></a><span class="default">    abivarname=</span><span class="string">&quot;optdriver&quot;</span><span class="default">,</span>
<a name="11517"><font size=-1>11517     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="11518"><font size=-1>11518     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11519"><font size=-1>11519     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_compulsory'</span><span class="default">,</span>
<a name="11520"><font size=-1>11520     </font></a><span class="default"> </span><span class="string">'GWls_compulsory'</span><span class="default">,</span>
<a name="11521"><font size=-1>11521     </font></a><span class="default"> </span><span class="string">'ElPhonInt_compulsory'</span><span class="default">,</span>
<a name="11522"><font size=-1>11522     </font></a><span class="default"> </span><span class="string">'GW_compulsory'</span><span class="default">,</span>
<a name="11523"><font size=-1>11523     </font></a><span class="default"> </span><span class="string">'BSE_compulsory'</span><span class="default">,</span>
<a name="11524"><font size=-1>11524     </font></a><span class="default"> </span><span class="string">'DFPT_compulsory'</span><span class="default">,</span>
<a name="11525"><font size=-1>11525     </font></a><span class="default"> </span><span class="string">'Susceptibility_compulsory'</span><span class="default">,</span>
<a name="11526"><font size=-1>11526     </font></a><span class="default"> </span><span class="string">'SelfEnergy_compulsory'</span><span class="default">],</span>
<a name="11527"><font size=-1>11527     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11528"><font size=-1>11528     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11529"><font size=-1>11529     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OPTions for the DRIVER&quot;</span><span class="default">,</span>
<a name="11530"><font size=-1>11530     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11531"><font size=-1>11531     </font></a><span class="string">For each dataset, choose the task to be done, at the level of the &quot;driver&quot;</span>
<a name="11532"><font size=-1>11532     </font></a><span class="string">routine.</span>
<a name="11533"><font size=-1>11533     </font></a><span class="string"></span>
<a name="11534"><font size=-1>11534     </font></a><span class="string">The choice is among:</span>
<a name="11535"><font size=-1>11535     </font></a><span class="string"></span>
<a name="11536"><font size=-1>11536     </font></a><span class="string">  * [[optdriver]] = 0: ground-state calculation (GS), routine &quot;gstate&quot;</span>
<a name="11537"><font size=-1>11537     </font></a><span class="string">  * [[optdriver]] = 1: response-function calculation (RF), routine &quot;respfn&quot;</span>
<a name="11538"><font size=-1>11538     </font></a><span class="string">  * [[optdriver]] = 2: susceptibility calculation (SUS), routine &quot;suscep&quot;</span>
<a name="11539"><font size=-1>11539     </font></a><span class="string">  * [[optdriver]] = 3: susceptibility and dielectric matrix calculation (SCR), routine &quot;screening&quot;</span>
<a name="11540"><font size=-1>11540     </font></a><span class="string">    (see the input variables [[ecutwfn]], [[ecuteps]], [[ppmfrq]], [[getwfk]], as</span>
<a name="11541"><font size=-1>11541     </font></a><span class="string">    well as [[nbandkss]] and [[nband]])</span>
<a name="11542"><font size=-1>11542     </font></a><span class="string">  * [[optdriver]] = 4: self-energy calculation (SIG), routine &quot;sigma&quot;</span>
<a name="11543"><font size=-1>11543     </font></a><span class="string">  * [[optdriver]] = 5: non-linear response functions (NONLINEAR), using the 2n+1</span>
<a name="11544"><font size=-1>11544     </font></a><span class="string">    theorem, routine &quot;nonlinear&quot;</span>
<a name="11545"><font size=-1>11545     </font></a><span class="string">  * [[optdriver]] =7: electron-phonon coupling (EPH)</span>
<a name="11546"><font size=-1>11546     </font></a><span class="string">  * [[optdriver]] =66: GW using Lanczos-Sternheimer, see input variables whose</span>
<a name="11547"><font size=-1>11547     </font></a><span class="string">    name start with gwls_*.</span>
<a name="11548"><font size=-1>11548     </font></a><span class="string">  * [[optdriver]] = 99: Bethe-Salpeter calculation (BSE), routine &quot;bethe_salpeter&quot;</span>
<a name="11549"><font size=-1>11549     </font></a><span class="string"></span>
<a name="11550"><font size=-1>11550     </font></a><span class="string">If one of [[rfphon]], [[rfddk]], [[rfelfd]], or [[rfstrs]] is non-zero, while</span>
<a name="11551"><font size=-1>11551     </font></a><span class="string">[[optdriver]] is not defined in the input file, ABINIT will set [[optdriver]]</span>
<a name="11552"><font size=-1>11552     </font></a><span class="string">to 1 automatically. These input variables ([[rfphon]], [[rfddk]], [[rfelfd]],</span>
<a name="11553"><font size=-1>11553     </font></a><span class="string">and [[rfstrs]]) must be zero if [[optdriver]] is not set to 1.</span>
<a name="11554"><font size=-1>11554     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11555"><font size=-1>11555     </font></a><span class="default">),</span>
<a name="11556"><font size=-1>11556     </font></a><span class="default"></span>
<a name="11557"><font size=-1>11557     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11558"><font size=-1>11558     </font></a><span class="default">    abivarname=</span><span class="string">&quot;optforces&quot;</span><span class="default">,</span>
<a name="11559"><font size=-1>11559     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="11560"><font size=-1>11560     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11561"><font size=-1>11561     </font></a><span class="default">    topics=[</span><span class="string">'ForcesStresses_basic'</span><span class="default">],</span>
<a name="11562"><font size=-1>11562     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11563"><font size=-1>11563     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[toldff]] or [[tolrff]] != 0'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">2</span><span class="default">}),</span>
<a name="11564"><font size=-1>11564     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OPTions for the calculation of FORCES&quot;</span><span class="default">,</span>
<a name="11565"><font size=-1>11565     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="11566"><font size=-1>11566     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11567"><font size=-1>11567     </font></a><span class="string">Allows to choose options for the calculation of forces.</span>
<a name="11568"><font size=-1>11568     </font></a><span class="string"></span>
<a name="11569"><font size=-1>11569     </font></a><span class="string">  * [[optforces]] = 0: the forces are set to zero, and many steps of the computation of forces are skipped</span>
<a name="11570"><font size=-1>11570     </font></a><span class="string">  * [[optforces]] = 1: calculation of forces at each SCF iteration, allowing to use forces as criterion to stop the SCF cycles</span>
<a name="11571"><font size=-1>11571     </font></a><span class="string">  * [[optforces]] = 2: calculation of forces at the end of the SCF iterations (like the stresses)</span>
<a name="11572"><font size=-1>11572     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11573"><font size=-1>11573     </font></a><span class="default">),</span>
<a name="11574"><font size=-1>11574     </font></a><span class="default"></span>
<a name="11575"><font size=-1>11575     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11576"><font size=-1>11576     </font></a><span class="default">    abivarname=</span><span class="string">&quot;optnlxccc&quot;</span><span class="default">,</span>
<a name="11577"><font size=-1>11577     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="11578"><font size=-1>11578     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11579"><font size=-1>11579     </font></a><span class="default">    topics=[</span><span class="string">'xc_expert'</span><span class="default">],</span>
<a name="11580"><font size=-1>11580     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11581"><font size=-1>11581     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="11582"><font size=-1>11582     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OPTion for the calculation of Non-Linear eXchange-Correlation Core Correction&quot;</span><span class="default">,</span>
<a name="11583"><font size=-1>11583     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="11584"><font size=-1>11584     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11585"><font size=-1>11585     </font></a><span class="string">Allows to choose options for the calculation of non-linear XC correction. At</span>
<a name="11586"><font size=-1>11586     </font></a><span class="string">present, only relevant for the FHI type of pseudopotentials, with pspcod=6.</span>
<a name="11587"><font size=-1>11587     </font></a><span class="string"></span>
<a name="11588"><font size=-1>11588     </font></a><span class="string">  * [[optnlxccc]] = 1: uses the old `psp6cc.f` routine, with inconsistent treatment of real-space derivatives of the core</span>
<a name="11589"><font size=-1>11589     </font></a><span class="string">  function (computed in this routine, while splined in the other parts of the code)</span>
<a name="11590"><font size=-1>11590     </font></a><span class="string">  * [[optnlxccc]] = 2: consistent calculation derivatives, in the `psp6cc_dhr.f` routine from DHamann.</span>
<a name="11591"><font size=-1>11591     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11592"><font size=-1>11592     </font></a><span class="default">),</span>
<a name="11593"><font size=-1>11593     </font></a><span class="default"></span>
<a name="11594"><font size=-1>11594     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11595"><font size=-1>11595     </font></a><span class="default">    abivarname=</span><span class="string">&quot;optstress&quot;</span><span class="default">,</span>
<a name="11596"><font size=-1>11596     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="11597"><font size=-1>11597     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11598"><font size=-1>11598     </font></a><span class="default">    topics=[</span><span class="string">'ForcesStresses_basic'</span><span class="default">],</span>
<a name="11599"><font size=-1>11599     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11600"><font size=-1>11600     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="11601"><font size=-1>11601     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;OPTion for the computation of STRESS&quot;</span><span class="default">,</span>
<a name="11602"><font size=-1>11602     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11603"><font size=-1>11603     </font></a><span class="string">If set to 1, the computation of stresses is done, in the SCF case (under the</span>
<a name="11604"><font size=-1>11604     </font></a><span class="string">conditions [[iscf]] &gt; 0, [[prtstm]] == 0, [[positron]] == 0, and either</span>
<a name="11605"><font size=-1>11605     </font></a><span class="string">[[nstep]] &gt;0, or [[usepaw]] == 0 or [[irdwfk]] == 1).</span>
<a name="11606"><font size=-1>11606     </font></a><span class="string">Otherwise, to save CPU time, if no optimization of the cell is required, one</span>
<a name="11607"><font size=-1>11607     </font></a><span class="string">can skip the computation of stresses. The CPU time saving might be interesting</span>
<a name="11608"><font size=-1>11608     </font></a><span class="string">for some PAW calculations.</span>
<a name="11609"><font size=-1>11609     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11610"><font size=-1>11610     </font></a><span class="default">),</span>
<a name="11611"><font size=-1>11611     </font></a><span class="default"></span>
<a name="11612"><font size=-1>11612     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11613"><font size=-1>11613     </font></a><span class="default">    abivarname=</span><span class="string">&quot;orbmag&quot;</span><span class="default">,</span>
<a name="11614"><font size=-1>11614     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="11615"><font size=-1>11615     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11616"><font size=-1>11616     </font></a><span class="default">    topics=[</span><span class="string">'MagField_expert'</span><span class="default">],</span>
<a name="11617"><font size=-1>11617     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11618"><font size=-1>11618     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11619"><font size=-1>11619     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ORBital MAGnetization&quot;</span><span class="default">,</span>
<a name="11620"><font size=-1>11620     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="11621"><font size=-1>11621     </font></a><span class="default">    requires=</span><span class="string">&quot;&quot;&quot;[[usepaw]] == 1</span>
<a name="11622"><font size=-1>11622     </font></a><span class="string">[[kptopt]] == 3</span>
<a name="11623"><font size=-1>11623     </font></a><span class="string">[[NPROC]] == 1&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11624"><font size=-1>11624     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11625"><font size=-1>11625     </font></a><span class="string">Compute quantities related to orbital magnetization. Currently only the Chern</span>
<a name="11626"><font size=-1>11626     </font></a><span class="string">number calculated.</span>
<a name="11627"><font size=-1>11627     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11628"><font size=-1>11628     </font></a><span class="default">),</span>
<a name="11629"><font size=-1>11629     </font></a><span class="default"></span>
<a name="11630"><font size=-1>11630     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11631"><font size=-1>11631     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ortalg&quot;</span><span class="default">,</span>
<a name="11632"><font size=-1>11632     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="11633"><font size=-1>11633     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11634"><font size=-1>11634     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="11635"><font size=-1>11635     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11636"><font size=-1>11636     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[wfoptalg]] &gt;= 10 '</span><span class="default">: -</span><span class="number">2</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">2</span><span class="default">}),</span>
<a name="11637"><font size=-1>11637     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ORThogonalisation ALGorithm&quot;</span><span class="default">,</span>
<a name="11638"><font size=-1>11638     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="11639"><font size=-1>11639     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11640"><font size=-1>11640     </font></a><span class="string">Allows to choose the algorithm for orthogonalisation.</span>
<a name="11641"><font size=-1>11641     </font></a><span class="string">Positive or zero values make two projections per line minimisation, one before</span>
<a name="11642"><font size=-1>11642     </font></a><span class="string">the preconditioning, one after. This is the clean application of the band-by-</span>
<a name="11643"><font size=-1>11643     </font></a><span class="string">band CG gradient for finding eigenfunctions.</span>
<a name="11644"><font size=-1>11644     </font></a><span class="string">Negative values make only one projection per line minimisation.</span>
<a name="11645"><font size=-1>11645     </font></a><span class="string">The orthogonalisation step is twice faster, but the convergence is less good.</span>
<a name="11646"><font size=-1>11646     </font></a><span class="string">This actually calls to a better understanding of this effect.</span>
<a name="11647"><font size=-1>11647     </font></a><span class="string">[[ortalg]] = 0, 1 or -1 is the conventional coding.</span>
<a name="11648"><font size=-1>11648     </font></a><span class="string">[[ortalg]] = 2 or -2 try to make better use of existing registers on the</span>
<a name="11649"><font size=-1>11649     </font></a><span class="string">particular machine one is running.</span>
<a name="11650"><font size=-1>11650     </font></a><span class="string">More demanding use of registers is provided by [[ortalg]] = 3 or -3, and so on.</span>
<a name="11651"><font size=-1>11651     </font></a><span class="string">The maximal value is presently 4 and -4.</span>
<a name="11652"><font size=-1>11652     </font></a><span class="string">Tests have shown that [[ortalg]] = 2 or -2 is suitable for use on the available</span>
<a name="11653"><font size=-1>11653     </font></a><span class="string">platforms.</span>
<a name="11654"><font size=-1>11654     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11655"><font size=-1>11655     </font></a><span class="default">),</span>
<a name="11656"><font size=-1>11656     </font></a><span class="default"></span>
<a name="11657"><font size=-1>11657     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11658"><font size=-1>11658     </font></a><span class="default">    abivarname=</span><span class="string">&quot;papiopt&quot;</span><span class="default">,</span>
<a name="11659"><font size=-1>11659     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="11660"><font size=-1>11660     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11661"><font size=-1>11661     </font></a><span class="default">    topics=[</span><span class="string">'Control_expert'</span><span class="default">],</span>
<a name="11662"><font size=-1>11662     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11663"><font size=-1>11663     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11664"><font size=-1>11664     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAPI OPTion&quot;</span><span class="default">,</span>
<a name="11665"><font size=-1>11665     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11666"><font size=-1>11666     </font></a><span class="string">[PAPI](http://icl.cs.utk.edu/papi/index.html) aims to provide the tool</span>
<a name="11667"><font size=-1>11667     </font></a><span class="string">designer and application engineer with a consistent interface and methodology</span>
<a name="11668"><font size=-1>11668     </font></a><span class="string">for use of the performance counter hardware found in most major</span>
<a name="11669"><font size=-1>11669     </font></a><span class="string">microprocessors. PAPI enables software engineers to see, in near real time,</span>
<a name="11670"><font size=-1>11670     </font></a><span class="string">the relation between software performance and processor events.</span>
<a name="11671"><font size=-1>11671     </font></a><span class="string">This option can be used only when ABINIT has been compiled with the `</span>
<a name="11672"><font size=-1>11672     </font></a><span class="string">--enable-papi ` configure option.</span>
<a name="11673"><font size=-1>11673     </font></a><span class="string">If [[papiopt]] = 1, then PAPI counters are used instead of the usual time()</span>
<a name="11674"><font size=-1>11674     </font></a><span class="string">routine. All the timing output of ABINIT is then done with PAPI values. The</span>
<a name="11675"><font size=-1>11675     </font></a><span class="string">measurements are more accurate and give also access to the flops of the calculation.</span>
<a name="11676"><font size=-1>11676     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11677"><font size=-1>11677     </font></a><span class="default">),</span>
<a name="11678"><font size=-1>11678     </font></a><span class="default"></span>
<a name="11679"><font size=-1>11679     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11680"><font size=-1>11680     </font></a><span class="default">    abivarname=</span><span class="string">&quot;paral_atom&quot;</span><span class="default">,</span>
<a name="11681"><font size=-1>11681     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="11682"><font size=-1>11682     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11683"><font size=-1>11683     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_basic'</span><span class="default">],</span>
<a name="11684"><font size=-1>11684     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11685"><font size=-1>11685     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="11686"><font size=-1>11686     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;activate PARALelization over (paw) ATOMic sites&quot;</span><span class="default">,</span>
<a name="11687"><font size=-1>11687     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11688"><font size=-1>11688     </font></a><span class="string">Relevant only for PAW calculations.</span>
<a name="11689"><font size=-1>11689     </font></a><span class="string">This keyword controls the parallel distribution of memory over atomic sites.</span>
<a name="11690"><font size=-1>11690     </font></a><span class="string">Calculations are also distributed using the &quot;kpt-band&quot; communicator.</span>
<a name="11691"><font size=-1>11691     </font></a><span class="string">Compatible with ground-state calculations and response function calculations</span>
<a name="11692"><font size=-1>11692     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11693"><font size=-1>11693     </font></a><span class="default">),</span>
<a name="11694"><font size=-1>11694     </font></a><span class="default"></span>
<a name="11695"><font size=-1>11695     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11696"><font size=-1>11696     </font></a><span class="default">    abivarname=</span><span class="string">&quot;paral_kgb&quot;</span><span class="default">,</span>
<a name="11697"><font size=-1>11697     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="11698"><font size=-1>11698     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11699"><font size=-1>11699     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_basic'</span><span class="default">],</span>
<a name="11700"><font size=-1>11700     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11701"><font size=-1>11701     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11702"><font size=-1>11702     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;activate PARALelization over K-point, G-vectors and Bands&quot;</span><span class="default">,</span>
<a name="11703"><font size=-1>11703     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11704"><font size=-1>11704     </font></a><span class="string">**If paral_kgb is not explicitely put in the input file**, ABINIT</span>
<a name="11705"><font size=-1>11705     </font></a><span class="string">automatically detects if the job has been sent in sequential or in parallel.</span>
<a name="11706"><font size=-1>11706     </font></a><span class="string">In this last case, it detects the number of processors on which the job has</span>
<a name="11707"><font size=-1>11707     </font></a><span class="string">been sent and calculates values of [[npkpt]], [[npfft]], [[npband]],</span>
<a name="11708"><font size=-1>11708     </font></a><span class="string">[[bandpp]], [[npimage]] and [[npspinor]] that are compatible with the number</span>
<a name="11709"><font size=-1>11709     </font></a><span class="string">of processors. It then set paral_kgb to 0 or 1 (see hereunder) and launches the job.</span>
<a name="11710"><font size=-1>11710     </font></a><span class="string"></span>
<a name="11711"><font size=-1>11711     </font></a><span class="string">**If paral_kgb=0**, the parallelization over k-points only is activated. In</span>
<a name="11712"><font size=-1>11712     </font></a><span class="string">this case, [[npkpt]], [[npspinor]], [[npfft]] and [[npband]] are ignored.</span>
<a name="11713"><font size=-1>11713     </font></a><span class="string">Require compilation option --enable-mpi=&quot;yes&quot;.</span>
<a name="11714"><font size=-1>11714     </font></a><span class="string"></span>
<a name="11715"><font size=-1>11715     </font></a><span class="string">**If paral_kgb=1**, the parallelization over bands, FFTs, and k-point/spin-</span>
<a name="11716"><font size=-1>11716     </font></a><span class="string">components is activated (see [[npkpt]], [[npfft]] [[npband]] and eventually</span>
<a name="11717"><font size=-1>11717     </font></a><span class="string">[[npspinor]]). With this parallelization, the work load is split over four</span>
<a name="11718"><font size=-1>11718     </font></a><span class="string">levels of parallelization (three level of parallelisation (kpt-band-fft )+</span>
<a name="11719"><font size=-1>11719     </font></a><span class="string">spin) The different communications almost occur along one dimension only.</span>
<a name="11720"><font size=-1>11720     </font></a><span class="string">Require compilation option --enable-mpi=&quot;yes&quot;.</span>
<a name="11721"><font size=-1>11721     </font></a><span class="string"></span>
<a name="11722"><font size=-1>11722     </font></a><span class="string">HOWTO fix the number of processors along one level of parallelisation:</span>
<a name="11723"><font size=-1>11723     </font></a><span class="string">At first, try to parallelise over the k point and spin (see</span>
<a name="11724"><font size=-1>11724     </font></a><span class="string">[[npkpt]],[[npspinor]]). Otherwise, for unpolarized calculation at the gamma</span>
<a name="11725"><font size=-1>11725     </font></a><span class="string">point, parallelise over the two other levels: the band and FFT ones. For nproc $\leq$ 50, the best speed-up is achieved for [[npband]] = nproc and [[npfft]] = 1</span>
<a name="11726"><font size=-1>11726     </font></a><span class="string">(which is not yet the default). For nproc $\geq$ 50, the best speed-up is achieved</span>
<a name="11727"><font size=-1>11727     </font></a><span class="string">for [[npband]] $\geq$ 4 $\\times$ [[npfft]].</span>
<a name="11728"><font size=-1>11728     </font></a><span class="string"></span>
<a name="11729"><font size=-1>11729     </font></a><span class="string">For additional information, download F. Bottin presentation at the</span>
<a name="11730"><font size=-1>11730     </font></a><span class="string">[ABINIT workshop 2007](https://www.abinit.org/sites/default/files/oldsites/workshop_07/program.html)</span>
<a name="11731"><font size=-1>11731     </font></a><span class="string"></span>
<a name="11732"><font size=-1>11732     </font></a><span class="string">Suggested acknowledgments:</span>
<a name="11733"><font size=-1>11733     </font></a><span class="string">[[cite:Bottin2008]], also available on arXiv, http://arxiv.org/abs/0707.3405.</span>
<a name="11734"><font size=-1>11734     </font></a><span class="string"></span>
<a name="11735"><font size=-1>11735     </font></a><span class="string">If the total number of processors used is compatible with the four levels of</span>
<a name="11736"><font size=-1>11736     </font></a><span class="string">parallelization, the values for [[npkpt]], [[npspinor]], [[npfft]], [[npband]]</span>
<a name="11737"><font size=-1>11737     </font></a><span class="string">and [[bandpp]] will be filled automatically, although the repartition may not</span>
<a name="11738"><font size=-1>11738     </font></a><span class="string">be optimal. To optimize the repartition use:</span>
<a name="11739"><font size=-1>11739     </font></a><span class="string"></span>
<a name="11740"><font size=-1>11740     </font></a><span class="string">**If paral_kgb=1** and **max_ncpus = n $\\ne$ 0** ABINIT will test automatically</span>
<a name="11741"><font size=-1>11741     </font></a><span class="string">if all the processor numbers between 2 and n are convenient for a parallel</span>
<a name="11742"><font size=-1>11742     </font></a><span class="string">calculation and print the possible values in the log file. A weight is</span>
<a name="11743"><font size=-1>11743     </font></a><span class="string">attributed to each possible processors repartition. It is adviced to select a</span>
<a name="11744"><font size=-1>11744     </font></a><span class="string">processor repartition for which the weight is high (as closed to the number of</span>
<a name="11745"><font size=-1>11745     </font></a><span class="string">processors as possible). The code will then stop after the printing. This test</span>
<a name="11746"><font size=-1>11746     </font></a><span class="string">can be done as well with a sequential as with a parallel version of the code.</span>
<a name="11747"><font size=-1>11747     </font></a><span class="string">The user can then choose the adequate number of processor on which he can run</span>
<a name="11748"><font size=-1>11748     </font></a><span class="string">his job. He must put again paral_kgb=1 in the input file and put the</span>
<a name="11749"><font size=-1>11749     </font></a><span class="string">corresponding values for [[npkpt]], [[npfft]], [[npband]],[[bandpp]] and</span>
<a name="11750"><font size=-1>11750     </font></a><span class="string">eventually [[npspinor]] in the input file.</span>
<a name="11751"><font size=-1>11751     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11752"><font size=-1>11752     </font></a><span class="default">),</span>
<a name="11753"><font size=-1>11753     </font></a><span class="default"></span>
<a name="11754"><font size=-1>11754     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11755"><font size=-1>11755     </font></a><span class="default">    abivarname=</span><span class="string">&quot;paral_rf&quot;</span><span class="default">,</span>
<a name="11756"><font size=-1>11756     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="11757"><font size=-1>11757     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11758"><font size=-1>11758     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_basic'</span><span class="default">],</span>
<a name="11759"><font size=-1>11759     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11760"><font size=-1>11760     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11761"><font size=-1>11761     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;activate PARALlelization over Response Function perturbations&quot;</span><span class="default">,</span>
<a name="11762"><font size=-1>11762     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11763"><font size=-1>11763     </font></a><span class="string">This parameter activates the parallelization over perturbations which can be</span>
<a name="11764"><font size=-1>11764     </font></a><span class="string">used during RF-Calculation. It is possible to use this type of parallelization</span>
<a name="11765"><font size=-1>11765     </font></a><span class="string">in combination to the parallelization over k-points.</span>
<a name="11766"><font size=-1>11766     </font></a><span class="string"></span>
<a name="11767"><font size=-1>11767     </font></a><span class="string">Currently total energies calculated by groups, where the master process is not</span>
<a name="11768"><font size=-1>11768     </font></a><span class="string">in, are saved in.status_LOGxxxx files.</span>
<a name="11769"><font size=-1>11769     </font></a><span class="string"></span>
<a name="11770"><font size=-1>11770     </font></a><span class="string">If [[paral_rf]] is set to -1, the code reports the list of irreducible</span>
<a name="11771"><font size=-1>11771     </font></a><span class="string">perturbations for the specified q-point in the log file (YAML format) and then stops.</span>
<a name="11772"><font size=-1>11772     </font></a><span class="string"></span>
<a name="11773"><font size=-1>11773     </font></a><span class="string">[[paral_rf]] can be specified separately for each dataset.</span>
<a name="11774"><font size=-1>11774     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11775"><font size=-1>11775     </font></a><span class="default">),</span>
<a name="11776"><font size=-1>11776     </font></a><span class="default"></span>
<a name="11777"><font size=-1>11777     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11778"><font size=-1>11778     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawcpxocc&quot;</span><span class="default">,</span>
<a name="11779"><font size=-1>11779     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11780"><font size=-1>11780     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11781"><font size=-1>11781     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="11782"><font size=-1>11782     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11783"><font size=-1>11783     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[optdriver]] == 0 and [[ionmov]] &lt; 6 and [[pawspnorb]] == 1 and [[iscf]] &gt;= 10 and ([[kptopt]] !=1 or [[kptopt]]!=2) and [[usepaw]] == 1'</span><span class="default">: </span><span class="number">2</span><span class="default">,</span>
<a name="11784"><font size=-1>11784     </font></a><span class="default"> </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="11785"><font size=-1>11785     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - use ComPleX rhoij OCCupancies&quot;</span><span class="default">,</span>
<a name="11786"><font size=-1>11786     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11787"><font size=-1>11787     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11788"><font size=-1>11788     </font></a><span class="string">The only possible values for [[pawcpxocc]] are 1 or 2.</span>
<a name="11789"><font size=-1>11789     </font></a><span class="string">When [[pawcpxocc]] == 1, &quot;direct&quot; decomposition of total energy cannot be</span>
<a name="11790"><font size=-1>11790     </font></a><span class="string">printed out.</span>
<a name="11791"><font size=-1>11791     </font></a><span class="string">When [[pawcpxocc]] == 2, PAW augmentation occupancies are treated as</span>
<a name="11792"><font size=-1>11792     </font></a><span class="string">COMPLEX; else they are considered as REAL.</span>
<a name="11793"><font size=-1>11793     </font></a><span class="string">This is needed when time-reversal symmetry is broken (typically when spin-</span>
<a name="11794"><font size=-1>11794     </font></a><span class="string">orbit coupling is activated).</span>
<a name="11795"><font size=-1>11795     </font></a><span class="string"></span>
<a name="11796"><font size=-1>11796     </font></a><span class="string">Note for ground-state calculations ([[optdriver]] == 0):</span>
<a name="11797"><font size=-1>11797     </font></a><span class="string">The imaginary part of PAW augmentation occupancies is only used for the</span>
<a name="11798"><font size=-1>11798     </font></a><span class="string">computation of the total energy by &quot;direct scheme&quot;; this is only necessary</span>
<a name="11799"><font size=-1>11799     </font></a><span class="string">when SCF mixing on potential is chosen ([[iscf]] &lt;10).</span>
<a name="11800"><font size=-1>11800     </font></a><span class="string">When SCF mixing on density is chosen ([[iscf]] &gt;= 10), the &quot;direct&quot;</span>
<a name="11801"><font size=-1>11801     </font></a><span class="string">decomposition of energy is only printed out without being used. It is thus</span>
<a name="11802"><font size=-1>11802     </font></a><span class="string">possible to use [[pawcpxocc]] = 1 in the latter case.</span>
<a name="11803"><font size=-1>11803     </font></a><span class="string">In order to save CPU time, when molecular dynamics is selected ([[ionmov]] &gt;= 6)</span>
<a name="11804"><font size=-1>11804     </font></a><span class="string">and SCF mixing done on density ([[iscf]] &gt;= 10), [[pawcpxocc]] = 2 is (by default)</span>
<a name="11805"><font size=-1>11805     </font></a><span class="string">set to **1**</span>
<a name="11806"><font size=-1>11806     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11807"><font size=-1>11807     </font></a><span class="default">),</span>
<a name="11808"><font size=-1>11808     </font></a><span class="default"></span>
<a name="11809"><font size=-1>11809     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11810"><font size=-1>11810     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawcross&quot;</span><span class="default">,</span>
<a name="11811"><font size=-1>11811     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11812"><font size=-1>11812     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11813"><font size=-1>11813     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="11814"><font size=-1>11814     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11815"><font size=-1>11815     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11816"><font size=-1>11816     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - add CROSS term in oscillator strengths&quot;</span><span class="default">,</span>
<a name="11817"><font size=-1>11817     </font></a><span class="default">    requires=</span><span class="string">&quot;([[optdriver]] == 3 or [[optdriver]] == 4) and [[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11818"><font size=-1>11818     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11819"><font size=-1>11819     </font></a><span class="string">When **pawcross=1**, the overlap between the plane-wave part of one band and</span>
<a name="11820"><font size=-1>11820     </font></a><span class="string">the on-site part of an other is taken into account in the computation of the</span>
<a name="11821"><font size=-1>11821     </font></a><span class="string">oscillator strengths. Hence, the completeness of the on-site basis is no longer assumed.</span>
<a name="11822"><font size=-1>11822     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11823"><font size=-1>11823     </font></a><span class="default">),</span>
<a name="11824"><font size=-1>11824     </font></a><span class="default"></span>
<a name="11825"><font size=-1>11825     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11826"><font size=-1>11826     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawecutdg&quot;</span><span class="default">,</span>
<a name="11827"><font size=-1>11827     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11828"><font size=-1>11828     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="11829"><font size=-1>11829     </font></a><span class="default">    topics=[</span><span class="string">'Planewaves_compulsory'</span><span class="default">, </span><span class="string">'PAW_compulsory'</span><span class="default">],</span>
<a name="11830"><font size=-1>11830     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11831"><font size=-1>11831     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="11832"><font size=-1>11832     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - Energy CUToff for the Double Grid&quot;</span><span class="default">,</span>
<a name="11833"><font size=-1>11833     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="11834"><font size=-1>11834     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;pawecutdg MUST be specified for PAW calculations.&quot;</span><span class="default">,</span>
<a name="11835"><font size=-1>11835     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11836"><font size=-1>11836     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11837"><font size=-1>11837     </font></a><span class="string">Define the energy cut-off for the fine FFT grid (the &quot;double grid&quot;, that</span>
<a name="11838"><font size=-1>11838     </font></a><span class="string">allows one to transfer data from the normal, coarse, FFT grid to the spherical</span>
<a name="11839"><font size=-1>11839     </font></a><span class="string">grid around each atom).</span>
<a name="11840"><font size=-1>11840     </font></a><span class="string">[[pawecutdg]] must be larger or equal to [[ecut]]. If it is equal to it, then</span>
<a name="11841"><font size=-1>11841     </font></a><span class="string">no fine grid is used. The results are not very accurate, but the computations</span>
<a name="11842"><font size=-1>11842     </font></a><span class="string">proceed quite fast.</span>
<a name="11843"><font size=-1>11843     </font></a><span class="string">For typical PAW computations, where [[ecut]] is on the order of 15 Ha,</span>
<a name="11844"><font size=-1>11844     </font></a><span class="string">[[pawecutdg]] must be tested according to what you want to do. For</span>
<a name="11845"><font size=-1>11845     </font></a><span class="string">calculations that do not require a high accuracy (molecular dynamics for</span>
<a name="11846"><font size=-1>11846     </font></a><span class="string">instance) a value of 20 Ha is enough. For calculations that require a high</span>
<a name="11847"><font size=-1>11847     </font></a><span class="string">accuracy (response functions for instance) it should be on the order of 30 Ha.</span>
<a name="11848"><font size=-1>11848     </font></a><span class="string">Choosing a larger value should not increase the accuracy, but does not slow</span>
<a name="11849"><font size=-1>11849     </font></a><span class="string">down the computation either, only the memory. The choice made for this</span>
<a name="11850"><font size=-1>11850     </font></a><span class="string">variable DOES have a bearing on the numerical accuracy of the results, and, as</span>
<a name="11851"><font size=-1>11851     </font></a><span class="string">such, should be the object of a convergence study. The convergence test might</span>
<a name="11852"><font size=-1>11852     </font></a><span class="string">be made on the total energy or derived quantities, like forces, but also on</span>
<a name="11853"><font size=-1>11853     </font></a><span class="string">the two values of the &quot;Compensation charge inside spheres&quot;, a quantity written</span>
<a name="11854"><font size=-1>11854     </font></a><span class="string">in the log file.</span>
<a name="11855"><font size=-1>11855     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11856"><font size=-1>11856     </font></a><span class="default">),</span>
<a name="11857"><font size=-1>11857     </font></a><span class="default"></span>
<a name="11858"><font size=-1>11858     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11859"><font size=-1>11859     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawfatbnd&quot;</span><span class="default">,</span>
<a name="11860"><font size=-1>11860     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11861"><font size=-1>11861     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11862"><font size=-1>11862     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">, </span><span class="string">'ElecBandStructure_useful'</span><span class="default">],</span>
<a name="11863"><font size=-1>11863     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11864"><font size=-1>11864     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="11865"><font size=-1>11865     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW: print band structure in the FAT-BaND representation&quot;</span><span class="default">,</span>
<a name="11866"><font size=-1>11866     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11867"><font size=-1>11867     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11868"><font size=-1>11868     </font></a><span class="string">For Ground-State calculations and non self-consistent calculations only.</span>
<a name="11869"><font size=-1>11869     </font></a><span class="string">This option can be used to plot band structure. For each atom (specified by</span>
<a name="11870"><font size=-1>11870     </font></a><span class="string">[[natsph]] and [[iatsph]]), each angular momentum, and each spin polarisation,</span>
<a name="11871"><font size=-1>11871     </font></a><span class="string">the band structure is written in files (such as e.g.</span>
<a name="11872"><font size=-1>11872     </font></a><span class="string">FATBANDS_at0001_Ni_is2_l2_m-1). Each file contains the eigenvalue, and the</span>
<a name="11873"><font size=-1>11873     </font></a><span class="string">contribution of angular momentum L, and projection of angular momentum M, (for</span>
<a name="11874"><font size=-1>11874     </font></a><span class="string">the corresponding wavefunction) to the PAW density inside the PAW sphere as a</span>
<a name="11875"><font size=-1>11875     </font></a><span class="string">function of the index of the k-point. The output can be readily plotted with</span>
<a name="11876"><font size=-1>11876     </font></a><span class="string">the software [xmgrace](http://plasma-gate.weizmann.ac.il/Grace/) (e.g</span>
<a name="11877"><font size=-1>11877     </font></a><span class="string">xmgrace FATBANDS_at0001_Ni_is2_l2_m-1). Relevant values are:</span>
<a name="11878"><font size=-1>11878     </font></a><span class="string"></span>
<a name="11879"><font size=-1>11879     </font></a><span class="string">  * 0: desactivated.</span>
<a name="11880"><font size=-1>11880     </font></a><span class="string">  * 1: The fatbands are only resolved in L.</span>
<a name="11881"><font size=-1>11881     </font></a><span class="string">  * 2: The fatbands are resolved in L and M.</span>
<a name="11882"><font size=-1>11882     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11883"><font size=-1>11883     </font></a><span class="default">),</span>
<a name="11884"><font size=-1>11884     </font></a><span class="default"></span>
<a name="11885"><font size=-1>11885     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11886"><font size=-1>11886     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawlcutd&quot;</span><span class="default">,</span>
<a name="11887"><font size=-1>11887     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11888"><font size=-1>11888     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11889"><font size=-1>11889     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="11890"><font size=-1>11890     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11891"><font size=-1>11891     </font></a><span class="default">    defaultval=</span><span class="number">10</span><span class="default">,</span>
<a name="11892"><font size=-1>11892     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - L angular momentum used to CUT the development in moments of the Densitites&quot;</span><span class="default">,</span>
<a name="11893"><font size=-1>11893     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11894"><font size=-1>11894     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11895"><font size=-1>11895     </font></a><span class="string">The expansion of the densities in angular momenta is performed up to</span>
<a name="11896"><font size=-1>11896     </font></a><span class="string">l=[[pawlcutd]].</span>
<a name="11897"><font size=-1>11897     </font></a><span class="string">Note that, for a given system, the maximum value of [[pawlcutd]] is</span>
<a name="11898"><font size=-1>11898     </font></a><span class="string">**2*l_max**, where l_max is the maximum l of the PAW partial waves basis.</span>
<a name="11899"><font size=-1>11899     </font></a><span class="string"></span>
<a name="11900"><font size=-1>11900     </font></a><span class="string">The choice made for this variable DOES have a bearing on the numerical</span>
<a name="11901"><font size=-1>11901     </font></a><span class="string">accuracy of the results, and, as such, should be the object of a convergence</span>
<a name="11902"><font size=-1>11902     </font></a><span class="string">study. The convergence test might be made on the total energy or derived</span>
<a name="11903"><font size=-1>11903     </font></a><span class="string">quantities, like forces, but also on the two values of the &quot;Compensation</span>
<a name="11904"><font size=-1>11904     </font></a><span class="string">charge inside spheres&quot;, a quantity written in the log file.</span>
<a name="11905"><font size=-1>11905     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11906"><font size=-1>11906     </font></a><span class="default">),</span>
<a name="11907"><font size=-1>11907     </font></a><span class="default"></span>
<a name="11908"><font size=-1>11908     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11909"><font size=-1>11909     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawlmix&quot;</span><span class="default">,</span>
<a name="11910"><font size=-1>11910     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11911"><font size=-1>11911     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11912"><font size=-1>11912     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="11913"><font size=-1>11913     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11914"><font size=-1>11914     </font></a><span class="default">    defaultval=</span><span class="number">10</span><span class="default">,</span>
<a name="11915"><font size=-1>11915     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - maximum L used in the spherical part MIXing&quot;</span><span class="default">,</span>
<a name="11916"><font size=-1>11916     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11917"><font size=-1>11917     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11918"><font size=-1>11918     </font></a><span class="string">The choice made for this variable determine how the spherical part of the</span>
<a name="11919"><font size=-1>11919     </font></a><span class="string">density is mixed during electronic iterations.</span>
<a name="11920"><font size=-1>11920     </font></a><span class="string"></span>
<a name="11921"><font size=-1>11921     </font></a><span class="string">Only parts of rhoij quantities associated with l angular momenta up to</span>
<a name="11922"><font size=-1>11922     </font></a><span class="string">l=pawlmix are mixed. Other parts of augmentation occupancies are not included</span>
<a name="11923"><font size=-1>11923     </font></a><span class="string">in the mixing process.</span>
<a name="11924"><font size=-1>11924     </font></a><span class="string">This option is useful to save CPU time but DOES have a bearing on the</span>
<a name="11925"><font size=-1>11925     </font></a><span class="string">numerical accuracy of the results.</span>
<a name="11926"><font size=-1>11926     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11927"><font size=-1>11927     </font></a><span class="default">),</span>
<a name="11928"><font size=-1>11928     </font></a><span class="default"></span>
<a name="11929"><font size=-1>11929     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11930"><font size=-1>11930     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawmixdg&quot;</span><span class="default">,</span>
<a name="11931"><font size=-1>11931     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11932"><font size=-1>11932     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11933"><font size=-1>11933     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="11934"><font size=-1>11934     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11935"><font size=-1>11935     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[npfft]] == 1'</span><span class="default">: </span><span class="number">0</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="11936"><font size=-1>11936     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - MIXing is done (or not) on the (fine) Double Grid&quot;</span><span class="default">,</span>
<a name="11937"><font size=-1>11937     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11938"><font size=-1>11938     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="11939"><font size=-1>11939     </font></a><span class="string">The choice made for this variable determines the grid on which the density (or</span>
<a name="11940"><font size=-1>11940     </font></a><span class="string">potential) is mixed during the SCF cycle.</span>
<a name="11941"><font size=-1>11941     </font></a><span class="string"></span>
<a name="11942"><font size=-1>11942     </font></a><span class="string">If **pawmixdg=1** the density/potential is mixed in REAL space using the</span>
<a name="11943"><font size=-1>11943     </font></a><span class="string">fine FFT grid (defined by [[pawecutdg]] or [[ngfftdg]]).</span>
<a name="11944"><font size=-1>11944     </font></a><span class="string"></span>
<a name="11945"><font size=-1>11945     </font></a><span class="string">If **pawmixdg=0** the density/potential is mixed in RECIPROCAL space using</span>
<a name="11946"><font size=-1>11946     </font></a><span class="string">the coarse FFT grid (defined by [[ecut]] or [[ngfft]]). Only components of the</span>
<a name="11947"><font size=-1>11947     </font></a><span class="string">coarse grid are mixed using the scheme defined by [[iscf]]; other components</span>
<a name="11948"><font size=-1>11948     </font></a><span class="string">are only precondionned by [[diemix]] and simply mixed.</span>
<a name="11949"><font size=-1>11949     </font></a><span class="string">This option is useful to save memory and does not affect numerical accuracy of</span>
<a name="11950"><font size=-1>11950     </font></a><span class="string">converged results. If **pawmixdg=1**, density and corresponding residual are</span>
<a name="11951"><font size=-1>11951     </font></a><span class="string">stored for previous iterations and are REAL arrays of size [[nfftdg]]. If</span>
<a name="11952"><font size=-1>11952     </font></a><span class="string">**pawmixdg=0**, density and corresponding residual are stored for previous</span>
<a name="11953"><font size=-1>11953     </font></a><span class="string">iterations and are COMPLEX arrays of size [[nfft]]. The memory saving is</span>
<a name="11954"><font size=-1>11954     </font></a><span class="string">particularly efficient when using the Pulay mixing ([[iscf]] = 7 or 17).</span>
<a name="11955"><font size=-1>11955     </font></a><span class="string"></span>
<a name="11956"><font size=-1>11956     </font></a><span class="string">In **wavelet** calculations [[usewvl]] = 1:</span>
<a name="11957"><font size=-1>11957     </font></a><span class="string"></span>
<a name="11958"><font size=-1>11958     </font></a><span class="string">    - pawmixdg is set to 1 by default.</span>
<a name="11959"><font size=-1>11959     </font></a><span class="string">    - A value of 0 is not allowed.</span>
<a name="11960"><font size=-1>11960     </font></a><span class="string">    - Density/potential is mixed in REAL space (Here only one grid is used).</span>
<a name="11961"><font size=-1>11961     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11962"><font size=-1>11962     </font></a><span class="default">),</span>
<a name="11963"><font size=-1>11963     </font></a><span class="default"></span>
<a name="11964"><font size=-1>11964     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11965"><font size=-1>11965     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawnhatxc&quot;</span><span class="default">,</span>
<a name="11966"><font size=-1>11966     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11967"><font size=-1>11967     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11968"><font size=-1>11968     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="11969"><font size=-1>11969     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11970"><font size=-1>11970     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="11971"><font size=-1>11971     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - Flag for exact computation of gradients of NHAT density in eXchange-Correlation.&quot;</span><span class="default">,</span>
<a name="11972"><font size=-1>11972     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11973"><font size=-1>11973     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11974"><font size=-1>11974     </font></a><span class="string">Relevant only when a GGA exchange-correlation functional is used.</span>
<a name="11975"><font size=-1>11975     </font></a><span class="string">When this flag is activated, the gradients of compensation charge density</span>
<a name="11976"><font size=-1>11976     </font></a><span class="string">(n_hat) are exactly computed (i.e. analytically); when it is deactivated, they</span>
<a name="11977"><font size=-1>11977     </font></a><span class="string">are computed with a numerical scheme in reciprocal space (which can produce</span>
<a name="11978"><font size=-1>11978     </font></a><span class="string">inaccurate results if the compensation charge density is highly localized).</span>
<a name="11979"><font size=-1>11979     </font></a><span class="string">As analytical treatment of compensation charge density gradients is CPU time</span>
<a name="11980"><font size=-1>11980     </font></a><span class="string">demanding, it is possible to bypass it with [[pawnhatxc]] = 0; but the numerical</span>
<a name="11981"><font size=-1>11981     </font></a><span class="string">accuracy can be affected by this choice. It is recommended to test the</span>
<a name="11982"><font size=-1>11982     </font></a><span class="string">validity of this approximation before use.</span>
<a name="11983"><font size=-1>11983     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="11984"><font size=-1>11984     </font></a><span class="default">),</span>
<a name="11985"><font size=-1>11985     </font></a><span class="default"></span>
<a name="11986"><font size=-1>11986     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="11987"><font size=-1>11987     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawnphi&quot;</span><span class="default">,</span>
<a name="11988"><font size=-1>11988     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="11989"><font size=-1>11989     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="11990"><font size=-1>11990     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="11991"><font size=-1>11991     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="11992"><font size=-1>11992     </font></a><span class="default">    defaultval=</span><span class="number">13</span><span class="default">,</span>
<a name="11993"><font size=-1>11993     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - Number of PHI angles used to discretize the sphere around each atom.&quot;</span><span class="default">,</span>
<a name="11994"><font size=-1>11994     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="11995"><font size=-1>11995     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="11996"><font size=-1>11996     </font></a><span class="string">Number of phi angles (longitude) used to discretize the data on the atomic</span>
<a name="11997"><font size=-1>11997     </font></a><span class="string">spheres. This discretization is completely defined by [[pawnphi]] and</span>
<a name="11998"><font size=-1>11998     </font></a><span class="string">[[pawntheta]].</span>
<a name="11999"><font size=-1>11999     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12000"><font size=-1>12000     </font></a><span class="default">),</span>
<a name="12001"><font size=-1>12001     </font></a><span class="default"></span>
<a name="12002"><font size=-1>12002     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12003"><font size=-1>12003     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawntheta&quot;</span><span class="default">,</span>
<a name="12004"><font size=-1>12004     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12005"><font size=-1>12005     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12006"><font size=-1>12006     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12007"><font size=-1>12007     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12008"><font size=-1>12008     </font></a><span class="default">    defaultval=</span><span class="number">12</span><span class="default">,</span>
<a name="12009"><font size=-1>12009     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - Number of THETA angles used to discretize the sphere around each atom.&quot;</span><span class="default">,</span>
<a name="12010"><font size=-1>12010     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12011"><font size=-1>12011     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12012"><font size=-1>12012     </font></a><span class="string">Number of theta angles (latitude) used to discretize the data on the atomic</span>
<a name="12013"><font size=-1>12013     </font></a><span class="string">spheres. This discretization is completely defined by [[pawntheta]] and</span>
<a name="12014"><font size=-1>12014     </font></a><span class="string">[[pawnphi]].</span>
<a name="12015"><font size=-1>12015     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12016"><font size=-1>12016     </font></a><span class="default">),</span>
<a name="12017"><font size=-1>12017     </font></a><span class="default"></span>
<a name="12018"><font size=-1>12018     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12019"><font size=-1>12019     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawnzlm&quot;</span><span class="default">,</span>
<a name="12020"><font size=-1>12020     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12021"><font size=-1>12021     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12022"><font size=-1>12022     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12023"><font size=-1>12023     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12024"><font size=-1>12024     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="12025"><font size=-1>12025     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - only compute Non-Zero LM-moments of the contributions to the density from the spheres&quot;</span><span class="default">,</span>
<a name="12026"><font size=-1>12026     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12027"><font size=-1>12027     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12028"><font size=-1>12028     </font></a><span class="string">Concerns the computation of the contributions to the density from the spheres</span>
<a name="12029"><font size=-1>12029     </font></a><span class="string">(named rho_1 - rho_tild_1).</span>
<a name="12030"><font size=-1>12030     </font></a><span class="string">If set to 0, all lm-moments of the sphere contributions to the density are</span>
<a name="12031"><font size=-1>12031     </font></a><span class="string">computed at each electronic iteration.</span>
<a name="12032"><font size=-1>12032     </font></a><span class="string">If set to 1, only non-zero lm-moments of the sphere contributions to the</span>
<a name="12033"><font size=-1>12033     </font></a><span class="string">density are computed at each electronic iteration (they are all computed at</span>
<a name="12034"><font size=-1>12034     </font></a><span class="string">the first iteration then only those found to be non-zero will be computed;</span>
<a name="12035"><font size=-1>12035     </font></a><span class="string">thus the first iteration is more cpu intensive)</span>
<a name="12036"><font size=-1>12036     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12037"><font size=-1>12037     </font></a><span class="default">),</span>
<a name="12038"><font size=-1>12038     </font></a><span class="default"></span>
<a name="12039"><font size=-1>12039     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12040"><font size=-1>12040     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawoptmix&quot;</span><span class="default">,</span>
<a name="12041"><font size=-1>12041     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12042"><font size=-1>12042     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12043"><font size=-1>12043     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12044"><font size=-1>12044     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12045"><font size=-1>12045     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12046"><font size=-1>12046     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - OPTion for the MIXing of the spherical part&quot;</span><span class="default">,</span>
<a name="12047"><font size=-1>12047     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12048"><font size=-1>12048     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12049"><font size=-1>12049     </font></a><span class="string">In the case of PAW computations, during the self-consistent cycle, ABINIT</span>
<a name="12050"><font size=-1>12050     </font></a><span class="string">mixes the density $\\rho(r)= \\tilde{\\rho}(r) +\\hat{\\rho}(r)$ and the occupancy matrix $\\rho_{ij}$. ($\\tilde{\\rho}(r)$ is</span>
<a name="12051"><font size=-1>12051     </font></a><span class="string">the pseudo density, $\\hat{\\rho}(r)$ is the compensation charge density). It can be</span>
<a name="12052"><font size=-1>12052     </font></a><span class="string">redundant as $\\rho_{ij}$ is contained in $\\hat{\\rho}(r)$.</span>
<a name="12053"><font size=-1>12053     </font></a><span class="string"></span>
<a name="12054"><font size=-1>12054     </font></a><span class="string">  * If **pawoptmix** =0:</span>
<a name="12055"><font size=-1>12055     </font></a><span class="string">ABINIT mixes $\\rho(r)$ and $\\rho_{ij}$ but the residual used to control the mixing</span>
<a name="12056"><font size=-1>12056     </font></a><span class="string">algorithm is only based on $\\rho(r)$.</span>
<a name="12057"><font size=-1>12057     </font></a><span class="string"></span>
<a name="12058"><font size=-1>12058     </font></a><span class="string">  * If **pawoptmix** =1:</span>
<a name="12059"><font size=-1>12059     </font></a><span class="string">ABINIT mixes $\\rho(r)$ and $\\rho_{ij}$ and the residual used to control the mixing</span>
<a name="12060"><font size=-1>12060     </font></a><span class="string">algorithm is based on $\\rho(r)$ and $\\rho_{ij}$.</span>
<a name="12061"><font size=-1>12061     </font></a><span class="string"></span>
<a name="12062"><font size=-1>12062     </font></a><span class="string">This has only an influence on the efficiency of the mixing algorithm.</span>
<a name="12063"><font size=-1>12063     </font></a><span class="string">In case of mixing problems, the first suggestion is to increase the size of the</span>
<a name="12064"><font size=-1>12064     </font></a><span class="string">history (see [[npulayit]]). Then it is also possible to play with the</span>
<a name="12065"><font size=-1>12065     </font></a><span class="string">parameters of the Kerker mixing: [[diemix]], [[diemac]], etc...</span>
<a name="12066"><font size=-1>12066     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12067"><font size=-1>12067     </font></a><span class="default">),</span>
<a name="12068"><font size=-1>12068     </font></a><span class="default"></span>
<a name="12069"><font size=-1>12069     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12070"><font size=-1>12070     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawoptosc&quot;</span><span class="default">,</span>
<a name="12071"><font size=-1>12071     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12072"><font size=-1>12072     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12073"><font size=-1>12073     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'BSE_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="12074"><font size=-1>12074     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12075"><font size=-1>12075     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12076"><font size=-1>12076     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - OPTion for the computation of the OSCillator matrix elements&quot;</span><span class="default">,</span>
<a name="12077"><font size=-1>12077     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12078"><font size=-1>12078     </font></a><span class="string">Only relevant for GW or Bethe-Salpeter calculations with PAW.</span>
<a name="12079"><font size=-1>12079     </font></a><span class="string">This variable defines the approach used for the evaluation of the oscillator</span>
<a name="12080"><font size=-1>12080     </font></a><span class="string">matrix elements within the PAW formalism. Possible values are 0,1,2.</span>
<a name="12081"><font size=-1>12081     </font></a><span class="string">If [[pawoptosc]] = 0 the code uses its internal default value (2 for SCREENING</span>
<a name="12082"><font size=-1>12082     </font></a><span class="string">calculations, 1 for SIGMA calculations, 2 for Bethe-Salpeter</span>
<a name="12083"><font size=-1>12083     </font></a><span class="string">If [[pawoptosc]] = 1 the matrix elements are computed with the expression given</span>
<a name="12084"><font size=-1>12084     </font></a><span class="string">by [[cite:Arnaud2000]]. The equation is exact provided that the</span>
<a name="12085"><font size=-1>12085     </font></a><span class="string">set of PAW partial waves is complete.</span>
<a name="12086"><font size=-1>12086     </font></a><span class="string">If [[pawoptosc]] = 2 the matrix elements are computed with the approximated</span>
<a name="12087"><font size=-1>12087     </font></a><span class="string">expression proposed by [[cite:Shishkin2006]].</span>
<a name="12088"><font size=-1>12088     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12089"><font size=-1>12089     </font></a><span class="default">),</span>
<a name="12090"><font size=-1>12090     </font></a><span class="default"></span>
<a name="12091"><font size=-1>12091     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12092"><font size=-1>12092     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawovlp&quot;</span><span class="default">,</span>
<a name="12093"><font size=-1>12093     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12094"><font size=-1>12094     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12095"><font size=-1>12095     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">],</span>
<a name="12096"><font size=-1>12096     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12097"><font size=-1>12097     </font></a><span class="default">    defaultval=</span><span class="number">5.0</span><span class="default">,</span>
<a name="12098"><font size=-1>12098     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - spheres OVerLaP allowed (in percentage)&quot;</span><span class="default">,</span>
<a name="12099"><font size=-1>12099     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12100"><font size=-1>12100     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12101"><font size=-1>12101     </font></a><span class="string">When PAW is activated, a localized atomic basis is added to describe wave</span>
<a name="12102"><font size=-1>12102     </font></a><span class="string">functions. Spheres around atoms are defined and they are IN PRINCIPLE not</span>
<a name="12103"><font size=-1>12103     </font></a><span class="string">allowed to overlap. However, a small overlap can be allowed without</span>
<a name="12104"><font size=-1>12104     </font></a><span class="string">compromising the accuracy of results. Be aware that too high overlaps can lead</span>
<a name="12105"><font size=-1>12105     </font></a><span class="string">to unphysical results.</span>
<a name="12106"><font size=-1>12106     </font></a><span class="string">With the [[pawovlp]] variable, the user can control the (voluminal) overlap</span>
<a name="12107"><font size=-1>12107     </font></a><span class="string">percentage allowed without stopping the execution.</span>
<a name="12108"><font size=-1>12108     </font></a><span class="string">[[pawovlp]] is the value (in percentage: 0...100%) obtained by dividing the</span>
<a name="12109"><font size=-1>12109     </font></a><span class="string">volume of the overlap of two spheres by the volume of the smallest sphere.</span>
<a name="12110"><font size=-1>12110     </font></a><span class="string">The following values are permitted for [[pawovlp]]:</span>
<a name="12111"><font size=-1>12111     </font></a><span class="string"></span>
<a name="12112"><font size=-1>12112     </font></a><span class="string">- [[pawovlp]] &lt; 0 --&gt; overlap is always allowed</span>
<a name="12113"><font size=-1>12113     </font></a><span class="string">- [[pawovlp]] = 0 --&gt; no overlap is allowed</span>
<a name="12114"><font size=-1>12114     </font></a><span class="string">- [[pawovlp]] &gt; 0 and &lt; 100 --&gt; overlap is allowed only if it is less than [[pawovlp]] %</span>
<a name="12115"><font size=-1>12115     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12116"><font size=-1>12116     </font></a><span class="default">),</span>
<a name="12117"><font size=-1>12117     </font></a><span class="default"></span>
<a name="12118"><font size=-1>12118     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12119"><font size=-1>12119     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawprt_b&quot;</span><span class="default">,</span>
<a name="12120"><font size=-1>12120     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12121"><font size=-1>12121     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12122"><font size=-1>12122     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12123"><font size=-1>12123     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12124"><font size=-1>12124     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12125"><font size=-1>12125     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW PRinT band&quot;</span><span class="default">,</span>
<a name="12126"><font size=-1>12126     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12127"><font size=-1>12127     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12128"><font size=-1>12128     </font></a><span class="string">Forces the output of the all-electron wavefunction for only a single band.</span>
<a name="12129"><font size=-1>12129     </font></a><span class="string">To be used in conjuction with: [[pawprtwf]] = 1 and [[pawprt_k]].</span>
<a name="12130"><font size=-1>12130     </font></a><span class="string">The indexing of the bands start with one for the lowest occupied band and goes up from there.</span>
<a name="12131"><font size=-1>12131     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12132"><font size=-1>12132     </font></a><span class="default">),</span>
<a name="12133"><font size=-1>12133     </font></a><span class="default"></span>
<a name="12134"><font size=-1>12134     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12135"><font size=-1>12135     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawprt_k&quot;</span><span class="default">,</span>
<a name="12136"><font size=-1>12136     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12137"><font size=-1>12137     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12138"><font size=-1>12138     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12139"><font size=-1>12139     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12140"><font size=-1>12140     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12141"><font size=-1>12141     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW PRinT K-point&quot;</span><span class="default">,</span>
<a name="12142"><font size=-1>12142     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12143"><font size=-1>12143     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12144"><font size=-1>12144     </font></a><span class="string">Forces the output of the all-electron wavefunction for only a single k-point.</span>
<a name="12145"><font size=-1>12145     </font></a><span class="string">To be used in conjunction with: [[pawprtwf]] = 1 and [[pawprt_b]].</span>
<a name="12146"><font size=-1>12146     </font></a><span class="string">The indexing follows the order in ouptput of the internal variable **kpt** in</span>
<a name="12147"><font size=-1>12147     </font></a><span class="string">the beginning of the run.</span>
<a name="12148"><font size=-1>12148     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12149"><font size=-1>12149     </font></a><span class="default">),</span>
<a name="12150"><font size=-1>12150     </font></a><span class="default"></span>
<a name="12151"><font size=-1>12151     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12152"><font size=-1>12152     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawprtden&quot;</span><span class="default">,</span>
<a name="12153"><font size=-1>12153     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12154"><font size=-1>12154     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12155"><font size=-1>12155     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">],</span>
<a name="12156"><font size=-1>12156     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12157"><font size=-1>12157     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12158"><font size=-1>12158     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW: PRinT total physical electron DENsity&quot;</span><span class="default">,</span>
<a name="12159"><font size=-1>12159     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12160"><font size=-1>12160     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12161"><font size=-1>12161     </font></a><span class="string">**Deprecated:** See the [[prtden]].</span>
<a name="12162"><font size=-1>12162     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12163"><font size=-1>12163     </font></a><span class="default">),</span>
<a name="12164"><font size=-1>12164     </font></a><span class="default"></span>
<a name="12165"><font size=-1>12165     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12166"><font size=-1>12166     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawprtdos&quot;</span><span class="default">,</span>
<a name="12167"><font size=-1>12167     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12168"><font size=-1>12168     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12169"><font size=-1>12169     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">, </span><span class="string">'ElecDOS_useful'</span><span class="default">],</span>
<a name="12170"><font size=-1>12170     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12171"><font size=-1>12171     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12172"><font size=-1>12172     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW: PRinT partial DOS contributions&quot;</span><span class="default">,</span>
<a name="12173"><font size=-1>12173     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[prtdos]] == 3&quot;</span><span class="default">,</span>
<a name="12174"><font size=-1>12174     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12175"><font size=-1>12175     </font></a><span class="string">This input variable controls the computation and/or printing of contributions</span>
<a name="12176"><font size=-1>12176     </font></a><span class="string">to the PAW partial DOS in _DOS file(s):</span>
<a name="12177"><font size=-1>12177     </font></a><span class="string"></span>
<a name="12178"><font size=-1>12178     </font></a><span class="string">* Plane-waves contribution</span>
<a name="12179"><font size=-1>12179     </font></a><span class="string"></span>
<a name="12180"><font size=-1>12180     </font></a><span class="string">  $+$ &quot;on-site&quot; all-electron contribution ($\\phi$)</span>
<a name="12181"><font size=-1>12181     </font></a><span class="string"></span>
<a name="12182"><font size=-1>12182     </font></a><span class="string">  $-$ &quot;on-site&quot; pseudo contribution ($\\tilde{\\phi}$).</span>
<a name="12183"><font size=-1>12183     </font></a><span class="string"></span>
<a name="12184"><font size=-1>12184     </font></a><span class="string">If **pawprtdos=0:**</span>
<a name="12185"><font size=-1>12185     </font></a><span class="string"></span>
<a name="12186"><font size=-1>12186     </font></a><span class="string">- The 3 contributions are computed; only the total partial DOS is output in _DOS file.</span>
<a name="12187"><font size=-1>12187     </font></a><span class="string"></span>
<a name="12188"><font size=-1>12188     </font></a><span class="string">If **pawprtdos=1:**</span>
<a name="12189"><font size=-1>12189     </font></a><span class="string"></span>
<a name="12190"><font size=-1>12190     </font></a><span class="string">- The 3 contributions are computed and output in _DOS file.</span>
<a name="12191"><font size=-1>12191     </font></a><span class="string">- In that case, integrated DOS is not output.</span>
<a name="12192"><font size=-1>12192     </font></a><span class="string"></span>
<a name="12193"><font size=-1>12193     </font></a><span class="string">If **pawprtdos=2:**</span>
<a name="12194"><font size=-1>12194     </font></a><span class="string"></span>
<a name="12195"><font size=-1>12195     </font></a><span class="string">- Only &quot;on-site&quot; all-electron contribution is computed and output in _DOS file.</span>
<a name="12196"><font size=-1>12196     </font></a><span class="string">- This a (very) good approximation of total DOS, provided that (1) the PAW</span>
<a name="12197"><font size=-1>12197     </font></a><span class="string">  local basis is complete, (2) the electronic charge is mostly contained in PAW spheres.</span>
<a name="12198"><font size=-1>12198     </font></a><span class="string">- In that case, the [[ratsph]] variable is automatically set to the PAW radius.</span>
<a name="12199"><font size=-1>12199     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12200"><font size=-1>12200     </font></a><span class="default">),</span>
<a name="12201"><font size=-1>12201     </font></a><span class="default"></span>
<a name="12202"><font size=-1>12202     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12203"><font size=-1>12203     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawprtvol&quot;</span><span class="default">,</span>
<a name="12204"><font size=-1>12204     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12205"><font size=-1>12205     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12206"><font size=-1>12206     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12207"><font size=-1>12207     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12208"><font size=-1>12208     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12209"><font size=-1>12209     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW: PRinT VOLume&quot;</span><span class="default">,</span>
<a name="12210"><font size=-1>12210     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12211"><font size=-1>12211     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12212"><font size=-1>12212     </font></a><span class="string">Control print volume and debugging output for PAW in log file or standard</span>
<a name="12213"><font size=-1>12213     </font></a><span class="string">output. If set to 0, the print volume is at its minimum.</span>
<a name="12214"><font size=-1>12214     </font></a><span class="string">**pawprtvol** can have values from -3 to 3:</span>
<a name="12215"><font size=-1>12215     </font></a><span class="string"></span>
<a name="12216"><font size=-1>12216     </font></a><span class="string">- **pawprtvol** = -1 or 1: matrices $\\rho_{ij}$ (atomic occupancies) and $D_{ij}$ (psp</span>
<a name="12217"><font size=-1>12217     </font></a><span class="string">  strength) are printed at each SCF cycle with details about their contributions.</span>
<a name="12218"><font size=-1>12218     </font></a><span class="string">- **pawprtvol** = -2 or 2: like -1 or 1 plus additional printing: moments of</span>
<a name="12219"><font size=-1>12219     </font></a><span class="string">  &quot;on-site&quot; densities, details about local exact exchange.</span>
<a name="12220"><font size=-1>12220     </font></a><span class="string">- **pawprtvol** = -3 or 3: like -2 or 2 plus additional printing: details about</span>
<a name="12221"><font size=-1>12221     </font></a><span class="string">  PAW+U, rotation matrices of spherical harmonics.</span>
<a name="12222"><font size=-1>12222     </font></a><span class="string"></span>
<a name="12223"><font size=-1>12223     </font></a><span class="string">When **pawprtvol** &gt;= 0, up to 12 components of $\\rho_{ij}$ and $D_{ij}$ matrices for the</span>
<a name="12224"><font size=-1>12224     </font></a><span class="string">1st and last atom are printed.</span>
<a name="12225"><font size=-1>12225     </font></a><span class="string">When **pawprtvol** &lt; 0, all components of $\\rho_{ij}$ and $D_{ij}$ matrices for all atoms are printed.</span>
<a name="12226"><font size=-1>12226     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12227"><font size=-1>12227     </font></a><span class="default">),</span>
<a name="12228"><font size=-1>12228     </font></a><span class="default"></span>
<a name="12229"><font size=-1>12229     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12230"><font size=-1>12230     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawprtwf&quot;</span><span class="default">,</span>
<a name="12231"><font size=-1>12231     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12232"><font size=-1>12232     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12233"><font size=-1>12233     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">],</span>
<a name="12234"><font size=-1>12234     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12235"><font size=-1>12235     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12236"><font size=-1>12236     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW: PRinT WaveFunctions&quot;</span><span class="default">,</span>
<a name="12237"><font size=-1>12237     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12238"><font size=-1>12238     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12239"><font size=-1>12239     </font></a><span class="string">This input variable controls the output of the **full** PAW wave functions</span>
<a name="12240"><font size=-1>12240     </font></a><span class="string">including the on-site contributions inside each PAW sphere needed to</span>
<a name="12241"><font size=-1>12241     </font></a><span class="string">reconstruct the correct nodal shape in the augmentation region.</span>
<a name="12242"><font size=-1>12242     </font></a><span class="string">**pawprtwf = 1** causes the generation of a file _PAWAVES.nc containing the full wavefunctions</span>
<a name="12243"><font size=-1>12243     </font></a><span class="string">in **real space** on the fine FFT grid defined by [[pawecutdg]] or [[ngfftdg]].</span>
<a name="12244"><font size=-1>12244     </font></a><span class="string"></span>
<a name="12245"><font size=-1>12245     </font></a><span class="string">Limitations: At present (v8.0), **pawprtwf = 1** is not compatible with [[nspinor]] =2 and parallel executions</span>
<a name="12246"><font size=-1>12246     </font></a><span class="string">Therefore the output of the _AE_WFK has to be done in sequential.</span>
<a name="12247"><font size=-1>12247     </font></a><span class="string">Moreover, in order to use this feature, one has to enable the support for netcdf at configure-time</span>
<a name="12248"><font size=-1>12248     </font></a><span class="string">as the _PAWAVES file is written using the NETCDF file format following the ETSF-IO</span>
<a name="12249"><font size=-1>12249     </font></a><span class="string">specifications for wavefunctions in real space.</span>
<a name="12250"><font size=-1>12250     </font></a><span class="string"></span>
<a name="12251"><font size=-1>12251     </font></a><span class="string">If the code is run entirely in serial, additional output is made of various contributions to the all-electron</span>
<a name="12252"><font size=-1>12252     </font></a><span class="string">wavefunction. By default the full available set of bands and k-points are</span>
<a name="12253"><font size=-1>12253     </font></a><span class="string">ouput, but a single band and k-point index can be requested by using the</span>
<a name="12254"><font size=-1>12254     </font></a><span class="string">variables [[pawprt_b]] and [[pawprt_k]].</span>
<a name="12255"><font size=-1>12255     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12256"><font size=-1>12256     </font></a><span class="default">),</span>
<a name="12257"><font size=-1>12257     </font></a><span class="default"></span>
<a name="12258"><font size=-1>12258     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12259"><font size=-1>12259     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawspnorb&quot;</span><span class="default">,</span>
<a name="12260"><font size=-1>12260     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12261"><font size=-1>12261     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12262"><font size=-1>12262     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">, </span><span class="string">'spinpolarisation_useful'</span><span class="default">],</span>
<a name="12263"><font size=-1>12263     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12264"><font size=-1>12264     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nspinor]] == 2'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="12265"><font size=-1>12265     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - option for SPiN-ORBit coupling&quot;</span><span class="default">,</span>
<a name="12266"><font size=-1>12266     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12267"><font size=-1>12267     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12268"><font size=-1>12268     </font></a><span class="string">When PAW is activated, the **spin-orbit coupling** can be added without the</span>
<a name="12269"><font size=-1>12269     </font></a><span class="string">use of specific PAW datasets (pseudopotentials).</span>
<a name="12270"><font size=-1>12270     </font></a><span class="string">If [[pawspnorb]] = 1, spin-orbit will be added.</span>
<a name="12271"><font size=-1>12271     </font></a><span class="string">If the wavefunction is spinorial (that is, if [[nspinor]] = 2), there is no</span>
<a name="12272"><font size=-1>12272     </font></a><span class="string">reason not to include the spin-orbit interaction, so that the default value of</span>
<a name="12273"><font size=-1>12273     </font></a><span class="string">[[pawspnorb]] becomes 1 when [[nspinor]] = 2.</span>
<a name="12274"><font size=-1>12274     </font></a><span class="string">Note that only the all-electron &quot;on-site&quot; contribution to the Hamiltonian is</span>
<a name="12275"><font size=-1>12275     </font></a><span class="string">taken into account; this is a very good approximation but requires the</span>
<a name="12276"><font size=-1>12276     </font></a><span class="string">following conditions to be fulfilled:</span>
<a name="12277"><font size=-1>12277     </font></a><span class="string"></span>
<a name="12278"><font size=-1>12278     </font></a><span class="string">1- the  $\\tilde{\\phi}_{i}$  basis is complete enough</span>
<a name="12279"><font size=-1>12279     </font></a><span class="string"></span>
<a name="12280"><font size=-1>12280     </font></a><span class="string">2- the electronic density is mainly contained in the PAW sphere</span>
<a name="12281"><font size=-1>12281     </font></a><span class="string"></span>
<a name="12282"><font size=-1>12282     </font></a><span class="string"></span>
<a name="12283"><font size=-1>12283     </font></a><span class="string">Also note that, when spin-orbit coupling is activated and there is some</span>
<a name="12284"><font size=-1>12284     </font></a><span class="string">magnetization [[nspden]] = 4, the time-reversal symmetry is broken.</span>
<a name="12285"><font size=-1>12285     </font></a><span class="string">The use of [[kptopt]] = 1 or [[kptopt]] = 2 is thus forbidden. It is advised to</span>
<a name="12286"><font size=-1>12286     </font></a><span class="string">use [[kptopt]] = 3 (no symmetry used to generate k-points) or [[kptopt]] = 4 (only</span>
<a name="12287"><font size=-1>12287     </font></a><span class="string">spatial symmetries used to generate k-points).</span>
<a name="12288"><font size=-1>12288     </font></a><span class="string">Be careful if you choose to use [[kptopt]] = 0 (k-points given by hand); Time-</span>
<a name="12289"><font size=-1>12289     </font></a><span class="string">reversal symmetry has to be avoided.</span>
<a name="12290"><font size=-1>12290     </font></a><span class="string">An artificial scaling of the spin-orbit can be introduced thanks to the</span>
<a name="12291"><font size=-1>12291     </font></a><span class="string">[[spnorbscl]] input variable.</span>
<a name="12292"><font size=-1>12292     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12293"><font size=-1>12293     </font></a><span class="default">),</span>
<a name="12294"><font size=-1>12294     </font></a><span class="default"></span>
<a name="12295"><font size=-1>12295     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12296"><font size=-1>12296     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawstgylm&quot;</span><span class="default">,</span>
<a name="12297"><font size=-1>12297     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12298"><font size=-1>12298     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12299"><font size=-1>12299     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12300"><font size=-1>12300     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12301"><font size=-1>12301     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="12302"><font size=-1>12302     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - option for the STorage of G_l(r).YLM(r)&quot;</span><span class="default">,</span>
<a name="12303"><font size=-1>12303     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] = 1&quot;</span><span class="default">,</span>
<a name="12304"><font size=-1>12304     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="12305"><font size=-1>12305     </font></a><span class="string">When PAW is activated, the computation of compensation charge density (so</span>
<a name="12306"><font size=-1>12306     </font></a><span class="string">called &quot;hat&quot; density) requires the computation of $g_{l}(r).Y_{lm}(r)$ factors (and</span>
<a name="12307"><font size=-1>12307     </font></a><span class="string">cartesian derivatives) at each point of real space contained in PAW spheres.</span>
<a name="12308"><font size=-1>12308     </font></a><span class="string">The number of atoms, of (l,m) quantum numbers and the sharpness of the real</span>
<a name="12309"><font size=-1>12309     </font></a><span class="string">FFT grid can lead to a very big {$g_{l}.Y_{lm}$} datastructure. One can save memory</span>
<a name="12310"><font size=-1>12310     </font></a><span class="string">by putting [[pawstgylm]] = 0; but, in that case, $g_{l}(r).Y_{lm}(r)$ factors a re-</span>
<a name="12311"><font size=-1>12311     </font></a><span class="string">computed each time they are needed and CPU time increases.</span>
<a name="12312"><font size=-1>12312     </font></a><span class="string"></span>
<a name="12313"><font size=-1>12313     </font></a><span class="string">Possible choices:</span>
<a name="12314"><font size=-1>12314     </font></a><span class="string"></span>
<a name="12315"><font size=-1>12315     </font></a><span class="string">- [[pawstgylm]] = 0: $g_{l}(r).Y_{lm}(r)$ are not stored in memory and recomputed.</span>
<a name="12316"><font size=-1>12316     </font></a><span class="string">- [[pawstgylm]] = 1: $g_{l}(r).Y_{lm}(r)$ are stored in memory.</span>
<a name="12317"><font size=-1>12317     </font></a><span class="string"></span>
<a name="12318"><font size=-1>12318     </font></a><span class="string">Note:</span>
<a name="12319"><font size=-1>12319     </font></a><span class="string">$g_{l}(r)$ are shape functions (analytically known)</span>
<a name="12320"><font size=-1>12320     </font></a><span class="string"></span>
<a name="12321"><font size=-1>12321     </font></a><span class="string">$Y_{lm}(r)$ are real spherical harmonics</span>
<a name="12322"><font size=-1>12322     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12323"><font size=-1>12323     </font></a><span class="default">),</span>
<a name="12324"><font size=-1>12324     </font></a><span class="default"></span>
<a name="12325"><font size=-1>12325     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12326"><font size=-1>12326     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawsushat&quot;</span><span class="default">,</span>
<a name="12327"><font size=-1>12327     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12328"><font size=-1>12328     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12329"><font size=-1>12329     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12330"><font size=-1>12330     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12331"><font size=-1>12331     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12332"><font size=-1>12332     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - SUSceptibility, inclusion of HAT (compensation charge) contribution&quot;</span><span class="default">,</span>
<a name="12333"><font size=-1>12333     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[optdriver]] == 0&quot;</span><span class="default">,</span>
<a name="12334"><font size=-1>12334     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="12335"><font size=-1>12335     </font></a><span class="string">Ground-State calculation only.</span>
<a name="12336"><font size=-1>12336     </font></a><span class="string">When a sophisticated preconditioning scheme is selected for the SCF cycle of a</span>
<a name="12337"><font size=-1>12337     </font></a><span class="string">Ground-State calculation ([[iprcel]] &gt; 0), the computation of the susceptibility</span>
<a name="12338"><font size=-1>12338     </font></a><span class="string">matrix is required several times during the cycle. This computation is</span>
<a name="12339"><font size=-1>12339     </font></a><span class="string">computer time consuming, especially -- within PAW -- because of the inclusion</span>
<a name="12340"><font size=-1>12340     </font></a><span class="string">of additional terms due to the compensation charge density. As only a crude</span>
<a name="12341"><font size=-1>12341     </font></a><span class="string">valuation of the susceptibilty matrix is needed (to evaluate a preconditioning</span>
<a name="12342"><font size=-1>12342     </font></a><span class="string">matrix), the compensation charge contribution can be neglected to save CPU</span>
<a name="12343"><font size=-1>12343     </font></a><span class="string">time (select [[pawsushat]] = 0). This approximation could be unfavourable in</span>
<a name="12344"><font size=-1>12344     </font></a><span class="string">some cases; in the latter, we advise to put [[pawsushat]] = 1.</span>
<a name="12345"><font size=-1>12345     </font></a><span class="string"></span>
<a name="12346"><font size=-1>12346     </font></a><span class="string">Possible choices:</span>
<a name="12347"><font size=-1>12347     </font></a><span class="string"></span>
<a name="12348"><font size=-1>12348     </font></a><span class="string">- [[pawsushat]] = 0: only plane-wave contribution to suscep. matrix is computed.</span>
<a name="12349"><font size=-1>12349     </font></a><span class="string">- [[pawsushat]] = 1: the whole suscep. matrix (PW + PAW on-site) is computed.</span>
<a name="12350"><font size=-1>12350     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12351"><font size=-1>12351     </font></a><span class="default">),</span>
<a name="12352"><font size=-1>12352     </font></a><span class="default"></span>
<a name="12353"><font size=-1>12353     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12354"><font size=-1>12354     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawujat&quot;</span><span class="default">,</span>
<a name="12355"><font size=-1>12355     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12356"><font size=-1>12356     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12357"><font size=-1>12357     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="12358"><font size=-1>12358     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12359"><font size=-1>12359     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="12360"><font size=-1>12360     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW+macro_UJ, ATom number&quot;</span><span class="default">,</span>
<a name="12361"><font size=-1>12361     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12362"><font size=-1>12362     </font></a><span class="default">    commentdefault=</span><span class="string">&quot; i.e. the first atom treated with PAW+U.&quot;</span><span class="default">,</span>
<a name="12363"><font size=-1>12363     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12364"><font size=-1>12364     </font></a><span class="string">Determines the atom for which U (or J) should be determined. See also [[macro_uj]].</span>
<a name="12365"><font size=-1>12365     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12366"><font size=-1>12366     </font></a><span class="default">),</span>
<a name="12367"><font size=-1>12367     </font></a><span class="default"></span>
<a name="12368"><font size=-1>12368     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12369"><font size=-1>12369     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawujrad&quot;</span><span class="default">,</span>
<a name="12370"><font size=-1>12370     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12371"><font size=-1>12371     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12372"><font size=-1>12372     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="12373"><font size=-1>12373     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12374"><font size=-1>12374     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'a.u.'</span><span class="default">, value=</span><span class="number">20</span><span class="default">),</span>
<a name="12375"><font size=-1>12375     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW+macro_UJ, sphere RADius&quot;</span><span class="default">,</span>
<a name="12376"><font size=-1>12376     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12377"><font size=-1>12377     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12378"><font size=-1>12378     </font></a><span class="string">The sphere radius serves to extrapolate the U value calculated at r_paw to a</span>
<a name="12379"><font size=-1>12379     </font></a><span class="string">larger sphere radius. See also [[macro_uj]]. As most projector functions are</span>
<a name="12380"><font size=-1>12380     </font></a><span class="string">localized within r_paw to 80%, 20 a.u. contains 100% of the wavefunction and</span>
<a name="12381"><font size=-1>12381     </font></a><span class="string">corresponds to r_paw -&gt; .</span>
<a name="12382"><font size=-1>12382     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12383"><font size=-1>12383     </font></a><span class="default">),</span>
<a name="12384"><font size=-1>12384     </font></a><span class="default"></span>
<a name="12385"><font size=-1>12385     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12386"><font size=-1>12386     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawujv&quot;</span><span class="default">,</span>
<a name="12387"><font size=-1>12387     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12388"><font size=-1>12388     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12389"><font size=-1>12389     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_expert'</span><span class="default">],</span>
<a name="12390"><font size=-1>12390     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12391"><font size=-1>12391     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'eV'</span><span class="default">, value=</span><span class="number">0.1</span><span class="default">),</span>
<a name="12392"><font size=-1>12392     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW+macro_UJ, potential shift (V)&quot;</span><span class="default">,</span>
<a name="12393"><font size=-1>12393     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12394"><font size=-1>12394     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12395"><font size=-1>12395     </font></a><span class="string">Amplitude of the potential shift for the determination of U (or J). See also [[macro_uj]].</span>
<a name="12396"><font size=-1>12396     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12397"><font size=-1>12397     </font></a><span class="default">),</span>
<a name="12398"><font size=-1>12398     </font></a><span class="default"></span>
<a name="12399"><font size=-1>12399     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12400"><font size=-1>12400     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawusecp&quot;</span><span class="default">,</span>
<a name="12401"><font size=-1>12401     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12402"><font size=-1>12402     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12403"><font size=-1>12403     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">],</span>
<a name="12404"><font size=-1>12404     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12405"><font size=-1>12405     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="12406"><font size=-1>12406     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - option for the USE of CPrj in memory (cprj=WF projected with NL projector)&quot;</span><span class="default">,</span>
<a name="12407"><font size=-1>12407     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12408"><font size=-1>12408     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12409"><font size=-1>12409     </font></a><span class="string">When PAW is activated, the computation of cprj arrays is memory and time</span>
<a name="12410"><font size=-1>12410     </font></a><span class="string">consuming.</span>
<a name="12411"><font size=-1>12411     </font></a><span class="string">When [[pawusecp]] = 0, then the cprj are never kept in memory, they are</span>
<a name="12412"><font size=-1>12412     </font></a><span class="string">recomputed when needed (this is CPU-time consuming). When [[pawusecp]] = 1, then</span>
<a name="12413"><font size=-1>12413     </font></a><span class="string">the cprj are computed once and then kept in memory.</span>
<a name="12414"><font size=-1>12414     </font></a><span class="string">Change the value of the keyword only if you are an experienced user</span>
<a name="12415"><font size=-1>12415     </font></a><span class="string">(developer).</span>
<a name="12416"><font size=-1>12416     </font></a><span class="string">Remember: $cprj = &lt;\\tilde{\\psi}_{m}.p_{i}&gt;$ ($\\tilde{\\psi}_{n}$=wave function, $p_{i}$=non-local projector).</span>
<a name="12417"><font size=-1>12417     </font></a><span class="string"></span>
<a name="12418"><font size=-1>12418     </font></a><span class="string">For the time being, only activated for RF calculations.</span>
<a name="12419"><font size=-1>12419     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12420"><font size=-1>12420     </font></a><span class="default">),</span>
<a name="12421"><font size=-1>12421     </font></a><span class="default"></span>
<a name="12422"><font size=-1>12422     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12423"><font size=-1>12423     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pawxcdev&quot;</span><span class="default">,</span>
<a name="12424"><font size=-1>12424     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="12425"><font size=-1>12425     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12426"><font size=-1>12426     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">],</span>
<a name="12427"><font size=-1>12427     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12428"><font size=-1>12428     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="12429"><font size=-1>12429     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PAW - choice for eXchange-Correlation DEVelopment (spherical part)&quot;</span><span class="default">,</span>
<a name="12430"><font size=-1>12430     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="12431"><font size=-1>12431     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12432"><font size=-1>12432     </font></a><span class="string">  * If set to 0, the exchange-correlation term in the spherical part of energy is totally computed on the angular mesh</span>
<a name="12433"><font size=-1>12433     </font></a><span class="string">  * If set to 1, the exchange-correlation term in the spherical part of energy is developed onto lm-moments at order 1</span>
<a name="12434"><font size=-1>12434     </font></a><span class="string">  * If set to 2, the exchange-correlation term in the spherical part of energy is developed onto lm-moments at order 2</span>
<a name="12435"><font size=-1>12435     </font></a><span class="string">    (can be memory/CPU consuming)</span>
<a name="12436"><font size=-1>12436     </font></a><span class="string"></span>
<a name="12437"><font size=-1>12437     </font></a><span class="string">Be careful: GGA requires [[pawxcdev]] &gt; 0</span>
<a name="12438"><font size=-1>12438     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12439"><font size=-1>12439     </font></a><span class="default">),</span>
<a name="12440"><font size=-1>12440     </font></a><span class="default"></span>
<a name="12441"><font size=-1>12441     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12442"><font size=-1>12442     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_intmeth&quot;</span><span class="default">,</span>
<a name="12443"><font size=-1>12443     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12444"><font size=-1>12444     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12445"><font size=-1>12445     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12446"><font size=-1>12446     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12447"><font size=-1>12447     </font></a><span class="default">    defaultval=</span><span class="number">2</span><span class="default">,</span>
<a name="12448"><font size=-1>12448     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: INTegration METHod&quot;</span><span class="default">,</span>
<a name="12449"><font size=-1>12449     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="12450"><font size=-1>12450     </font></a><span class="string">Select the integration technique for computing the phonon DOS and the</span>
<a name="12451"><font size=-1>12451     </font></a><span class="string">Eliashberg function $\alpha^2F(\omega)$.</span>
<a name="12452"><font size=-1>12452     </font></a><span class="string"></span>
<a name="12453"><font size=-1>12453     </font></a><span class="string"> * 1 --&gt; Gaussian scheme (see also [[ph_smear]]).</span>
<a name="12454"><font size=-1>12454     </font></a><span class="string"> * 2 --&gt; tetrahedron method (no other input is needed but requires at least 4 q-points in the BZ)</span>
<a name="12455"><font size=-1>12455     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12456"><font size=-1>12456     </font></a><span class="default">),</span>
<a name="12457"><font size=-1>12457     </font></a><span class="default"></span>
<a name="12458"><font size=-1>12458     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12459"><font size=-1>12459     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_ndivsm&quot;</span><span class="default">,</span>
<a name="12460"><font size=-1>12460     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12461"><font size=-1>12461     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12462"><font size=-1>12462     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12463"><font size=-1>12463     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12464"><font size=-1>12464     </font></a><span class="default">    defaultval=</span><span class="number">20</span><span class="default">,</span>
<a name="12465"><font size=-1>12465     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: Number of DIVisions for sampling the SMallest segment&quot;</span><span class="default">,</span>
<a name="12466"><font size=-1>12466     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12467"><font size=-1>12467     </font></a><span class="string">This variable is used in conjunction with [[ph_nqpath]] and [[ph_qpath]] to</span>
<a name="12468"><font size=-1>12468     </font></a><span class="string">define the q-path used for phonon band structures and phonon linewidths. It</span>
<a name="12469"><font size=-1>12469     </font></a><span class="string">gives the number of points used to sample the smallest segment in the q-path</span>
<a name="12470"><font size=-1>12470     </font></a><span class="string">specified by [[ph_qpath]].</span>
<a name="12471"><font size=-1>12471     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12472"><font size=-1>12472     </font></a><span class="default">),</span>
<a name="12473"><font size=-1>12473     </font></a><span class="default"></span>
<a name="12474"><font size=-1>12474     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12475"><font size=-1>12475     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_ngqpt&quot;</span><span class="default">,</span>
<a name="12476"><font size=-1>12476     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12477"><font size=-1>12477     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12478"><font size=-1>12478     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12479"><font size=-1>12479     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="12480"><font size=-1>12480     </font></a><span class="default">    defaultval=[</span><span class="number">20</span><span class="default">, </span><span class="number">20</span><span class="default">, </span><span class="number">20</span><span class="default">],</span>
<a name="12481"><font size=-1>12481     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: Number of Grid points for Q-PoinT mesh.&quot;</span><span class="default">,</span>
<a name="12482"><font size=-1>12482     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12483"><font size=-1>12483     </font></a><span class="string">This variable defines the q-mesh used to compute the phonon DOS and the</span>
<a name="12484"><font size=-1>12484     </font></a><span class="string">Eliashberg function via Fourier interpolation.</span>
<a name="12485"><font size=-1>12485     </font></a><span class="string">Related input variables: [[ph_qshift]] and [[ph_nqshift]].</span>
<a name="12486"><font size=-1>12486     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12487"><font size=-1>12487     </font></a><span class="default">),</span>
<a name="12488"><font size=-1>12488     </font></a><span class="default"></span>
<a name="12489"><font size=-1>12489     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12490"><font size=-1>12490     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_nqpath&quot;</span><span class="default">,</span>
<a name="12491"><font size=-1>12491     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12492"><font size=-1>12492     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12493"><font size=-1>12493     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12494"><font size=-1>12494     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12495"><font size=-1>12495     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12496"><font size=-1>12496     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: Number of Q-points defining the PATH&quot;</span><span class="default">,</span>
<a name="12497"><font size=-1>12497     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12498"><font size=-1>12498     </font></a><span class="string">This integer defines the number of points in the [[ph_qpath]] array.</span>
<a name="12499"><font size=-1>12499     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12500"><font size=-1>12500     </font></a><span class="default">),</span>
<a name="12501"><font size=-1>12501     </font></a><span class="default"></span>
<a name="12502"><font size=-1>12502     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12503"><font size=-1>12503     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_nqshift&quot;</span><span class="default">,</span>
<a name="12504"><font size=-1>12504     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12505"><font size=-1>12505     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12506"><font size=-1>12506     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12507"><font size=-1>12507     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12508"><font size=-1>12508     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="12509"><font size=-1>12509     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: Number of Q-SHIFTs&quot;</span><span class="default">,</span>
<a name="12510"><font size=-1>12510     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12511"><font size=-1>12511     </font></a><span class="string">This variable defines the number of shifts in the q-mesh used for the phonon</span>
<a name="12512"><font size=-1>12512     </font></a><span class="string">DOS and for the Eliashberg functions (see [[ph_ngqpt]]). If not given, the</span>
<a name="12513"><font size=-1>12513     </font></a><span class="string">code assumes a Gamma-centered mesh. The shifts are specified by [[ph_qshift]].</span>
<a name="12514"><font size=-1>12514     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12515"><font size=-1>12515     </font></a><span class="default">),</span>
<a name="12516"><font size=-1>12516     </font></a><span class="default"></span>
<a name="12517"><font size=-1>12517     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12518"><font size=-1>12518     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_qpath&quot;</span><span class="default">,</span>
<a name="12519"><font size=-1>12519     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12520"><font size=-1>12520     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12521"><font size=-1>12521     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12522"><font size=-1>12522     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'ph_nqpath'</span><span class="default">],</span>
<a name="12523"><font size=-1>12523     </font></a><span class="default">    defaultval=</span><span class="string">&quot;None&quot;</span><span class="default">,</span>
<a name="12524"><font size=-1>12524     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Phonons: Q-PATH&quot;</span><span class="default">,</span>
<a name="12525"><font size=-1>12525     </font></a><span class="default">    requires=</span><span class="string">&quot;specified([[ph_nqpath]])&quot;</span><span class="default">,</span>
<a name="12526"><font size=-1>12526     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12527"><font size=-1>12527     </font></a><span class="string">This array contains the list of special q-points used to construct the q-path</span>
<a name="12528"><font size=-1>12528     </font></a><span class="string">used to (Fourier) interpolate phonon band structures and phonon linewidths.</span>
<a name="12529"><font size=-1>12529     </font></a><span class="string">See also [[ph_nqpath]] and [[ph_ndivsm]].</span>
<a name="12530"><font size=-1>12530     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12531"><font size=-1>12531     </font></a><span class="default">),</span>
<a name="12532"><font size=-1>12532     </font></a><span class="default"></span>
<a name="12533"><font size=-1>12533     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12534"><font size=-1>12534     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_qshift&quot;</span><span class="default">,</span>
<a name="12535"><font size=-1>12535     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12536"><font size=-1>12536     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12537"><font size=-1>12537     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12538"><font size=-1>12538     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'ph_nqshift'</span><span class="default">],</span>
<a name="12539"><font size=-1>12539     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="12540"><font size=-1>12540     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: Q-SHIFTs for mesh.&quot;</span><span class="default">,</span>
<a name="12541"><font size=-1>12541     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ph_nqshift]]&quot;</span><span class="default">,</span>
<a name="12542"><font size=-1>12542     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12543"><font size=-1>12543     </font></a><span class="string">This array gives the shifts to be used to construct the q-mesh for computing</span>
<a name="12544"><font size=-1>12544     </font></a><span class="string">the phonon DOS and the Eliashberg functions (see also [[ph_nqshift]]).</span>
<a name="12545"><font size=-1>12545     </font></a><span class="string">If not given, a Gamma-centered mesh is used.</span>
<a name="12546"><font size=-1>12546     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12547"><font size=-1>12547     </font></a><span class="default">),</span>
<a name="12548"><font size=-1>12548     </font></a><span class="default"></span>
<a name="12549"><font size=-1>12549     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12550"><font size=-1>12550     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_smear&quot;</span><span class="default">,</span>
<a name="12551"><font size=-1>12551     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12552"><font size=-1>12552     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12553"><font size=-1>12553     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12554"><font size=-1>12554     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12555"><font size=-1>12555     </font></a><span class="default">    defaultval=</span><span class="string">&quot;0.00002 Hartree&quot;</span><span class="default">,</span>
<a name="12556"><font size=-1>12556     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: SMEARing factor&quot;</span><span class="default">,</span>
<a name="12557"><font size=-1>12557     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="12558"><font size=-1>12558     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ph_intmeth]] == 1&quot;</span><span class="default">,</span>
<a name="12559"><font size=-1>12559     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12560"><font size=-1>12560     </font></a><span class="string">The gaussian broadening used for the integration of the phonon DOS and the</span>
<a name="12561"><font size=-1>12561     </font></a><span class="string">Eliashberg function. See also [[ph_intmeth]] and [[ph_ngqpt]].</span>
<a name="12562"><font size=-1>12562     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12563"><font size=-1>12563     </font></a><span class="default">),</span>
<a name="12564"><font size=-1>12564     </font></a><span class="default"></span>
<a name="12565"><font size=-1>12565     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12566"><font size=-1>12566     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ph_wstep&quot;</span><span class="default">,</span>
<a name="12567"><font size=-1>12567     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="12568"><font size=-1>12568     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12569"><font size=-1>12569     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="12570"><font size=-1>12570     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12571"><font size=-1>12571     </font></a><span class="default">    defaultval=</span><span class="string">&quot;0.1 meV&quot;</span><span class="default">,</span>
<a name="12572"><font size=-1>12572     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PHonons: frequency(W)  STEP.&quot;</span><span class="default">,</span>
<a name="12573"><font size=-1>12573     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="12574"><font size=-1>12574     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12575"><font size=-1>12575     </font></a><span class="string">The step used to generate the (linear) frequency mesh for the phonon DOS and</span>
<a name="12576"><font size=-1>12576     </font></a><span class="string">the Eliashberg function. The extrema of the mesh are automatically computed by the code.</span>
<a name="12577"><font size=-1>12577     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12578"><font size=-1>12578     </font></a><span class="default">),</span>
<a name="12579"><font size=-1>12579     </font></a><span class="default"></span>
<a name="12580"><font size=-1>12580     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12581"><font size=-1>12581     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pimass&quot;</span><span class="default">,</span>
<a name="12582"><font size=-1>12582     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="12583"><font size=-1>12583     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12584"><font size=-1>12584     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_useful'</span><span class="default">],</span>
<a name="12585"><font size=-1>12585     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="12586"><font size=-1>12586     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[ntypat]]&quot;</span><span class="default">,</span>
<a name="12587"><font size=-1>12587     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Path Integral fictitious MASSes&quot;</span><span class="default">,</span>
<a name="12588"><font size=-1>12588     </font></a><span class="default">    requires=</span><span class="string">&quot;[[imgmov]] = 9 or 13&quot;</span><span class="default">,</span>
<a name="12589"><font size=-1>12589     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12590"><font size=-1>12590     </font></a><span class="string">Only relevant if [[imgmov]] = 9 or 13 (Path-Integral Molecular Dynamics).</span>
<a name="12591"><font size=-1>12591     </font></a><span class="string">Gives the fictitious masses ( [[cite:Marx1996]]) in atomic mass units for each kind of atom in cell. These masses are the inertial masses used in performing Path Integral Molecular</span>
<a name="12592"><font size=-1>12592     </font></a><span class="string">Dynamics (PIMD), they are different from the true masses ([[amu]]) used to</span>
<a name="12593"><font size=-1>12593     </font></a><span class="string">define the quantum spring that relates the different beads in PIMD. They can</span>
<a name="12594"><font size=-1>12594     </font></a><span class="string">be chosen arbitrarily, but an appropriate choice will lead the different</span>
<a name="12595"><font size=-1>12595     </font></a><span class="string">variables to move on the same time scale in order to optimize the sampling</span>
<a name="12596"><font size=-1>12596     </font></a><span class="string">efficiency of the PIMD trajectory.</span>
<a name="12597"><font size=-1>12597     </font></a><span class="string">If [[pitransform]] = 1 (normal mode transformation), or [[pitransform]] = 2</span>
<a name="12598"><font size=-1>12598     </font></a><span class="string">(staging transformation), [[pimass]] is automatically set to its optimal value.</span>
<a name="12599"><font size=-1>12599     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12600"><font size=-1>12600     </font></a><span class="default">),</span>
<a name="12601"><font size=-1>12601     </font></a><span class="default"></span>
<a name="12602"><font size=-1>12602     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12603"><font size=-1>12603     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pimd_constraint&quot;</span><span class="default">,</span>
<a name="12604"><font size=-1>12604     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="12605"><font size=-1>12605     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12606"><font size=-1>12606     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_useful'</span><span class="default">],</span>
<a name="12607"><font size=-1>12607     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12608"><font size=-1>12608     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12609"><font size=-1>12609     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Path-Integral Molecular Dynamics: CONSTRAINT to be applied on a reaction coordinate&quot;</span><span class="default">,</span>
<a name="12610"><font size=-1>12610     </font></a><span class="default">    requires=</span><span class="string">&quot;[[imgmov]] = 9 or 13&quot;</span><span class="default">,</span>
<a name="12611"><font size=-1>12611     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12612"><font size=-1>12612     </font></a><span class="string">Only relevant for Path-Integral Molecular Dynamics.</span>
<a name="12613"><font size=-1>12613     </font></a><span class="string">Selects a constraint to be applied during the PIMD trajectory. The constraint</span>
<a name="12614"><font size=-1>12614     </font></a><span class="string">is holonomic (it is a relation between the position variables). In practice,</span>
<a name="12615"><font size=-1>12615     </font></a><span class="string">the total forces applied to the atomic positions are modified so as to respect</span>
<a name="12616"><font size=-1>12616     </font></a><span class="string">the constraint.</span>
<a name="12617"><font size=-1>12617     </font></a><span class="string"></span>
<a name="12618"><font size=-1>12618     </font></a><span class="string">To date, the available constraints are:</span>
<a name="12619"><font size=-1>12619     </font></a><span class="string"></span>
<a name="12620"><font size=-1>12620     </font></a><span class="string">  * **0**: no constraint</span>
<a name="12621"><font size=-1>12621     </font></a><span class="string">  * **1**: _&quot;Blue Moon Ensemble&quot; method_.</span>
<a name="12622"><font size=-1>12622     </font></a><span class="string">The constraint is a linear combination of the positions of atomic centroids</span>
<a name="12623"><font size=-1>12623     </font></a><span class="string">(this linear combination is kept constant during the simulation).</span>
<a name="12624"><font size=-1>12624     </font></a><span class="string">Sum[W_i * X_i] = constant</span>
<a name="12625"><font size=-1>12625     </font></a><span class="string">The X_i are the coordinates of the atomic centroids. The weights W_i have to</span>
<a name="12626"><font size=-1>12626     </font></a><span class="string">be specified with the [[wtatcon]](3,[[natcon]],[[nconeq]]),</span>
<a name="12627"><font size=-1>12627     </font></a><span class="string">[[iatcon]]([[natcon]]) and [[natcon]] input parameters (where [[nconeq]] is</span>
<a name="12628"><font size=-1>12628     </font></a><span class="string">fixed to 1).</span>
<a name="12629"><font size=-1>12629     </font></a><span class="string">More details on the implementation in [[cite:Komeiji2007]].</span>
<a name="12630"><font size=-1>12630     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12631"><font size=-1>12631     </font></a><span class="default">),</span>
<a name="12632"><font size=-1>12632     </font></a><span class="default"></span>
<a name="12633"><font size=-1>12633     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12634"><font size=-1>12634     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pitransform&quot;</span><span class="default">,</span>
<a name="12635"><font size=-1>12635     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="12636"><font size=-1>12636     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12637"><font size=-1>12637     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_useful'</span><span class="default">],</span>
<a name="12638"><font size=-1>12638     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12639"><font size=-1>12639     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12640"><font size=-1>12640     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Path Integral coordinate TRANSFORMation&quot;</span><span class="default">,</span>
<a name="12641"><font size=-1>12641     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12642"><font size=-1>12642     </font></a><span class="string">Only relevant if [[imgmov]] = 9 or 13 (Path-Integral Molecular Dynamics).</span>
<a name="12643"><font size=-1>12643     </font></a><span class="string">Coordinate transformation used in the integration of the Path Integral</span>
<a name="12644"><font size=-1>12644     </font></a><span class="string">Molecular Dynamics equations of motion. The transformation, with an</span>
<a name="12645"><font size=-1>12645     </font></a><span class="string">appropriate choice of fictitious masses ([[pimass]]), is used to force the</span>
<a name="12646"><font size=-1>12646     </font></a><span class="string">different modes to move on the same time scale, and thus optimize the</span>
<a name="12647"><font size=-1>12647     </font></a><span class="string">efficiency of the statistical sampling in the corresponding statistical</span>
<a name="12648"><font size=-1>12648     </font></a><span class="string">ensemble. Available with a Langevin thermostat ([[imgmov]] = 9) or with Nose-</span>
<a name="12649"><font size=-1>12649     </font></a><span class="string">Hoover chains ([[imgmov]] = 13). See [[cite:Tuckerman1996]].</span>
<a name="12650"><font size=-1>12650     </font></a><span class="string"></span>
<a name="12651"><font size=-1>12651     </font></a><span class="string">If equal to 0, no transformation is applied (primitive coordinates).</span>
<a name="12652"><font size=-1>12652     </font></a><span class="string">If equal to 1, normal mode transformation (in that case, [[nimage]] must be</span>
<a name="12653"><font size=-1>12653     </font></a><span class="string">absolutely EVEN).</span>
<a name="12654"><font size=-1>12654     </font></a><span class="string">If equal to 2, staging transformation.</span>
<a name="12655"><font size=-1>12655     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12656"><font size=-1>12656     </font></a><span class="default">),</span>
<a name="12657"><font size=-1>12657     </font></a><span class="default"></span>
<a name="12658"><font size=-1>12658     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12659"><font size=-1>12659     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_bandf&quot;</span><span class="default">,</span>
<a name="12660"><font size=-1>12660     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12661"><font size=-1>12661     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12662"><font size=-1>12662     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12663"><font size=-1>12663     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12664"><font size=-1>12664     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12665"><font size=-1>12665     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions BAND Final&quot;</span><span class="default">,</span>
<a name="12666"><font size=-1>12666     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12667"><font size=-1>12667     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12668"><font size=-1>12668     </font></a><span class="string"></span>
<a name="12669"><font size=-1>12669     </font></a><span class="string">Gives the upper band to include in the calculation of Wannier functions</span>
<a name="12670"><font size=-1>12670     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12671"><font size=-1>12671     </font></a><span class="default">),</span>
<a name="12672"><font size=-1>12672     </font></a><span class="default"></span>
<a name="12673"><font size=-1>12673     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12674"><font size=-1>12674     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_bandi&quot;</span><span class="default">,</span>
<a name="12675"><font size=-1>12675     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12676"><font size=-1>12676     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12677"><font size=-1>12677     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12678"><font size=-1>12678     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12679"><font size=-1>12679     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12680"><font size=-1>12680     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions BAND Initial&quot;</span><span class="default">,</span>
<a name="12681"><font size=-1>12681     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12682"><font size=-1>12682     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12683"><font size=-1>12683     </font></a><span class="string">Gives the lower band to include in the calculation of Wannier functions</span>
<a name="12684"><font size=-1>12684     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12685"><font size=-1>12685     </font></a><span class="default">),</span>
<a name="12686"><font size=-1>12686     </font></a><span class="default"></span>
<a name="12687"><font size=-1>12687     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12688"><font size=-1>12688     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_compute&quot;</span><span class="default">,</span>
<a name="12689"><font size=-1>12689     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12690"><font size=-1>12690     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12691"><font size=-1>12691     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12692"><font size=-1>12692     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12693"><font size=-1>12693     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12694"><font size=-1>12694     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions COMPUTATION&quot;</span><span class="default">,</span>
<a name="12695"><font size=-1>12695     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12696"><font size=-1>12696     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12697"><font size=-1>12697     </font></a><span class="string"></span>
<a name="12698"><font size=-1>12698     </font></a><span class="string">Activate computation of Projected Local Orbital Wannier functions (PLO</span>
<a name="12699"><font size=-1>12699     </font></a><span class="string">Wannier) and corresponding band structure. Variables [[plowan_bandi]],</span>
<a name="12700"><font size=-1>12700     </font></a><span class="string">[[plowan_bandf]], [[plowan_natom]], [[plowan_nbl]], [[plowan_iatom]],</span>
<a name="12701"><font size=-1>12701     </font></a><span class="string">[[plowan_lcalc]], [[plowan_projcalc]] are mandatory to precise the nature of</span>
<a name="12702"><font size=-1>12702     </font></a><span class="string">the projections.</span>
<a name="12703"><font size=-1>12703     </font></a><span class="string"></span>
<a name="12704"><font size=-1>12704     </font></a><span class="string">  * 0 --&gt; Default value: do not activate calculation of PLO Wannier.</span>
<a name="12705"><font size=-1>12705     </font></a><span class="string">  * 1 --&gt; Compute PLO Wannier and band structure</span>
<a name="12706"><font size=-1>12706     </font></a><span class="string">  * 2 --&gt; Compute PLO Wannier and band structure. In this case, the</span>
<a name="12707"><font size=-1>12707     </font></a><span class="string">  coupling in k-space between blocks of Wannier functions belonging to</span>
<a name="12708"><font size=-1>12708     </font></a><span class="string">  different angular momenta or atoms is removed.</span>
<a name="12709"><font size=-1>12709     </font></a><span class="string"></span>
<a name="12710"><font size=-1>12710     </font></a><span class="string">Other related variables are [[plowan_realspace]], [[plowan_nt]],</span>
<a name="12711"><font size=-1>12711     </font></a><span class="string">[[plowan_it]]. The implementation is not symetrized over k-point and not</span>
<a name="12712"><font size=-1>12712     </font></a><span class="string">parallelized. (The calculation of projections is detailed in [[cite:Amadon2008]] )</span>
<a name="12713"><font size=-1>12713     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12714"><font size=-1>12714     </font></a><span class="default">),</span>
<a name="12715"><font size=-1>12715     </font></a><span class="default"></span>
<a name="12716"><font size=-1>12716     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12717"><font size=-1>12717     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_iatom&quot;</span><span class="default">,</span>
<a name="12718"><font size=-1>12718     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12719"><font size=-1>12719     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12720"><font size=-1>12720     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12721"><font size=-1>12721     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12722"><font size=-1>12722     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12723"><font size=-1>12723     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions, Index of ATOM&quot;</span><span class="default">,</span>
<a name="12724"><font size=-1>12724     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12725"><font size=-1>12725     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12726"><font size=-1>12726     </font></a><span class="string"></span>
<a name="12727"><font size=-1>12727     </font></a><span class="string">Gives the indices of the [[plowan_natom]] atoms on which the projections will be done.</span>
<a name="12728"><font size=-1>12728     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12729"><font size=-1>12729     </font></a><span class="default">),</span>
<a name="12730"><font size=-1>12730     </font></a><span class="default"></span>
<a name="12731"><font size=-1>12731     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12732"><font size=-1>12732     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_it&quot;</span><span class="default">,</span>
<a name="12733"><font size=-1>12733     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12734"><font size=-1>12734     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12735"><font size=-1>12735     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_useful'</span><span class="default">],</span>
<a name="12736"><font size=-1>12736     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[plowan_nt]]'</span><span class="default">],</span>
<a name="12737"><font size=-1>12737     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12738"><font size=-1>12738     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions,  Index of Translation.&quot;</span><span class="default">,</span>
<a name="12739"><font size=-1>12739     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12740"><font size=-1>12740     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12741"><font size=-1>12741     </font></a><span class="string">Requires [[plowan_realspace]] to be greater than 0 and [[plowan_nt]] to be</span>
<a name="12742"><font size=-1>12742     </font></a><span class="string">greater than 0. Precise a given set of selected real space translation by</span>
<a name="12743"><font size=-1>12743     </font></a><span class="string">using the real space vectors basis. These atoms are used to define Wannier</span>
<a name="12744"><font size=-1>12744     </font></a><span class="string">functions in real space. These real space Wannier functions are used as a</span>
<a name="12745"><font size=-1>12745     </font></a><span class="string">basis to compute the Hamiltonian.</span>
<a name="12746"><font size=-1>12746     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12747"><font size=-1>12747     </font></a><span class="default">),</span>
<a name="12748"><font size=-1>12748     </font></a><span class="default"></span>
<a name="12749"><font size=-1>12749     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12750"><font size=-1>12750     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_lcalc&quot;</span><span class="default">,</span>
<a name="12751"><font size=-1>12751     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12752"><font size=-1>12752     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12753"><font size=-1>12753     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12754"><font size=-1>12754     </font></a><span class="default">    dimensions=[</span><span class="string">'sum([[plowan_nbl]])'</span><span class="default">],</span>
<a name="12755"><font size=-1>12755     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="12756"><font size=-1>12756     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions,  L values to use for CALCulation&quot;</span><span class="default">,</span>
<a name="12757"><font size=-1>12757     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12758"><font size=-1>12758     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12759"><font size=-1>12759     </font></a><span class="string">Gives the [[plowan_nbl]] values of angular momenta for each atom, in the order</span>
<a name="12760"><font size=-1>12760     </font></a><span class="string">of the atoms as given in [[plowan_iatom]].</span>
<a name="12761"><font size=-1>12761     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12762"><font size=-1>12762     </font></a><span class="default">),</span>
<a name="12763"><font size=-1>12763     </font></a><span class="default"></span>
<a name="12764"><font size=-1>12764     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12765"><font size=-1>12765     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_natom&quot;</span><span class="default">,</span>
<a name="12766"><font size=-1>12766     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12767"><font size=-1>12767     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12768"><font size=-1>12768     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12769"><font size=-1>12769     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12770"><font size=-1>12770     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12771"><font size=-1>12771     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions, Number of ATOMs&quot;</span><span class="default">,</span>
<a name="12772"><font size=-1>12772     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12773"><font size=-1>12773     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12774"><font size=-1>12774     </font></a><span class="string">Gives the number of atoms on which the projection will be done</span>
<a name="12775"><font size=-1>12775     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12776"><font size=-1>12776     </font></a><span class="default">),</span>
<a name="12777"><font size=-1>12777     </font></a><span class="default"></span>
<a name="12778"><font size=-1>12778     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12779"><font size=-1>12779     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_nbl&quot;</span><span class="default">,</span>
<a name="12780"><font size=-1>12780     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12781"><font size=-1>12781     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12782"><font size=-1>12782     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12783"><font size=-1>12783     </font></a><span class="default">    dimensions=[</span><span class="string">'[[plowan_natom]]'</span><span class="default">],</span>
<a name="12784"><font size=-1>12784     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12785"><font size=-1>12785     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions,  NumBer of L values&quot;</span><span class="default">,</span>
<a name="12786"><font size=-1>12786     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12787"><font size=-1>12787     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12788"><font size=-1>12788     </font></a><span class="string">Gives the total number of angular momenta (over all atoms) to compute the projections.</span>
<a name="12789"><font size=-1>12789     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12790"><font size=-1>12790     </font></a><span class="default">),</span>
<a name="12791"><font size=-1>12791     </font></a><span class="default"></span>
<a name="12792"><font size=-1>12792     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12793"><font size=-1>12793     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_nt&quot;</span><span class="default">,</span>
<a name="12794"><font size=-1>12794     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12795"><font size=-1>12795     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12796"><font size=-1>12796     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_useful'</span><span class="default">],</span>
<a name="12797"><font size=-1>12797     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12798"><font size=-1>12798     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12799"><font size=-1>12799     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;&quot;&quot;Projected Local Orbital WANnier functions,  Number of Translation on which the real space values of</span>
<a name="12800"><font size=-1>12800     </font></a><span class="string">energy are computed&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12801"><font size=-1>12801     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12802"><font size=-1>12802     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12803"><font size=-1>12803     </font></a><span class="string">Requires [[plowan_realspace]] to be greater than 0. Gives a number of selected</span>
<a name="12804"><font size=-1>12804     </font></a><span class="string">atoms. These atoms are used to define Wannier functions in real space. These</span>
<a name="12805"><font size=-1>12805     </font></a><span class="string">real space Wannier functions are used as a basis to compute the Hamiltonian.</span>
<a name="12806"><font size=-1>12806     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12807"><font size=-1>12807     </font></a><span class="default">),</span>
<a name="12808"><font size=-1>12808     </font></a><span class="default"></span>
<a name="12809"><font size=-1>12809     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12810"><font size=-1>12810     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_projcalc&quot;</span><span class="default">,</span>
<a name="12811"><font size=-1>12811     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12812"><font size=-1>12812     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12813"><font size=-1>12813     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="12814"><font size=-1>12814     </font></a><span class="default">    dimensions=[</span><span class="string">'sum([[plowan_nbl]])'</span><span class="default">],</span>
<a name="12815"><font size=-1>12815     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="12816"><font size=-1>12816     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions,  PROJectors values to use for CALCulation&quot;</span><span class="default">,</span>
<a name="12817"><font size=-1>12817     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12818"><font size=-1>12818     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12819"><font size=-1>12819     </font></a><span class="string">Gives the [[plowan_nbl]] values of projectors for each atom, in the order of</span>
<a name="12820"><font size=-1>12820     </font></a><span class="string">the atoms as given in [[plowan_iatom]]. The index i for the projectors refers</span>
<a name="12821"><font size=-1>12821     </font></a><span class="string">to the ith number on line orbitals of the PAW atomic data file.</span>
<a name="12822"><font size=-1>12822     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12823"><font size=-1>12823     </font></a><span class="default">),</span>
<a name="12824"><font size=-1>12824     </font></a><span class="default"></span>
<a name="12825"><font size=-1>12825     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12826"><font size=-1>12826     </font></a><span class="default">    abivarname=</span><span class="string">&quot;plowan_realspace&quot;</span><span class="default">,</span>
<a name="12827"><font size=-1>12827     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="12828"><font size=-1>12828     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12829"><font size=-1>12829     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_useful'</span><span class="default">],</span>
<a name="12830"><font size=-1>12830     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12831"><font size=-1>12831     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12832"><font size=-1>12832     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Projected Local Orbital WANnier functions,  activate REAL SPACE calculation.&quot;</span><span class="default">,</span>
<a name="12833"><font size=-1>12833     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="12834"><font size=-1>12834     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12835"><font size=-1>12835     </font></a><span class="string">Can take the following values:</span>
<a name="12836"><font size=-1>12836     </font></a><span class="string"></span>
<a name="12837"><font size=-1>12837     </font></a><span class="string">  * 0 --&gt; Default value: do not activate calculation of real space Wannier functions.</span>
<a name="12838"><font size=-1>12838     </font></a><span class="string">  * 1 --&gt; Compute PLO Wannier in real space for analysis. These data can also be used</span>
<a name="12839"><font size=-1>12839     </font></a><span class="string">    in a following dataset to perform a Wannier interpolation.</span>
<a name="12840"><font size=-1>12840     </font></a><span class="string">  * 2 --&gt; Do simple Wannier Interpolation for a given k points starting from real space Wannier function</span>
<a name="12841"><font size=-1>12841     </font></a><span class="string">    Hamiltonian computed in a preceding dataset.</span>
<a name="12842"><font size=-1>12842     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12843"><font size=-1>12843     </font></a><span class="default">),</span>
<a name="12844"><font size=-1>12844     </font></a><span class="default"></span>
<a name="12845"><font size=-1>12845     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12846"><font size=-1>12846     </font></a><span class="default">    abivarname=</span><span class="string">&quot;polcen&quot;</span><span class="default">,</span>
<a name="12847"><font size=-1>12847     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="12848"><font size=-1>12848     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="12849"><font size=-1>12849     </font></a><span class="default">    topics=[</span><span class="string">'Berry_useful'</span><span class="default">],</span>
<a name="12850"><font size=-1>12850     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="12851"><font size=-1>12851     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="12852"><font size=-1>12852     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;POLarization for CENtrosymmetric geometry&quot;</span><span class="default">,</span>
<a name="12853"><font size=-1>12853     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12854"><font size=-1>12854     </font></a><span class="string">When doing a finite electric displacement field calculation, if the structure</span>
<a name="12855"><font size=-1>12855     </font></a><span class="string">is centrosymmetric but the polarization is non-zero (such as for AlAs), this</span>
<a name="12856"><font size=-1>12856     </font></a><span class="string">non-zero polarization should be specified as [[polcen]] (in REDUCED</span>
<a name="12857"><font size=-1>12857     </font></a><span class="string">coordinates, in atomic units) in the input file. See Eq.(24) in the Suppl. of</span>
<a name="12858"><font size=-1>12858     </font></a><span class="string">[[cite:Stengel2009]]</span>
<a name="12859"><font size=-1>12859     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12860"><font size=-1>12860     </font></a><span class="default">),</span>
<a name="12861"><font size=-1>12861     </font></a><span class="default"></span>
<a name="12862"><font size=-1>12862     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12863"><font size=-1>12863     </font></a><span class="default">    abivarname=</span><span class="string">&quot;posdoppler&quot;</span><span class="default">,</span>
<a name="12864"><font size=-1>12864     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="12865"><font size=-1>12865     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12866"><font size=-1>12866     </font></a><span class="default">    topics=[</span><span class="string">'positron_basic'</span><span class="default">],</span>
<a name="12867"><font size=-1>12867     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12868"><font size=-1>12868     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12869"><font size=-1>12869     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;POSitron computation of DOPPLER broadening&quot;</span><span class="default">,</span>
<a name="12870"><font size=-1>12870     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12871"><font size=-1>12871     </font></a><span class="string">Relevant only when [[positron]]/=0.</span>
<a name="12872"><font size=-1>12872     </font></a><span class="string">This input parameter activates the calculation of the Doppler broadening of</span>
<a name="12873"><font size=-1>12873     </font></a><span class="string">the electron-positron annihilation radiation.</span>
<a name="12874"><font size=-1>12874     </font></a><span class="string">An output file containing the momentum distributions of annihilating electron-positron pairs is created.</span>
<a name="12875"><font size=-1>12875     </font></a><span class="string">Such a computation needs a core wave-function file (per atom type) to be</span>
<a name="12876"><font size=-1>12876     </font></a><span class="string">provided. This core WF file should be named '**psp_file_name**.corewf' (where</span>
<a name="12877"><font size=-1>12877     </font></a><span class="string">**pspfile_name** is the name of the pseudo-potential (or PAW) file) or</span>
<a name="12878"><font size=-1>12878     </font></a><span class="string">'corewf.abinit**ityp**' (where **ityp** is the index of the atom type). Core WF</span>
<a name="12879"><font size=-1>12879     </font></a><span class="string">files can be obtained with the atompaw tool by the use of **prtcorewf** keyword.</span>
<a name="12880"><font size=-1>12880     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="12881"><font size=-1>12881     </font></a><span class="default">),</span>
<a name="12882"><font size=-1>12882     </font></a><span class="default"></span>
<a name="12883"><font size=-1>12883     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="12884"><font size=-1>12884     </font></a><span class="default">    abivarname=</span><span class="string">&quot;positron&quot;</span><span class="default">,</span>
<a name="12885"><font size=-1>12885     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="12886"><font size=-1>12886     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="12887"><font size=-1>12887     </font></a><span class="default">    topics=[</span><span class="string">'positron_compulsory'</span><span class="default">],</span>
<a name="12888"><font size=-1>12888     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="12889"><font size=-1>12889     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="12890"><font size=-1>12890     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;POSITRON calculation&quot;</span><span class="default">,</span>
<a name="12891"><font size=-1>12891     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="12892"><font size=-1>12892     </font></a><span class="string">This input parameter can be positive or negative.</span>
<a name="12893"><font size=-1>12893     </font></a><span class="string">Negative values for [[positron]] are only relevant for PAW calculations.</span>
<a name="12894"><font size=-1>12894     </font></a><span class="string">Electron-positron correlation functional is defined by [[ixcpositron]].</span>
<a name="12895"><font size=-1>12895     </font></a><span class="string">Other relevant input parameter: [[posocc]] (occupation number for the</span>
<a name="12896"><font size=-1>12896     </font></a><span class="string">positron).</span>
<a name="12897"><font size=-1>12897     </font></a><span class="string"></span>
<a name="12898"><font size=-1>12898     </font></a><span class="string">Positive values for [[positron]]:\n</span>
<a name="12899"><font size=-1>12899     </font></a><span class="string">For [[positron]] = 1 or 2, will perform the calculation of positron</span>
<a name="12900"><font size=-1>12900     </font></a><span class="string">lifetime (and annihilation rate).</span>
<a name="12901"><font size=-1>12901     </font></a><span class="string"></span>
<a name="12902"><font size=-1>12902     </font></a><span class="string">  * [[positron]] = 1:\n</span>
<a name="12903"><font size=-1>12903     </font></a><span class="string">Starting from a previous electronic GS density (with [[positron]] = 0), a</span>
<a name="12904"><font size=-1>12904     </font></a><span class="string">positronic ground-state calculation is performed, considering that the</span>
<a name="12905"><font size=-1>12905     </font></a><span class="string">electrons are not perturbed by the presence of the positron.</span>
<a name="12906"><font size=-1>12906     </font></a><span class="string">This is almost correct for a positron in a perfect bulk material. But this</span>
<a name="12907"><font size=-1>12907     </font></a><span class="string">approximation fails when defects exist in the material (for instance: the</span>
<a name="12908"><font size=-1>12908     </font></a><span class="string">positron might be trapped by a vacancy).</span>
<a name="12909"><font size=-1>12909     </font></a><span class="string">The electronic density will be automatically read from a _DEN file (with or</span>
<a name="12910"><font size=-1>12910     </font></a><span class="string">without [[irdden]] keyword).</span>
<a name="12911"><font size=-1>12911     </font></a><span class="string">At the end of the SCF cycle, the positron lifetime and annihilation rate are</span>
<a name="12912"><font size=-1>12912     </font></a><span class="string">printed out.</span>
<a name="12913"><font size=-1>12913     </font></a><span class="string"></span>
<a name="12914"><font size=-1>12914     </font></a><span class="string">Additional information for the use of pseudopotentials:</span>
<a name="12915"><font size=-1>12915     </font></a><span class="string"></span>
<a name="12916"><font size=-1>12916     </font></a><span class="string">    PAW datasets: nothing to do; simply use usual electronic PAW datasets</span>
<a name="12917"><font size=-1>12917     </font></a><span class="string">    Norm-conserving pseudopotentials: One has to use specific pseudopotentials for the positron calculation. They must be of the FHI type (pspcod=6), and must contain at their end, the all-electrons core density generated with FHI98PP. They must have lmax=lloc=0 (check that this works for the electronic GS !! No ghost, etc...). Otherwise, their are similar to an usual FHI pseudopotential.</span>
<a name="12918"><font size=-1>12918     </font></a><span class="string"></span>
<a name="12919"><font size=-1>12919     </font></a><span class="string"></span>
<a name="12920"><font size=-1>12920     </font></a><span class="string">  * [[positron]] = 2:\n</span>
<a name="12921"><font size=-1>12921     </font></a><span class="string">Starting from a previous positronic GS density (with [[positron]] = 1 ), an</span>
<a name="12922"><font size=-1>12922     </font></a><span class="string">electronic ground-state calculation is performed, keeping the positronic</span>
<a name="12923"><font size=-1>12923     </font></a><span class="string">density constant.</span>
<a name="12924"><font size=-1>12924     </font></a><span class="string">The positronic density will be automatically read from a _DEN file (with or</span>
<a name="12925"><font size=-1>12925     </font></a><span class="string">without [[getden]]/[[irdden]] keyword).</span>
<a name="12926"><font size=-1>12926     </font></a><span class="string">At the end of the SCF cycle, the positron lifetime and annihilation rate are</span>
<a name="12927"><font size=-1>12927     </font></a><span class="string">printed out.</span>
<a name="12928"><font size=-1>12928     </font></a><span class="string"></span>
<a name="12929"><font size=-1>12929     </font></a><span class="string">Additional information for the use of pseudopotentials:</span>
<a name="12930"><font size=-1>12930     </font></a><span class="string"></span>
<a name="12931"><font size=-1>12931     </font></a><span class="string">    PAW datasets: nothing to do; simply use usual electronic PAW datasets</span>
<a name="12932"><font size=-1>12932     </font></a><span class="string">    Norm-conserving pseudopotentials: One has to use specific pseudopotentials for the electron calculation. They must be of the FHI type (pspcod=6), and must contain at their end, the all-electrons core density generated with FHI98PP.</span>
<a name="12933"><font size=-1>12933     </font></a><span class="string"></span>
<a name="12934"><font size=-1>12934     </font></a><span class="string"></span>
<a name="12935"><font size=-1>12935     </font></a><span class="string">  * **Typical use**:\n</span>
<a name="12936"><font size=-1>12936     </font></a><span class="string">The calculation is done in several steps:</span>
<a name="12937"><font size=-1>12937     </font></a><span class="string">The first one is a normal GS calculation for the electrons, with [[positron]] = 0.</span>
<a name="12938"><font size=-1>12938     </font></a><span class="string">The only specific thing to do is to set [[prtden]] = 1 (this is the default</span>
<a name="12939"><font size=-1>12939     </font></a><span class="string">for ABINIT v6.x+). This will create the associated _DEN file which will be</span>
<a name="12940"><font size=-1>12940     </font></a><span class="string">used as input file for the positronic GS calculation.</span>
<a name="12941"><font size=-1>12941     </font></a><span class="string">The second step is the GS calculation of the positron and subsequently its</span>
<a name="12942"><font size=-1>12942     </font></a><span class="string">lifetime, with [[positron]] =1. One has to define also [[ixcpositron]].</span>
<a name="12943"><font size=-1>12943     </font></a><span class="string">Then, it is possible to perform an additional step, computing the GS</span>
<a name="12944"><font size=-1>12944     </font></a><span class="string">electronic density in presence of the positron, with [[positron]] = 2.</span>
<a name="12945"><font size=-1>12945     </font></a><span class="string">and so on...</span>
<a name="12946"><font size=-1>12946     </font></a><span class="string">This procedure can be automated (for PAW only) by the use of a negative value</span>
<a name="12947"><font size=-1>12947     </font></a><span class="string">for [[positron]].</span>
<a name="12948"><font size=-1>12948     </font></a><span class="string">At the end, a converged value of the positron lifetime (decomposed in several</span>
<a name="12949"><font size=-1>12949     </font></a><span class="string">contributions) is printed.</span>
<a name="12950"><font size=-1>12950     </font></a><span class="string">See also [[posdoppler]] keyword for the calculation of Doppler broadening.</span>
<a name="12951"><font size=-1>12951     </font></a><span class="string"></span>
<a name="12952"><font size=-1>12952     </font></a><span class="string"></span>
<a name="12953"><font size=-1>12953     </font></a><span class="string">Negative values for [[positron]]:\n</span>
<a name="12954"><font size=-1>12954     </font></a><span class="string">For [[positron]]&lt;0, will perform an automatic calculation of electrons and</span>
<a name="12955"><font size=-1>12955     </font></a><span class="string">positron densities in the two-component DFT context; then will compute</span>
<a name="12956"><font size=-1>12956     </font></a><span class="string">positron lifetime (and annihilation rate).</span>
<a name="12957"><font size=-1>12957     </font></a><span class="string"></span>
<a name="12958"><font size=-1>12958     </font></a><span class="string">  * [[positron]] = -1:\n</span>
<a name="12959"><font size=-1>12959     </font></a><span class="string">Starting from scratch, will first perform a usual electronic ground-state</span>
<a name="12960"><font size=-1>12960     </font></a><span class="string">calculation until convergence (controlled by the use of one of the _tolerance_</span>
<a name="12961"><font size=-1>12961     </font></a><span class="string">keywords).</span>
<a name="12962"><font size=-1>12962     </font></a><span class="string">Then will perform a positronic ground state calculation in presence of the</span>
<a name="12963"><font size=-1>12963     </font></a><span class="string">electrons and ions; then an electronic ground state calculation in presence of</span>
<a name="12964"><font size=-1>12964     </font></a><span class="string">the positron and the ions...</span>
<a name="12965"><font size=-1>12965     </font></a><span class="string">and so on... until the total energy is converged.</span>
<a name="12966"><font size=-1>12966     </font></a><span class="string">The convergence of the total energy of the ions+electrons+positron system is</span>
<a name="12967"><font size=-1>12967     </font></a><span class="string">controlled by the use of the [[postoldfe]], [[postoldff]] and [[posnstep]]</span>
<a name="12968"><font size=-1>12968     </font></a><span class="string">input keywords.</span>
<a name="12969"><font size=-1>12969     </font></a><span class="string">With [[positron]] = -1, at the beginning of each new electronic/positronic</span>
<a name="12970"><font size=-1>12970     </font></a><span class="string">step, the wave functions are unknown.</span>
<a name="12971"><font size=-1>12971     </font></a><span class="string"></span>
<a name="12972"><font size=-1>12972     </font></a><span class="string">  * [[positron]] = -10:\n</span>
<a name="12973"><font size=-1>12973     </font></a><span class="string">Same as [[positron]] = -1 except that the electronic/positronic wave functions</span>
<a name="12974"><font size=-1>12974     </font></a><span class="string">are stored in memory.</span>
<a name="12975"><font size=-1>12975     </font></a><span class="string">Consequently, the total number of iterations to reach the convergence</span>
<a name="12976"><font size=-1>12976     </font></a><span class="string">($\Delta$Etotal&lt;[[postoldfe]] or $\Delta$Forces&lt;[[postoldff]]) is smaller.</span>
<a name="12977"><font size=-1>12977     </font></a><span class="string">But, this can increase the total amount of memory needed by the code.</span>
<a name="12978"><font size=-1>12978     </font></a><span class="string"></span>
<a name="12979"><font size=-1>12979     </font></a><span class="string">  * [[positron]] = -2:\n</span>
<a name="12980"><font size=-1>12980     </font></a><span class="string">Same as [[positron]] = -1 except that the two-component DFT cycle is forced to</span>
<a name="12981"><font size=-1>12981     </font></a><span class="string">stop at the end of an electronic step.</span>
<a name="12982"><font size=-1>12982     </font></a><span class="string"></span>
<a name="12983"><font size=-1>12983     </font></a><span class="string">  * [[positron]] = -20:\n</span>
<a name="12984"><font size=-1>12984     </font></a><span class="string">Same as [[positron]] = -10 except that the two-component DFT cycle is forced to</span>
<a name="12985"><font size=-1>12985     </font></a><span class="string">stop at the end of an electronic step.</span>
<a name="12986"><font size=-1>12986     </font></a><span class="string"></span>
<a name="12987"><font size=-1>12987     </font></a><span class="string"></span>
<a name="12988"><font size=-1>12988     </font></a><span class="string">Advice for use:</span>
<a name="12989"><font size=-1>12989     </font></a><span class="string">There are two typical cases which have to be differently treated:</span>
<a name="12990"><font size=-1>12990     </font></a><span class="string"></span>
<a name="12991"><font size=-1>12991     </font></a><span class="string">  * **A positron in a perfect _bulk_ system**:\n</span>
<a name="12992"><font size=-1>12992     </font></a><span class="string">In that case, the positron is delocalized in the whole crystal. Its density is</span>
<a name="12993"><font size=-1>12993     </font></a><span class="string">almost zero.</span>
<a name="12994"><font size=-1>12994     </font></a><span class="string">Thus, the &quot;zero density positron limit&quot; has to be used. [[ixcpositron]] has to</span>
<a name="12995"><font size=-1>12995     </font></a><span class="string">be choosen accordingly.</span>
<a name="12996"><font size=-1>12996     </font></a><span class="string">In order to have the zero density positron limit it is adviced to follow these</span>
<a name="12997"><font size=-1>12997     </font></a><span class="string">points:</span>
<a name="12998"><font size=-1>12998     </font></a><span class="string"></span>
<a name="12999"><font size=-1>12999     </font></a><span class="string">  * 1- Put a small positronic charge (by setting a [[posocc]] to a small value) **OR** use a big supercell.</span>
<a name="13000"><font size=-1>13000     </font></a><span class="string">  * 2- Use only k=$\Gamma$ wave vector for the positronic calculation.</span>
<a name="13001"><font size=-1>13001     </font></a><span class="string">  * 3- Use the manual procedure in 2 steps: first [[positron]] = 0 and then [[positron]] = 1; avoid the [[positron]] = 2 step and the automatic procedure ([[positron]]&lt;0).</span>
<a name="13002"><font size=-1>13002     </font></a><span class="string"></span>
<a name="13003"><font size=-1>13003     </font></a><span class="string">In principle, the positron lifetime should converge with the value of</span>
<a name="13004"><font size=-1>13004     </font></a><span class="string">[[posocc]] or the size of the supercell.</span>
<a name="13005"><font size=-1>13005     </font></a><span class="string"></span>
<a name="13006"><font size=-1>13006     </font></a><span class="string">  * **A positron trapped in a _default_ (vacancy...)**:\n</span>
<a name="13007"><font size=-1>13007     </font></a><span class="string">In that case, the positron is localized in the default. Its density can be</span>
<a name="13008"><font size=-1>13008     </font></a><span class="string">localized in the simulation cell (provided that the cell is sufficiently</span>
<a name="13009"><font size=-1>13009     </font></a><span class="string">large) and influences the electronic density.</span>
<a name="13010"><font size=-1>13010     </font></a><span class="string">So, it is advised to use the automatic procedure ([[positron]]&lt;0) or the</span>
<a name="13011"><font size=-1>13011     </font></a><span class="string">manual procedure with several [[positron]] = 0,1,2,1,... steps.</span>
<a name="13012"><font size=-1>13012     </font></a><span class="string">K-points can be used as in usual electronic calculations.</span>
<a name="13013"><font size=-1>13013     </font></a><span class="string">Also note that it is possible to use forces and stresses to perform structural</span>
<a name="13014"><font size=-1>13014     </font></a><span class="string">minimization.</span>
<a name="13015"><font size=-1>13015     </font></a><span class="string"></span>
<a name="13016"><font size=-1>13016     </font></a><span class="string">References: [[cite:Arponen1979a]], [[cite:Boronski1986]], [[cite:Sterne1991]], [[cite:Puska1995]], [[cite:Barbiellini1995]]</span>
<a name="13017"><font size=-1>13017     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13018"><font size=-1>13018     </font></a><span class="default">),</span>
<a name="13019"><font size=-1>13019     </font></a><span class="default"></span>
<a name="13020"><font size=-1>13020     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13021"><font size=-1>13021     </font></a><span class="default">    abivarname=</span><span class="string">&quot;posnstep&quot;</span><span class="default">,</span>
<a name="13022"><font size=-1>13022     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="13023"><font size=-1>13023     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13024"><font size=-1>13024     </font></a><span class="default">    topics=[</span><span class="string">'positron_basic'</span><span class="default">],</span>
<a name="13025"><font size=-1>13025     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13026"><font size=-1>13026     </font></a><span class="default">    defaultval=</span><span class="number">50</span><span class="default">,</span>
<a name="13027"><font size=-1>13027     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;POSitron calculation: max. Number of STEPs for the two-component DFT&quot;</span><span class="default">,</span>
<a name="13028"><font size=-1>13028     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13029"><font size=-1>13029     </font></a><span class="string">Relevant only when [[positron]]&lt;0.</span>
<a name="13030"><font size=-1>13030     </font></a><span class="string">Sets the maximum number of electronic/positronic iterations that, when</span>
<a name="13031"><font size=-1>13031     </font></a><span class="string">reached, will cause the two-component DFT SCF cycle to stop.</span>
<a name="13032"><font size=-1>13032     </font></a><span class="string">The code will first compute the electronic ground-state, then the positronic</span>
<a name="13033"><font size=-1>13033     </font></a><span class="string">ground state in the electronic density, then the electronic ground state in</span>
<a name="13034"><font size=-1>13034     </font></a><span class="string">the positronic density until $\Delta$Etotal&lt;[[postoldfe]] or $\Delta$Forces&lt;[[postoldff]] or the number</span>
<a name="13035"><font size=-1>13035     </font></a><span class="string">of electronic/positronic steps is [[posnstep]].</span>
<a name="13036"><font size=-1>13036     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13037"><font size=-1>13037     </font></a><span class="default">),</span>
<a name="13038"><font size=-1>13038     </font></a><span class="default"></span>
<a name="13039"><font size=-1>13039     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13040"><font size=-1>13040     </font></a><span class="default">    abivarname=</span><span class="string">&quot;posocc&quot;</span><span class="default">,</span>
<a name="13041"><font size=-1>13041     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="13042"><font size=-1>13042     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="13043"><font size=-1>13043     </font></a><span class="default">    topics=[</span><span class="string">'positron_basic'</span><span class="default">],</span>
<a name="13044"><font size=-1>13044     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13045"><font size=-1>13045     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="13046"><font size=-1>13046     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;POSitron calculation: OCCupation number for the positron&quot;</span><span class="default">,</span>
<a name="13047"><font size=-1>13047     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13048"><font size=-1>13048     </font></a><span class="string">Relevant only when [[positron]]/=0.</span>
<a name="13049"><font size=-1>13049     </font></a><span class="string">Sets the occupation number for the positron. Has to be &lt;=1.</span>
<a name="13050"><font size=-1>13050     </font></a><span class="string">Changing [[posocc]] is only useful for bulk calculation when one wants to</span>
<a name="13051"><font size=-1>13051     </font></a><span class="string">perform lifetime computations using a small simulation cell (can avoid the use</span>
<a name="13052"><font size=-1>13052     </font></a><span class="string">of a supercell). It simulates the dispersion of the positron in the whole</span>
<a name="13053"><font size=-1>13053     </font></a><span class="string">crystal.</span>
<a name="13054"><font size=-1>13054     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13055"><font size=-1>13055     </font></a><span class="default">),</span>
<a name="13056"><font size=-1>13056     </font></a><span class="default"></span>
<a name="13057"><font size=-1>13057     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13058"><font size=-1>13058     </font></a><span class="default">    abivarname=</span><span class="string">&quot;postoldfe&quot;</span><span class="default">,</span>
<a name="13059"><font size=-1>13059     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="13060"><font size=-1>13060     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="13061"><font size=-1>13061     </font></a><span class="default">    topics=[</span><span class="string">'positron_basic'</span><span class="default">],</span>
<a name="13062"><font size=-1>13062     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13063"><font size=-1>13063     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[postoldff]] = 0'</span><span class="default">: </span><span class="number">1e-06</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0.0</span><span class="default">}),</span>
<a name="13064"><font size=-1>13064     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;POSitron calculation: TOLerance on the DiFference of total Energy&quot;</span><span class="default">,</span>
<a name="13065"><font size=-1>13065     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="13066"><font size=-1>13066     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13067"><font size=-1>13067     </font></a><span class="string">Relevant only when [[positron]]&lt;0.</span>
<a name="13068"><font size=-1>13068     </font></a><span class="string">Sets a tolerance for absolute difference of total energy (of</span>
<a name="13069"><font size=-1>13069     </font></a><span class="string">_ions+electrons+positron_ system) that, when reached, will cause the SCF cycle</span>
<a name="13070"><font size=-1>13070     </font></a><span class="string">to stop before the number of steps is [[nstep]] or the number of</span>
<a name="13071"><font size=-1>13071     </font></a><span class="string">electronic/positronic steps is [[posnstep]].</span>
<a name="13072"><font size=-1>13072     </font></a><span class="string"></span>
<a name="13073"><font size=-1>13073     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[postoldfe]] has</span>
<a name="13074"><font size=-1>13074     </font></a><span class="string">the [[ENERGY]] characteristics.</span>
<a name="13075"><font size=-1>13075     </font></a><span class="string">One and only one of [[postoldfe]] or [[postoldff]] can be set.</span>
<a name="13076"><font size=-1>13076     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13077"><font size=-1>13077     </font></a><span class="default">),</span>
<a name="13078"><font size=-1>13078     </font></a><span class="default"></span>
<a name="13079"><font size=-1>13079     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13080"><font size=-1>13080     </font></a><span class="default">    abivarname=</span><span class="string">&quot;postoldff&quot;</span><span class="default">,</span>
<a name="13081"><font size=-1>13081     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="13082"><font size=-1>13082     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="13083"><font size=-1>13083     </font></a><span class="default">    topics=[</span><span class="string">'positron_basic'</span><span class="default">],</span>
<a name="13084"><font size=-1>13084     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13085"><font size=-1>13085     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13086"><font size=-1>13086     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;POSitron calculation: TOLerance on the DiFference of Forces&quot;</span><span class="default">,</span>
<a name="13087"><font size=-1>13087     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13088"><font size=-1>13088     </font></a><span class="string">Relevant only when [[positron]] &lt; 0.</span>
<a name="13089"><font size=-1>13089     </font></a><span class="string">Sets a tolerance for absolute difference of maximum force (in hartree/Bohr) acting on ions (due</span>
<a name="13090"><font size=-1>13090     </font></a><span class="string">to _ions+electrons+positron_ system) that, when reached, will cause the SCF</span>
<a name="13091"><font size=-1>13091     </font></a><span class="string">cycle to stop before the number of SCF steps is [[nstep]] or the number of</span>
<a name="13092"><font size=-1>13092     </font></a><span class="string">electronic/positronic steps is [[posnstep]].</span>
<a name="13093"><font size=-1>13093     </font></a><span class="string">One and only one of [[postoldfe]] or [[postoldff]] can be set.</span>
<a name="13094"><font size=-1>13094     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13095"><font size=-1>13095     </font></a><span class="default">),</span>
<a name="13096"><font size=-1>13096     </font></a><span class="default"></span>
<a name="13097"><font size=-1>13097     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13098"><font size=-1>13098     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ppmfrq&quot;</span><span class="default">,</span>
<a name="13099"><font size=-1>13099     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="13100"><font size=-1>13100     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="13101"><font size=-1>13101     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="13102"><font size=-1>13102     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13103"><font size=-1>13103     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'Ha'</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="13104"><font size=-1>13104     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Plasmon Pole Model FReQuency&quot;</span><span class="default">,</span>
<a name="13105"><font size=-1>13105     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="13106"><font size=-1>13106     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="13107"><font size=-1>13107     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13108"><font size=-1>13108     </font></a><span class="string">**In plasmon-pole calculations**</span>
<a name="13109"><font size=-1>13109     </font></a><span class="string"></span>
<a name="13110"><font size=-1>13110     </font></a><span class="string">Usually only effective if GW corrections are evaluated using the plasmon-pole</span>
<a name="13111"><font size=-1>13111     </font></a><span class="string">model of Godby-Needs ([[ppmodel]] == 1).</span>
<a name="13112"><font size=-1>13112     </font></a><span class="string"></span>
<a name="13113"><font size=-1>13113     </font></a><span class="string">In the present status of the GW code, the convolution in frequency space</span>
<a name="13114"><font size=-1>13114     </font></a><span class="string">defining the self-energy operator can be evaluated using two different</span>
<a name="13115"><font size=-1>13115     </font></a><span class="string">approaches: numerical integration and plasmon-pole models.</span>
<a name="13116"><font size=-1>13116     </font></a><span class="string">Methods based on the numerical integration (contour deformation, analytic</span>
<a name="13117"><font size=-1>13117     </font></a><span class="string">continuation) require the knowledge of the screened interaction for several</span>
<a name="13118"><font size=-1>13118     </font></a><span class="string">frequencies. These approaches give the most accurate results but at the price</span>
<a name="13119"><font size=-1>13119     </font></a><span class="string">of an increase in the CPU time required.</span>
<a name="13120"><font size=-1>13120     </font></a><span class="string">Alternatively, it is possible to approximate the dynamical behaviour of the</span>
<a name="13121"><font size=-1>13121     </font></a><span class="string">screened interaction through simple analytical expressions, the so-called</span>
<a name="13122"><font size=-1>13122     </font></a><span class="string">plasmon-pole models. In the plasmon-pole model proposed by Godby-Needs</span>
<a name="13123"><font size=-1>13123     </font></a><span class="string">([[ppmodel]] = 1), the screening must be available at zero frequency, as well as</span>
<a name="13124"><font size=-1>13124     </font></a><span class="string">at another imaginary frequency, of the order of the plasmon frequency (the</span>
<a name="13125"><font size=-1>13125     </font></a><span class="string">peak in the EELS spectrum). This information is used to model the behaviour of</span>
<a name="13126"><font size=-1>13126     </font></a><span class="string">the dielectric matrix for all frequencies. During the calculation of the</span>
<a name="13127"><font size=-1>13127     </font></a><span class="string">screening, [[ppmfrq]] defines the imaginary frequency where the dielectric</span>
<a name="13128"><font size=-1>13128     </font></a><span class="string">matrix is evaluated, in addition to the zero frequency. During the self-energy</span>
<a name="13129"><font size=-1>13129     </font></a><span class="string">run, [[ppmfrq]] can be used to define the second frequency to be used to</span>
<a name="13130"><font size=-1>13130     </font></a><span class="string">calculate the plasmon-pole parameters. This is particularly useful when the</span>
<a name="13131"><font size=-1>13131     </font></a><span class="string">SCR file contains several frequencies along the imaginary axis. In this case</span>
<a name="13132"><font size=-1>13132     </font></a><span class="string">the frequency whose value is the closest one to [[ppmfrq]] will be selected.</span>
<a name="13133"><font size=-1>13133     </font></a><span class="string">Note that, if the plasmon-pole approximation is good, then, the choice of</span>
<a name="13134"><font size=-1>13134     </font></a><span class="string">[[ppmfrq]] should have no influence on the final result. One should check</span>
<a name="13135"><font size=-1>13135     </font></a><span class="string">whether this is the case. In general, the plasmon frequencies of bulk solids</span>
<a name="13136"><font size=-1>13136     </font></a><span class="string">are of the order of 0.5 Hartree.</span>
<a name="13137"><font size=-1>13137     </font></a><span class="string"></span>
<a name="13138"><font size=-1>13138     </font></a><span class="string">**In Contour Deformation calculations**</span>
<a name="13139"><font size=-1>13139     </font></a><span class="string"></span>
<a name="13140"><font size=-1>13140     </font></a><span class="string">[[ppmfrq]] is here used to **override** the default value calculated from the</span>
<a name="13141"><font size=-1>13141     </font></a><span class="string">average electronic density per unit cell. This can affect the distribution of</span>
<a name="13142"><font size=-1>13142     </font></a><span class="string">gridpoints along the imaginary and real frequency axes. See</span>
<a name="13143"><font size=-1>13143     </font></a><span class="string">[[cd_frqim_method]], [[gw_frqim_inzgrid]] and [[gw_frqre_inzgrid]] for more</span>
<a name="13144"><font size=-1>13144     </font></a><span class="string">details.</span>
<a name="13145"><font size=-1>13145     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13146"><font size=-1>13146     </font></a><span class="default">),</span>
<a name="13147"><font size=-1>13147     </font></a><span class="default"></span>
<a name="13148"><font size=-1>13148     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13149"><font size=-1>13149     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ppmodel&quot;</span><span class="default">,</span>
<a name="13150"><font size=-1>13150     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="13151"><font size=-1>13151     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13152"><font size=-1>13152     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="13153"><font size=-1>13153     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13154"><font size=-1>13154     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="13155"><font size=-1>13155     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Plasmon Pole MODEL&quot;</span><span class="default">,</span>
<a name="13156"><font size=-1>13156     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4]&quot;</span><span class="default">,</span>
<a name="13157"><font size=-1>13157     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13158"><font size=-1>13158     </font></a><span class="string">  * [[ppmodel]] = 1: PP model of Godby and Needs [[cite:Godby1989]].</span>
<a name="13159"><font size=-1>13159     </font></a><span class="string">  * [[ppmodel]] = 2: PP model of Hybertsen and Louie [[cite:Hybertsen1986]].</span>
<a name="13160"><font size=-1>13160     </font></a><span class="string">  * [[ppmodel]] = 3: PP model of W. von der Linden and P. Horsh [[cite:vonderLinden1988]].</span>
<a name="13161"><font size=-1>13161     </font></a><span class="string">  * [[ppmodel]] = 4: PP model of Farid and Engel [[cite:Engel1993]].</span>
<a name="13162"><font size=-1>13162     </font></a><span class="string">  * [[ppmodel]] = 0: no PP model, numerical integration (contour deformation method [[cite:Lebegue2003]]).</span>
<a name="13163"><font size=-1>13163     </font></a><span class="string"></span>
<a name="13164"><font size=-1>13164     </font></a><span class="string">Please note the difference between [[ppmodel]] 1 and [[ppmodel]] 2,3,4. In the</span>
<a name="13165"><font size=-1>13165     </font></a><span class="string">first case ([[ppmodel]] = 1), the plasmon-pole parameters are determined in</span>
<a name="13166"><font size=-1>13166     </font></a><span class="string">order to reproduce the behaviour of the dielectric matrix at two calculated</span>
<a name="13167"><font size=-1>13167     </font></a><span class="string">frequencies: the static limit ($\omega=0$) and the imaginary frequency defined by</span>
<a name="13168"><font size=-1>13168     </font></a><span class="string">[[ppmfrq]]. In the last three cases, instead, the plasmon-pole parameters are</span>
<a name="13169"><font size=-1>13169     </font></a><span class="string">found by using the dielectric matrix calculated only at $\omega=0$ and enforcing</span>
<a name="13170"><font size=-1>13170     </font></a><span class="string">the so-called f-sum rule. See also [[nfreqre]].</span>
<a name="13171"><font size=-1>13171     </font></a><span class="string"></span>
<a name="13172"><font size=-1>13172     </font></a><span class="string">Please note also that in the case of [[ppmodel]] 4, the plasmon energies are</span>
<a name="13173"><font size=-1>13173     </font></a><span class="string">not simple mathematical parameters, but rather have a physical meaning (at</span>
<a name="13174"><font size=-1>13174     </font></a><span class="string">least the lowest ones). Thus the calculated plasmon band structure (plasmon</span>
<a name="13175"><font size=-1>13175     </font></a><span class="string">energy vs q vector) is reported in the output file for the lowest 10 bands.</span>
<a name="13176"><font size=-1>13176     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13177"><font size=-1>13177     </font></a><span class="default">),</span>
<a name="13178"><font size=-1>13178     </font></a><span class="default"></span>
<a name="13179"><font size=-1>13179     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13180"><font size=-1>13180     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prepanl&quot;</span><span class="default">,</span>
<a name="13181"><font size=-1>13181     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="13182"><font size=-1>13182     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13183"><font size=-1>13183     </font></a><span class="default">    topics=[</span><span class="string">'nonlinear_compulsory'</span><span class="default">],</span>
<a name="13184"><font size=-1>13184     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13185"><font size=-1>13185     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13186"><font size=-1>13186     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PREPAre Non-Linear response calculation&quot;</span><span class="default">,</span>
<a name="13187"><font size=-1>13187     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13188"><font size=-1>13188     </font></a><span class="string">The computation of third-order derivatives from the 2n+1 theorem requires the</span>
<a name="13189"><font size=-1>13189     </font></a><span class="string">first-order wavefunctions and densities obtained from a linear response</span>
<a name="13190"><font size=-1>13190     </font></a><span class="string">calculation. The standard approach in a linear response calculation is:</span>
<a name="13191"><font size=-1>13191     </font></a><span class="string"></span>
<a name="13192"><font size=-1>13192     </font></a><span class="string">  * compute only the irreducible perturbations;</span>
<a name="13193"><font size=-1>13193     </font></a><span class="string">  * use symmetries to reduce the number of k-points for the k-point integration.</span>
<a name="13194"><font size=-1>13194     </font></a><span class="string"></span>
<a name="13195"><font size=-1>13195     </font></a><span class="string">This approach cannot be applied, presently (v4.1), if the first-order</span>
<a name="13196"><font size=-1>13196     </font></a><span class="string">wavefunctions are to be used to compute third-order derivatives. First, for</span>
<a name="13197"><font size=-1>13197     </font></a><span class="string">electric fields, the code needs the derivatives along the three directions.</span>
<a name="13198"><font size=-1>13198     </font></a><span class="string">Still, in case of phonons, only the irreducible perturbations are required.</span>
<a name="13199"><font size=-1>13199     </font></a><span class="string">Second, for both electric fields and phonons, the wavefunctions must be</span>
<a name="13200"><font size=-1>13200     </font></a><span class="string">available in half the BZ (kptopt=2), or the full BZ (kptopt=3).</span>
<a name="13201"><font size=-1>13201     </font></a><span class="string">During the linear response calculation, in order to prepare a non-linear</span>
<a name="13202"><font size=-1>13202     </font></a><span class="string">calculation, one should put [[prepanl]] to 1 in order to force ABINIT to</span>
<a name="13203"><font size=-1>13203     </font></a><span class="string">compute the electric field perturbation along the three directions explicitly,</span>
<a name="13204"><font size=-1>13204     </font></a><span class="string">and to keep the full number of k-points.</span>
<a name="13205"><font size=-1>13205     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13206"><font size=-1>13206     </font></a><span class="default">),</span>
<a name="13207"><font size=-1>13207     </font></a><span class="default"></span>
<a name="13208"><font size=-1>13208     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13209"><font size=-1>13209     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prepgkk&quot;</span><span class="default">,</span>
<a name="13210"><font size=-1>13210     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="13211"><font size=-1>13211     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13212"><font size=-1>13212     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_compulsory'</span><span class="default">],</span>
<a name="13213"><font size=-1>13213     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13214"><font size=-1>13214     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13215"><font size=-1>13215     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PREPAre GKK calculation&quot;</span><span class="default">,</span>
<a name="13216"><font size=-1>13216     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13217"><font size=-1>13217     </font></a><span class="string">The calculation of electron-phonon coupling quantities requires the presence</span>
<a name="13218"><font size=-1>13218     </font></a><span class="string">of all the perturbations (all atoms in all directions) for the chosen set of</span>
<a name="13219"><font size=-1>13219     </font></a><span class="string">(irreducible) q-points. To impose this and prevent ABINIT from using symmetry</span>
<a name="13220"><font size=-1>13220     </font></a><span class="string">to reduce the number of perturbations, set [[prepgkk]] to 1. Use in</span>
<a name="13221"><font size=-1>13221     </font></a><span class="string">conjunction with [[prtgkk]].</span>
<a name="13222"><font size=-1>13222     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13223"><font size=-1>13223     </font></a><span class="default">),</span>
<a name="13224"><font size=-1>13224     </font></a><span class="default"></span>
<a name="13225"><font size=-1>13225     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13226"><font size=-1>13226     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prepscphon&quot;</span><span class="default">,</span>
<a name="13227"><font size=-1>13227     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="13228"><font size=-1>13228     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13229"><font size=-1>13229     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">],</span>
<a name="13230"><font size=-1>13230     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13231"><font size=-1>13231     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13232"><font size=-1>13232     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PREPare Self-Consistent PHONon calculation&quot;</span><span class="default">,</span>
<a name="13233"><font size=-1>13233     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="13234"><font size=-1>13234     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13235"><font size=-1>13235     </font></a><span class="string">Print PCINFO, PHFREQ, and PHVEC files, for use with self-consistent phonon</span>
<a name="13236"><font size=-1>13236     </font></a><span class="string">runs, after a perturbation calculation. Only prints out files for the present</span>
<a name="13237"><font size=-1>13237     </font></a><span class="string">q-point, and there is presently no tool to symmetrize or merge these files, so</span>
<a name="13238"><font size=-1>13238     </font></a><span class="string">use anaddb instead (with prtscphon input variable). The abinit input variable</span>
<a name="13239"><font size=-1>13239     </font></a><span class="string">is destined to someday bypass the use of anaddb for scphon calculations.</span>
<a name="13240"><font size=-1>13240     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13241"><font size=-1>13241     </font></a><span class="default">),</span>
<a name="13242"><font size=-1>13242     </font></a><span class="default"></span>
<a name="13243"><font size=-1>13243     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13244"><font size=-1>13244     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prt1dm&quot;</span><span class="default">,</span>
<a name="13245"><font size=-1>13245     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13246"><font size=-1>13246     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13247"><font size=-1>13247     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13248"><font size=-1>13248     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13249"><font size=-1>13249     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13250"><font size=-1>13250     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT 1-DiMensional potential and density&quot;</span><span class="default">,</span>
<a name="13251"><font size=-1>13251     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13252"><font size=-1>13252     </font></a><span class="string">If set &gt;= 1, provide one-dimensional projection of potential and density, for</span>
<a name="13253"><font size=-1>13253     </font></a><span class="string">each of the three axis. This corresponds to averaging the potential or the</span>
<a name="13254"><font size=-1>13254     </font></a><span class="string">density on bi-dimensional slices of the FFT grid.</span>
<a name="13255"><font size=-1>13255     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13256"><font size=-1>13256     </font></a><span class="default">),</span>
<a name="13257"><font size=-1>13257     </font></a><span class="default"></span>
<a name="13258"><font size=-1>13258     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13259"><font size=-1>13259     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtatlist&quot;</span><span class="default">,</span>
<a name="13260"><font size=-1>13260     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="13261"><font size=-1>13261     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13262"><font size=-1>13262     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgeo'</span><span class="default">, </span><span class="string">'Output_useful'</span><span class="default">],</span>
<a name="13263"><font size=-1>13263     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natom]]'</span><span class="default">],</span>
<a name="13264"><font size=-1>13264     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13265"><font size=-1>13265     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT by ATom LIST of ATom&quot;</span><span class="default">,</span>
<a name="13266"><font size=-1>13266     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="13267"><font size=-1>13267     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13268"><font size=-1>13268     </font></a><span class="string">This is an array of the numbers associated to the index atoms that the user</span>
<a name="13269"><font size=-1>13269     </font></a><span class="string">want to print in the output or log files, this is useful when you have a large</span>
<a name="13270"><font size=-1>13270     </font></a><span class="string">number of atoms and you are only interested to follow specific atoms, the</span>
<a name="13271"><font size=-1>13271     </font></a><span class="string">numbers associated should be consistent with the list in [[xcart]] or</span>
<a name="13272"><font size=-1>13272     </font></a><span class="string">[[xred]]. This input variable does not affect the contents of the &quot;OUT.nc&quot; or</span>
<a name="13273"><font size=-1>13273     </font></a><span class="string">&quot;HIST.nc&quot;, those are NetCDF files containing the information about all the atoms.</span>
<a name="13274"><font size=-1>13274     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13275"><font size=-1>13275     </font></a><span class="default">),</span>
<a name="13276"><font size=-1>13276     </font></a><span class="default"></span>
<a name="13277"><font size=-1>13277     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13278"><font size=-1>13278     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtbbb&quot;</span><span class="default">,</span>
<a name="13279"><font size=-1>13279     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="13280"><font size=-1>13280     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13281"><font size=-1>13281     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">, </span><span class="string">'Output_useful'</span><span class="default">],</span>
<a name="13282"><font size=-1>13282     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13283"><font size=-1>13283     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13284"><font size=-1>13284     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Band-By-Band decomposition&quot;</span><span class="default">,</span>
<a name="13285"><font size=-1>13285     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13286"><font size=-1>13286     </font></a><span class="string">If [[prtbbb]] is 1, print the band-by-band decomposition of Born effective</span>
<a name="13287"><font size=-1>13287     </font></a><span class="string">charges and localization tensor, in case they are computed. See [[cite:Ghosez2000]].</span>
<a name="13288"><font size=-1>13288     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13289"><font size=-1>13289     </font></a><span class="default">),</span>
<a name="13290"><font size=-1>13290     </font></a><span class="default"></span>
<a name="13291"><font size=-1>13291     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13292"><font size=-1>13292     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtbltztrp&quot;</span><span class="default">,</span>
<a name="13293"><font size=-1>13293     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="13294"><font size=-1>13294     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13295"><font size=-1>13295     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13296"><font size=-1>13296     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13297"><font size=-1>13297     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13298"><font size=-1>13298     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT output for BoLTZTRaP code&quot;</span><span class="default">,</span>
<a name="13299"><font size=-1>13299     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="13300"><font size=-1>13300     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13301"><font size=-1>13301     </font></a><span class="string">Print out geometry _BLZTRP_GEOM and eigenenergy _BLZTRP_EIGEN files for</span>
<a name="13302"><font size=-1>13302     </font></a><span class="string">the [BoltzTraP code](https://www.imc.tuwien.ac.at/forschungsbereich_theoretische_chemie/forschungsgruppen/prof_dr_gkh_madsen_theoretical_materials_chemistry/boltztrap/) by Georg Madsen.</span>
<a name="13303"><font size=-1>13303     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13304"><font size=-1>13304     </font></a><span class="default">),</span>
<a name="13305"><font size=-1>13305     </font></a><span class="default"></span>
<a name="13306"><font size=-1>13306     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13307"><font size=-1>13307     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtcif&quot;</span><span class="default">,</span>
<a name="13308"><font size=-1>13308     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="13309"><font size=-1>13309     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13310"><font size=-1>13310     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgeo'</span><span class="default">],</span>
<a name="13311"><font size=-1>13311     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13312"><font size=-1>13312     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13313"><font size=-1>13313     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Crystallographic Information File&quot;</span><span class="default">,</span>
<a name="13314"><font size=-1>13314     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="13315"><font size=-1>13315     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13316"><font size=-1>13316     </font></a><span class="string">If set to 1, a CIF file is output with the crystallographic data for the</span>
<a name="13317"><font size=-1>13317     </font></a><span class="string">present run (cell size shape and atomic positions).</span>
<a name="13318"><font size=-1>13318     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13319"><font size=-1>13319     </font></a><span class="default">),</span>
<a name="13320"><font size=-1>13320     </font></a><span class="default"></span>
<a name="13321"><font size=-1>13321     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13322"><font size=-1>13322     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtden&quot;</span><span class="default">,</span>
<a name="13323"><font size=-1>13323     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13324"><font size=-1>13324     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13325"><font size=-1>13325     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="13326"><font size=-1>13326     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13327"><font size=-1>13327     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nimage]] &gt; 1'</span><span class="default">: </span><span class="number">0</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="13328"><font size=-1>13328     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the DENsity&quot;</span><span class="default">,</span>
<a name="13329"><font size=-1>13329     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13330"><font size=-1>13330     </font></a><span class="string">If set to 1 or a larger value, provide output of electron density in real</span>
<a name="13331"><font size=-1>13331     </font></a><span class="string">space rho(r), in units of electrons/Bohr^3.</span>
<a name="13332"><font size=-1>13332     </font></a><span class="string">If [[ionmov]] == 0, the name of the density file will be the root output name,</span>
<a name="13333"><font size=-1>13333     </font></a><span class="string">followed by _DEN.</span>
<a name="13334"><font size=-1>13334     </font></a><span class="string">If [[ionmov]] == 1 or 2, density files will be output at each time step, with</span>
<a name="13335"><font size=-1>13335     </font></a><span class="string">the name being made of</span>
<a name="13336"><font size=-1>13336     </font></a><span class="string"></span>
<a name="13337"><font size=-1>13337     </font></a><span class="string">  * the root output name,</span>
<a name="13338"><font size=-1>13338     </font></a><span class="string">  * followed by _TIMx, where x is related to the time step (see later)</span>
<a name="13339"><font size=-1>13339     </font></a><span class="string">  * then followed by _DEN</span>
<a name="13340"><font size=-1>13340     </font></a><span class="string"></span>
<a name="13341"><font size=-1>13341     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#denfile|this section]].</span>
<a name="13342"><font size=-1>13342     </font></a><span class="string">If [[prtden]] is lower than 0, two files will be printed for restart every</span>
<a name="13343"><font size=-1>13343     </font></a><span class="string">[[prtden]] step, with the names being made of</span>
<a name="13344"><font size=-1>13344     </font></a><span class="string"></span>
<a name="13345"><font size=-1>13345     </font></a><span class="string">  * the root temporary name,</span>
<a name="13346"><font size=-1>13346     </font></a><span class="string">  * followed by _DEN_x, where x is 0000 or 0001 alternatively.</span>
<a name="13347"><font size=-1>13347     </font></a><span class="string">  * The most recent of the two files should be used for restart, and copied to root input name_DS2_DEN</span>
<a name="13348"><font size=-1>13348     </font></a><span class="string">  * To perform a restart, in a multidataset mode, use ndtset 2 and jdtset 2 3 (that is 2 datasets, numbered 2 and 3)</span>
<a name="13349"><font size=-1>13349     </font></a><span class="string">  * In the dataset 2, get the density you just copied (getden2 -1), perform a non self-consistent calculation and print the wave function (prtwf2 1)</span>
<a name="13350"><font size=-1>13350     </font></a><span class="string">  * In the dataset 3, get the previous wf(getwfk3 -1), and continue the calculation</span>
<a name="13351"><font size=-1>13351     </font></a><span class="string">  * This complicated procedure is due to the fact that reading the density is only allowed for a non sc calculation, and also for a dataset different of 0 or the previous one, the option we choose here.</span>
<a name="13352"><font size=-1>13352     </font></a><span class="string"></span>
<a name="13353"><font size=-1>13353     </font></a><span class="string">Please note that in the case of PAW ([[usepaw]] = 1) calculations, the _DEN</span>
<a name="13354"><font size=-1>13354     </font></a><span class="string">density output is not the full physical electron density. If what is wanted is</span>
<a name="13355"><font size=-1>13355     </font></a><span class="string">the full physical electron density, say for post-processing with [[help:aim|AIM]]</span>
<a name="13356"><font size=-1>13356     </font></a><span class="string">or visualization, prtden &gt; 1 will produce physical electron density or other interesting quantities (see below).</span>
<a name="13357"><font size=-1>13357     </font></a><span class="string">Nevertheless, even in the PAW case, when chaining together calculations where</span>
<a name="13358"><font size=-1>13358     </font></a><span class="string">the density from one calculation is to be used in a subsequent calculation, it</span>
<a name="13359"><font size=-1>13359     </font></a><span class="string">is necessary to use the _DEN files and **not** one of the other files produced</span>
<a name="13360"><font size=-1>13360     </font></a><span class="string">with prtden  &gt; 1, i.e. _PAWDEN, ATMDEN_xxx or else. Note that the usual _DEN</span>
<a name="13361"><font size=-1>13361     </font></a><span class="string">file is always generated as soon as prtden &gt;= 1. Options 2 to 6 for prtden are</span>
<a name="13362"><font size=-1>13362     </font></a><span class="string">relevant only for [[usepaw]] = 1 and control the output of the full electron</span>
<a name="13363"><font size=-1>13363     </font></a><span class="string">density in the PAW case:</span>
<a name="13364"><font size=-1>13364     </font></a><span class="string"></span>
<a name="13365"><font size=-1>13365     </font></a><span class="string"></span>
<a name="13366"><font size=-1>13366     </font></a><span class="string">**prtden=2** causes generation of a file _PAWDEN that contains the bulk</span>
<a name="13367"><font size=-1>13367     </font></a><span class="string">**valence** charge density together with the PAW on-site contributions, and</span>
<a name="13368"><font size=-1>13368     </font></a><span class="string">has the same format as the other density files.</span>
<a name="13369"><font size=-1>13369     </font></a><span class="string">**prtden=3** causes generation of a file _PAWDEN that contains the bulk</span>
<a name="13370"><font size=-1>13370     </font></a><span class="string">**full** charge density (valence+core)</span>
<a name="13371"><font size=-1>13371     </font></a><span class="string">**prtden=4** causes generation of three files _ATMDEN_CORE, _ATMDEN_VAL and</span>
<a name="13372"><font size=-1>13372     </font></a><span class="string">_ATMDEN_FULL which respectively contain the core, valence and full atomic</span>
<a name="13373"><font size=-1>13373     </font></a><span class="string">protodensity (the density of the individual component atoms in vacuum</span>
<a name="13374"><font size=-1>13374     </font></a><span class="string">superposed at the bulk atomic positions). This can be used to generate various</span>
<a name="13375"><font size=-1>13375     </font></a><span class="string">visualizations of the bonding density.</span>
<a name="13376"><font size=-1>13376     </font></a><span class="string">**prtden=5** options 2 and 4 taken together.</span>
<a name="13377"><font size=-1>13377     </font></a><span class="string">**prtden=6** options 3 and 4 taken together.</span>
<a name="13378"><font size=-1>13378     </font></a><span class="string">**prtden=7** causes the generation of all the individual contributions to the</span>
<a name="13379"><font size=-1>13379     </font></a><span class="string">bulk **valence** charge density: n_tilde-n_hat (_N_TILDE), n_onsite (_N_ONE)</span>
<a name="13380"><font size=-1>13380     </font></a><span class="string">and n_tilde_onsite (_NT_ONE). This is for diagnosis purposes only.</span>
<a name="13381"><font size=-1>13381     </font></a><span class="string"></span>
<a name="13382"><font size=-1>13382     </font></a><span class="string">Options 3 to 6 currently require the user to supply the atomic core and</span>
<a name="13383"><font size=-1>13383     </font></a><span class="string">valence density in external files in the working directory. The files must be</span>
<a name="13384"><font size=-1>13384     </font></a><span class="string">named properly; for example, the files for an atom of type 1 should be named:</span>
<a name="13385"><font size=-1>13385     </font></a><span class="string">&quot;core_density_atom_type1.dat&quot; and &quot;valence_density_atom_type1.dat&quot;. The file</span>
<a name="13386"><font size=-1>13386     </font></a><span class="string">should be a text file, where the first line is assumed to be a comment, and</span>
<a name="13387"><font size=-1>13387     </font></a><span class="string">the subsequent lines contain two values each, where the first one is a radial</span>
<a name="13388"><font size=-1>13388     </font></a><span class="string">coordinate and the second the value of the density n(r). Please note that it</span>
<a name="13389"><font size=-1>13389     </font></a><span class="string">is n(r) which should be supplied, **not** n(r)/r^2. The first coordinate point</span>
<a name="13390"><font size=-1>13390     </font></a><span class="string">must be the origin, i.e. **_r = 0_ **. The atomic densities are spherically</span>
<a name="13391"><font size=-1>13391     </font></a><span class="string">averaged, so assumed to be completely spherically symmetric, even for open</span>
<a name="13392"><font size=-1>13392     </font></a><span class="string">shells.</span>
<a name="13393"><font size=-1>13393     </font></a><span class="string"></span>
<a name="13394"><font size=-1>13394     </font></a><span class="string">NOTE: in the PAW case, **DO NOT** use _PAWDEN or _ATMDEN_xxx files produced by</span>
<a name="13395"><font size=-1>13395     </font></a><span class="string">prtden  &gt; 1 to chain the density output from one calculation as the input to</span>
<a name="13396"><font size=-1>13396     </font></a><span class="string">another, use the _DEN file for that.</span>
<a name="13397"><font size=-1>13397     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13398"><font size=-1>13398     </font></a><span class="default">),</span>
<a name="13399"><font size=-1>13399     </font></a><span class="default"></span>
<a name="13400"><font size=-1>13400     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13401"><font size=-1>13401     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtdensph&quot;</span><span class="default">,</span>
<a name="13402"><font size=-1>13402     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="13403"><font size=-1>13403     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13404"><font size=-1>13404     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="13405"><font size=-1>13405     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13406"><font size=-1>13406     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="13407"><font size=-1>13407     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT integral of DENsity inside atomic SPHeres&quot;</span><span class="default">,</span>
<a name="13408"><font size=-1>13408     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13409"><font size=-1>13409     </font></a><span class="string">When this flag is activated, values of integral(s) of total density inside</span>
<a name="13410"><font size=-1>13410     </font></a><span class="string">sphere(s) around each atom are printed in output file (for each spin</span>
<a name="13411"><font size=-1>13411     </font></a><span class="string">component). Spheres around atoms are defined by a radius given by [[ratsph]] keyword.</span>
<a name="13412"><font size=-1>13412     </font></a><span class="string">Note: integral of density inside a sphere around an atom can be used to</span>
<a name="13413"><font size=-1>13413     </font></a><span class="string">determine a rough approximation of the local magnetic moment; this is</span>
<a name="13414"><font size=-1>13414     </font></a><span class="string">particularly useful for antiferromagnetic systems.</span>
<a name="13415"><font size=-1>13415     </font></a><span class="string">The algorithm to compute this integral is particularly primitive: the points</span>
<a name="13416"><font size=-1>13416     </font></a><span class="string">on the FFT grids, belonging to the interior of the sphere are determined, and</span>
<a name="13417"><font size=-1>13417     </font></a><span class="string">the value of the functions on these points are summed, taking into account a</span>
<a name="13418"><font size=-1>13418     </font></a><span class="string">fixed volume attributed to each point. In particular, the integral as a</span>
<a name="13419"><font size=-1>13419     </font></a><span class="string">function of the radius will be a constant, except when a new point enters the</span>
<a name="13420"><font size=-1>13420     </font></a><span class="string">sphere, in which case a sudden jump occurs. However, since the purpose of this</span>
<a name="13421"><font size=-1>13421     </font></a><span class="string">output is to get a rough idea of the repartition of the density, this is not a</span>
<a name="13422"><font size=-1>13422     </font></a><span class="string">real problem. If you are interested in a more accurate estimation of the</span>
<a name="13423"><font size=-1>13423     </font></a><span class="string">density within a sphere, you should use the cut3d postprocessor ([[help:cut3d]]).</span>
<a name="13424"><font size=-1>13424     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13425"><font size=-1>13425     </font></a><span class="default">),</span>
<a name="13426"><font size=-1>13426     </font></a><span class="default"></span>
<a name="13427"><font size=-1>13427     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13428"><font size=-1>13428     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtdipole&quot;</span><span class="default">,</span>
<a name="13429"><font size=-1>13429     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="13430"><font size=-1>13430     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13431"><font size=-1>13431     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13432"><font size=-1>13432     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13433"><font size=-1>13433     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13434"><font size=-1>13434     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT DIPOLE&quot;</span><span class="default">,</span>
<a name="13435"><font size=-1>13435     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="13436"><font size=-1>13436     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13437"><font size=-1>13437     </font></a><span class="string">Print out dipole of unit cell, calculated in real space for the primitive cell</span>
<a name="13438"><font size=-1>13438     </font></a><span class="string">only. Under development.</span>
<a name="13439"><font size=-1>13439     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13440"><font size=-1>13440     </font></a><span class="default">),</span>
<a name="13441"><font size=-1>13441     </font></a><span class="default"></span>
<a name="13442"><font size=-1>13442     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13443"><font size=-1>13443     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtdos&quot;</span><span class="default">,</span>
<a name="13444"><font size=-1>13444     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13445"><font size=-1>13445     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13446"><font size=-1>13446     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">, </span><span class="string">'ElecDOS_basic'</span><span class="default">],</span>
<a name="13447"><font size=-1>13447     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13448"><font size=-1>13448     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13449"><font size=-1>13449     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the Density Of States&quot;</span><span class="default">,</span>
<a name="13450"><font size=-1>13450     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13451"><font size=-1>13451     </font></a><span class="string">Provide output of Density of States if set to 1, 2 or 3. Can either use a</span>
<a name="13452"><font size=-1>13452     </font></a><span class="string">smearing technique ([[prtdos]] = 1), or the tetrahedron method ([[prtdos]] = 2).</span>
<a name="13453"><font size=-1>13453     </font></a><span class="string">If [[prtdos]] = 3, provide output of Local Density of States inside a sphere</span>
<a name="13454"><font size=-1>13454     </font></a><span class="string">centered on an atom, as well as the angular-momentum projected DOS, in the</span>
<a name="13455"><font size=-1>13455     </font></a><span class="string">same sphere. The resolution of the linear grid of energies for which the DOS</span>
<a name="13456"><font size=-1>13456     </font></a><span class="string">is computed can be tuned thanks to [[dosdeltae]].</span>
<a name="13457"><font size=-1>13457     </font></a><span class="string"></span>
<a name="13458"><font size=-1>13458     </font></a><span class="string">If [[prtdos]] = 1, the smeared density of states is obtained from the</span>
<a name="13459"><font size=-1>13459     </font></a><span class="string">eigenvalues, properly weighted at each k point using [[wtk]], and smeared</span>
<a name="13460"><font size=-1>13460     </font></a><span class="string">according to [[occopt]] and [[tsmear]]. All levels that are present in the</span>
<a name="13461"><font size=-1>13461     </font></a><span class="string">calculation are taken into account (occupied and unoccupied). Note that</span>
<a name="13462"><font size=-1>13462     </font></a><span class="string">[[occopt]] must be between 3 and 7. Also note that the sampling of the</span>
<a name="13463"><font size=-1>13463     </font></a><span class="string">Brillouin Zone that is needed to get a converged DOS is usually much finer</span>
<a name="13464"><font size=-1>13464     </font></a><span class="string">than the sampling needed to converge the total energy or the geometry of the</span>
<a name="13465"><font size=-1>13465     </font></a><span class="string">system, unless [[tsmear]] is very large (hence the DOS is not obtained</span>
<a name="13466"><font size=-1>13466     </font></a><span class="string">properly).. A separate convergence study is needed.</span>
<a name="13467"><font size=-1>13467     </font></a><span class="string">In order to compute the DOS of an insulator with [[prtdos]] = 1, compute its</span>
<a name="13468"><font size=-1>13468     </font></a><span class="string">density thanks to a self-consistent calculation (with a non-metallic</span>
<a name="13469"><font size=-1>13469     </font></a><span class="string">[[occopt]] value, 0, 1 or 2), then use [[prtdos]] = 1, together with</span>
<a name="13470"><font size=-1>13470     </font></a><span class="string">[[iscf]] = -3, and a metallic [[occopt]], between 3 and 7, providing the needed</span>
<a name="13471"><font size=-1>13471     </font></a><span class="string">smearing. If [[prtdos]] = 1, the name of the DOS file is the root name for the</span>
<a name="13472"><font size=-1>13472     </font></a><span class="string">output files, followed by &quot;_DOS&quot;.</span>
<a name="13473"><font size=-1>13473     </font></a><span class="string"></span>
<a name="13474"><font size=-1>13474     </font></a><span class="string">If [[prtdos]] = 2, the DOS is computed using the tetrahedron method. As in the</span>
<a name="13475"><font size=-1>13475     </font></a><span class="string">case of [[prtdos]] = 1, all levels that are present in the calculation are taken</span>
<a name="13476"><font size=-1>13476     </font></a><span class="string">into account (occupied and unoccupied). In this case, the k-points must have</span>
<a name="13477"><font size=-1>13477     </font></a><span class="string">been defined using the input variable [[ngkpt]] or the input variable</span>
<a name="13478"><font size=-1>13478     </font></a><span class="string">[[kptrlatt]]. There must be at least two non-equivalent points in the</span>
<a name="13479"><font size=-1>13479     </font></a><span class="string">Irreducible Brillouin Zone to use [[prtdos]] = 2. It is strongly advised to use</span>
<a name="13480"><font size=-1>13480     </font></a><span class="string">a non-shifted k-point grid ([[shiftk]] 0 0 0): such grids contain naturally</span>
<a name="13481"><font size=-1>13481     </font></a><span class="string">more extremal points (band minima and maxima at Gamma or at the zone-</span>
<a name="13482"><font size=-1>13482     </font></a><span class="string">boundaries) than shifted grids, and lead to more non-equivalent points than</span>
<a name="13483"><font size=-1>13483     </font></a><span class="string">shifted grids, for the same grid spacing. There is no need to take care of the</span>
<a name="13484"><font size=-1>13484     </font></a><span class="string">[[occopt]] or [[tsmear]] input variables, and there is no subtlety to be taken</span>
<a name="13485"><font size=-1>13485     </font></a><span class="string">into account for insulators. The computation can be done in the self-</span>
<a name="13486"><font size=-1>13486     </font></a><span class="string">consistent case as well as in the non-self-consistent case, using [[iscf]] = -3.</span>
<a name="13487"><font size=-1>13487     </font></a><span class="string">This allows one to refine the DOS at fixed starting density.</span>
<a name="13488"><font size=-1>13488     </font></a><span class="string">In that case, if [[ionmov]] == 0, the name of the potential file will be the</span>
<a name="13489"><font size=-1>13489     </font></a><span class="string">root output name, followed by _DOS (like in the [[prtdos]] = 1 case).</span>
<a name="13490"><font size=-1>13490     </font></a><span class="string">However, if [[ionmov]] == 1 or 2, potential files will be output at each time</span>
<a name="13491"><font size=-1>13491     </font></a><span class="string">step, with the name being made of</span>
<a name="13492"><font size=-1>13492     </font></a><span class="string"></span>
<a name="13493"><font size=-1>13493     </font></a><span class="string">  * the root output name,</span>
<a name="13494"><font size=-1>13494     </font></a><span class="string">  * followed by _TIMx, where x is related to the time step (see later)</span>
<a name="13495"><font size=-1>13495     </font></a><span class="string">  * then followed by _DOS.</span>
<a name="13496"><font size=-1>13496     </font></a><span class="string"></span>
<a name="13497"><font size=-1>13497     </font></a><span class="string">If [[prtdos]] = 3, the same tetrahedron method as for [[prtdos]] = 2 is used, but</span>
<a name="13498"><font size=-1>13498     </font></a><span class="string">the DOS inside a sphere centered on some atom is delivered, as well as the</span>
<a name="13499"><font size=-1>13499     </font></a><span class="string">angular-momentum projected (l=0,1,2,3,4) DOS in the same sphere. The</span>
<a name="13500"><font size=-1>13500     </font></a><span class="string">preparation of this case, the parameters under which the computation is to be</span>
<a name="13501"><font size=-1>13501     </font></a><span class="string">done, and the file denomination is similar to the [[prtdos]] = 2 case. However,</span>
<a name="13502"><font size=-1>13502     </font></a><span class="string">three additional input variables might be provided, describing the atoms that</span>
<a name="13503"><font size=-1>13503     </font></a><span class="string">are the center of the sphere (input variables [[natsph]] and [[iatsph]]), as</span>
<a name="13504"><font size=-1>13504     </font></a><span class="string">well as the radius of this sphere (input variable [[ratsph]]).</span>
<a name="13505"><font size=-1>13505     </font></a><span class="string">In case of PAW, [[ratsph]] radius has to be greater or equal to largest PAW</span>
<a name="13506"><font size=-1>13506     </font></a><span class="string">radius of the atom types considered (which is read from the PAW atomic data</span>
<a name="13507"><font size=-1>13507     </font></a><span class="string">file; see rc_sph or r_paw). Additional printing and/or approximations in PAW</span>
<a name="13508"><font size=-1>13508     </font></a><span class="string">mode can be controlled with [[pawprtdos]] keyword (in</span>
<a name="13509"><font size=-1>13509     </font></a><span class="string">particular,[[pawprtdos]] = 2 can be used to compute quickly a very good</span>
<a name="13510"><font size=-1>13510     </font></a><span class="string">approximation of the DOS).</span>
<a name="13511"><font size=-1>13511     </font></a><span class="string"></span>
<a name="13512"><font size=-1>13512     </font></a><span class="string">Note 1: when [[prtdos]] = 3, it is possible to output m-decomposed LDOS in _DOS</span>
<a name="13513"><font size=-1>13513     </font></a><span class="string">file; simply use [[prtdosm]] keyword.</span>
<a name="13514"><font size=-1>13514     </font></a><span class="string">Note 2: the integrated total DOS in spheres around atoms can be obtained when</span>
<a name="13515"><font size=-1>13515     </font></a><span class="string">[[prtdensph]] flag is activated. It can be compared to the integrated DOS</span>
<a name="13516"><font size=-1>13516     </font></a><span class="string">provided in _DOS file when [[prtdos]] = 3.</span>
<a name="13517"><font size=-1>13517     </font></a><span class="string"></span>
<a name="13518"><font size=-1>13518     </font></a><span class="string">[[prtdos]] = 4 delivers the sphere-projected DOS (like [[prtdos]] = 3), on the</span>
<a name="13519"><font size=-1>13519     </font></a><span class="string">basis of a smearing approach (like [[prtdos]] = 1)</span>
<a name="13520"><font size=-1>13520     </font></a><span class="string"></span>
<a name="13521"><font size=-1>13521     </font></a><span class="string">[[prtdos]] = 5 delivers the spin-spin DOS in the [[nspinor]] == 2 case, using the</span>
<a name="13522"><font size=-1>13522     </font></a><span class="string">tetrahedron method (as [[prtdos]] = 2).</span>
<a name="13523"><font size=-1>13523     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13524"><font size=-1>13524     </font></a><span class="default">),</span>
<a name="13525"><font size=-1>13525     </font></a><span class="default"></span>
<a name="13526"><font size=-1>13526     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13527"><font size=-1>13527     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtdosm&quot;</span><span class="default">,</span>
<a name="13528"><font size=-1>13528     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13529"><font size=-1>13529     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13530"><font size=-1>13530     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">, </span><span class="string">'ElecDOS_basic'</span><span class="default">],</span>
<a name="13531"><font size=-1>13531     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13532"><font size=-1>13532     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13533"><font size=-1>13533     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the Density Of States with M decomposition&quot;</span><span class="default">,</span>
<a name="13534"><font size=-1>13534     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13535"><font size=-1>13535     </font></a><span class="string">Relevant only when [[prtdos]] = 3.</span>
<a name="13536"><font size=-1>13536     </font></a><span class="string">If set to 1, the m-decomposed LDOS is delivered in DOS file.</span>
<a name="13537"><font size=-1>13537     </font></a><span class="string">Note that [[prtdosm]] computes the M-resolved partial dos for complex</span>
<a name="13538"><font size=-1>13538     </font></a><span class="string">spherical harmonics,giving e.g. DOS(L,M) == DOS(L,-M) (without spin-orbit). In</span>
<a name="13539"><font size=-1>13539     </font></a><span class="string">the contrary, the LDA+U occupation matrix, see [[dmatpawu]] is in the real</span>
<a name="13540"><font size=-1>13540     </font></a><span class="string">spherical harmonics basis.</span>
<a name="13541"><font size=-1>13541     </font></a><span class="string">If set to 2, the m-decomposed LDOS is delivered in DOS file.</span>
<a name="13542"><font size=-1>13542     </font></a><span class="string">In this case, [[prtdosm]] computes the M-resolved partial dos for real</span>
<a name="13543"><font size=-1>13543     </font></a><span class="string">spherical harmonics in the same basis as the LDA+U occupation matrix.</span>
<a name="13544"><font size=-1>13544     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13545"><font size=-1>13545     </font></a><span class="default">),</span>
<a name="13546"><font size=-1>13546     </font></a><span class="default"></span>
<a name="13547"><font size=-1>13547     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13548"><font size=-1>13548     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtebands&quot;</span><span class="default">,</span>
<a name="13549"><font size=-1>13549     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="13550"><font size=-1>13550     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13551"><font size=-1>13551     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="13552"><font size=-1>13552     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13553"><font size=-1>13553     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nimage]] &gt; 1'</span><span class="default">: </span><span class="number">0</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="13554"><font size=-1>13554     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Electron BANDS&quot;</span><span class="default">,</span>
<a name="13555"><font size=-1>13555     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13556"><font size=-1>13556     </font></a><span class="string">This option activates the output of the electron eigenvalues. Possible values:</span>
<a name="13557"><font size=-1>13557     </font></a><span class="string"></span>
<a name="13558"><font size=-1>13558     </font></a><span class="string">  * 0- Disable the output of the band energies.</span>
<a name="13559"><font size=-1>13559     </font></a><span class="string">  * 1- Write eigenvalues in xmgrace format. A file with extension `EBANDS.agr` is produced at the end of the run.</span>
<a name="13560"><font size=-1>13560     </font></a><span class="string">    Use `xmgrace file_EBANDS.agr` to visualize the band energies</span>
<a name="13561"><font size=-1>13561     </font></a><span class="string">  * 2- Write eigenvalues in gnuplot format. The code produces a `EBANDS.dat` file with the eigenvalues</span>
<a name="13562"><font size=-1>13562     </font></a><span class="string">    and a `EBANDS.gnuplot` script. Use `gnuplot file_EBANDS.gnuplot` to visualize the band energies.</span>
<a name="13563"><font size=-1>13563     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13564"><font size=-1>13564     </font></a><span class="default">),</span>
<a name="13565"><font size=-1>13565     </font></a><span class="default"></span>
<a name="13566"><font size=-1>13566     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13567"><font size=-1>13567     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtefg&quot;</span><span class="default">,</span>
<a name="13568"><font size=-1>13568     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="13569"><font size=-1>13569     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13570"><font size=-1>13570     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">, </span><span class="string">'EFG_basic'</span><span class="default">],</span>
<a name="13571"><font size=-1>13571     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13572"><font size=-1>13572     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13573"><font size=-1>13573     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRint Electric Field Gradient&quot;</span><span class="default">,</span>
<a name="13574"><font size=-1>13574     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1, [[quadmom]]&quot;</span><span class="default">,</span>
<a name="13575"><font size=-1>13575     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13576"><font size=-1>13576     </font></a><span class="string">  * If nonzero, calculate the electric field gradient at each atomic site in the unit cell. Using this option requires [[quadmom]] to be set as well. Values will be written to main output file (search for Electric Field Gradient). If prtefg=1, only the quadrupole coupling in MHz and asymmetry are reported. If prtefg=2, the full electric field gradient tensors in atomic units are also given, showing separate contributions from the valence electrons, the ion cores, and the PAW reconstruction. If prtefg=3, then in addition to the prtefg=2 output, the EFGs are computed using an ionic point charge model. This is useful for comparing the accurate PAW-based results to those of simple ion-only models. Use of prtefg=3 requires that the variable [[ptcharge]] be set as well.</span>
<a name="13577"><font size=-1>13577     </font></a><span class="string">The option prtefg is compatible with spin polarized calculations (see</span>
<a name="13578"><font size=-1>13578     </font></a><span class="string">[[nspden]]) and also LDA+U (see [[usepawu]]).</span>
<a name="13579"><font size=-1>13579     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13580"><font size=-1>13580     </font></a><span class="default">),</span>
<a name="13581"><font size=-1>13581     </font></a><span class="default"></span>
<a name="13582"><font size=-1>13582     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13583"><font size=-1>13583     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtefmas&quot;</span><span class="default">,</span>
<a name="13584"><font size=-1>13584     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="13585"><font size=-1>13585     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13586"><font size=-1>13586     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">, </span><span class="string">'EffectiveMass_useful'</span><span class="default">],</span>
<a name="13587"><font size=-1>13587     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13588"><font size=-1>13588     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13589"><font size=-1>13589     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRint EFfective MASs data&quot;</span><span class="default">,</span>
<a name="13590"><font size=-1>13590     </font></a><span class="default">    requires=</span><span class="string">&quot;[[efmas]] == 1&quot;</span><span class="default">,</span>
<a name="13591"><font size=-1>13591     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13592"><font size=-1>13592     </font></a><span class="string">  * If 1, at the end of an effective mass calculation ([[efmas]] = 1), create a file *_EFMAS, that contains the generalized second-order k-derivatives, see Eq.(66) in [[cite:Laflamme2016]], in view of further processing.</span>
<a name="13593"><font size=-1>13593     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13594"><font size=-1>13594     </font></a><span class="default">),</span>
<a name="13595"><font size=-1>13595     </font></a><span class="default"></span>
<a name="13596"><font size=-1>13596     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13597"><font size=-1>13597     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prteig&quot;</span><span class="default">,</span>
<a name="13598"><font size=-1>13598     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13599"><font size=-1>13599     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13600"><font size=-1>13600     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="13601"><font size=-1>13601     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13602"><font size=-1>13602     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nimage]] &gt; 1'</span><span class="default">: </span><span class="number">0</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="13603"><font size=-1>13603     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT EIGenenergies&quot;</span><span class="default">,</span>
<a name="13604"><font size=-1>13604     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13605"><font size=-1>13605     </font></a><span class="string">If set to 1, a file *_EIG, containing the k-points and one-electron eigenvalues is printed.</span>
<a name="13606"><font size=-1>13606     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13607"><font size=-1>13607     </font></a><span class="default">),</span>
<a name="13608"><font size=-1>13608     </font></a><span class="default"></span>
<a name="13609"><font size=-1>13609     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13610"><font size=-1>13610     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtelf&quot;</span><span class="default">,</span>
<a name="13611"><font size=-1>13611     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13612"><font size=-1>13612     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13613"><font size=-1>13613     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13614"><font size=-1>13614     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13615"><font size=-1>13615     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13616"><font size=-1>13616     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Electron Localization Function (ELF)&quot;</span><span class="default">,</span>
<a name="13617"><font size=-1>13617     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13618"><font size=-1>13618     </font></a><span class="string">If set to 1 or a larger value, provide output of ELF in real space elf(r).</span>
<a name="13619"><font size=-1>13619     </font></a><span class="string">This is a dimensionless quantity bounded between 0 and 1.</span>
<a name="13620"><font size=-1>13620     </font></a><span class="string">The name of the ELF file will be the root output name, followed by _ELF.</span>
<a name="13621"><font size=-1>13621     </font></a><span class="string">Like a _DEN file, it can be analyzed by cut3d. However unlike densities, in</span>
<a name="13622"><font size=-1>13622     </font></a><span class="string">case of spin polarized calculations, the spin down component can not be</span>
<a name="13623"><font size=-1>13623     </font></a><span class="string">obtained by subtracting the spin up component to the total ELF. Hence when</span>
<a name="13624"><font size=-1>13624     </font></a><span class="string">spin polarized calculations are performed the code produces also output files</span>
<a name="13625"><font size=-1>13625     </font></a><span class="string">with _ELF_UP and _ELF_DOWN extensions. (For technical reasons these files</span>
<a name="13626"><font size=-1>13626     </font></a><span class="string">contain also two components but the second is zero. So to perform analysis of</span>
<a name="13627"><font size=-1>13627     </font></a><span class="string">_ELF_UP and _ELF_DOWN files with cut3d you have to answer &quot;ispden= 0 --&gt; Total</span>
<a name="13628"><font size=-1>13628     </font></a><span class="string">density&quot; when cut3d ask you which ispden to choose. Also remember that spin</span>
<a name="13629"><font size=-1>13629     </font></a><span class="string">down component can not be obtained by using cut3d on the _ELF file. Sorry for</span>
<a name="13630"><font size=-1>13630     </font></a><span class="string">the inconvenience, this will be fixed in the next release.)</span>
<a name="13631"><font size=-1>13631     </font></a><span class="string">ELF is not yet implemented in non collinear spin case.</span>
<a name="13632"><font size=-1>13632     </font></a><span class="string">If prtelf is set to 2, in the case of spin polarized calculation, the total</span>
<a name="13633"><font size=-1>13633     </font></a><span class="string">ELF is computed from an alternative approach which should better take into</span>
<a name="13634"><font size=-1>13634     </font></a><span class="string">account the existence of spin dependent densities (see the documentation in</span>
<a name="13635"><font size=-1>13635     </font></a><span class="string">/doc/theory/ELF of your ABINIT repository)</span>
<a name="13636"><font size=-1>13636     </font></a><span class="string"></span>
<a name="13637"><font size=-1>13637     </font></a><span class="string">Please note that ELF is **not** yet implemented in the case of PAW</span>
<a name="13638"><font size=-1>13638     </font></a><span class="string">([[usepaw]] = 1) calculations.</span>
<a name="13639"><font size=-1>13639     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13640"><font size=-1>13640     </font></a><span class="default">),</span>
<a name="13641"><font size=-1>13641     </font></a><span class="default"></span>
<a name="13642"><font size=-1>13642     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13643"><font size=-1>13643     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtfc&quot;</span><span class="default">,</span>
<a name="13644"><font size=-1>13644     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="13645"><font size=-1>13645     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13646"><font size=-1>13646     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">, </span><span class="string">'EFG_basic'</span><span class="default">],</span>
<a name="13647"><font size=-1>13647     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13648"><font size=-1>13648     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13649"><font size=-1>13649     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Fermi Contact term&quot;</span><span class="default">,</span>
<a name="13650"><font size=-1>13650     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="13651"><font size=-1>13651     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13652"><font size=-1>13652     </font></a><span class="string">  * If set to 1, print the Fermi contact interaction at each nuclear site, that is, the electron density at each site. The result appears in the main output file (search for FC). Note that this calculation is different than what is done by cut3d, because it also computes the PAW on-site corrections in addition to the contribution from the valence pseudo-wavefunctions.</span>
<a name="13653"><font size=-1>13653     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13654"><font size=-1>13654     </font></a><span class="default">),</span>
<a name="13655"><font size=-1>13655     </font></a><span class="default"></span>
<a name="13656"><font size=-1>13656     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13657"><font size=-1>13657     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtfull1wf&quot;</span><span class="default">,</span>
<a name="13658"><font size=-1>13658     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="13659"><font size=-1>13659     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13660"><font size=-1>13660     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="13661"><font size=-1>13661     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13662"><font size=-1>13662     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13663"><font size=-1>13663     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT FULL 1st-order WaveFunction&quot;</span><span class="default">,</span>
<a name="13664"><font size=-1>13664     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13665"><font size=-1>13665     </font></a><span class="string">If set to 1, the output _1WF files will contain the full 1st-order wavefunctions, for both valence and conduction bands.</span>
<a name="13666"><font size=-1>13666     </font></a><span class="string">Otherwise, the _1WF files are not really 1st-order perturbed wavefunctions, but merely a set of perturbed wavefunctions that yield the correct perturbed density.</span>
<a name="13667"><font size=-1>13667     </font></a><span class="string">This is used when one expect to perform post-processing of the 1st-order wavefunctions.</span>
<a name="13668"><font size=-1>13668     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13669"><font size=-1>13669     </font></a><span class="default">),</span>
<a name="13670"><font size=-1>13670     </font></a><span class="default"></span>
<a name="13671"><font size=-1>13671     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13672"><font size=-1>13672     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtfsurf&quot;</span><span class="default">,</span>
<a name="13673"><font size=-1>13673     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13674"><font size=-1>13674     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13675"><font size=-1>13675     </font></a><span class="default">    topics=[</span><span class="string">'printing_prfermi'</span><span class="default">],</span>
<a name="13676"><font size=-1>13676     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13677"><font size=-1>13677     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13678"><font size=-1>13678     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Fermi SURFace file&quot;</span><span class="default">,</span>
<a name="13679"><font size=-1>13679     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13680"><font size=-1>13680     </font></a><span class="string">If set to 1, provide Fermi surface file in the BXSF format (Xcrysden) If</span>
<a name="13681"><font size=-1>13681     </font></a><span class="string">[[prtfsurf]] = 1, a _BXSF file readable by [ XCrySDen ](http://www.xcrysden.org)</span>
<a name="13682"><font size=-1>13682     </font></a><span class="string">will be produced at the end of the calculation. The file contains information</span>
<a name="13683"><font size=-1>13683     </font></a><span class="string">on the band structure of the system and can be used to visualize the Fermi</span>
<a name="13684"><font size=-1>13684     </font></a><span class="string">surface or any other energy isosurface. [[prtfsurf]] = 1 is compatible only with</span>
<a name="13685"><font size=-1>13685     </font></a><span class="string">SCF calculations ([[iscf]] &gt; 1) or NSCF runs in which the occupation factors</span>
<a name="13686"><font size=-1>13686     </font></a><span class="string">and Fermi level are recalculated once convergence is achieved ([[iscf]] = -3).</span>
<a name="13687"><font size=-1>13687     </font></a><span class="string">The two methods should produce the same Fermi surface provided that the</span>
<a name="13688"><font size=-1>13688     </font></a><span class="string">k-meshes are sufficiently dense. The k-mesh used for the sampling of the Fermi</span>
<a name="13689"><font size=-1>13689     </font></a><span class="string">surface can be specified using the standard variables [[ngkpt]], ([[shiftk]],</span>
<a name="13690"><font size=-1>13690     </font></a><span class="string">and [[nshiftk]]. Note, however, that the mesh must be homogeneous and centered</span>
<a name="13691"><font size=-1>13691     </font></a><span class="string">on gamma (multiple shifts are not supported by Xcrysden)</span>
<a name="13692"><font size=-1>13692     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13693"><font size=-1>13693     </font></a><span class="default">),</span>
<a name="13694"><font size=-1>13694     </font></a><span class="default"></span>
<a name="13695"><font size=-1>13695     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13696"><font size=-1>13696     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtgden&quot;</span><span class="default">,</span>
<a name="13697"><font size=-1>13697     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13698"><font size=-1>13698     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13699"><font size=-1>13699     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="13700"><font size=-1>13700     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13701"><font size=-1>13701     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13702"><font size=-1>13702     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the Gradient of electron DENsity&quot;</span><span class="default">,</span>
<a name="13703"><font size=-1>13703     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13704"><font size=-1>13704     </font></a><span class="string">If set to 1 or a larger value, provide output of gradient of electron density</span>
<a name="13705"><font size=-1>13705     </font></a><span class="string">in real space grho(r), in units of Bohr^-(5/2).</span>
<a name="13706"><font size=-1>13706     </font></a><span class="string">The names of the gradient of electron density files will be the root output</span>
<a name="13707"><font size=-1>13707     </font></a><span class="string">name, followed by _GDEN1, _GDEN2, GDEN3 for each principal direction (indeed</span>
<a name="13708"><font size=-1>13708     </font></a><span class="string">it is a vector).</span>
<a name="13709"><font size=-1>13709     </font></a><span class="string">Like a _DEN file, it can be analyzed by cut3d.</span>
<a name="13710"><font size=-1>13710     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#denfile|this section]].</span>
<a name="13711"><font size=-1>13711     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13712"><font size=-1>13712     </font></a><span class="default">),</span>
<a name="13713"><font size=-1>13713     </font></a><span class="default"></span>
<a name="13714"><font size=-1>13714     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13715"><font size=-1>13715     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtgeo&quot;</span><span class="default">,</span>
<a name="13716"><font size=-1>13716     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13717"><font size=-1>13717     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13718"><font size=-1>13718     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgeo'</span><span class="default">],</span>
<a name="13719"><font size=-1>13719     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13720"><font size=-1>13720     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13721"><font size=-1>13721     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the GEOmetry analysis&quot;</span><span class="default">,</span>
<a name="13722"><font size=-1>13722     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13723"><font size=-1>13723     </font></a><span class="string">If set to 1 or a larger value, provide output of geometrical analysis (bond</span>
<a name="13724"><font size=-1>13724     </font></a><span class="string">lengths and bond angles). The value of [[prtgeo]] is taken by the code to be</span>
<a name="13725"><font size=-1>13725     </font></a><span class="string">the maximum coordination number of atoms in the system.</span>
<a name="13726"><font size=-1>13726     </font></a><span class="string">It will deduce a maximum number of &quot;nearest&quot; and &quot;next-nearest&quot; neighbors</span>
<a name="13727"><font size=-1>13727     </font></a><span class="string">accordingly, and compute corresponding bond lengths.</span>
<a name="13728"><font size=-1>13728     </font></a><span class="string">It will compute bond angles for the &quot;nearest&quot; neighbours only.</span>
<a name="13729"><font size=-1>13729     </font></a><span class="string">If [[ionmov]] == 0, the name of the file will be the root output name, followed by _GEO.</span>
<a name="13730"><font size=-1>13730     </font></a><span class="string">If [[ionmov]] == 1 or 2, one file will be output at each time step, with the</span>
<a name="13731"><font size=-1>13731     </font></a><span class="string">name being made of</span>
<a name="13732"><font size=-1>13732     </font></a><span class="string"></span>
<a name="13733"><font size=-1>13733     </font></a><span class="string">  * the root output name,</span>
<a name="13734"><font size=-1>13734     </font></a><span class="string">  * followed by _TIMx, where x is related to the time step (see later)</span>
<a name="13735"><font size=-1>13735     </font></a><span class="string">  * then followed by _GEO</span>
<a name="13736"><font size=-1>13736     </font></a><span class="string"></span>
<a name="13737"><font size=-1>13737     </font></a><span class="string">The content of the file should be rather self-explanatory.</span>
<a name="13738"><font size=-1>13738     </font></a><span class="string">No output is provided by [[prtgeo]] is lower than or equal to 0.</span>
<a name="13739"><font size=-1>13739     </font></a><span class="string">If [[prtgeo]] &gt; 0, the maximum number of atoms ([[natom]]) is 9999.</span>
<a name="13740"><font size=-1>13740     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13741"><font size=-1>13741     </font></a><span class="default">),</span>
<a name="13742"><font size=-1>13742     </font></a><span class="default"></span>
<a name="13743"><font size=-1>13743     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13744"><font size=-1>13744     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtgkk&quot;</span><span class="default">,</span>
<a name="13745"><font size=-1>13745     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13746"><font size=-1>13746     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13747"><font size=-1>13747     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">, </span><span class="string">'ElPhonInt_compulsory'</span><span class="default">],</span>
<a name="13748"><font size=-1>13748     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13749"><font size=-1>13749     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13750"><font size=-1>13750     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the GKK matrix elements file&quot;</span><span class="default">,</span>
<a name="13751"><font size=-1>13751     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13752"><font size=-1>13752     </font></a><span class="string">If set to 1, provide output of electron-phonon &quot;gkk&quot; matrix elements, for</span>
<a name="13753"><font size=-1>13753     </font></a><span class="string">further treatment by mrggkk utility or anaddb utility. Note that symmetry will</span>
<a name="13754"><font size=-1>13754     </font></a><span class="string">be disabled for the calculation of the perturbation, forcing the inclusion of</span>
<a name="13755"><font size=-1>13755     </font></a><span class="string">all k-points and all perturbation directions. Additional information on</span>
<a name="13756"><font size=-1>13756     </font></a><span class="string">electron-phonon treatment in ABINIT is given in the tutorial [[tutorial:eph]].</span>
<a name="13757"><font size=-1>13757     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13758"><font size=-1>13758     </font></a><span class="default">),</span>
<a name="13759"><font size=-1>13759     </font></a><span class="default"></span>
<a name="13760"><font size=-1>13760     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13761"><font size=-1>13761     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtgsr&quot;</span><span class="default">,</span>
<a name="13762"><font size=-1>13762     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13763"><font size=-1>13763     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13764"><font size=-1>13764     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13765"><font size=-1>13765     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13766"><font size=-1>13766     </font></a><span class="default">    defaultval=</span><span class="string">&quot;prtgsr = 0&quot;</span><span class="default">,</span>
<a name="13767"><font size=-1>13767     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the GSR file&quot;</span><span class="default">,</span>
<a name="13768"><font size=-1>13768     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13769"><font size=-1>13769     </font></a><span class="string">If set to 1, ABINIT will produce a GSR file at the end of the GS calculation.</span>
<a name="13770"><font size=-1>13770     </font></a><span class="string">The GSR file contains the most important GS results (band structure, forces,</span>
<a name="13771"><font size=-1>13771     </font></a><span class="string">stresses, electronic density). The GSR file can be read by AbiPy and used for further post-processing.</span>
<a name="13772"><font size=-1>13772     </font></a><span class="string">Note that, by default, the GSR file contains the electronic density unless [[prtden]] is set to 0.</span>
<a name="13773"><font size=-1>13773     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13774"><font size=-1>13774     </font></a><span class="default">),</span>
<a name="13775"><font size=-1>13775     </font></a><span class="default"></span>
<a name="13776"><font size=-1>13776     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13777"><font size=-1>13777     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtkden&quot;</span><span class="default">,</span>
<a name="13778"><font size=-1>13778     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13779"><font size=-1>13779     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13780"><font size=-1>13780     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="13781"><font size=-1>13781     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13782"><font size=-1>13782     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13783"><font size=-1>13783     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the Kinetic energy DENsity&quot;</span><span class="default">,</span>
<a name="13784"><font size=-1>13784     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13785"><font size=-1>13785     </font></a><span class="string">If set to 1 or a larger value, provide output of kinetic energy density in</span>
<a name="13786"><font size=-1>13786     </font></a><span class="string">real space tau(r), in units of Bohr^-5.</span>
<a name="13787"><font size=-1>13787     </font></a><span class="string">The name of the kinetic energy density file will be the root output name, followed by _KDEN.</span>
<a name="13788"><font size=-1>13788     </font></a><span class="string">Like a _DEN file, it can be analyzed by cut3d.</span>
<a name="13789"><font size=-1>13789     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#denfile|this section]].</span>
<a name="13790"><font size=-1>13790     </font></a><span class="string">Note that the computation of the kinetic energy density must be activate,</span>
<a name="13791"><font size=-1>13791     </font></a><span class="string">thanks to the input variable [[usekden]].</span>
<a name="13792"><font size=-1>13792     </font></a><span class="string">Please note that kinetic energy density is **not** yet implemented in the case</span>
<a name="13793"><font size=-1>13793     </font></a><span class="string">of PAW ([[usepaw]] = 1) calculations.</span>
<a name="13794"><font size=-1>13794     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13795"><font size=-1>13795     </font></a><span class="default">),</span>
<a name="13796"><font size=-1>13796     </font></a><span class="default"></span>
<a name="13797"><font size=-1>13797     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13798"><font size=-1>13798     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtkpt&quot;</span><span class="default">,</span>
<a name="13799"><font size=-1>13799     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13800"><font size=-1>13800     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13801"><font size=-1>13801     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">, </span><span class="string">'Output_useful'</span><span class="default">, </span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="13802"><font size=-1>13802     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13803"><font size=-1>13803     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13804"><font size=-1>13804     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the K-PoinTs sets&quot;</span><span class="default">,</span>
<a name="13805"><font size=-1>13805     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13806"><font size=-1>13806     </font></a><span class="string">If set /= 0, proceeds to a detailed analysis of different k point grids.</span>
<a name="13807"><font size=-1>13807     </font></a><span class="string">Works only if [[kptopt]] is positive, and neither [[kptrlatt]] nor [[ngkpt]]</span>
<a name="13808"><font size=-1>13808     </font></a><span class="string">are defined. ABINIT will stop after this analysis.</span>
<a name="13809"><font size=-1>13809     </font></a><span class="string"></span>
<a name="13810"><font size=-1>13810     </font></a><span class="string">Different sets of k point grids are defined, with common values of [[shiftk]].</span>
<a name="13811"><font size=-1>13811     </font></a><span class="string">In each set, ABINIT increases the length of vectors of the supercell (see</span>
<a name="13812"><font size=-1>13812     </font></a><span class="string">[[kptrlatt]]) by integer steps. The different sets are labelled by &quot;iset&quot;. For</span>
<a name="13813"><font size=-1>13813     </font></a><span class="string">each k point grid, [[kptrlen]] and [[nkpt]] are computed (the latter always</span>
<a name="13814"><font size=-1>13814     </font></a><span class="string">invoking [[kptopt]] = 1, that is, full use of symmetries). A series is finished</span>
<a name="13815"><font size=-1>13815     </font></a><span class="string">when the computed [[kptrlen]] is twice larger than the input variable</span>
<a name="13816"><font size=-1>13816     </font></a><span class="string">[[kptrlen]]. After the examination of the different sets, ABINIT summarizes,</span>
<a name="13817"><font size=-1>13817     </font></a><span class="string">for each [[nkpt]], the best possible grid, that is, the one with the largest</span>
<a name="13818"><font size=-1>13818     </font></a><span class="string">computed [[kptrlen]].</span>
<a name="13819"><font size=-1>13819     </font></a><span class="string"></span>
<a name="13820"><font size=-1>13820     </font></a><span class="string">Note that this analysis is also performed when [[prtkpt]] = 0, as soon as</span>
<a name="13821"><font size=-1>13821     </font></a><span class="string">neither [[kptrlatt]] nor [[ngkpt]] are defined. But, in this case, no analysis</span>
<a name="13822"><font size=-1>13822     </font></a><span class="string">report is given, and the code selects the grid with the smaller [[ngkpt]] for</span>
<a name="13823"><font size=-1>13823     </font></a><span class="string">the desired [[kptrlen]]. However, this analysis takes some times (well</span>
<a name="13824"><font size=-1>13824     </font></a><span class="string">sometimes, it is only a few seconds - it depends on the value of the input</span>
<a name="13825"><font size=-1>13825     </font></a><span class="string">[[kptrlen]]), and it is better to examine the full analysis for a given cell</span>
<a name="13826"><font size=-1>13826     </font></a><span class="string">and set of symmetries, [[shiftk]] for all the production runs.</span>
<a name="13827"><font size=-1>13827     </font></a><span class="string"></span>
<a name="13828"><font size=-1>13828     </font></a><span class="string">If set to -2, the code stops in invars1 after the computation of the</span>
<a name="13829"><font size=-1>13829     </font></a><span class="string">irreducible set and a file named kpts.nc with the list of the k-points and the</span>
<a name="13830"><font size=-1>13830     </font></a><span class="string">corresponding weights is produced</span>
<a name="13831"><font size=-1>13831     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13832"><font size=-1>13832     </font></a><span class="default">),</span>
<a name="13833"><font size=-1>13833     </font></a><span class="default"></span>
<a name="13834"><font size=-1>13834     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13835"><font size=-1>13835     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtlden&quot;</span><span class="default">,</span>
<a name="13836"><font size=-1>13836     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13837"><font size=-1>13837     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13838"><font size=-1>13838     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="13839"><font size=-1>13839     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13840"><font size=-1>13840     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13841"><font size=-1>13841     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the Laplacian of electron DENsity&quot;</span><span class="default">,</span>
<a name="13842"><font size=-1>13842     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13843"><font size=-1>13843     </font></a><span class="string">If set to 1 or a larger value, provide output of Laplacian of electron density</span>
<a name="13844"><font size=-1>13844     </font></a><span class="string">in real space grho(r), in units of Bohr^-(7/2).</span>
<a name="13845"><font size=-1>13845     </font></a><span class="string">The name of the Laplacian of electron density file will be the root output name, followed by _LDEN.</span>
<a name="13846"><font size=-1>13846     </font></a><span class="string">Like a _DEN file, it can be analyzed by cut3d.</span>
<a name="13847"><font size=-1>13847     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#denfile|this section]].</span>
<a name="13848"><font size=-1>13848     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13849"><font size=-1>13849     </font></a><span class="default">),</span>
<a name="13850"><font size=-1>13850     </font></a><span class="default"></span>
<a name="13851"><font size=-1>13851     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13852"><font size=-1>13852     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtnabla&quot;</span><span class="default">,</span>
<a name="13853"><font size=-1>13853     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="13854"><font size=-1>13854     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13855"><font size=-1>13855     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13856"><font size=-1>13856     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13857"><font size=-1>13857     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13858"><font size=-1>13858     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRint NABLA&quot;</span><span class="default">,</span>
<a name="13859"><font size=-1>13859     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="13860"><font size=-1>13860     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13861"><font size=-1>13861     </font></a><span class="string">  * If set to 1, calculate the matrix elements &lt;Psi_n|-inabla|Psi_m&gt; and write it in file _OPT to be read by the code conducti (see [[cite:Mazevet2010]]).</span>
<a name="13862"><font size=-1>13862     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13863"><font size=-1>13863     </font></a><span class="default">),</span>
<a name="13864"><font size=-1>13864     </font></a><span class="default"></span>
<a name="13865"><font size=-1>13865     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13866"><font size=-1>13866     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtnest&quot;</span><span class="default">,</span>
<a name="13867"><font size=-1>13867     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="13868"><font size=-1>13868     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13869"><font size=-1>13869     </font></a><span class="default">    topics=[</span><span class="string">'printing_prfermi'</span><span class="default">],</span>
<a name="13870"><font size=-1>13870     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13871"><font size=-1>13871     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13872"><font size=-1>13872     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT NESTing function&quot;</span><span class="default">,</span>
<a name="13873"><font size=-1>13873     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="13874"><font size=-1>13874     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13875"><font size=-1>13875     </font></a><span class="string">If set to 1, the nesting function for the k-point grid is printed. For the</span>
<a name="13876"><font size=-1>13876     </font></a><span class="string">moment the path in q space for the nesting function is fixed, but will become</span>
<a name="13877"><font size=-1>13877     </font></a><span class="string">an input as well.</span>
<a name="13878"><font size=-1>13878     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13879"><font size=-1>13879     </font></a><span class="default">),</span>
<a name="13880"><font size=-1>13880     </font></a><span class="default"></span>
<a name="13881"><font size=-1>13881     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13882"><font size=-1>13882     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtphbands&quot;</span><span class="default">,</span>
<a name="13883"><font size=-1>13883     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="13884"><font size=-1>13884     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13885"><font size=-1>13885     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">],</span>
<a name="13886"><font size=-1>13886     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13887"><font size=-1>13887     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="13888"><font size=-1>13888     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT PHonon BANDS&quot;</span><span class="default">,</span>
<a name="13889"><font size=-1>13889     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13890"><font size=-1>13890     </font></a><span class="string">This option activates the output of the phonon frequencies in the EPH code.</span>
<a name="13891"><font size=-1>13891     </font></a><span class="string">Possible values:</span>
<a name="13892"><font size=-1>13892     </font></a><span class="string"></span>
<a name="13893"><font size=-1>13893     </font></a><span class="string">  * 0 Disable the output of the phonon frequencies.</span>
<a name="13894"><font size=-1>13894     </font></a><span class="string">  * 1 Write frequencies in |xmgrace| format. A file with extension `PHBANDS.agr` is produced.</span>
<a name="13895"><font size=-1>13895     </font></a><span class="string">    Use `xmgrace file_PHBANDS.agr` to visualize the data</span>
<a name="13896"><font size=-1>13896     </font></a><span class="string">  * 2 Write frequencies in |gnuplot| format. The code produces a `PHBANDS.dat` file</span>
<a name="13897"><font size=-1>13897     </font></a><span class="string">    with the eigenvalues and a `PHBANDS.gnuplot` script.</span>
<a name="13898"><font size=-1>13898     </font></a><span class="string">    Use `gnuplot file_PHBANDS.gnuplot` to visualize the phonon band structure.</span>
<a name="13899"><font size=-1>13899     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13900"><font size=-1>13900     </font></a><span class="default">),</span>
<a name="13901"><font size=-1>13901     </font></a><span class="default"></span>
<a name="13902"><font size=-1>13902     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13903"><font size=-1>13903     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtphdos&quot;</span><span class="default">,</span>
<a name="13904"><font size=-1>13904     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="13905"><font size=-1>13905     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13906"><font size=-1>13906     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">, </span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="13907"><font size=-1>13907     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13908"><font size=-1>13908     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="13909"><font size=-1>13909     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the PHonon Density Of States&quot;</span><span class="default">,</span>
<a name="13910"><font size=-1>13910     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="13911"><font size=-1>13911     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13912"><font size=-1>13912     </font></a><span class="string">Print the phonon density of states. It is activated by default when [[optdriver]] == 7.</span>
<a name="13913"><font size=-1>13913     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13914"><font size=-1>13914     </font></a><span class="default">),</span>
<a name="13915"><font size=-1>13915     </font></a><span class="default"></span>
<a name="13916"><font size=-1>13916     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13917"><font size=-1>13917     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtphsurf&quot;</span><span class="default">,</span>
<a name="13918"><font size=-1>13918     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="13919"><font size=-1>13919     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13920"><font size=-1>13920     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">, </span><span class="string">'ElPhonInt_expert'</span><span class="default">],</span>
<a name="13921"><font size=-1>13921     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13922"><font size=-1>13922     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13923"><font size=-1>13923     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT PHonon iso-SURFace&quot;</span><span class="default">,</span>
<a name="13924"><font size=-1>13924     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13925"><font size=-1>13925     </font></a><span class="string">Print a bxsf file (Xcrysden format) with the (interpolated) phonon frequencies</span>
<a name="13926"><font size=-1>13926     </font></a><span class="string">computed of the q-mesh determined by [[ph_ngqpt]]. The file can be use to</span>
<a name="13927"><font size=-1>13927     </font></a><span class="string">visualize isosurfaces with Xcrysden or other similar tools supporting the bxsf</span>
<a name="13928"><font size=-1>13928     </font></a><span class="string">format. Note that the (dense) q-mesh must be Gamma-centered, shifted meshes are</span>
<a name="13929"><font size=-1>13929     </font></a><span class="string">not supported by Xcrysden. This variable requires [[optdriver]] == 7.</span>
<a name="13930"><font size=-1>13930     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13931"><font size=-1>13931     </font></a><span class="default">),</span>
<a name="13932"><font size=-1>13932     </font></a><span class="default"></span>
<a name="13933"><font size=-1>13933     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13934"><font size=-1>13934     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtposcar&quot;</span><span class="default">,</span>
<a name="13935"><font size=-1>13935     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="13936"><font size=-1>13936     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13937"><font size=-1>13937     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgeo'</span><span class="default">],</span>
<a name="13938"><font size=-1>13938     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13939"><font size=-1>13939     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13940"><font size=-1>13940     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT POSCAR file&quot;</span><span class="default">,</span>
<a name="13941"><font size=-1>13941     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="13942"><font size=-1>13942     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13943"><font size=-1>13943     </font></a><span class="string">Print out VASP-style POSCAR and FORCES files, for use with PHON or frophon</span>
<a name="13944"><font size=-1>13944     </font></a><span class="string">codes for frozen phonon calculations. See the associated script in</span>
<a name="13945"><font size=-1>13945     </font></a><span class="string">{% modal ../scripts/post_processing/phondisp2abi.py %} for further details on</span>
<a name="13946"><font size=-1>13946     </font></a><span class="string">interfacing with PHON, PHONOPY, etc...</span>
<a name="13947"><font size=-1>13947     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13948"><font size=-1>13948     </font></a><span class="default">),</span>
<a name="13949"><font size=-1>13949     </font></a><span class="default"></span>
<a name="13950"><font size=-1>13950     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13951"><font size=-1>13951     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtpot&quot;</span><span class="default">,</span>
<a name="13952"><font size=-1>13952     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13953"><font size=-1>13953     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13954"><font size=-1>13954     </font></a><span class="default">    topics=[</span><span class="string">'printing_prpot'</span><span class="default">],</span>
<a name="13955"><font size=-1>13955     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13956"><font size=-1>13956     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13957"><font size=-1>13957     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT total POTential&quot;</span><span class="default">,</span>
<a name="13958"><font size=-1>13958     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13959"><font size=-1>13959     </font></a><span class="string">If set &gt;=1, provide output of the total (Kohn-Sham) potential (sum of local</span>
<a name="13960"><font size=-1>13960     </font></a><span class="string">pseudo-potential, Hartree potential, and xc potential).</span>
<a name="13961"><font size=-1>13961     </font></a><span class="string"></span>
<a name="13962"><font size=-1>13962     </font></a><span class="string">If [[ionmov]] == 0, the name of the potential file will be the root output name,</span>
<a name="13963"><font size=-1>13963     </font></a><span class="string">followed by _POT.</span>
<a name="13964"><font size=-1>13964     </font></a><span class="string">If [[ionmov]] == 1 or 2, potential file will be output at each time step, with</span>
<a name="13965"><font size=-1>13965     </font></a><span class="string">the name being made of</span>
<a name="13966"><font size=-1>13966     </font></a><span class="string"></span>
<a name="13967"><font size=-1>13967     </font></a><span class="string">  * the root output name,</span>
<a name="13968"><font size=-1>13968     </font></a><span class="string">  * followed by _TIMx, where x is related to the time step (see later)</span>
<a name="13969"><font size=-1>13969     </font></a><span class="string">  * then followed by _POT.</span>
<a name="13970"><font size=-1>13970     </font></a><span class="string"></span>
<a name="13971"><font size=-1>13971     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#localpotfile|this section]].</span>
<a name="13972"><font size=-1>13972     </font></a><span class="string">No output is provided by a negative value of this variable.</span>
<a name="13973"><font size=-1>13973     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13974"><font size=-1>13974     </font></a><span class="default">),</span>
<a name="13975"><font size=-1>13975     </font></a><span class="default"></span>
<a name="13976"><font size=-1>13976     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13977"><font size=-1>13977     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtpsps&quot;</span><span class="default">,</span>
<a name="13978"><font size=-1>13978     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13979"><font size=-1>13979     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13980"><font size=-1>13980     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13981"><font size=-1>13981     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13982"><font size=-1>13982     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13983"><font size=-1>13983     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRint the PSPS file&quot;</span><span class="default">,</span>
<a name="13984"><font size=-1>13984     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="13985"><font size=-1>13985     </font></a><span class="string">If set to 1, the code produces a netcdf file (PSPS.nc) with the internal</span>
<a name="13986"><font size=-1>13986     </font></a><span class="string">tables used by Abinit to apply the pseudopotential part of the KS Hamiltonian.</span>
<a name="13987"><font size=-1>13987     </font></a><span class="string">The data can be visualized with AbiPy. if prtpsps is set to -1, the code will</span>
<a name="13988"><font size=-1>13988     </font></a><span class="string">exit after the output of the PSPS.nc file.</span>
<a name="13989"><font size=-1>13989     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="13990"><font size=-1>13990     </font></a><span class="default">),</span>
<a name="13991"><font size=-1>13991     </font></a><span class="default"></span>
<a name="13992"><font size=-1>13992     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="13993"><font size=-1>13993     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtspcur&quot;</span><span class="default">,</span>
<a name="13994"><font size=-1>13994     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="13995"><font size=-1>13995     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="13996"><font size=-1>13996     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="13997"><font size=-1>13997     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="13998"><font size=-1>13998     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="13999"><font size=-1>13999     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the SPin CURrent density&quot;</span><span class="default">,</span>
<a name="14000"><font size=-1>14000     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14001"><font size=-1>14001     </font></a><span class="string">If set to 1 or a larger value, provide output of the current density of</span>
<a name="14002"><font size=-1>14002     </font></a><span class="string">different direction spins (x,y,z) in the whole unit cell. Should require</span>
<a name="14003"><font size=-1>14003     </font></a><span class="string">spinorial wave functions [[nspinor]] = 2. Experimental: this does not work yet.</span>
<a name="14004"><font size=-1>14004     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14005"><font size=-1>14005     </font></a><span class="default">),</span>
<a name="14006"><font size=-1>14006     </font></a><span class="default"></span>
<a name="14007"><font size=-1>14007     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14008"><font size=-1>14008     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtstm&quot;</span><span class="default">,</span>
<a name="14009"><font size=-1>14009     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14010"><font size=-1>14010     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14011"><font size=-1>14011     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">, </span><span class="string">'STM_compulsory'</span><span class="default">],</span>
<a name="14012"><font size=-1>14012     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14013"><font size=-1>14013     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14014"><font size=-1>14014     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the STM density&quot;</span><span class="default">,</span>
<a name="14015"><font size=-1>14015     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14016"><font size=-1>14016     </font></a><span class="string">If set to 1 or a larger value, provide output of the electron density in real</span>
<a name="14017"><font size=-1>14017     </font></a><span class="string">space rho(r), made only from the electrons close to the Fermi energy, in a</span>
<a name="14018"><font size=-1>14018     </font></a><span class="string">range of energy (positive or negative), determined by the (positive or</span>
<a name="14019"><font size=-1>14019     </font></a><span class="string">negative, but non-zero) value of the STM bias [[stmbias]].</span>
<a name="14020"><font size=-1>14020     </font></a><span class="string">This is a very approximate way to obtain STM profiles: one can choose an</span>
<a name="14021"><font size=-1>14021     </font></a><span class="string">equidensity surface, and consider that the STM tip will follow this surface.</span>
<a name="14022"><font size=-1>14022     </font></a><span class="string">Such equidensity surface might be determined with the help of Cut3D, and</span>
<a name="14023"><font size=-1>14023     </font></a><span class="string">further post-processing of it (to be implemented). The big approximations of</span>
<a name="14024"><font size=-1>14024     </font></a><span class="string">this technique are: neglect of the finite size of the tip, and position-</span>
<a name="14025"><font size=-1>14025     </font></a><span class="string">independent transfer matrix elements between the tip and the surface.</span>
<a name="14026"><font size=-1>14026     </font></a><span class="string">The charge density is provided in units of electrons/Bohr^3. The name of the</span>
<a name="14027"><font size=-1>14027     </font></a><span class="string">STM density file will be the root output name, followed by _STM. Like a _DEN</span>
<a name="14028"><font size=-1>14028     </font></a><span class="string">file, it can be analyzed by cut3d.</span>
<a name="14029"><font size=-1>14029     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#denfile|this section]].</span>
<a name="14030"><font size=-1>14030     </font></a><span class="string">For the STM charge density to be generated, one must give, as an input file,</span>
<a name="14031"><font size=-1>14031     </font></a><span class="string">the converged wavefunctions obtained from a previous run, at exactly the same</span>
<a name="14032"><font size=-1>14032     </font></a><span class="string">k-points and cut-off energy, self-consistently determined, using the</span>
<a name="14033"><font size=-1>14033     </font></a><span class="string">occupation numbers from [[occopt]] = 7.</span>
<a name="14034"><font size=-1>14034     </font></a><span class="string">In the run with positive [[prtstm]], one has to use:</span>
<a name="14035"><font size=-1>14035     </font></a><span class="string"></span>
<a name="14036"><font size=-1>14036     </font></a><span class="string">  * positive [[iscf]]</span>
<a name="14037"><font size=-1>14037     </font></a><span class="string">  * [[occopt]] = 7, with specification of [[tsmear]]</span>
<a name="14038"><font size=-1>14038     </font></a><span class="string">  * [[nstep]] = 1</span>
<a name="14039"><font size=-1>14039     </font></a><span class="string">  * the [[tolwfr]] convergence criterion</span>
<a name="14040"><font size=-1>14040     </font></a><span class="string">  * [[ionmov]] = 0 (this is the default value)</span>
<a name="14041"><font size=-1>14041     </font></a><span class="string">  * [[optdriver]] = 0 (this is the default value)</span>
<a name="14042"><font size=-1>14042     </font></a><span class="string"></span>
<a name="14043"><font size=-1>14043     </font></a><span class="string">Note that you might have to adjust the value of [[nband]] as well, for the</span>
<a name="14044"><font size=-1>14044     </font></a><span class="string">treatment of unoccupied states, because the automatic determination of</span>
<a name="14045"><font size=-1>14045     </font></a><span class="string">[[nband]] will often not include enough unoccupied states.</span>
<a name="14046"><font size=-1>14046     </font></a><span class="string">When [[prtstm]] is non-zero, the stress tensor is set to zero.</span>
<a name="14047"><font size=-1>14047     </font></a><span class="string">No output of _STM file is provided by [[prtstm]] lower or equal to 0.</span>
<a name="14048"><font size=-1>14048     </font></a><span class="string">No other printing variables for density or potentials should be activated</span>
<a name="14049"><font size=-1>14049     </font></a><span class="string">(e.g. [[prtden]] has to be set to zero).</span>
<a name="14050"><font size=-1>14050     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14051"><font size=-1>14051     </font></a><span class="default">),</span>
<a name="14052"><font size=-1>14052     </font></a><span class="default"></span>
<a name="14053"><font size=-1>14053     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14054"><font size=-1>14054     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtsuscep&quot;</span><span class="default">,</span>
<a name="14055"><font size=-1>14055     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14056"><font size=-1>14056     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14057"><font size=-1>14057     </font></a><span class="default">    topics=[</span><span class="string">'printing_prngs'</span><span class="default">],</span>
<a name="14058"><font size=-1>14058     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14059"><font size=-1>14059     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14060"><font size=-1>14060     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the SUSCEPtibility file (the irreducible polarizability)&quot;</span><span class="default">,</span>
<a name="14061"><font size=-1>14061     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14062"><font size=-1>14062     </font></a><span class="string">If set to 0, no _SUSC file will be produced after the screening calculation,</span>
<a name="14063"><font size=-1>14063     </font></a><span class="string">only the _SCR file will be output.</span>
<a name="14064"><font size=-1>14064     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14065"><font size=-1>14065     </font></a><span class="default">),</span>
<a name="14066"><font size=-1>14066     </font></a><span class="default"></span>
<a name="14067"><font size=-1>14067     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14068"><font size=-1>14068     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvclmb&quot;</span><span class="default">,</span>
<a name="14069"><font size=-1>14069     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14070"><font size=-1>14070     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14071"><font size=-1>14071     </font></a><span class="default">    topics=[</span><span class="string">'printing_prpot'</span><span class="default">],</span>
<a name="14072"><font size=-1>14072     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14073"><font size=-1>14073     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14074"><font size=-1>14074     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT V CouLoMB&quot;</span><span class="default">,</span>
<a name="14075"><font size=-1>14075     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14076"><font size=-1>14076     </font></a><span class="string">If set &gt;= 0 outputs a file with the Coulomb potential, defined as Hartree +</span>
<a name="14077"><font size=-1>14077     </font></a><span class="string">local Pseudopotential.</span>
<a name="14078"><font size=-1>14078     </font></a><span class="string"></span>
<a name="14079"><font size=-1>14079     </font></a><span class="string">If **prtvclmb=1** and in case of PAW ([[usepaw]] &gt; 0), the full core potential</span>
<a name="14080"><font size=-1>14080     </font></a><span class="string">is added for the Hartree part, with the on-site corrections vh1 - vht1.</span>
<a name="14081"><font size=-1>14081     </font></a><span class="string"></span>
<a name="14082"><font size=-1>14082     </font></a><span class="string">If **prtvclmb=2**, only the smooth part of the Coulomb potential is output.</span>
<a name="14083"><font size=-1>14083     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14084"><font size=-1>14084     </font></a><span class="default">),</span>
<a name="14085"><font size=-1>14085     </font></a><span class="default"></span>
<a name="14086"><font size=-1>14086     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14087"><font size=-1>14087     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvdw&quot;</span><span class="default">,</span>
<a name="14088"><font size=-1>14088     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="14089"><font size=-1>14089     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14090"><font size=-1>14090     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="14091"><font size=-1>14091     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14092"><font size=-1>14092     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14093"><font size=-1>14093     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Van Der Waals file&quot;</span><span class="default">,</span>
<a name="14094"><font size=-1>14094     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14095"><font size=-1>14095     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14096"><font size=-1>14096     </font></a><span class="string">Print out a NetCDF file containing a vdW-DF kernel.</span>
<a name="14097"><font size=-1>14097     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14098"><font size=-1>14098     </font></a><span class="default">),</span>
<a name="14099"><font size=-1>14099     </font></a><span class="default"></span>
<a name="14100"><font size=-1>14100     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14101"><font size=-1>14101     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvha&quot;</span><span class="default">,</span>
<a name="14102"><font size=-1>14102     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14103"><font size=-1>14103     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14104"><font size=-1>14104     </font></a><span class="default">    topics=[</span><span class="string">'printing_prpot'</span><span class="default">],</span>
<a name="14105"><font size=-1>14105     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14106"><font size=-1>14106     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14107"><font size=-1>14107     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT V_HArtree&quot;</span><span class="default">,</span>
<a name="14108"><font size=-1>14108     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14109"><font size=-1>14109     </font></a><span class="string">If set &gt;=1, provide output of the Hartree potential.</span>
<a name="14110"><font size=-1>14110     </font></a><span class="string"></span>
<a name="14111"><font size=-1>14111     </font></a><span class="string">If [[ionmov]] == 0, the name of the potential file will be the root output name,</span>
<a name="14112"><font size=-1>14112     </font></a><span class="string">followed by _VHA.</span>
<a name="14113"><font size=-1>14113     </font></a><span class="string">If [[ionmov]] == 1 or 2, potential files will be output at each time step, with</span>
<a name="14114"><font size=-1>14114     </font></a><span class="string">the name being made of</span>
<a name="14115"><font size=-1>14115     </font></a><span class="string"></span>
<a name="14116"><font size=-1>14116     </font></a><span class="string">  * the root output name,</span>
<a name="14117"><font size=-1>14117     </font></a><span class="string">  * followed by _TIMx, where x is related to the time step (see later)</span>
<a name="14118"><font size=-1>14118     </font></a><span class="string">  * then followed by _VHA.</span>
<a name="14119"><font size=-1>14119     </font></a><span class="string"></span>
<a name="14120"><font size=-1>14120     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#localpotfile|this section]].</span>
<a name="14121"><font size=-1>14121     </font></a><span class="string">No output is provided by a negative value of this variable.</span>
<a name="14122"><font size=-1>14122     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14123"><font size=-1>14123     </font></a><span class="default">),</span>
<a name="14124"><font size=-1>14124     </font></a><span class="default"></span>
<a name="14125"><font size=-1>14125     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14126"><font size=-1>14126     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvhxc&quot;</span><span class="default">,</span>
<a name="14127"><font size=-1>14127     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14128"><font size=-1>14128     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14129"><font size=-1>14129     </font></a><span class="default">    topics=[</span><span class="string">'printing_prpot'</span><span class="default">],</span>
<a name="14130"><font size=-1>14130     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14131"><font size=-1>14131     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14132"><font size=-1>14132     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT V_HXC&quot;</span><span class="default">,</span>
<a name="14133"><font size=-1>14133     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14134"><font size=-1>14134     </font></a><span class="string">If set &gt;=1, provide output of the sum of the Hartree potential and xc potential.</span>
<a name="14135"><font size=-1>14135     </font></a><span class="string"></span>
<a name="14136"><font size=-1>14136     </font></a><span class="string">If [[ionmov]] == 0, the name of the potential file will be the root output name,</span>
<a name="14137"><font size=-1>14137     </font></a><span class="string">followed by _VHXC.</span>
<a name="14138"><font size=-1>14138     </font></a><span class="string">If [[ionmov]] == 1 or 2, potential files will be output at each time step, with</span>
<a name="14139"><font size=-1>14139     </font></a><span class="string">the name being made of</span>
<a name="14140"><font size=-1>14140     </font></a><span class="string"></span>
<a name="14141"><font size=-1>14141     </font></a><span class="string">  * the root output name,</span>
<a name="14142"><font size=-1>14142     </font></a><span class="string">  * followed by _TIMx, where x is related to the time step (see later)</span>
<a name="14143"><font size=-1>14143     </font></a><span class="string">  * then followed by _VHXC.</span>
<a name="14144"><font size=-1>14144     </font></a><span class="string"></span>
<a name="14145"><font size=-1>14145     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#localpotfile|this section]].</span>
<a name="14146"><font size=-1>14146     </font></a><span class="string">No output is provided by a negative value of this variable.</span>
<a name="14147"><font size=-1>14147     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14148"><font size=-1>14148     </font></a><span class="default">),</span>
<a name="14149"><font size=-1>14149     </font></a><span class="default"></span>
<a name="14150"><font size=-1>14150     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14151"><font size=-1>14151     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvol&quot;</span><span class="default">,</span>
<a name="14152"><font size=-1>14152     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14153"><font size=-1>14153     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14154"><font size=-1>14154     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">, </span><span class="string">'Output_basic'</span><span class="default">],</span>
<a name="14155"><font size=-1>14155     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14156"><font size=-1>14156     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14157"><font size=-1>14157     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT VOLume&quot;</span><span class="default">,</span>
<a name="14158"><font size=-1>14158     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14159"><font size=-1>14159     </font></a><span class="string">Control the volume of printed output. In particular, this concerns the</span>
<a name="14160"><font size=-1>14160     </font></a><span class="string">explicit echo of eigenenergies and residuals for all bands and k points in the</span>
<a name="14161"><font size=-1>14161     </font></a><span class="string">main output file. Also, the analysis of the value and location of the maximal</span>
<a name="14162"><font size=-1>14162     </font></a><span class="string">density (and magnetization).</span>
<a name="14163"><font size=-1>14163     </font></a><span class="string">Standard choice is 0. Positive values print more in the output and log files,</span>
<a name="14164"><font size=-1>14164     </font></a><span class="string">while negative values are for debugging (or preprocessing only), and cause the</span>
<a name="14165"><font size=-1>14165     </font></a><span class="string">code to stop at some point.</span>
<a name="14166"><font size=-1>14166     </font></a><span class="string"></span>
<a name="14167"><font size=-1>14167     </font></a><span class="string">  * 0 --&gt; The eigenenergies and residuals for all bands and k points are not echoed in the main output file. There are exceptions: the eigenvalues of the first k point are printed at the end of the SCF loop, and also, if [[iscf]] = -2 and [[kptopt]]&lt;=0, the eigenvalues for all the k points are printed anyway, for a maximum of 50 k-points. Due to some subtlety, if for **some** dataset [[prtvol]] is non-zero, the limit for input and output echoes cannot be enforced, so it is like if [[prtvol]] = 1 for **all** the datasets for which [[prtvol]] was set to 0.</span>
<a name="14168"><font size=-1>14168     </font></a><span class="string">  * 1 --&gt; the eigenvalues for the first 50 k-points are printed in all cases, at the end of the SCF loop.</span>
<a name="14169"><font size=-1>14169     </font></a><span class="string">  * 2 --&gt; all the eigenvalues and the residuals are printed at the end of the SCF loop. Also, the analysis of the value and location of the maximal density (and magnetization) is printed.</span>
<a name="14170"><font size=-1>14170     </font></a><span class="string">  * 3 --&gt; Print memory information for lobpcg</span>
<a name="14171"><font size=-1>14171     </font></a><span class="string">  * 4 --&gt; Like 3 and prints information of lobpcg algorithm convergence</span>
<a name="14172"><font size=-1>14172     </font></a><span class="string">  * 10 --&gt; the eigenvalues are printed for every SCF iteration, as well as other additions (to be specified in the future...)</span>
<a name="14173"><font size=-1>14173     </font></a><span class="string"></span>
<a name="14174"><font size=-1>14174     </font></a><span class="string">Debugging options:</span>
<a name="14175"><font size=-1>14175     </font></a><span class="string"></span>
<a name="14176"><font size=-1>14176     </font></a><span class="string">  * = -1 --&gt; stop in abinit (main program), before call driver. Useful to see the effect of the preprocessing of input variables (memory needed, effect of symmetries, k points...) without going further. Run very fast, on the order of the second.</span>
<a name="14177"><font size=-1>14177     </font></a><span class="string">  * =-2 --&gt; same as -1, except that print only the first dataset. All the non default input variables associated to all datasets are printed in the output file, but only for the first dataset. Also all the input variables are written in the NetCDF file &quot;OUT.nc&quot;, even if the value is the default.</span>
<a name="14178"><font size=-1>14178     </font></a><span class="string">  * = -3 --&gt; stop in gstate, before call scfcv, move or brdmin. Useful to debug pseudopotentials</span>
<a name="14179"><font size=-1>14179     </font></a><span class="string">  * = -4 --&gt; stop in move, after completion of all loops</span>
<a name="14180"><font size=-1>14180     </font></a><span class="string">  * = -5 --&gt; stop in brdmin, after completion of all loops</span>
<a name="14181"><font size=-1>14181     </font></a><span class="string">  * = -6 --&gt; stop in scfcv, after completion of all loops</span>
<a name="14182"><font size=-1>14182     </font></a><span class="string">  * = -7 --&gt; stop in vtorho, after the first rho is obtained</span>
<a name="14183"><font size=-1>14183     </font></a><span class="string">  * = -8 --&gt; stop in vtowfk, after the first k point is treated</span>
<a name="14184"><font size=-1>14184     </font></a><span class="string">  * = -9 --&gt; stop in cgwf, after the first wf is optimized</span>
<a name="14185"><font size=-1>14185     </font></a><span class="string">  * = -10 --&gt; stop in getghc, after the Hamiltonian is applied once</span>
<a name="14186"><font size=-1>14186     </font></a><span class="string"></span>
<a name="14187"><font size=-1>14187     </font></a><span class="string">This debugging feature is not yet activated in the RF routines. Note that</span>
<a name="14188"><font size=-1>14188     </font></a><span class="string">[[fftalg]] offers another option for debugging.</span>
<a name="14189"><font size=-1>14189     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14190"><font size=-1>14190     </font></a><span class="default">),</span>
<a name="14191"><font size=-1>14191     </font></a><span class="default"></span>
<a name="14192"><font size=-1>14192     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14193"><font size=-1>14193     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvolimg&quot;</span><span class="default">,</span>
<a name="14194"><font size=-1>14194     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14195"><font size=-1>14195     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14196"><font size=-1>14196     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">, </span><span class="string">'Output_useful'</span><span class="default">],</span>
<a name="14197"><font size=-1>14197     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14198"><font size=-1>14198     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14199"><font size=-1>14199     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT VOLume for IMaGes&quot;</span><span class="default">,</span>
<a name="14200"><font size=-1>14200     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14201"><font size=-1>14201     </font></a><span class="string">Control the volume of printed output when an algorithm using images of the</span>
<a name="14202"><font size=-1>14202     </font></a><span class="string">cell is used ([[nimage]] &gt; 1).</span>
<a name="14203"><font size=-1>14203     </font></a><span class="string">When such an algorithm is activated, the printing volume (in output file) can</span>
<a name="14204"><font size=-1>14204     </font></a><span class="string">be large and difficult to read.</span>
<a name="14205"><font size=-1>14205     </font></a><span class="string">Using **prtvolimg=1**, the printing volume, for each image, is reduced to</span>
<a name="14206"><font size=-1>14206     </font></a><span class="string">unit cell, atomic positions, total energy, forces, stresses, velocities and</span>
<a name="14207"><font size=-1>14207     </font></a><span class="string">convergence residuals.</span>
<a name="14208"><font size=-1>14208     </font></a><span class="string">Using **prtvolimg=2**, the printing volume, for each image, is reduced to</span>
<a name="14209"><font size=-1>14209     </font></a><span class="string">total energy and convergence residuals only.</span>
<a name="14210"><font size=-1>14210     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14211"><font size=-1>14211     </font></a><span class="default">),</span>
<a name="14212"><font size=-1>14212     </font></a><span class="default"></span>
<a name="14213"><font size=-1>14213     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14214"><font size=-1>14214     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvpsp&quot;</span><span class="default">,</span>
<a name="14215"><font size=-1>14215     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14216"><font size=-1>14216     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14217"><font size=-1>14217     </font></a><span class="default">    topics=[</span><span class="string">'printing_prpot'</span><span class="default">],</span>
<a name="14218"><font size=-1>14218     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14219"><font size=-1>14219     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14220"><font size=-1>14220     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT V_PSeudoPotential&quot;</span><span class="default">,</span>
<a name="14221"><font size=-1>14221     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14222"><font size=-1>14222     </font></a><span class="string">If set &gt;=1, provide output of the local pseudo potential.</span>
<a name="14223"><font size=-1>14223     </font></a><span class="string"></span>
<a name="14224"><font size=-1>14224     </font></a><span class="string">If [[ionmov]] == 0, the name of the potential file will be the root output name, followed by _VPSP.</span>
<a name="14225"><font size=-1>14225     </font></a><span class="string">If [[ionmov]] == 1 or 2, potential files will be output at each time step, with the name being made of</span>
<a name="14226"><font size=-1>14226     </font></a><span class="string"></span>
<a name="14227"><font size=-1>14227     </font></a><span class="string">  * the root output name,</span>
<a name="14228"><font size=-1>14228     </font></a><span class="string">  * followed by _TIMx, where x is related to the timestep (see later)</span>
<a name="14229"><font size=-1>14229     </font></a><span class="string">  * then followed by _VPSP.</span>
<a name="14230"><font size=-1>14230     </font></a><span class="string"></span>
<a name="14231"><font size=-1>14231     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#localpotfile|this section]].</span>
<a name="14232"><font size=-1>14232     </font></a><span class="string">No output is provided by a negative value of this variable.</span>
<a name="14233"><font size=-1>14233     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14234"><font size=-1>14234     </font></a><span class="default">),</span>
<a name="14235"><font size=-1>14235     </font></a><span class="default"></span>
<a name="14236"><font size=-1>14236     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14237"><font size=-1>14237     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtvxc&quot;</span><span class="default">,</span>
<a name="14238"><font size=-1>14238     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14239"><font size=-1>14239     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14240"><font size=-1>14240     </font></a><span class="default">    topics=[</span><span class="string">'printing_prpot'</span><span class="default">],</span>
<a name="14241"><font size=-1>14241     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14242"><font size=-1>14242     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14243"><font size=-1>14243     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT V_XC&quot;</span><span class="default">,</span>
<a name="14244"><font size=-1>14244     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14245"><font size=-1>14245     </font></a><span class="string">If set &gt;=1, provide output of the exchange-correlation potential.</span>
<a name="14246"><font size=-1>14246     </font></a><span class="string"></span>
<a name="14247"><font size=-1>14247     </font></a><span class="string">If [[ionmov]] == 0, the name of the potential file will be the root output name,</span>
<a name="14248"><font size=-1>14248     </font></a><span class="string">followed by _VXC.</span>
<a name="14249"><font size=-1>14249     </font></a><span class="string">If [[ionmov]] == 1 or 2, potential files will be output at each time step, with</span>
<a name="14250"><font size=-1>14250     </font></a><span class="string">the name being made of</span>
<a name="14251"><font size=-1>14251     </font></a><span class="string"></span>
<a name="14252"><font size=-1>14252     </font></a><span class="string">  * the root output name,</span>
<a name="14253"><font size=-1>14253     </font></a><span class="string">  * followed by _TIMx, where x is related to the timestep (see later)</span>
<a name="14254"><font size=-1>14254     </font></a><span class="string">  * then followed by _VXC.</span>
<a name="14255"><font size=-1>14255     </font></a><span class="string"></span>
<a name="14256"><font size=-1>14256     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#localpotfile|this section]].</span>
<a name="14257"><font size=-1>14257     </font></a><span class="string">No output is provided by a negative value of this variable.</span>
<a name="14258"><font size=-1>14258     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14259"><font size=-1>14259     </font></a><span class="default">),</span>
<a name="14260"><font size=-1>14260     </font></a><span class="default"></span>
<a name="14261"><font size=-1>14261     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14262"><font size=-1>14262     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtwant&quot;</span><span class="default">,</span>
<a name="14263"><font size=-1>14263     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14264"><font size=-1>14264     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14265"><font size=-1>14265     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">, </span><span class="string">'Wannier_compulsory'</span><span class="default">],</span>
<a name="14266"><font size=-1>14266     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14267"><font size=-1>14267     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14268"><font size=-1>14268     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT WANT file&quot;</span><span class="default">,</span>
<a name="14269"><font size=-1>14269     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="14270"><font size=-1>14270     </font></a><span class="string">Flag used to indicate that either the Wannier90 or the WanT interfaces will be used.</span>
<a name="14271"><font size=-1>14271     </font></a><span class="string"></span>
<a name="14272"><font size=-1>14272     </font></a><span class="string">  * [[prtwant]] = 1 --&gt; Use the **ABINIT- WanT** interface.</span>
<a name="14273"><font size=-1>14273     </font></a><span class="string"></span>
<a name="14274"><font size=-1>14274     </font></a><span class="string">Provide an output file that can be used by the WanT postprocessing program</span>
<a name="14275"><font size=-1>14275     </font></a><span class="string">(see [http://www.wannier-transport.org](http://www.wannier-transport.org)). The value of the prtwant indicates the</span>
<a name="14276"><font size=-1>14276     </font></a><span class="string">version of the WanT code that can read it. Currently only the value</span>
<a name="14277"><font size=-1>14277     </font></a><span class="string">[[prtwant]] = 1 is implemented, corresponding to WanT version 1.0.1, available</span>
<a name="14278"><font size=-1>14278     </font></a><span class="string">since Oct. 22, 2004.</span>
<a name="14279"><font size=-1>14279     </font></a><span class="string"></span>
<a name="14280"><font size=-1>14280     </font></a><span class="string">Notes: Several requirements must be fulfilled by the wavefunction. Among</span>
<a name="14281"><font size=-1>14281     </font></a><span class="string">them, two are mandatory:</span>
<a name="14282"><font size=-1>14282     </font></a><span class="string"></span>
<a name="14283"><font size=-1>14283     </font></a><span class="string">    * 1. An uniform grid of k-points, including the GAMMA point must be used.</span>
<a name="14284"><font size=-1>14284     </font></a><span class="string">    * 2. The use of time reversal symmetry is not allowed (istwfk=1)</span>
<a name="14285"><font size=-1>14285     </font></a><span class="string">    * 3. The list of k-points must be ordered, such that the coordinates, namely</span>
<a name="14286"><font size=-1>14286     </font></a><span class="string">      three-components vectors has the third index varying the most rapidly, then the second index, then the first index</span>
<a name="14287"><font size=-1>14287     </font></a><span class="string"></span>
<a name="14288"><font size=-1>14288     </font></a><span class="string">If these requirement are not fulfilled, the program will stop and an error</span>
<a name="14289"><font size=-1>14289     </font></a><span class="string">message is returned.</span>
<a name="14290"><font size=-1>14290     </font></a><span class="string"></span>
<a name="14291"><font size=-1>14291     </font></a><span class="string">As an example of k-point grid in case of systems that have some 3D character</span>
<a name="14292"><font size=-1>14292     </font></a><span class="string">(1D systems are easy):</span>
<a name="14293"><font size=-1>14293     </font></a><span class="string"></span>
<a name="14294"><font size=-1>14294     </font></a><span class="string">    nkpt 8</span>
<a name="14295"><font size=-1>14295     </font></a><span class="string">    kpt  0   0   0</span>
<a name="14296"><font size=-1>14296     </font></a><span class="string">    0   0   1/2</span>
<a name="14297"><font size=-1>14297     </font></a><span class="string">    0   1/2 0</span>
<a name="14298"><font size=-1>14298     </font></a><span class="string">    0   1/2 1/2</span>
<a name="14299"><font size=-1>14299     </font></a><span class="string">    1/2 0   0</span>
<a name="14300"><font size=-1>14300     </font></a><span class="string">    1/2 0   1/2</span>
<a name="14301"><font size=-1>14301     </font></a><span class="string">    1/2 1/2 0</span>
<a name="14302"><font size=-1>14302     </font></a><span class="string">    1/2 1/2 1/2</span>
<a name="14303"><font size=-1>14303     </font></a><span class="string">    istwfk 8*1</span>
<a name="14304"><font size=-1>14304     </font></a><span class="string"></span>
<a name="14305"><font size=-1>14305     </font></a><span class="string">Also, in order to use WanT as a post-processing program for ABINIT you might</span>
<a name="14306"><font size=-1>14306     </font></a><span class="string">have to recompile it with the appropriate flags (see ABINIT makefile). Up to</span>
<a name="14307"><font size=-1>14307     </font></a><span class="string">now only the -convert big-endian was found to be mandatory, for machines with</span>
<a name="14308"><font size=-1>14308     </font></a><span class="string">little-endian default choice.</span>
<a name="14309"><font size=-1>14309     </font></a><span class="string"></span>
<a name="14310"><font size=-1>14310     </font></a><span class="string">  * [[prtwant]] = 2 --&gt; Use the **ABINIT- Wannier90** interface.</span>
<a name="14311"><font size=-1>14311     </font></a><span class="string"></span>
<a name="14312"><font size=-1>14312     </font></a><span class="string">ABINIT will produce the input files required by Wannier90 and it will run</span>
<a name="14313"><font size=-1>14313     </font></a><span class="string">Wannier90 to produce the Maximally-locallized Wannier functions (see [</span>
<a name="14314"><font size=-1>14314     </font></a><span class="string">http://www.wannier.org ](http://www.wannier.org) ).</span>
<a name="14315"><font size=-1>14315     </font></a><span class="string"></span>
<a name="14316"><font size=-1>14316     </font></a><span class="string">!!! Notes</span>
<a name="14317"><font size=-1>14317     </font></a><span class="string"></span>
<a name="14318"><font size=-1>14318     </font></a><span class="string">    * The files that are created can also be used by Wannier90 in stand-alone mode.</span>
<a name="14319"><font size=-1>14319     </font></a><span class="string">    * In order to use Wannier90 as a post-processing program for ABINIT you might have to recompile it with the appropriate flags (see ABINIT makefile). You might use ./configure --enable-wannier90</span>
<a name="14320"><font size=-1>14320     </font></a><span class="string">    * There are some other variables related to the interface of Wannier90 and ABINIT. See [[varset:w90]].</span>
<a name="14321"><font size=-1>14321     </font></a><span class="string"></span>
<a name="14322"><font size=-1>14322     </font></a><span class="string">  * [[prtwant]] = 3 --&gt; Use the **ABINIT- Wannier90** interface after converting the input wavefunctions to **quasiparticle** wavefunctions.</span>
<a name="14323"><font size=-1>14323     </font></a><span class="string"></span>
<a name="14324"><font size=-1>14324     </font></a><span class="string">ABINIT will produce the input files required by Wannier90 and it will run</span>
<a name="14325"><font size=-1>14325     </font></a><span class="string">Wannier90 to produce the Maximally-localized Wannier functions (see [</span>
<a name="14326"><font size=-1>14326     </font></a><span class="string">http://www.wannier.org ](http://www.wannier.org) ).</span>
<a name="14327"><font size=-1>14327     </font></a><span class="string"></span>
<a name="14328"><font size=-1>14328     </font></a><span class="string">!!! Notes</span>
<a name="14329"><font size=-1>14329     </font></a><span class="string"></span>
<a name="14330"><font size=-1>14330     </font></a><span class="string">    * An input file of LDA wave functions is required which is completely consistent with the _KSS file used in the self-consistent GW calculation. This means that [[kssform]] 3 must be used to create the _KSS file and the output _WFK file from the same run must be used as input here.</span>
<a name="14331"><font size=-1>14331     </font></a><span class="string">    * Wannier90 requires [[nshiftk]] = 1, and [[shiftk]] =  0 0 0 is recommended. The k-point set used for the GW calculation, typically the irreducible BZ set created using [[kptopt]] = 1, and that for the Abinit- Wannier90 interface must be consistent.</span>
<a name="14332"><font size=-1>14332     </font></a><span class="string">    * Full-BZ wavefunctions should be generated in the run calling the interface by setting [[kptopt]] = 3, [[iscf]] = -2, and [[nstep]] = 3. This will simply use symmetry to transform the input IBZ wavefunctions to the full BZ set, still consistent with the GW _KSS input.</span>
<a name="14333"><font size=-1>14333     </font></a><span class="string">    * The final _QPS file created by the self-consistent GW run is required as input.</span>
<a name="14334"><font size=-1>14334     </font></a><span class="string">    * Any value of [[gwcalctyp]] between between 20 and 29 should be suitable, so, for example, Hartree-Fock maximally-localized Wannier functions could be generated setting [[gwcalctyp]] = 25.</span>
<a name="14335"><font size=-1>14335     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14336"><font size=-1>14336     </font></a><span class="default">),</span>
<a name="14337"><font size=-1>14337     </font></a><span class="default"></span>
<a name="14338"><font size=-1>14338     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14339"><font size=-1>14339     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtwf&quot;</span><span class="default">,</span>
<a name="14340"><font size=-1>14340     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14341"><font size=-1>14341     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14342"><font size=-1>14342     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">, </span><span class="string">'vdw_useful'</span><span class="default">],</span>
<a name="14343"><font size=-1>14343     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14344"><font size=-1>14344     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nimage]] &gt; 1'</span><span class="default">: </span><span class="number">0</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">1</span><span class="default">}),</span>
<a name="14345"><font size=-1>14345     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT the WaveFunction&quot;</span><span class="default">,</span>
<a name="14346"><font size=-1>14346     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14347"><font size=-1>14347     </font></a><span class="string">If [[prtwf]] = 1, provide output of wavefunction and eigenvalue file</span>
<a name="14348"><font size=-1>14348     </font></a><span class="string">The file structure of this unformatted output file is described in [[help:abinit#wfkfile|this section]].</span>
<a name="14349"><font size=-1>14349     </font></a><span class="string">For a standard ground-state calculation, the name of the wavefunction file</span>
<a name="14350"><font size=-1>14350     </font></a><span class="string">will be the root output name, followed by _WFK. If [[nqpt]] = 1, the root name</span>
<a name="14351"><font size=-1>14351     </font></a><span class="string">will be followed by _WFQ. For response-function calculations, the root name</span>
<a name="14352"><font size=-1>14352     </font></a><span class="string">will be followed by _1WFx, where x is the number of the perturbation. The</span>
<a name="14353"><font size=-1>14353     </font></a><span class="string">dataset information will be added as well, if relevant.</span>
<a name="14354"><font size=-1>14354     </font></a><span class="string">No wavefunction output is provided by [[prtwf]] = 0.</span>
<a name="14355"><font size=-1>14355     </font></a><span class="string">If [[prtwf]] = -1, the code writes the wavefunction file only if convergence is</span>
<a name="14356"><font size=-1>14356     </font></a><span class="string">not achieved in the self-consistent cycle.</span>
<a name="14357"><font size=-1>14357     </font></a><span class="string"></span>
<a name="14358"><font size=-1>14358     </font></a><span class="string"></span>
<a name="14359"><font size=-1>14359     </font></a><span class="string">If [[prtwf]] = 2, a file pwfn.data is produced, to be used as input for the</span>
<a name="14360"><font size=-1>14360     </font></a><span class="string">CASINO QMC code. See more explanation at the end of this section.</span>
<a name="14361"><font size=-1>14361     </font></a><span class="string">If [[prtwf]] = 3, the file that is created is nearly the same as with</span>
<a name="14362"><font size=-1>14362     </font></a><span class="string">[[prtwf]] = 1, except that the records that should contain the wavefunction is</span>
<a name="14363"><font size=-1>14363     </font></a><span class="string">empty (so, such records exist, but store nothing). This is useful to generate</span>
<a name="14364"><font size=-1>14364     </font></a><span class="string">size-reduced DDK files, to perform an optic run. Indeed, in the latter case,</span>
<a name="14365"><font size=-1>14365     </font></a><span class="string">only matrix elements are needed [so, no wavefunction], but possibly a large</span>
<a name="14366"><font size=-1>14366     </font></a><span class="string">number of conduction bands, so that the DDK file might be huge if it contains</span>
<a name="14367"><font size=-1>14367     </font></a><span class="string">the wavefunctions.</span>
<a name="14368"><font size=-1>14368     </font></a><span class="string"></span>
<a name="14369"><font size=-1>14369     </font></a><span class="string">Further explanation for the [[prtwf]] = 2 case. To produce a wave function</span>
<a name="14370"><font size=-1>14370     </font></a><span class="string">suitable for use as a CASINO trial wave function, certain ABINIT parameters</span>
<a name="14371"><font size=-1>14371     </font></a><span class="string">must be set correctly. Primarily, CASINO (and QMC methods generally) can only</span>
<a name="14372"><font size=-1>14372     </font></a><span class="string">take advantage of time-reversal symmetry, and not the full set of symmetries</span>
<a name="14373"><font size=-1>14373     </font></a><span class="string">of the crystal structure. Therefore, ABINIT must be instructed to generate</span>
<a name="14374"><font size=-1>14374     </font></a><span class="string">k-points not just in the Irreducible Brillouin Zone, but in a full half of the</span>
<a name="14375"><font size=-1>14375     </font></a><span class="string">Brillouin Zone (using time-reversal symmetry to generate the other half).</span>
<a name="14376"><font size=-1>14376     </font></a><span class="string">Additionally, unless instructed otherwise, Abinit avoids the need for internal</span>
<a name="14377"><font size=-1>14377     </font></a><span class="string">storage of many of the coefficients of its wave functions for k-points that</span>
<a name="14378"><font size=-1>14378     </font></a><span class="string">have the property 2k=G_latt, where G_latt is a reciprocal lattice vector, by</span>
<a name="14379"><font size=-1>14379     </font></a><span class="string">making use of the property that c_k(G)=c^*_k(-G-G_latt). Abinit must be</span>
<a name="14380"><font size=-1>14380     </font></a><span class="string">instructed not to do this in order to output the full set of coefficients for</span>
<a name="14381"><font size=-1>14381     </font></a><span class="string">use in CASINO. See the ABINIT theoretical background documents</span>
<a name="14382"><font size=-1>14382     </font></a><span class="string">ABINIT/Infos/Theory/geometry.pdf and ABINIT/Infos/Theory/1WF.pdf for more</span>
<a name="14383"><font size=-1>14383     </font></a><span class="string">information.</span>
<a name="14384"><font size=-1>14384     </font></a><span class="string">The first of these requirements is met by setting the ABINIT input variable</span>
<a name="14385"><font size=-1>14385     </font></a><span class="string">[[kptopt]] to 2 and the second by setting</span>
<a name="14386"><font size=-1>14386     </font></a><span class="string">[[istwfk]] to 1 for all the k points. Since</span>
<a name="14387"><font size=-1>14387     </font></a><span class="string">CASINO is typically run with relatively small numbers of k-points, this is</span>
<a name="14388"><font size=-1>14388     </font></a><span class="string">easily done by defining an array of &quot;1&quot; in the input file.</span>
<a name="14389"><font size=-1>14389     </font></a><span class="string">For example, for the 8 k-points generated with ngkpt 2 2 2, we add the</span>
<a name="14390"><font size=-1>14390     </font></a><span class="string">following lines to the input file:</span>
<a name="14391"><font size=-1>14391     </font></a><span class="string"></span>
<a name="14392"><font size=-1>14392     </font></a><span class="string">    # Turn off special storage mode for time-reversal k-points</span>
<a name="14393"><font size=-1>14393     </font></a><span class="string">    istwfk 1 1 1 1 1 1 1 1</span>
<a name="14394"><font size=-1>14394     </font></a><span class="string">    # Use only time reversal symmetry, not full set of symmetries.</span>
<a name="14395"><font size=-1>14395     </font></a><span class="string">    kptopt 2</span>
<a name="14396"><font size=-1>14396     </font></a><span class="string"></span>
<a name="14397"><font size=-1>14397     </font></a><span class="string"></span>
<a name="14398"><font size=-1>14398     </font></a><span class="string">Other useful input variables of relevance to the plane waves ABINIT will</span>
<a name="14399"><font size=-1>14399     </font></a><span class="string">produce include ecut, nshiftk, shiftk, nband, occopt, occ, spinat and nsppol</span>
<a name="14400"><font size=-1>14400     </font></a><span class="string">(see relevant input variable documents in ABINIT/Infos/). If ABINIT is run in</span>
<a name="14401"><font size=-1>14401     </font></a><span class="string">multiple dataset mode, the different wave functions for the various datasets</span>
<a name="14402"><font size=-1>14402     </font></a><span class="string">are exported as pwfn1.data, pwfn2.data, ..., pwfnn.data where the numbers are</span>
<a name="14403"><font size=-1>14403     </font></a><span class="string">the contents of the contents of the input array jdtset (defaults to</span>
<a name="14404"><font size=-1>14404     </font></a><span class="string">1,2,...,ndtset).</span>
<a name="14405"><font size=-1>14405     </font></a><span class="string">Once the routine is incorporated into the ABINIT package it is anticipated</span>
<a name="14406"><font size=-1>14406     </font></a><span class="string">that there will be an input variable to control whether or not a CASINO</span>
<a name="14407"><font size=-1>14407     </font></a><span class="string">pwfn.data file is written.</span>
<a name="14408"><font size=-1>14408     </font></a><span class="string"></span>
<a name="14409"><font size=-1>14409     </font></a><span class="string">Other issues related to [[prtwf]] = 2.</span>
<a name="14410"><font size=-1>14410     </font></a><span class="string">The exporter does not currently work when ABINIT is used in parallel mode on</span>
<a name="14411"><font size=-1>14411     </font></a><span class="string">multiple processors if k-point parallelism is chosen. ABINIT does not store</span>
<a name="14412"><font size=-1>14412     </font></a><span class="string">the full wave function on each processor but rather splits the k-points</span>
<a name="14413"><font size=-1>14413     </font></a><span class="string">between the processors, so no one processor could write out the whole file.</span>
<a name="14414"><font size=-1>14414     </font></a><span class="string">Clearly this could be fixed but we have not done it yet. The sort of plane</span>
<a name="14415"><font size=-1>14415     </font></a><span class="string">wave DFT calculations usually required to generate QMC trial wave functions</span>
<a name="14416"><font size=-1>14416     </font></a><span class="string">execute very rapidly anyway and will generally not require a parallel</span>
<a name="14417"><font size=-1>14417     </font></a><span class="string">machines. The outqmc routine currently bails out with an error if this</span>
<a name="14418"><font size=-1>14418     </font></a><span class="string">combination of modes is selected - this will hopefully be fixed later.</span>
<a name="14419"><font size=-1>14419     </font></a><span class="string">There has not been very extensive testing of less common situations such as</span>
<a name="14420"><font size=-1>14420     </font></a><span class="string">different numbers of bands for different k-points, and more complicated spin</span>
<a name="14421"><font size=-1>14421     </font></a><span class="string">polarized systems, so care should be taken when using the output in these circumstances.</span>
<a name="14422"><font size=-1>14422     </font></a><span class="string">If there is any doubt about the output of this routine, the first place to</span>
<a name="14423"><font size=-1>14423     </font></a><span class="string">look is the log file produced by ABINIT: if there are any warnings about</span>
<a name="14424"><font size=-1>14424     </font></a><span class="string">incorrectly normalized orbitals or non-integer occupation numbers there is</span>
<a name="14425"><font size=-1>14425     </font></a><span class="string">probably something set wrong in the input file.</span>
<a name="14426"><font size=-1>14426     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14427"><font size=-1>14427     </font></a><span class="default">),</span>
<a name="14428"><font size=-1>14428     </font></a><span class="default"></span>
<a name="14429"><font size=-1>14429     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14430"><font size=-1>14430     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtwf_full&quot;</span><span class="default">,</span>
<a name="14431"><font size=-1>14431     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14432"><font size=-1>14432     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14433"><font size=-1>14433     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="14434"><font size=-1>14434     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14435"><font size=-1>14435     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14436"><font size=-1>14436     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Wavefunction file on the FULL mesh&quot;</span><span class="default">,</span>
<a name="14437"><font size=-1>14437     </font></a><span class="default">    requires=</span><span class="string">&quot;[[prtwf]] == 1&quot;</span><span class="default">,</span>
<a name="14438"><font size=-1>14438     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14439"><font size=-1>14439     </font></a><span class="string">If set to 1 in a ground-state calculation, the code will output another WFK</span>
<a name="14440"><font size=-1>14440     </font></a><span class="string">file (with extension FULL_WFK) containing the wavefunctions in the full BZ as</span>
<a name="14441"><font size=-1>14441     </font></a><span class="string">well as a text file with the tables used for the tetrahedron method. Note that</span>
<a name="14442"><font size=-1>14442     </font></a><span class="string">prtwf_full requires [[prtwf]] == 1 and a ground-state calculation done on a</span>
<a name="14443"><font size=-1>14443     </font></a><span class="string">homogeneous k-mesh (see [[ngkpt]] and [[shiftk]]). The tetrahedron table is</span>
<a name="14444"><font size=-1>14444     </font></a><span class="string">produced only if the number of k-points in the irreducible zone ([[nkpt]]) is</span>
<a name="14445"><font size=-1>14445     </font></a><span class="string">greater than 3.</span>
<a name="14446"><font size=-1>14446     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14447"><font size=-1>14447     </font></a><span class="default">),</span>
<a name="14448"><font size=-1>14448     </font></a><span class="default"></span>
<a name="14449"><font size=-1>14449     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14450"><font size=-1>14450     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtxml&quot;</span><span class="default">,</span>
<a name="14451"><font size=-1>14451     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="14452"><font size=-1>14452     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14453"><font size=-1>14453     </font></a><span class="default">    topics=[</span><span class="string">'printing_prgs'</span><span class="default">],</span>
<a name="14454"><font size=-1>14454     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14455"><font size=-1>14455     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14456"><font size=-1>14456     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT an XML output&quot;</span><span class="default">,</span>
<a name="14457"><font size=-1>14457     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14458"><font size=-1>14458     </font></a><span class="string">Create an XML output with common values. The corresponding DTD is distributed</span>
<a name="14459"><font size=-1>14459     </font></a><span class="string">in sources as extras/post_processing/abinitRun.dtd. All the DTD is not yet</span>
<a name="14460"><font size=-1>14460     </font></a><span class="string">implemented and this one is currently restricted to ground-state computations</span>
<a name="14461"><font size=-1>14461     </font></a><span class="string">(and derivative such as geometry optimisation).</span>
<a name="14462"><font size=-1>14462     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14463"><font size=-1>14463     </font></a><span class="default">),</span>
<a name="14464"><font size=-1>14464     </font></a><span class="default"></span>
<a name="14465"><font size=-1>14465     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14466"><font size=-1>14466     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ptcharge&quot;</span><span class="default">,</span>
<a name="14467"><font size=-1>14467     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="14468"><font size=-1>14468     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14469"><font size=-1>14469     </font></a><span class="default">    topics=[</span><span class="string">'EFG_basic'</span><span class="default">],</span>
<a name="14470"><font size=-1>14470     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="14471"><font size=-1>14471     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="14472"><font size=-1>14472     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PoinT CHARGEs&quot;</span><span class="default">,</span>
<a name="14473"><font size=-1>14473     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[prtefg]]&gt;=3&quot;</span><span class="default">,</span>
<a name="14474"><font size=-1>14474     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14475"><font size=-1>14475     </font></a><span class="string">  * Array of point charges, in atomic units, of the nuclei. In the normal computation of electric field gradients (see [[prtefg]]) the ionic contribution is calculated from the core charges of the atomic sites. Thus for example in a PAW data set for oxygen where the core is $1s^{2}$, the core charge is +6 (total nuclear charge minus core electron charge). In point charge models, which are much less accurate than PAW calculations, all atomic sites are treated as ions with charges determined by their valence states. In such a case oxygen almost always would have a point charge of -2. The present variable taken together with [[prtefg]] performs a full PAW computation of the electric field gradient and also a simple point charge computation. The user inputs whatever point charges he/she wishes for each atom type.</span>
<a name="14476"><font size=-1>14476     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14477"><font size=-1>14477     </font></a><span class="default">),</span>
<a name="14478"><font size=-1>14478     </font></a><span class="default"></span>
<a name="14479"><font size=-1>14479     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14480"><font size=-1>14480     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ptgroupma&quot;</span><span class="default">,</span>
<a name="14481"><font size=-1>14481     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="14482"><font size=-1>14482     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14483"><font size=-1>14483     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_internal'</span><span class="default">, </span><span class="string">'SmartSymm_internal'</span><span class="default">],</span>
<a name="14484"><font size=-1>14484     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14485"><font size=-1>14485     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14486"><font size=-1>14486     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PoinT GROUP number for the MAgnetic space group&quot;</span><span class="default">,</span>
<a name="14487"><font size=-1>14487     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="14488"><font size=-1>14488     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14489"><font size=-1>14489     </font></a><span class="string">This internal variable characterizes a Shubnikov type III magnetic space group</span>
<a name="14490"><font size=-1>14490     </font></a><span class="string">(anti-ferromagnetic space group). The user is advised to consult [[cite:Bradley1972]].</span>
<a name="14491"><font size=-1>14491     </font></a><span class="string">A Shubnikov type III magnetic space group might be defined by its Fedorov</span>
<a name="14492"><font size=-1>14492     </font></a><span class="string">space group (set of all spatial symmetries, irrespective of their magnetic</span>
<a name="14493"><font size=-1>14493     </font></a><span class="string">action), and the halving space group (only the symmetries that do not change</span>
<a name="14494"><font size=-1>14494     </font></a><span class="string">the magnetization).</span>
<a name="14495"><font size=-1>14495     </font></a><span class="string">The specification of the halving space group might be done by specifying, for</span>
<a name="14496"><font size=-1>14496     </font></a><span class="string">each point symmetry, the magnetic action. See Table 7.1 of the above-mentioned</span>
<a name="14497"><font size=-1>14497     </font></a><span class="string">reference. Magnetic point groups are numbered from 1 to 58.</span>
<a name="14498"><font size=-1>14498     </font></a><span class="string"></span>
<a name="14499"><font size=-1>14499     </font></a><span class="string">Related input variables: [[spgroup]], [[spgroupma]], [[genafm]]</span>
<a name="14500"><font size=-1>14500     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14501"><font size=-1>14501     </font></a><span class="default">),</span>
<a name="14502"><font size=-1>14502     </font></a><span class="default"></span>
<a name="14503"><font size=-1>14503     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14504"><font size=-1>14504     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pvelmax&quot;</span><span class="default">,</span>
<a name="14505"><font size=-1>14505     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="14506"><font size=-1>14506     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14507"><font size=-1>14507     </font></a><span class="default">    topics=[</span><span class="string">'RandStopPow_basic'</span><span class="default">],</span>
<a name="14508"><font size=-1>14508     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="14509"><font size=-1>14509     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">1.0</span><span class="default">),</span>
<a name="14510"><font size=-1>14510     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Particle VELocity MAXimum&quot;</span><span class="default">,</span>
<a name="14511"><font size=-1>14511     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3&quot;</span><span class="default">,</span>
<a name="14512"><font size=-1>14512     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14513"><font size=-1>14513     </font></a><span class="string">When [[npvel]] is larger than 0, it performs electronic stopping power</span>
<a name="14514"><font size=-1>14514     </font></a><span class="string">calculations on a velocity grid along the direction determined by [[pvelmax]].</span>
<a name="14515"><font size=-1>14515     </font></a><span class="string">The vector [[pvelmax]] defines both the direction and the maximum velocity.</span>
<a name="14516"><font size=-1>14516     </font></a><span class="string">[[pvelmax]] is input in Cartesian coordinates.</span>
<a name="14517"><font size=-1>14517     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14518"><font size=-1>14518     </font></a><span class="default">),</span>
<a name="14519"><font size=-1>14519     </font></a><span class="default"></span>
<a name="14520"><font size=-1>14520     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14521"><font size=-1>14521     </font></a><span class="default">    abivarname=</span><span class="string">&quot;pw_unbal_thresh&quot;</span><span class="default">,</span>
<a name="14522"><font size=-1>14522     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="14523"><font size=-1>14523     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14524"><font size=-1>14524     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="14525"><font size=-1>14525     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14526"><font size=-1>14526     </font></a><span class="default">    defaultval=</span><span class="string">&quot;40%&quot;</span><span class="default">,</span>
<a name="14527"><font size=-1>14527     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Plane Wave UNBALancing: THRESHold for balancing procedure&quot;</span><span class="default">,</span>
<a name="14528"><font size=-1>14528     </font></a><span class="default">    requires=</span><span class="string">&quot;[[paral_kgb]] == 1&quot;</span><span class="default">,</span>
<a name="14529"><font size=-1>14529     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14530"><font size=-1>14530     </font></a><span class="string">This parameter (in %) activates a load balancing procedure when the</span>
<a name="14531"><font size=-1>14531     </font></a><span class="string">distribution of plane wave components over MPI processes is not optimal. The</span>
<a name="14532"><font size=-1>14532     </font></a><span class="string">balancing procedure is activated when the ratio between the number of plane</span>
<a name="14533"><font size=-1>14533     </font></a><span class="string">waves treated by a processor and the ideal one is higher than</span>
<a name="14534"><font size=-1>14534     </font></a><span class="string">_pw_unbal_thresh_ %.</span>
<a name="14535"><font size=-1>14535     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14536"><font size=-1>14536     </font></a><span class="default">),</span>
<a name="14537"><font size=-1>14537     </font></a><span class="default"></span>
<a name="14538"><font size=-1>14538     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14539"><font size=-1>14539     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qmass&quot;</span><span class="default">,</span>
<a name="14540"><font size=-1>14540     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="14541"><font size=-1>14541     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14542"><font size=-1>14542     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_basic'</span><span class="default">, </span><span class="string">'MolecularDynamics_basic'</span><span class="default">],</span>
<a name="14543"><font size=-1>14543     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nnos]]'</span><span class="default">],</span>
<a name="14544"><font size=-1>14544     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">10.0</span><span class="default">),</span>
<a name="14545"><font size=-1>14545     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Q thermostat MASS&quot;</span><span class="default">,</span>
<a name="14546"><font size=-1>14546     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14547"><font size=-1>14547     </font></a><span class="string">This are the masses of the chains of [[nnos]] thermostats to be used when</span>
<a name="14548"><font size=-1>14548     </font></a><span class="string">[[ionmov]] = 13 (Molecular Dynamics) or [[imgmov]] = 13 (Path Integral Molecular</span>
<a name="14549"><font size=-1>14549     </font></a><span class="string">Dynamics).</span>
<a name="14550"><font size=-1>14550     </font></a><span class="string"></span>
<a name="14551"><font size=-1>14551     </font></a><span class="string">If [[ionmov]] = 13 (Molecular Dynamics), this temperature control can be used</span>
<a name="14552"><font size=-1>14552     </font></a><span class="string">with  [[optcell]] =0, 1 (homogeneous cell deformation) or 2 (full cell</span>
<a name="14553"><font size=-1>14553     </font></a><span class="string">deformation).</span>
<a name="14554"><font size=-1>14554     </font></a><span class="string">If [[imgmov]] = 13 (Path Integral Molecular Dynamics), this temperature control</span>
<a name="14555"><font size=-1>14555     </font></a><span class="string">can be used with  [[optcell]] =0 (NVT ensemble) or 2 (fully flexible NPT</span>
<a name="14556"><font size=-1>14556     </font></a><span class="string">ensemble). In that case, [[optcell]] = 2 iS NOT USABLE yet.</span>
<a name="14557"><font size=-1>14557     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14558"><font size=-1>14558     </font></a><span class="default">),</span>
<a name="14559"><font size=-1>14559     </font></a><span class="default"></span>
<a name="14560"><font size=-1>14560     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14561"><font size=-1>14561     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qprtrb&quot;</span><span class="default">,</span>
<a name="14562"><font size=-1>14562     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="14563"><font size=-1>14563     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14564"><font size=-1>14564     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_useful'</span><span class="default">],</span>
<a name="14565"><font size=-1>14565     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="14566"><font size=-1>14566     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="14567"><font size=-1>14567     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Q-wavevector of the PERTurbation&quot;</span><span class="default">,</span>
<a name="14568"><font size=-1>14568     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14569"><font size=-1>14569     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vprtrb]]&quot;</span><span class="default">,</span>
<a name="14570"><font size=-1>14570     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14571"><font size=-1>14571     </font></a><span class="string">Gives the wavevector, in units of reciprocal lattice primitive translations,</span>
<a name="14572"><font size=-1>14572     </font></a><span class="string">of a perturbing potential of strength [[vprtrb]]. See [[vprtrb]] for more</span>
<a name="14573"><font size=-1>14573     </font></a><span class="string">explanation.</span>
<a name="14574"><font size=-1>14574     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14575"><font size=-1>14575     </font></a><span class="default">),</span>
<a name="14576"><font size=-1>14576     </font></a><span class="default"></span>
<a name="14577"><font size=-1>14577     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14578"><font size=-1>14578     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qpt&quot;</span><span class="default">,</span>
<a name="14579"><font size=-1>14579     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="14580"><font size=-1>14580     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14581"><font size=-1>14581     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="14582"><font size=-1>14582     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="14583"><font size=-1>14583     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="14584"><font size=-1>14584     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Q PoinT&quot;</span><span class="default">,</span>
<a name="14585"><font size=-1>14585     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="14586"><font size=-1>14586     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14587"><font size=-1>14587     </font></a><span class="string">Only used if [[nqpt]] = 1.</span>
<a name="14588"><font size=-1>14588     </font></a><span class="string"></span>
<a name="14589"><font size=-1>14589     </font></a><span class="string">Combined with [[qptnrm]], define the q vector [[qptn]](1:3) in the case</span>
<a name="14590"><font size=-1>14590     </font></a><span class="string">[[qptopt]] = 0.</span>
<a name="14591"><font size=-1>14591     </font></a><span class="string"></span>
<a name="14592"><font size=-1>14592     </font></a><span class="string">This input variable is not internal ([[qptn]](1:3) is used instead), but is</span>
<a name="14593"><font size=-1>14593     </font></a><span class="string">used to echo the value of [[qptn]](1:3), with renormalisation factor one.</span>
<a name="14594"><font size=-1>14594     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14595"><font size=-1>14595     </font></a><span class="default">),</span>
<a name="14596"><font size=-1>14596     </font></a><span class="default"></span>
<a name="14597"><font size=-1>14597     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14598"><font size=-1>14598     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qptdm&quot;</span><span class="default">,</span>
<a name="14599"><font size=-1>14599     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="14600"><font size=-1>14600     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14601"><font size=-1>14601     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_useful'</span><span class="default">],</span>
<a name="14602"><font size=-1>14602     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nqptdm]]'</span><span class="default">],</span>
<a name="14603"><font size=-1>14603     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="14604"><font size=-1>14604     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Q-PoinTs for the Dielectric Matrix&quot;</span><span class="default">,</span>
<a name="14605"><font size=-1>14605     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[nqptdm]]!=0&quot;</span><span class="default">,</span>
<a name="14606"><font size=-1>14606     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14607"><font size=-1>14607     </font></a><span class="string">[[qptdm]] contains the set of q points used in the screening part of ABINIT,</span>
<a name="14608"><font size=-1>14608     </font></a><span class="string">instead of the automatic generation of the q points when [[nqptdm]] = 0. These q</span>
<a name="14609"><font size=-1>14609     </font></a><span class="string">points are given in terms of reciprocal space primitive translations (**not** in</span>
<a name="14610"><font size=-1>14610     </font></a><span class="string">cartesian coordinates!). For further explanation, see the input variable</span>
<a name="14611"><font size=-1>14611     </font></a><span class="string">[[nqptdm]].</span>
<a name="14612"><font size=-1>14612     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14613"><font size=-1>14613     </font></a><span class="default">),</span>
<a name="14614"><font size=-1>14614     </font></a><span class="default"></span>
<a name="14615"><font size=-1>14615     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14616"><font size=-1>14616     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qptn&quot;</span><span class="default">,</span>
<a name="14617"><font size=-1>14617     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="14618"><font size=-1>14618     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14619"><font size=-1>14619     </font></a><span class="default">    topics=[</span><span class="string">' DFPT_internal'</span><span class="default">],</span>
<a name="14620"><font size=-1>14620     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="14621"><font size=-1>14621     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="14622"><font size=-1>14622     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Q-PoinT re-Normalized&quot;</span><span class="default">,</span>
<a name="14623"><font size=-1>14623     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="14624"><font size=-1>14624     </font></a><span class="default">    requires=</span><span class="string">&quot;[[nqpt]] == 1&quot;</span><span class="default">,</span>
<a name="14625"><font size=-1>14625     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14626"><font size=-1>14626     </font></a><span class="string">Only used if [[nqpt]] = 1.</span>
<a name="14627"><font size=-1>14627     </font></a><span class="string"></span>
<a name="14628"><font size=-1>14628     </font></a><span class="string">In ground-state calculation, the vector [[qptn]](1:3) is added to each</span>
<a name="14629"><font size=-1>14629     </font></a><span class="string">renormalized k point (whatever the value of [[kptopt]] that was used) to</span>
<a name="14630"><font size=-1>14630     </font></a><span class="string">generate the normalized, shifted, set of k-points [[kptns]](1:3,1: **nkpt** ).</span>
<a name="14631"><font size=-1>14631     </font></a><span class="string">In response-function calculations, [[qptn]](1:3) is the wavevector of the</span>
<a name="14632"><font size=-1>14632     </font></a><span class="string">phonon-type calculation.</span>
<a name="14633"><font size=-1>14633     </font></a><span class="string"></span>
<a name="14634"><font size=-1>14634     </font></a><span class="string">[[qptn]](1:3) can be produced on the basis of the different methods described</span>
<a name="14635"><font size=-1>14635     </font></a><span class="string">in [[qptopt]], like using [[qpt]](1:3) with renormalisation provided by</span>
<a name="14636"><font size=-1>14636     </font></a><span class="string">[[qptnrm]], or using the other possibilities defined by [[iqpt]], [[ngqpt]],</span>
<a name="14637"><font size=-1>14637     </font></a><span class="string">[[nshiftq]], [[qptrlatt]], [[shiftq]].</span>
<a name="14638"><font size=-1>14638     </font></a><span class="string"></span>
<a name="14639"><font size=-1>14639     </font></a><span class="string">For insulators, there is no restriction on the q-points to be used for the</span>
<a name="14640"><font size=-1>14640     </font></a><span class="string">perturbations. By contrast, for metals, for the time being, it is advised to</span>
<a name="14641"><font size=-1>14641     </font></a><span class="string">take q points for which the k and k+q grids are the same (when the periodicity</span>
<a name="14642"><font size=-1>14642     </font></a><span class="string">in reciprocal space is taken into account). Tests remain to be done to see</span>
<a name="14643"><font size=-1>14643     </font></a><span class="string">whether other q points might be allowed (perhaps with some modification of the code).</span>
<a name="14644"><font size=-1>14644     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14645"><font size=-1>14645     </font></a><span class="default">),</span>
<a name="14646"><font size=-1>14646     </font></a><span class="default"></span>
<a name="14647"><font size=-1>14647     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14648"><font size=-1>14648     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qptnrm&quot;</span><span class="default">,</span>
<a name="14649"><font size=-1>14649     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="14650"><font size=-1>14650     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14651"><font size=-1>14651     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="14652"><font size=-1>14652     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14653"><font size=-1>14653     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="14654"><font size=-1>14654     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Q PoinTs NoRMalization&quot;</span><span class="default">,</span>
<a name="14655"><font size=-1>14655     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="14656"><font size=-1>14656     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14657"><font size=-1>14657     </font></a><span class="string">Only used if [[nqpt]] = 1 and [[qptopt]] = 0</span>
<a name="14658"><font size=-1>14658     </font></a><span class="string"></span>
<a name="14659"><font size=-1>14659     </font></a><span class="string">Provides re-normalization of [[qpt]]. Must be positive, non-zero. The actual q</span>
<a name="14660"><font size=-1>14660     </font></a><span class="string">vector (renormalized) is [[qptn]](1:3)= [[qpt]](1:3)/[[qptnrm]].</span>
<a name="14661"><font size=-1>14661     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14662"><font size=-1>14662     </font></a><span class="default">),</span>
<a name="14663"><font size=-1>14663     </font></a><span class="default"></span>
<a name="14664"><font size=-1>14664     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14665"><font size=-1>14665     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qptopt&quot;</span><span class="default">,</span>
<a name="14666"><font size=-1>14666     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="14667"><font size=-1>14667     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14668"><font size=-1>14668     </font></a><span class="default">    topics=[</span><span class="string">'q-points_basic'</span><span class="default">],</span>
<a name="14669"><font size=-1>14669     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14670"><font size=-1>14670     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14671"><font size=-1>14671     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;QPoinTs OPTion&quot;</span><span class="default">,</span>
<a name="14672"><font size=-1>14672     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="14673"><font size=-1>14673     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14674"><font size=-1>14674     </font></a><span class="string">Only used if [[nqpt]] = 1.</span>
<a name="14675"><font size=-1>14675     </font></a><span class="string"></span>
<a name="14676"><font size=-1>14676     </font></a><span class="string">Controls the set up to generate the Q point [[qptn]](1:3) to be used for the</span>
<a name="14677"><font size=-1>14677     </font></a><span class="string">specific dataset, either as a shift of k-point grid in ground-state</span>
<a name="14678"><font size=-1>14678     </font></a><span class="string">calculations, or as a stand-alone phonon wavevector.</span>
<a name="14679"><font size=-1>14679     </font></a><span class="string"></span>
<a name="14680"><font size=-1>14680     </font></a><span class="string">There are two basic techniques to generate the Q point: either by specifying</span>
<a name="14681"><font size=-1>14681     </font></a><span class="string">it directly, possibly with a renormalisation factor ([[qptopt]] = 0), or</span>
<a name="14682"><font size=-1>14682     </font></a><span class="string">extracting it from a grid a Q points ([[qptopt]] = 1 to 4), using the index</span>
<a name="14683"><font size=-1>14683     </font></a><span class="string">[[iqpt]]. At variance with the similar generation of k points, only ONE q</span>
<a name="14684"><font size=-1>14684     </font></a><span class="string">point can be used per dataset.</span>
<a name="14685"><font size=-1>14685     </font></a><span class="string"></span>
<a name="14686"><font size=-1>14686     </font></a><span class="string">With [[qptopt]] = 1 to 4, rely on [[ngqpt]] or [[qptrlatt]], as well as on</span>
<a name="14687"><font size=-1>14687     </font></a><span class="string">[[nshiftq]] and [[shiftq]] to set up a q point grid, from which the q point</span>
<a name="14688"><font size=-1>14688     </font></a><span class="string">with number [[iqpt]] will be selected. The values [[qptopt]] = 1 to 4 differ by</span>
<a name="14689"><font size=-1>14689     </font></a><span class="string">the treatment of symmetries. Note that the symmetries are recomputed starting</span>
<a name="14690"><font size=-1>14690     </font></a><span class="string">from the values of [[rprimd]], [[xred]] and [[spinat]]. So, the explicit value</span>
<a name="14691"><font size=-1>14691     </font></a><span class="string">of [[symrel]] are not used. This is to allow doing calculations with</span>
<a name="14692"><font size=-1>14692     </font></a><span class="string">[[nsym]] = 1, sometimes needed for T-dependent electronic structure, still</span>
<a name="14693"><font size=-1>14693     </font></a><span class="string">decreasing the number of q points in the case [[qptopt]] = 1 or [[qptopt]] = 3.</span>
<a name="14694"><font size=-1>14694     </font></a><span class="string"></span>
<a name="14695"><font size=-1>14695     </font></a><span class="string">  * 0 --&gt; read directly [[qpt]], and its (eventual) renormalisation factor [[qptnrm]].</span>
<a name="14696"><font size=-1>14696     </font></a><span class="string"></span>
<a name="14697"><font size=-1>14697     </font></a><span class="string">  * 1 --&gt; Take fully into account the symmetry to generate the grid of q points in the Irreducible Brillouin Zone only.</span>
<a name="14698"><font size=-1>14698     </font></a><span class="string">    (This is the usual mode for RF calculations)</span>
<a name="14699"><font size=-1>14699     </font></a><span class="string"></span>
<a name="14700"><font size=-1>14700     </font></a><span class="string">  * 2 --&gt; Take into account only the time-reversal symmetry: q points will be generated in half the Brillouin zone.</span>
<a name="14701"><font size=-1>14701     </font></a><span class="string"></span>
<a name="14702"><font size=-1>14702     </font></a><span class="string">  * 3 --&gt; Do not take into account any symmetry: q points will be generated in the full Brillouin zone.</span>
<a name="14703"><font size=-1>14703     </font></a><span class="string"></span>
<a name="14704"><font size=-1>14704     </font></a><span class="string">  * 4 --&gt; Take into account all the symmetries EXCEPT the time-reversal symmetry to generate</span>
<a name="14705"><font size=-1>14705     </font></a><span class="string">    the k points in the Irreducible Brillouin Zone.</span>
<a name="14706"><font size=-1>14706     </font></a><span class="string"></span>
<a name="14707"><font size=-1>14707     </font></a><span class="string">In the case of a grid of q points, the auxiliary variables [[kptrlen]],</span>
<a name="14708"><font size=-1>14708     </font></a><span class="string">[[ngkpt]] and [[prtkpt]] might help you to select the optimal grid, similarly</span>
<a name="14709"><font size=-1>14709     </font></a><span class="string">to the case of the K point grid.</span>
<a name="14710"><font size=-1>14710     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14711"><font size=-1>14711     </font></a><span class="default">),</span>
<a name="14712"><font size=-1>14712     </font></a><span class="default"></span>
<a name="14713"><font size=-1>14713     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14714"><font size=-1>14714     </font></a><span class="default">    abivarname=</span><span class="string">&quot;qptrlatt&quot;</span><span class="default">,</span>
<a name="14715"><font size=-1>14715     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="14716"><font size=-1>14716     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14717"><font size=-1>14717     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="14718"><font size=-1>14718     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="number">3</span><span class="default">],</span>
<a name="14719"><font size=-1>14719     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="14720"><font size=-1>14720     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Q - PoinTs grid: Real space LATTice&quot;</span><span class="default">,</span>
<a name="14721"><font size=-1>14721     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="14722"><font size=-1>14722     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[ngqpt]]&quot;</span><span class="default">,</span>
<a name="14723"><font size=-1>14723     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14724"><font size=-1>14724     </font></a><span class="string">This input variable is used only when [[qptopt]] is positive. It partially</span>
<a name="14725"><font size=-1>14725     </font></a><span class="string">defines the q point grid. The other piece of information is contained in</span>
<a name="14726"><font size=-1>14726     </font></a><span class="string">[[shiftq]]. [[qptrlatt]] cannot be used together with [[ngqpt]].</span>
<a name="14727"><font size=-1>14727     </font></a><span class="string"></span>
<a name="14728"><font size=-1>14728     </font></a><span class="string">The values [[qptrlatt]](1:3,1), [[qptrlatt]](1:3,2), [[qptrlatt]](1:3,3) are</span>
<a name="14729"><font size=-1>14729     </font></a><span class="string">the coordinates of three vectors in real space, expressed in the [[rprimd]]</span>
<a name="14730"><font size=-1>14730     </font></a><span class="string">coordinate system (reduced coordinates). They defines a super-lattice in real</span>
<a name="14731"><font size=-1>14731     </font></a><span class="string">space. The k point lattice is the reciprocal of this super-lattice, possibly</span>
<a name="14732"><font size=-1>14732     </font></a><span class="string">shifted (see [[shiftq]]).</span>
<a name="14733"><font size=-1>14733     </font></a><span class="string"></span>
<a name="14734"><font size=-1>14734     </font></a><span class="string">If neither [[ngqpt]] nor [[qptrlatt]] are defined, ABINIT will automatically</span>
<a name="14735"><font size=-1>14735     </font></a><span class="string">generate a set of k point grids, and select the best combination of</span>
<a name="14736"><font size=-1>14736     </font></a><span class="string">[[qptrlatt]] and [[shiftq]] that allows one to reach a sufficient value of</span>
<a name="14737"><font size=-1>14737     </font></a><span class="string">[[kptrlen]]. See this latter variable for a complete description of this procedure.</span>
<a name="14738"><font size=-1>14738     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14739"><font size=-1>14739     </font></a><span class="default">),</span>
<a name="14740"><font size=-1>14740     </font></a><span class="default"></span>
<a name="14741"><font size=-1>14741     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14742"><font size=-1>14742     </font></a><span class="default">    abivarname=</span><span class="string">&quot;quadmom&quot;</span><span class="default">,</span>
<a name="14743"><font size=-1>14743     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="14744"><font size=-1>14744     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14745"><font size=-1>14745     </font></a><span class="default">    topics=[</span><span class="string">'EFG_basic'</span><span class="default">],</span>
<a name="14746"><font size=-1>14746     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="14747"><font size=-1>14747     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="14748"><font size=-1>14748     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;QUADrupole MOMents&quot;</span><span class="default">,</span>
<a name="14749"><font size=-1>14749     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[prtefg]]&gt;=1&quot;</span><span class="default">,</span>
<a name="14750"><font size=-1>14750     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14751"><font size=-1>14751     </font></a><span class="string">  * Array of quadrupole moments, in barns, of the nuclei. These values are used in conjunction with the electric field gradients computed with [[prtefg]] to calculate the quadrupole couplings in MHz, as well as the asymmetries. Note that the electric field gradient at a nuclear site is independent of the nuclear quadrupole moment, thus the quadrupole moment of a nucleus can be input as 0, and the option [[prtefg]] = 2 used to determine the electric field gradient at the site.</span>
<a name="14752"><font size=-1>14752     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14753"><font size=-1>14753     </font></a><span class="default">),</span>
<a name="14754"><font size=-1>14754     </font></a><span class="default"></span>
<a name="14755"><font size=-1>14755     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14756"><font size=-1>14756     </font></a><span class="default">    abivarname=</span><span class="string">&quot;random_atpos&quot;</span><span class="default">,</span>
<a name="14757"><font size=-1>14757     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="14758"><font size=-1>14758     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14759"><font size=-1>14759     </font></a><span class="default">    topics=[</span><span class="string">'crystal_expert'</span><span class="default">, </span><span class="string">'GeoOpt_expert'</span><span class="default">],</span>
<a name="14760"><font size=-1>14760     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14761"><font size=-1>14761     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14762"><font size=-1>14762     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RANDOM ATomic POSitions&quot;</span><span class="default">,</span>
<a name="14763"><font size=-1>14763     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14764"><font size=-1>14764     </font></a><span class="string">Control the inner coordinates, which can be generated randomly by using 4</span>
<a name="14765"><font size=-1>14765     </font></a><span class="string">different methods depending ont its value</span>
<a name="14766"><font size=-1>14766     </font></a><span class="string">(0) if zero, no random generation and xred are taken as they have been introduced by the user</span>
<a name="14767"><font size=-1>14767     </font></a><span class="string">(1) if one, particles are generated completely random within the unit cell.</span>
<a name="14768"><font size=-1>14768     </font></a><span class="string">(2) if two, particles are generated randomly but the inner particle distance</span>
<a name="14769"><font size=-1>14769     </font></a><span class="string">is always larger than a factor of the sum of the covalent bonds between the</span>
<a name="14770"><font size=-1>14770     </font></a><span class="string">atoms (note: this is incompatible with the definition of alchemical mixing,</span>
<a name="14771"><font size=-1>14771     </font></a><span class="string">in which [[ntypat]] differs from [[npsp]])</span>
<a name="14772"><font size=-1>14772     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14773"><font size=-1>14773     </font></a><span class="default">),</span>
<a name="14774"><font size=-1>14774     </font></a><span class="default"></span>
<a name="14775"><font size=-1>14775     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14776"><font size=-1>14776     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ratsph&quot;</span><span class="default">,</span>
<a name="14777"><font size=-1>14777     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="14778"><font size=-1>14778     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14779"><font size=-1>14779     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">, </span><span class="string">'MagMom_useful'</span><span class="default">, </span><span class="string">'ElecBandStructure_useful'</span><span class="default">, </span><span class="string">'ElecDOS_useful'</span><span class="default">],</span>
<a name="14780"><font size=-1>14780     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="14781"><font size=-1>14781     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[usepaw]] == 1'</span><span class="default">: </span><span class="string">'[[AUTO_FROM_PSP]]' </span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">2.0</span><span class="default">}),</span>
<a name="14782"><font size=-1>14782     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Radii of the ATomic SPHere(s)&quot;</span><span class="default">,</span>
<a name="14783"><font size=-1>14783     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14784"><font size=-1>14784     </font></a><span class="string">Relevant only when [[prtdos]] = 3 or [[prtdensph]] = 1.</span>
<a name="14785"><font size=-1>14785     </font></a><span class="string"></span>
<a name="14786"><font size=-1>14786     </font></a><span class="string">When [[prtdos]] = 3:\n</span>
<a name="14787"><font size=-1>14787     </font></a><span class="string">Provides the radius of the spheres around the [[natsph]] atoms of indices</span>
<a name="14788"><font size=-1>14788     </font></a><span class="string">[[iatsph]], in which the local DOS and its angular-momentum projections will</span>
<a name="14789"><font size=-1>14789     </font></a><span class="string">be analysed. The choice of this radius is quite arbitrary. In a plane-wave</span>
<a name="14790"><font size=-1>14790     </font></a><span class="string">basis set, there is no natural definition of an atomic sphere. However, it</span>
<a name="14791"><font size=-1>14791     </font></a><span class="string">might be wise to use the following well-defined and physically motivated procedure:</span>
<a name="14792"><font size=-1>14792     </font></a><span class="string">from the Bader analysis, one can define the radius of the sphere that contains</span>
<a name="14793"><font size=-1>14793     </font></a><span class="string">the same charge as the Bader volume. This &quot;Equivalent Bader charge atomic</span>
<a name="14794"><font size=-1>14794     </font></a><span class="string">radius&quot; might then be used to perform the present analysis. See the</span>
<a name="14795"><font size=-1>14795     </font></a><span class="string">[[help:aim]] for more explanations. Another physically motivated choice would</span>
<a name="14796"><font size=-1>14796     </font></a><span class="string">be to rely on another charge partitioning, like the Hirshfeld one (see the</span>
<a name="14797"><font size=-1>14797     </font></a><span class="string">cut3d utility [[help:cut3d]]). The advantage of using charge partitioning schemes comes from</span>
<a name="14798"><font size=-1>14798     </font></a><span class="string">the fact that the sum of atomic DOS, for all angular momenta and atoms,</span>
<a name="14799"><font size=-1>14799     </font></a><span class="string">integrated on the energy range of the occupied states, gives back the total</span>
<a name="14800"><font size=-1>14800     </font></a><span class="string">charge. If this is not an issue, one could rely on the half of the nearest-</span>
<a name="14801"><font size=-1>14801     </font></a><span class="string">neighbour distances, or any scheme that allows one to define an atomic radius.</span>
<a name="14802"><font size=-1>14802     </font></a><span class="string">Note that the choice of this radius is however critical for the balance</span>
<a name="14803"><font size=-1>14803     </font></a><span class="string">between the s, p and d components. Indeed, the integrated charge within a</span>
<a name="14804"><font size=-1>14804     </font></a><span class="string">given radius, behave as a different power of the radius, for the different</span>
<a name="14805"><font size=-1>14805     </font></a><span class="string">channels s, p, d. At the limit of very small radii, the s component dominates</span>
<a name="14806"><font size=-1>14806     </font></a><span class="string">the charge contained in the sphere...</span>
<a name="14807"><font size=-1>14807     </font></a><span class="string"></span>
<a name="14808"><font size=-1>14808     </font></a><span class="string">When [[prtdensph]] = 1:\n</span>
<a name="14809"><font size=-1>14809     </font></a><span class="string">Provides the radius of the spheres around (all) atoms in which the total</span>
<a name="14810"><font size=-1>14810     </font></a><span class="string">charge density will be integrated.</span>
<a name="14811"><font size=-1>14811     </font></a><span class="string"></span>
<a name="14812"><font size=-1>14812     </font></a><span class="string">In case of PAW, [[ratsph]] radius has to be greater or equal to PAW radius of</span>
<a name="14813"><font size=-1>14813     </font></a><span class="string">considered atom type (which is read from the PAW dataset file; see **rc_sph** or **r_paw**).</span>
<a name="14814"><font size=-1>14814     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14815"><font size=-1>14815     </font></a><span class="default">),</span>
<a name="14816"><font size=-1>14816     </font></a><span class="default"></span>
<a name="14817"><font size=-1>14817     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14818"><font size=-1>14818     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ratsph_extra&quot;</span><span class="default">,</span>
<a name="14819"><font size=-1>14819     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="14820"><font size=-1>14820     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14821"><font size=-1>14821     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">],</span>
<a name="14822"><font size=-1>14822     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14823"><font size=-1>14823     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9325">ValueWithUnit</a>(units=</span><span class="string">'Bohr'</span><span class="default">, value=</span><span class="number">2.0</span><span class="default">),</span>
<a name="14824"><font size=-1>14824     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Radii of the ATomic SPHere(s) in the EXTRA set&quot;</span><span class="default">,</span>
<a name="14825"><font size=-1>14825     </font></a><span class="default">    characteristics=[</span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="14826"><font size=-1>14826     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14827"><font size=-1>14827     </font></a><span class="string">Radius for extra spheres the DOS is projected into. See [[natsph_extra]] and</span>
<a name="14828"><font size=-1>14828     </font></a><span class="string">[[xredsph_extra]] for the number and positions of the spheres.</span>
<a name="14829"><font size=-1>14829     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14830"><font size=-1>14830     </font></a><span class="default">),</span>
<a name="14831"><font size=-1>14831     </font></a><span class="default"></span>
<a name="14832"><font size=-1>14832     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14833"><font size=-1>14833     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rcut&quot;</span><span class="default">,</span>
<a name="14834"><font size=-1>14834     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="14835"><font size=-1>14835     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14836"><font size=-1>14836     </font></a><span class="default">    topics=[</span><span class="string">'GWls_compulsory'</span><span class="default">, </span><span class="string">'Susceptibility_basic'</span><span class="default">, </span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="14837"><font size=-1>14837     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14838"><font size=-1>14838     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="14839"><font size=-1>14839     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Radius of the CUT-off for coulomb interaction&quot;</span><span class="default">,</span>
<a name="14840"><font size=-1>14840     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14841"><font size=-1>14841     </font></a><span class="string">Truncation of the Coulomb interaction in real space. The meaning of [[rcut]]</span>
<a name="14842"><font size=-1>14842     </font></a><span class="string">is governed by the cutoff shape option [[icutcoul]].</span>
<a name="14843"><font size=-1>14843     </font></a><span class="string"></span>
<a name="14844"><font size=-1>14844     </font></a><span class="string">If [[rcut]] is negative, the cutoff is automatically calculated so to enclose</span>
<a name="14845"><font size=-1>14845     </font></a><span class="string">the same volume inside the cutoff as the volume of the primitive cell.</span>
<a name="14846"><font size=-1>14846     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14847"><font size=-1>14847     </font></a><span class="default">),</span>
<a name="14848"><font size=-1>14848     </font></a><span class="default"></span>
<a name="14849"><font size=-1>14849     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14850"><font size=-1>14850     </font></a><span class="default">    abivarname=</span><span class="string">&quot;recefermi&quot;</span><span class="default">,</span>
<a name="14851"><font size=-1>14851     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14852"><font size=-1>14852     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14853"><font size=-1>14853     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_useful'</span><span class="default">],</span>
<a name="14854"><font size=-1>14854     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14855"><font size=-1>14855     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14856"><font size=-1>14856     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - initial guess  of the FERMI Energy&quot;</span><span class="default">,</span>
<a name="14857"><font size=-1>14857     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14858"><font size=-1>14858     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14859"><font size=-1>14859     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). In the first SCF calculation it</span>
<a name="14860"><font size=-1>14860     </font></a><span class="string">fixes the initial guess for the Fermi energy.</span>
<a name="14861"><font size=-1>14861     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14862"><font size=-1>14862     </font></a><span class="default">),</span>
<a name="14863"><font size=-1>14863     </font></a><span class="default"></span>
<a name="14864"><font size=-1>14864     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14865"><font size=-1>14865     </font></a><span class="default">    abivarname=</span><span class="string">&quot;recgratio&quot;</span><span class="default">,</span>
<a name="14866"><font size=-1>14866     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14867"><font size=-1>14867     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14868"><font size=-1>14868     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_useful'</span><span class="default">],</span>
<a name="14869"><font size=-1>14869     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14870"><font size=-1>14870     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="14871"><font size=-1>14871     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - Grid RATIO&quot;</span><span class="default">,</span>
<a name="14872"><font size=-1>14872     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14873"><font size=-1>14873     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14874"><font size=-1>14874     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). It represents the ratio of the two</span>
<a name="14875"><font size=-1>14875     </font></a><span class="string">grid step: [[recgratio]] = fine_step/coarse_step and it is bigger or equal than</span>
<a name="14876"><font size=-1>14876     </font></a><span class="string">1. It introduces a double-grid system which permits to compute the electronic</span>
<a name="14877"><font size=-1>14877     </font></a><span class="string">density on a coarse grid, using a fine grid (defined by [[ngfft]]) in the</span>
<a name="14878"><font size=-1>14878     </font></a><span class="string">discretisation of the green kernel (see [[recptrott]]). Successively the</span>
<a name="14879"><font size=-1>14879     </font></a><span class="string">density and the recursion coefficients are interpolated on the fine grid by</span>
<a name="14880"><font size=-1>14880     </font></a><span class="string">FFT interpolation. Note that ngfft/recgratio=number of points of the coarse</span>
<a name="14881"><font size=-1>14881     </font></a><span class="string">grid has to be compatible with the parallelization parameters.</span>
<a name="14882"><font size=-1>14882     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14883"><font size=-1>14883     </font></a><span class="default">),</span>
<a name="14884"><font size=-1>14884     </font></a><span class="default"></span>
<a name="14885"><font size=-1>14885     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14886"><font size=-1>14886     </font></a><span class="default">    abivarname=</span><span class="string">&quot;recnpath&quot;</span><span class="default">,</span>
<a name="14887"><font size=-1>14887     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14888"><font size=-1>14888     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14889"><font size=-1>14889     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_expert'</span><span class="default">],</span>
<a name="14890"><font size=-1>14890     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14891"><font size=-1>14891     </font></a><span class="default">    defaultval=</span><span class="number">500</span><span class="default">,</span>
<a name="14892"><font size=-1>14892     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - Number of point for PATH integral calculations&quot;</span><span class="default">,</span>
<a name="14893"><font size=-1>14893     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14894"><font size=-1>14894     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14895"><font size=-1>14895     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). Determine the number of</span>
<a name="14896"><font size=-1>14896     </font></a><span class="string">discretisation points to compute some path integral in the recursion method;</span>
<a name="14897"><font size=-1>14897     </font></a><span class="string">those path integrals are used to compute the entropy and the eigenvalues</span>
<a name="14898"><font size=-1>14898     </font></a><span class="string">energy. during the latest SFC cycles.</span>
<a name="14899"><font size=-1>14899     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14900"><font size=-1>14900     </font></a><span class="default">),</span>
<a name="14901"><font size=-1>14901     </font></a><span class="default"></span>
<a name="14902"><font size=-1>14902     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14903"><font size=-1>14903     </font></a><span class="default">    abivarname=</span><span class="string">&quot;recnrec&quot;</span><span class="default">,</span>
<a name="14904"><font size=-1>14904     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14905"><font size=-1>14905     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14906"><font size=-1>14906     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_expert'</span><span class="default">],</span>
<a name="14907"><font size=-1>14907     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14908"><font size=-1>14908     </font></a><span class="default">    defaultval=</span><span class="number">10</span><span class="default">,</span>
<a name="14909"><font size=-1>14909     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - Number of RECursions&quot;</span><span class="default">,</span>
<a name="14910"><font size=-1>14910     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14911"><font size=-1>14911     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14912"><font size=-1>14912     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). Determine the maximum order of</span>
<a name="14913"><font size=-1>14913     </font></a><span class="string">recursion, that is the dimension of the krylov space we use to compute</span>
<a name="14914"><font size=-1>14914     </font></a><span class="string">density. If the precision set by [[rectolden]] is reached before that order,</span>
<a name="14915"><font size=-1>14915     </font></a><span class="string">the recursion method automatically stops.</span>
<a name="14916"><font size=-1>14916     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14917"><font size=-1>14917     </font></a><span class="default">),</span>
<a name="14918"><font size=-1>14918     </font></a><span class="default"></span>
<a name="14919"><font size=-1>14919     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14920"><font size=-1>14920     </font></a><span class="default">    abivarname=</span><span class="string">&quot;recptrott&quot;</span><span class="default">,</span>
<a name="14921"><font size=-1>14921     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14922"><font size=-1>14922     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14923"><font size=-1>14923     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_expert'</span><span class="default">],</span>
<a name="14924"><font size=-1>14924     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14925"><font size=-1>14925     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14926"><font size=-1>14926     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - TROTTer parameter&quot;</span><span class="default">,</span>
<a name="14927"><font size=-1>14927     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14928"><font size=-1>14928     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="14929"><font size=-1>14929     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). Determine the trotter parameter</span>
<a name="14930"><font size=-1>14930     </font></a><span class="string">used to compute the exponential of the hamiltonian in the recursion method:</span>
<a name="14931"><font size=-1>14931     </font></a><span class="string"></span>
<a name="14932"><font size=-1>14932     </font></a><span class="string">$$ e^{-\beta(-\Delta + V)} \approx</span>
<a name="14933"><font size=-1>14933     </font></a><span class="string">\left(</span>
<a name="14934"><font size=-1>14934     </font></a><span class="string">    e^{-\frac{\beta}{4c} V}</span>
<a name="14935"><font size=-1>14935     </font></a><span class="string">    e^{-\frac{\beta}{4c} \Delta}</span>
<a name="14936"><font size=-1>14936     </font></a><span class="string">    e^{-\frac{\beta}{4c} V}</span>
<a name="14937"><font size=-1>14937     </font></a><span class="string">\right)^{2c} $$</span>
<a name="14938"><font size=-1>14938     </font></a><span class="string"></span>
<a name="14939"><font size=-1>14939     </font></a><span class="string">where $c$=[[recptrott]].</span>
<a name="14940"><font size=-1>14940     </font></a><span class="string">If set to 0, we use [[recptrott]] = $1/2$ in the above formula.</span>
<a name="14941"><font size=-1>14941     </font></a><span class="string">Increasing [[recptrott]] improve the</span>
<a name="14942"><font size=-1>14942     </font></a><span class="string">accuracy of the trotter formula, but increase the dicretisation error: it may</span>
<a name="14943"><font size=-1>14943     </font></a><span class="string">be necessary to increase [[ngfft]]. The discretisation error is essentially</span>
<a name="14944"><font size=-1>14944     </font></a><span class="string">the discretisation error of the green kernel $e^{\frac{c}{\beta|r|^2}}$ on</span>
<a name="14945"><font size=-1>14945     </font></a><span class="string">the ngfft grid.</span>
<a name="14946"><font size=-1>14946     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14947"><font size=-1>14947     </font></a><span class="default">),</span>
<a name="14948"><font size=-1>14948     </font></a><span class="default"></span>
<a name="14949"><font size=-1>14949     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14950"><font size=-1>14950     </font></a><span class="default">    abivarname=</span><span class="string">&quot;recrcut&quot;</span><span class="default">,</span>
<a name="14951"><font size=-1>14951     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14952"><font size=-1>14952     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14953"><font size=-1>14953     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_useful'</span><span class="default">],</span>
<a name="14954"><font size=-1>14954     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14955"><font size=-1>14955     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14956"><font size=-1>14956     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - CUTing Radius&quot;</span><span class="default">,</span>
<a name="14957"><font size=-1>14957     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14958"><font size=-1>14958     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14959"><font size=-1>14959     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). Used to improve the computational</span>
<a name="14960"><font size=-1>14960     </font></a><span class="string">time in the case of the recursion method in a large cell: the density at a</span>
<a name="14961"><font size=-1>14961     </font></a><span class="string">point will be computed with taking account only of a sphere of radius [[recrcut]].</span>
<a name="14962"><font size=-1>14962     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14963"><font size=-1>14963     </font></a><span class="default">),</span>
<a name="14964"><font size=-1>14964     </font></a><span class="default"></span>
<a name="14965"><font size=-1>14965     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14966"><font size=-1>14966     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rectesteg&quot;</span><span class="default">,</span>
<a name="14967"><font size=-1>14967     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14968"><font size=-1>14968     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="14969"><font size=-1>14969     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_expert'</span><span class="default">],</span>
<a name="14970"><font size=-1>14970     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14971"><font size=-1>14971     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="14972"><font size=-1>14972     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - TEST on Electron Gas&quot;</span><span class="default">,</span>
<a name="14973"><font size=-1>14973     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14974"><font size=-1>14974     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14975"><font size=-1>14975     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). It is used to test an electron gas</span>
<a name="14976"><font size=-1>14976     </font></a><span class="string">by putting the ion potential equal to zero.</span>
<a name="14977"><font size=-1>14977     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14978"><font size=-1>14978     </font></a><span class="default">),</span>
<a name="14979"><font size=-1>14979     </font></a><span class="default"></span>
<a name="14980"><font size=-1>14980     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="14981"><font size=-1>14981     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rectolden&quot;</span><span class="default">,</span>
<a name="14982"><font size=-1>14982     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="14983"><font size=-1>14983     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="14984"><font size=-1>14984     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_basic'</span><span class="default">],</span>
<a name="14985"><font size=-1>14985     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="14986"><font size=-1>14986     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="14987"><font size=-1>14987     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RECursion - TOLerance on the difference of electronic DENsity&quot;</span><span class="default">,</span>
<a name="14988"><font size=-1>14988     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="14989"><font size=-1>14989     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Default value to be changed.&quot;</span><span class="default">,</span>
<a name="14990"><font size=-1>14990     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="14991"><font size=-1>14991     </font></a><span class="string">Used in Recursion method ([[tfkinfunc]] = 2). Sets a tolerance for differences</span>
<a name="14992"><font size=-1>14992     </font></a><span class="string">of electronic density that, reached TWICE successively, will cause one SCF</span>
<a name="14993"><font size=-1>14993     </font></a><span class="string">cycle to stop. That electronic density difference is computed in the infinity</span>
<a name="14994"><font size=-1>14994     </font></a><span class="string">norm (that is, it is computed point-by-point, and then the maximum difference</span>
<a name="14995"><font size=-1>14995     </font></a><span class="string">is computed).</span>
<a name="14996"><font size=-1>14996     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="14997"><font size=-1>14997     </font></a><span class="default">),</span>
<a name="14998"><font size=-1>14998     </font></a><span class="default"></span>
<a name="14999"><font size=-1>14999     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15000"><font size=-1>15000     </font></a><span class="default">    abivarname=</span><span class="string">&quot;red_dfield&quot;</span><span class="default">,</span>
<a name="15001"><font size=-1>15001     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="15002"><font size=-1>15002     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15003"><font size=-1>15003     </font></a><span class="default">    topics=[</span><span class="string">'Berry_useful'</span><span class="default">],</span>
<a name="15004"><font size=-1>15004     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="15005"><font size=-1>15005     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="15006"><font size=-1>15006     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;REDuced Displacement FIELD&quot;</span><span class="default">,</span>
<a name="15007"><font size=-1>15007     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] = 16, [[red_efield]]&quot;</span><span class="default">,</span>
<a name="15008"><font size=-1>15008     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15009"><font size=-1>15009     </font></a><span class="string">In case [[berryopt]] = 16, a reduced finite electric displacement field</span>
<a name="15010"><font size=-1>15010     </font></a><span class="string">calculation is performed. The value of this displacement field, and its</span>
<a name="15011"><font size=-1>15011     </font></a><span class="string">direction is determined by [[red_dfield]]. It must be given in atomic units.</span>
<a name="15012"><font size=-1>15012     </font></a><span class="string"></span>
<a name="15013"><font size=-1>15013     </font></a><span class="string">[[red_dfield]] is defined via Eq.(26) in the Supplement of [[cite:Stengel2009]].</span>
<a name="15014"><font size=-1>15014     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15015"><font size=-1>15015     </font></a><span class="default">),</span>
<a name="15016"><font size=-1>15016     </font></a><span class="default"></span>
<a name="15017"><font size=-1>15017     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15018"><font size=-1>15018     </font></a><span class="default">    abivarname=</span><span class="string">&quot;red_efield&quot;</span><span class="default">,</span>
<a name="15019"><font size=-1>15019     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="15020"><font size=-1>15020     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15021"><font size=-1>15021     </font></a><span class="default">    topics=[</span><span class="string">'Berry_useful'</span><span class="default">],</span>
<a name="15022"><font size=-1>15022     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="15023"><font size=-1>15023     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="15024"><font size=-1>15024     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;REDuced Electric FIELD&quot;</span><span class="default">,</span>
<a name="15025"><font size=-1>15025     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] = 16&quot;</span><span class="default">,</span>
<a name="15026"><font size=-1>15026     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15027"><font size=-1>15027     </font></a><span class="string">In case [[berryopt]] = 16, a reduced finite electric displacement field</span>
<a name="15028"><font size=-1>15028     </font></a><span class="string">calculation is performed. In this case, the parameter [[red_efield]] specifies the</span>
<a name="15029"><font size=-1>15029     </font></a><span class="string">initial electric field used on the first iteration, in atomic units.</span>
<a name="15030"><font size=-1>15030     </font></a><span class="string"></span>
<a name="15031"><font size=-1>15031     </font></a><span class="string">[[red_efield]] is defined via Eq.(25) in the Supplement [[cite:Stengel2009]].</span>
<a name="15032"><font size=-1>15032     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15033"><font size=-1>15033     </font></a><span class="default">),</span>
<a name="15034"><font size=-1>15034     </font></a><span class="default"></span>
<a name="15035"><font size=-1>15035     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15036"><font size=-1>15036     </font></a><span class="default">    abivarname=</span><span class="string">&quot;red_efieldbar&quot;</span><span class="default">,</span>
<a name="15037"><font size=-1>15037     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="15038"><font size=-1>15038     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15039"><font size=-1>15039     </font></a><span class="default">    topics=[</span><span class="string">'Berry_useful'</span><span class="default">],</span>
<a name="15040"><font size=-1>15040     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="15041"><font size=-1>15041     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="15042"><font size=-1>15042     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;REDuced Electric FIELD BAR&quot;</span><span class="default">,</span>
<a name="15043"><font size=-1>15043     </font></a><span class="default">    requires=</span><span class="string">&quot;[[berryopt]] = 14&quot;</span><span class="default">,</span>
<a name="15044"><font size=-1>15044     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15045"><font size=-1>15045     </font></a><span class="string">In case [[berryopt]] = 14, a reduced finite electric field calculation is</span>
<a name="15046"><font size=-1>15046     </font></a><span class="string">performed. The magnitude and direction of this electric field are determined</span>
<a name="15047"><font size=-1>15047     </font></a><span class="string">by [[red_efieldbar]]. It must be given in atomic units.</span>
<a name="15048"><font size=-1>15048     </font></a><span class="string"></span>
<a name="15049"><font size=-1>15049     </font></a><span class="string">[[red_efieldbar]] is defined via Eq.(28) in the Supplement of [[cite:Stengel2009]].</span>
<a name="15050"><font size=-1>15050     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15051"><font size=-1>15051     </font></a><span class="default">),</span>
<a name="15052"><font size=-1>15052     </font></a><span class="default"></span>
<a name="15053"><font size=-1>15053     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15054"><font size=-1>15054     </font></a><span class="default">    abivarname=</span><span class="string">&quot;restartxf&quot;</span><span class="default">,</span>
<a name="15055"><font size=-1>15055     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="15056"><font size=-1>15056     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15057"><font size=-1>15057     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_useful'</span><span class="default">, </span><span class="string">'MolecularDynamics_useful'</span><span class="default">, </span><span class="string">'GeoOpt_useful'</span><span class="default">],</span>
<a name="15058"><font size=-1>15058     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15059"><font size=-1>15059     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15060"><font size=-1>15060     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RESTART from (X,F) history&quot;</span><span class="default">,</span>
<a name="15061"><font size=-1>15061     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15062"><font size=-1>15062     </font></a><span class="string">Control the restart of a molecular dynamics or structural optimization job.</span>
<a name="15063"><font size=-1>15063     </font></a><span class="string"></span>
<a name="15064"><font size=-1>15064     </font></a><span class="string">**restartxf &gt;0 (Deprecated) **:The code reads from the input wf file, the</span>
<a name="15065"><font size=-1>15065     </font></a><span class="string">previous history of atomic coordinates and corresponding forces, in order to</span>
<a name="15066"><font size=-1>15066     </font></a><span class="string">continue the work done by the job that produced this wf file. If</span>
<a name="15067"><font size=-1>15067     </font></a><span class="string">[[optcell]]/=0, the history of [[acell]] and [[rprim]] variables is also taken</span>
<a name="15068"><font size=-1>15068     </font></a><span class="string">into account. The code will take into consideration the whole history (if</span>
<a name="15069"><font size=-1>15069     </font></a><span class="string">[[restartxf]] = 1), or discard the few first (x,f) pairs, and begin only at the</span>
<a name="15070"><font size=-1>15070     </font></a><span class="string">pair whose number corresponds to [[restartxf]].</span>
<a name="15071"><font size=-1>15071     </font></a><span class="string">Works only for [[ionmov]] = 2 (Broyden) and when an input wavefunction file is</span>
<a name="15072"><font size=-1>15072     </font></a><span class="string">specified, thanks to the appropriate values of [[irdwfk]] or [[getwfk]].</span>
<a name="15073"><font size=-1>15073     </font></a><span class="string"></span>
<a name="15074"><font size=-1>15074     </font></a><span class="string">NOTES:</span>
<a name="15075"><font size=-1>15075     </font></a><span class="string">* The input wf file must have been produced by a run that exited cleanly. It cannot be one of the temporary wf files that exist when a job crashed.</span>
<a name="15076"><font size=-1>15076     </font></a><span class="string">* One cannot restart a calculation with a non-zero [[optcell]] value from the (x,f) history of another run with a different non-zero [[optcell]] value. Starting a non-zero [[optcell]] run from a zero [[optcell]] run should work.</span>
<a name="15077"><font size=-1>15077     </font></a><span class="string">* Deprecated, the use of the new options (-1 and -2) is preferred.</span>
<a name="15078"><font size=-1>15078     </font></a><span class="string"></span>
<a name="15079"><font size=-1>15079     </font></a><span class="string">**restartxf=0 (Default)**: No restart procedure is enable and will start a</span>
<a name="15080"><font size=-1>15080     </font></a><span class="string">Molecular dynamics or structural optimization from scratch.</span>
<a name="15081"><font size=-1>15081     </font></a><span class="string"></span>
<a name="15082"><font size=-1>15082     </font></a><span class="string">**restartxf=-1 (New)**: Use the HIST file to reconstruct a partial</span>
<a name="15083"><font size=-1>15083     </font></a><span class="string">calculation. It will reconstruct the different configurations using the forces</span>
<a name="15084"><font size=-1>15084     </font></a><span class="string">and stress store in the HIST file, instead of calling the SCF procedure.</span>
<a name="15085"><font size=-1>15085     </font></a><span class="string">Enable **restartxf=-1** from the beginning is harmless. The only condition is</span>
<a name="15086"><font size=-1>15086     </font></a><span class="string">to keep the input file the same in such a way that the same predictor is used</span>
<a name="15087"><font size=-1>15087     </font></a><span class="string">and it will predict the same structure recorded in the HIST file.</span>
<a name="15088"><font size=-1>15088     </font></a><span class="string">This option will always compute extra [[ntime]] iterations independent of the</span>
<a name="15089"><font size=-1>15089     </font></a><span class="string">number of iterations recovered previously.</span>
<a name="15090"><font size=-1>15090     </font></a><span class="string"></span>
<a name="15091"><font size=-1>15091     </font></a><span class="string">**restartxf=-2 (New)**:Read the HIST file and select the atomic positions and</span>
<a name="15092"><font size=-1>15092     </font></a><span class="string">cell parameters with the lowest energy. Forget all the history and start the</span>
<a name="15093"><font size=-1>15093     </font></a><span class="string">calculation using those values. The original atomic coordinates and cell</span>
<a name="15094"><font size=-1>15094     </font></a><span class="string">parameters are irrelevant in that case.</span>
<a name="15095"><font size=-1>15095     </font></a><span class="string"></span>
<a name="15096"><font size=-1>15096     </font></a><span class="string">**restartxf=-3 (New)**:Read **ONLY** the last require the atomic positions and cell parameters in the HIST file to restart the Molecular dynamics or structural optimization.</span>
<a name="15097"><font size=-1>15097     </font></a><span class="string"></span>
<a name="15098"><font size=-1>15098     </font></a><span class="string">NOTES:</span>
<a name="15099"><font size=-1>15099     </font></a><span class="string">* You can use **restartxf=-1, -2 or -3** for all predictiors that make no use of random numbers.</span>
<a name="15100"><font size=-1>15100     </font></a><span class="string">* You can use **restartxf=-1, -2 or -3** to restart a calculation that was not completed. The HIST file is written on each iteration. So you always have something to recover from.</span>
<a name="15101"><font size=-1>15101     </font></a><span class="string">* You can take advantage of the appropriate values of [[irdwfk]] or [[getwfk]] to get a good wave function to continue your job.</span>
<a name="15102"><font size=-1>15102     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15103"><font size=-1>15103     </font></a><span class="default">),</span>
<a name="15104"><font size=-1>15104     </font></a><span class="default"></span>
<a name="15105"><font size=-1>15105     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15106"><font size=-1>15106     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rf2_dkdk&quot;</span><span class="default">,</span>
<a name="15107"><font size=-1>15107     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15108"><font size=-1>15108     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15109"><font size=-1>15109     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="15110"><font size=-1>15110     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15111"><font size=-1>15111     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15112"><font size=-1>15112     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function: 2nd Derivative of wavefunctions with respect to K&quot;</span><span class="default">,</span>
<a name="15113"><font size=-1>15113     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15114"><font size=-1>15114     </font></a><span class="string">UNUSABLE (in development)</span>
<a name="15115"><font size=-1>15115     </font></a><span class="string"></span>
<a name="15116"><font size=-1>15116     </font></a><span class="string">Activates computation of second derivatives of wavefunctions with respect to</span>
<a name="15117"><font size=-1>15117     </font></a><span class="string">wavevectors. This is not strictly a response function but is a needed</span>
<a name="15118"><font size=-1>15118     </font></a><span class="string">auxiliary quantity in the calculations of 3rd-order derivatives of the energy</span>
<a name="15119"><font size=-1>15119     </font></a><span class="string">(non-linear response). The directions for the derivatives are determined by</span>
<a name="15120"><font size=-1>15120     </font></a><span class="string">[[rfdir]] (TO BE CORRECTED!).</span>
<a name="15121"><font size=-1>15121     </font></a><span class="string"></span>
<a name="15122"><font size=-1>15122     </font></a><span class="string">  * 0 --&gt; no derivative calculation</span>
<a name="15123"><font size=-1>15123     </font></a><span class="string">  * 1 --&gt; calculation along diagonal directions ($\,d^2$/($\,d k_i \,d k_i$), natom+10 is activated)</span>
<a name="15124"><font size=-1>15124     </font></a><span class="string">  * 2 --&gt; calculation along off-diagonal directions ($\,d^2$/($\,d k_i \,d k_j$), natom+11 is activated)</span>
<a name="15125"><font size=-1>15125     </font></a><span class="string">  * 3 --&gt; calculation along all directions (both natom+10 and natom+11 are activated)</span>
<a name="15126"><font size=-1>15126     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15127"><font size=-1>15127     </font></a><span class="default">),</span>
<a name="15128"><font size=-1>15128     </font></a><span class="default"></span>
<a name="15129"><font size=-1>15129     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15130"><font size=-1>15130     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfasr&quot;</span><span class="default">,</span>
<a name="15131"><font size=-1>15131     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15132"><font size=-1>15132     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15133"><font size=-1>15133     </font></a><span class="default">    topics=[</span><span class="string">'Phonons_basic'</span><span class="default">],</span>
<a name="15134"><font size=-1>15134     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15135"><font size=-1>15135     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15136"><font size=-1>15136     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function: Acoustic Sum Rule&quot;</span><span class="default">,</span>
<a name="15137"><font size=-1>15137     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15138"><font size=-1>15138     </font></a><span class="string">Control the evaluation of the acoustic sum rule in effective charges and</span>
<a name="15139"><font size=-1>15139     </font></a><span class="string">dynamical matrix at Gamma within a response function calculation (not active</span>
<a name="15140"><font size=-1>15140     </font></a><span class="string">at the level of producing the DDB, but at the level of the phonon</span>
<a name="15141"><font size=-1>15141     </font></a><span class="string">eigenfrequencies output).</span>
<a name="15142"><font size=-1>15142     </font></a><span class="string"></span>
<a name="15143"><font size=-1>15143     </font></a><span class="string">  * 0 --&gt; no acoustic sum rule imposed</span>
<a name="15144"><font size=-1>15144     </font></a><span class="string">  * 1 --&gt; acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality</span>
<a name="15145"><font size=-1>15145     </font></a><span class="string">    imposed with extra charge evenly distributed among atoms</span>
<a name="15146"><font size=-1>15146     </font></a><span class="string">  * 2 --&gt; acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality</span>
<a name="15147"><font size=-1>15147     </font></a><span class="string">    imposed with extra charge given proportionally to those atoms with the largest effective charge.</span>
<a name="15148"><font size=-1>15148     </font></a><span class="string"></span>
<a name="15149"><font size=-1>15149     </font></a><span class="string">The treatment of the acoustic sum rule and charge neutrality sum rule is finer</span>
<a name="15150"><font size=-1>15150     </font></a><span class="string">at the level of the ANADDB utility, with the two independent input variables</span>
<a name="15151"><font size=-1>15151     </font></a><span class="string">[[anaddb:asr]] and [[anaddb:chneut]].</span>
<a name="15152"><font size=-1>15152     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15153"><font size=-1>15153     </font></a><span class="default">),</span>
<a name="15154"><font size=-1>15154     </font></a><span class="default"></span>
<a name="15155"><font size=-1>15155     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15156"><font size=-1>15156     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfatpol&quot;</span><span class="default">,</span>
<a name="15157"><font size=-1>15157     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15158"><font size=-1>15158     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15159"><font size=-1>15159     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_basic'</span><span class="default">, </span><span class="string">'Elastic_compulsory'</span><span class="default">, </span><span class="string">'Phonons_compulsory'</span><span class="default">],</span>
<a name="15160"><font size=-1>15160     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="15161"><font size=-1>15161     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">],</span>
<a name="15162"><font size=-1>15162     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function: ATomic POLarisation&quot;</span><span class="default">,</span>
<a name="15163"><font size=-1>15163     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15164"><font size=-1>15164     </font></a><span class="string">Control the range of atoms for which displacements will be considered in</span>
<a name="15165"><font size=-1>15165     </font></a><span class="string">phonon calculations (atomic polarizations).</span>
<a name="15166"><font size=-1>15166     </font></a><span class="string">These values are only relevant to phonon response function calculations.</span>
<a name="15167"><font size=-1>15167     </font></a><span class="string">May take values from 1 to [[natom]], with [[rfatpol]](1)&lt;=[[rfatpol]](2).</span>
<a name="15168"><font size=-1>15168     </font></a><span class="string">The atoms to be moved will be defined by the</span>
<a name="15169"><font size=-1>15169     </font></a><span class="string">do-loop variable iatpol:</span>
<a name="15170"><font size=-1>15170     </font></a><span class="string"></span>
<a name="15171"><font size=-1>15171     </font></a><span class="string">  - do iatpol=[[rfatpol]](1),[[rfatpol]](2)</span>
<a name="15172"><font size=-1>15172     </font></a><span class="string"></span>
<a name="15173"><font size=-1>15173     </font></a><span class="string">For the calculation of a full dynamical matrix, use [[rfatpol]](1)=1 and</span>
<a name="15174"><font size=-1>15174     </font></a><span class="string">[[rfatpol]](2)=[[natom]], together with [[rfdir]] 1 1 1. For selected</span>
<a name="15175"><font size=-1>15175     </font></a><span class="string">elements of the dynamical matrix, use different values of [[rfatpol]] and/or</span>
<a name="15176"><font size=-1>15176     </font></a><span class="string">[[rfdir]]. The name 'iatpol' is used for the part of the internal variable</span>
<a name="15177"><font size=-1>15177     </font></a><span class="string">ipert when it runs from 1 to [[natom]]. The internal variable ipert can also</span>
<a name="15178"><font size=-1>15178     </font></a><span class="string">assume values larger than [[natom]], denoting perturbations of electric field</span>
<a name="15179"><font size=-1>15179     </font></a><span class="string">or stress type (see [the DFPT help file](../guide/respfn)).</span>
<a name="15180"><font size=-1>15180     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15181"><font size=-1>15181     </font></a><span class="default">),</span>
<a name="15182"><font size=-1>15182     </font></a><span class="default"></span>
<a name="15183"><font size=-1>15183     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15184"><font size=-1>15184     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfddk&quot;</span><span class="default">,</span>
<a name="15185"><font size=-1>15185     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15186"><font size=-1>15186     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15187"><font size=-1>15187     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_basic'</span><span class="default">],</span>
<a name="15188"><font size=-1>15188     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15189"><font size=-1>15189     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15190"><font size=-1>15190     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function with respect to Derivative with respect to K&quot;</span><span class="default">,</span>
<a name="15191"><font size=-1>15191     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15192"><font size=-1>15192     </font></a><span class="string">Activates computation of derivatives of ground state wavefunctions with</span>
<a name="15193"><font size=-1>15193     </font></a><span class="string">respect to wavevectors. This is not strictly a response function but is a</span>
<a name="15194"><font size=-1>15194     </font></a><span class="string">needed auxiliary quantity in the electric field calculations (see [[rfelfd]]).</span>
<a name="15195"><font size=-1>15195     </font></a><span class="string">The directions for the derivatives are determined by [[rfdir]].</span>
<a name="15196"><font size=-1>15196     </font></a><span class="string"></span>
<a name="15197"><font size=-1>15197     </font></a><span class="string">  * 0 --&gt; no derivative calculation</span>
<a name="15198"><font size=-1>15198     </font></a><span class="string">  * 1 --&gt; calculation of first derivatives of wavefunctions with respect to k points ($\,d/ \,d k$ calculation).</span>
<a name="15199"><font size=-1>15199     </font></a><span class="string">    The exact same functionality is provided by [[rfelfd]] = 2.</span>
<a name="15200"><font size=-1>15200     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15201"><font size=-1>15201     </font></a><span class="default">),</span>
<a name="15202"><font size=-1>15202     </font></a><span class="default"></span>
<a name="15203"><font size=-1>15203     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15204"><font size=-1>15204     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfdir&quot;</span><span class="default">,</span>
<a name="15205"><font size=-1>15205     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15206"><font size=-1>15206     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15207"><font size=-1>15207     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_compulsory'</span><span class="default">, </span><span class="string">'Elastic_compulsory'</span><span class="default">, </span><span class="string">'Phonons_compulsory'</span><span class="default">],</span>
<a name="15208"><font size=-1>15208     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="15209"><font size=-1>15209     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="15210"><font size=-1>15210     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function: DIRections&quot;</span><span class="default">,</span>
<a name="15211"><font size=-1>15211     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15212"><font size=-1>15212     </font></a><span class="string">Gives the directions to be considered for response function calculations (also</span>
<a name="15213"><font size=-1>15213     </font></a><span class="string">for the Berry phase computation of the polarization, see the [[berryopt]]</span>
<a name="15214"><font size=-1>15214     </font></a><span class="string">input variable).</span>
<a name="15215"><font size=-1>15215     </font></a><span class="string">The three elements corresponds to the three primitive vectors, either in real</span>
<a name="15216"><font size=-1>15216     </font></a><span class="string">space (phonon calculations), or in reciprocal space ($\,d/ \,d k$, homogeneous</span>
<a name="15217"><font size=-1>15217     </font></a><span class="string">electric field, homogeneous magnetic field calculations). So, they generate a</span>
<a name="15218"><font size=-1>15218     </font></a><span class="string">basis for the generation of the dynamical matrix or the macroscopic dielectric</span>
<a name="15219"><font size=-1>15219     </font></a><span class="string">tensor or magnetic susceptibility and magnetic shielding, or the effective charge tensors.</span>
<a name="15220"><font size=-1>15220     </font></a><span class="string">If equal to 1, response functions, as defined by [[rfddk]], [[rfelfd]],</span>
<a name="15221"><font size=-1>15221     </font></a><span class="string">[[rfphon]], [[rfdir]] and [[rfatpol]], are to be computed for the</span>
<a name="15222"><font size=-1>15222     </font></a><span class="string">corresponding direction. If 0, this direction should not be considered.</span>
<a name="15223"><font size=-1>15223     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15224"><font size=-1>15224     </font></a><span class="default">),</span>
<a name="15225"><font size=-1>15225     </font></a><span class="default"></span>
<a name="15226"><font size=-1>15226     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15227"><font size=-1>15227     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfelfd&quot;</span><span class="default">,</span>
<a name="15228"><font size=-1>15228     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15229"><font size=-1>15229     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15230"><font size=-1>15230     </font></a><span class="default">    topics=[</span><span class="string">'EffectiveMass_compulsory'</span><span class="default">, </span><span class="string">'DFPT_basic'</span><span class="default">],</span>
<a name="15231"><font size=-1>15231     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15232"><font size=-1>15232     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15233"><font size=-1>15233     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function with respect to the ELectric FielD&quot;</span><span class="default">,</span>
<a name="15234"><font size=-1>15234     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15235"><font size=-1>15235     </font></a><span class="string">Turns on electric field response function calculations. Actually, such</span>
<a name="15236"><font size=-1>15236     </font></a><span class="string">calculations requires first the non-self-consistent calculation of derivatives</span>
<a name="15237"><font size=-1>15237     </font></a><span class="string">with respect to k, independently of the electric field perturbation itself.</span>
<a name="15238"><font size=-1>15238     </font></a><span class="string"></span>
<a name="15239"><font size=-1>15239     </font></a><span class="string">  * 0 --&gt; no electric field perturbation</span>
<a name="15240"><font size=-1>15240     </font></a><span class="string">  * 1 --&gt; full calculation, with first the derivative of ground-state wavefunction with respect to k ($\,d / \,d k$ calculation), by a non-self-consistent calculation, then the generation of the first-order response to an homogeneous electric field</span>
<a name="15241"><font size=-1>15241     </font></a><span class="string">  * 2 --&gt; only the derivative of ground-state wavefunctions with respect to k</span>
<a name="15242"><font size=-1>15242     </font></a><span class="string">  * 3 --&gt; only the generation of the first-order response to the electric field, assuming that the data on derivative of ground-state wavefunction with respect to k is available on disk.</span>
<a name="15243"><font size=-1>15243     </font></a><span class="string"></span>
<a name="15244"><font size=-1>15244     </font></a><span class="string">!!! note</span>
<a name="15245"><font size=-1>15245     </font></a><span class="string">    Because the tolerances to be used for derivatives or homogeneous</span>
<a name="15246"><font size=-1>15246     </font></a><span class="string">    electric field are different, one often does the calculation of derivatives in</span>
<a name="15247"><font size=-1>15247     </font></a><span class="string">    a separate dataset, followed by calculation of electric field response as well</span>
<a name="15248"><font size=-1>15248     </font></a><span class="string">    as phonon.</span>
<a name="15249"><font size=-1>15249     </font></a><span class="string">    The options 2 and 3 proves useful in that context; also, in case a scissor</span>
<a name="15250"><font size=-1>15250     </font></a><span class="string">    shift is to be used, it is usually not applied for the $\,d / \,d k$ response).</span>
<a name="15251"><font size=-1>15251     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15252"><font size=-1>15252     </font></a><span class="default">),</span>
<a name="15253"><font size=-1>15253     </font></a><span class="default"></span>
<a name="15254"><font size=-1>15254     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15255"><font size=-1>15255     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfmagn&quot;</span><span class="default">,</span>
<a name="15256"><font size=-1>15256     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15257"><font size=-1>15257     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15258"><font size=-1>15258     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_basic'</span><span class="default">],</span>
<a name="15259"><font size=-1>15259     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15260"><font size=-1>15260     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15261"><font size=-1>15261     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function with respect to MAGNetic B-field perturbation&quot;</span><span class="default">,</span>
<a name="15262"><font size=-1>15262     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15263"><font size=-1>15263     </font></a><span class="string">[[rfmagn]] allows one to run response function calculations with respect to</span>
<a name="15264"><font size=-1>15264     </font></a><span class="string">external magnetic field if set to 1. Currently, orbital magnetism is not taken into</span>
<a name="15265"><font size=-1>15265     </font></a><span class="string">account and the perturbing potential has Zeeman form.</span>
<a name="15266"><font size=-1>15266     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15267"><font size=-1>15267     </font></a><span class="default">),</span>
<a name="15268"><font size=-1>15268     </font></a><span class="default"></span>
<a name="15269"><font size=-1>15269     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15270"><font size=-1>15270     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfmeth&quot;</span><span class="default">,</span>
<a name="15271"><font size=-1>15271     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15272"><font size=-1>15272     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15273"><font size=-1>15273     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="15274"><font size=-1>15274     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15275"><font size=-1>15275     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="15276"><font size=-1>15276     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function METHod&quot;</span><span class="default">,</span>
<a name="15277"><font size=-1>15277     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15278"><font size=-1>15278     </font></a><span class="string">Selects method used in response function calculations. Presently, only abs([[rfmeth]]) = 1 is</span>
<a name="15279"><font size=-1>15279     </font></a><span class="string">allowed. This corresponds to storing matrix elements of the 2DTE computed using non-stationary expressions,</span>
<a name="15280"><font size=-1>15280     </font></a><span class="string">instead of stationary ones.</span>
<a name="15281"><font size=-1>15281     </font></a><span class="string"></span>
<a name="15282"><font size=-1>15282     </font></a><span class="string">The difference between positive and negative values is rather technical. Very often, the symmetries can be used in such a way that</span>
<a name="15283"><font size=-1>15283     </font></a><span class="string">some matrix elements can be proven to be zero even without doing any computation. Positive values of [[rfmeth]] activate</span>
<a name="15284"><font size=-1>15284     </font></a><span class="string">this use of symmetries, while it is denied when [[rfmeth]] is negative. There is an indirect additional outcome of this,</span>
<a name="15285"><font size=-1>15285     </font></a><span class="string">as a symmetrization of the whole 2DTE is sometimes rendered possible when the additional knowledge of the zero matrix elements</span>
<a name="15286"><font size=-1>15286     </font></a><span class="string">is available. Thus, the results obtained for positive and negative values of [[rfmeth]] might slightly differ for non-zero elements of the 2DTE,</span>
<a name="15287"><font size=-1>15287     </font></a><span class="string">if they are computed in both cases. </span>
<a name="15288"><font size=-1>15288     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15289"><font size=-1>15289     </font></a><span class="default">),</span>
<a name="15290"><font size=-1>15290     </font></a><span class="default"></span>
<a name="15291"><font size=-1>15291     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15292"><font size=-1>15292     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfphon&quot;</span><span class="default">,</span>
<a name="15293"><font size=-1>15293     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15294"><font size=-1>15294     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15295"><font size=-1>15295     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_basic'</span><span class="default">],</span>
<a name="15296"><font size=-1>15296     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15297"><font size=-1>15297     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15298"><font size=-1>15298     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function with respect to PHONons&quot;</span><span class="default">,</span>
<a name="15299"><font size=-1>15299     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15300"><font size=-1>15300     </font></a><span class="string">It must be equal to 1 to run phonon response function calculations.</span>
<a name="15301"><font size=-1>15301     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15302"><font size=-1>15302     </font></a><span class="default">),</span>
<a name="15303"><font size=-1>15303     </font></a><span class="default"></span>
<a name="15304"><font size=-1>15304     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15305"><font size=-1>15305     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfstrs&quot;</span><span class="default">,</span>
<a name="15306"><font size=-1>15306     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15307"><font size=-1>15307     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15308"><font size=-1>15308     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_basic'</span><span class="default">, </span><span class="string">'Elastic_compulsory'</span><span class="default">],</span>
<a name="15309"><font size=-1>15309     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15310"><font size=-1>15310     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15311"><font size=-1>15311     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function with respect to STRainS&quot;</span><span class="default">,</span>
<a name="15312"><font size=-1>15312     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15313"><font size=-1>15313     </font></a><span class="string">Used to run strain response-function calculations (e.g. needed to get elastic</span>
<a name="15314"><font size=-1>15314     </font></a><span class="string">constants). Define, with [[rfdir]], the set of perturbations.</span>
<a name="15315"><font size=-1>15315     </font></a><span class="string"></span>
<a name="15316"><font size=-1>15316     </font></a><span class="string">  * 0 --&gt; no strain perturbation</span>
<a name="15317"><font size=-1>15317     </font></a><span class="string">  * 1 --&gt; only uniaxial strain(s) (ipert=natom+3 is activated)</span>
<a name="15318"><font size=-1>15318     </font></a><span class="string">  * 2 --&gt; only shear strain(s) (ipert=natom+4 is activated)</span>
<a name="15319"><font size=-1>15319     </font></a><span class="string">  * 3 --&gt; both uniaxial and shear strain(s) (both ipert=natom+3 and ipert=natom+4 are activated)</span>
<a name="15320"><font size=-1>15320     </font></a><span class="string"></span>
<a name="15321"><font size=-1>15321     </font></a><span class="string">See the possible restrictions on the use of strain perturbations, in the [[help:respfn]].</span>
<a name="15322"><font size=-1>15322     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15323"><font size=-1>15323     </font></a><span class="default">),</span>
<a name="15324"><font size=-1>15324     </font></a><span class="default"></span>
<a name="15325"><font size=-1>15325     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15326"><font size=-1>15326     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rfuser&quot;</span><span class="default">,</span>
<a name="15327"><font size=-1>15327     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15328"><font size=-1>15328     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15329"><font size=-1>15329     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="15330"><font size=-1>15330     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15331"><font size=-1>15331     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15332"><font size=-1>15332     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Response Function, USER-defined&quot;</span><span class="default">,</span>
<a name="15333"><font size=-1>15333     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15334"><font size=-1>15334     </font></a><span class="string">Available to the developpers, to activate the use of ipert=natom+6 and</span>
<a name="15335"><font size=-1>15335     </font></a><span class="string">ipert=natom+7, two sets of perturbations that the developpers can define.</span>
<a name="15336"><font size=-1>15336     </font></a><span class="string"></span>
<a name="15337"><font size=-1>15337     </font></a><span class="string">  * 0 --&gt; no computations for ipert=natom+6 or ipert=natom+7</span>
<a name="15338"><font size=-1>15338     </font></a><span class="string">  * 1 --&gt; response with respect to perturbation natom+6 will be computed</span>
<a name="15339"><font size=-1>15339     </font></a><span class="string">  * 2 --&gt; response with respect to perturbation natom+7 will be computed</span>
<a name="15340"><font size=-1>15340     </font></a><span class="string">  * 3 --&gt; responses with respect to perturbations natom+6 and natom+7 will be computed</span>
<a name="15341"><font size=-1>15341     </font></a><span class="string"></span>
<a name="15342"><font size=-1>15342     </font></a><span class="string">!!! important</span>
<a name="15343"><font size=-1>15343     </font></a><span class="string">    In order to define and use correctly the new perturbations, the developper</span>
<a name="15344"><font size=-1>15344     </font></a><span class="string">    might have to include code lines or additional routines at the level of the</span>
<a name="15345"><font size=-1>15345     </font></a><span class="string">    following routines: dfpt_cgwf.F90, dfpt_dyout.F90, dfpt_symph.F90,</span>
<a name="15346"><font size=-1>15346     </font></a><span class="string">    dfpt_dyout.F90, dfpt_etot.F90, littlegroup_pert.F90, dfpt_looppert.F90,</span>
<a name="15347"><font size=-1>15347     </font></a><span class="string">    dfpt_mkcor.F90, dfpt_nstdy.F90, dfpt_nstwf.F90, respfn.F90, dfpt_scfcv.F90,</span>
<a name="15348"><font size=-1>15348     </font></a><span class="string">    irreducible_set_pert.F90, dfpt_vloca.F90, dfpt_vtorho.F90, dfpt_vtowfk.F90. In</span>
<a name="15349"><font size=-1>15349     </font></a><span class="string">    these routines, the developper should pay a particular attention to the rfpert</span>
<a name="15350"><font size=-1>15350     </font></a><span class="string">    array, defined in the routine respfn (in m_respfn_driver.F90), as well as to the ipert local</span>
<a name="15351"><font size=-1>15351     </font></a><span class="string">    variable.</span>
<a name="15352"><font size=-1>15352     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15353"><font size=-1>15353     </font></a><span class="default">),</span>
<a name="15354"><font size=-1>15354     </font></a><span class="default"></span>
<a name="15355"><font size=-1>15355     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15356"><font size=-1>15356     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rhoqpmix&quot;</span><span class="default">,</span>
<a name="15357"><font size=-1>15357     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="15358"><font size=-1>15358     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15359"><font size=-1>15359     </font></a><span class="default">    topics=[</span><span class="string">'GW_useful'</span><span class="default">],</span>
<a name="15360"><font size=-1>15360     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15361"><font size=-1>15361     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="15362"><font size=-1>15362     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;RHO QuasiParticle MIXing&quot;</span><span class="default">,</span>
<a name="15363"><font size=-1>15363     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15364"><font size=-1>15364     </font></a><span class="string">For self-consistent GW runs, [[rhoqpmix]] sets the mixing coefficient between</span>
<a name="15365"><font size=-1>15365     </font></a><span class="string">the new and the previous electronic densities. This mixing damps the spurious</span>
<a name="15366"><font size=-1>15366     </font></a><span class="string">oscillations in the Hartree potential when achieving self-consistency.</span>
<a name="15367"><font size=-1>15367     </font></a><span class="string">[[rhoqpmix]] is meaningful only when doing self-consistency on the</span>
<a name="15368"><font size=-1>15368     </font></a><span class="string">wavefunctions with [[gwcalctyp]] &gt;= 20.</span>
<a name="15369"><font size=-1>15369     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15370"><font size=-1>15370     </font></a><span class="default">),</span>
<a name="15371"><font size=-1>15371     </font></a><span class="default"></span>
<a name="15372"><font size=-1>15372     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15373"><font size=-1>15373     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rprim&quot;</span><span class="default">,</span>
<a name="15374"><font size=-1>15374     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="15375"><font size=-1>15375     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15376"><font size=-1>15376     </font></a><span class="default">    topics=[</span><span class="string">'UnitCell_basic'</span><span class="default">],</span>
<a name="15377"><font size=-1>15377     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="number">3</span><span class="default">],</span>
<a name="15378"><font size=-1>15378     </font></a><span class="default">    defaultval=[[</span><span class="number">1</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">], [</span><span class="number">0</span><span class="default">, </span><span class="number">1</span><span class="default">, </span><span class="number">0</span><span class="default">], [</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">1</span><span class="default">]],</span>
<a name="15379"><font size=-1>15379     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Real space PRIMitive translations&quot;</span><span class="default">,</span>
<a name="15380"><font size=-1>15380     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="15381"><font size=-1>15381     </font></a><span class="default">    commentdims=</span><span class="string">&quot;Internally, it is represented as rprim(3,3,[[nimage]])&quot;</span><span class="default">,</span>
<a name="15382"><font size=-1>15382     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15383"><font size=-1>15383     </font></a><span class="string">Give, in columnwise entry, the three dimensionless primitive translations in</span>
<a name="15384"><font size=-1>15384     </font></a><span class="string">real space, to be rescaled by [[acell]] and [[scalecart]].</span>
<a name="15385"><font size=-1>15385     </font></a><span class="string">It is [[EVOLVING]] only if [[ionmov]] == 2 and [[optcell]]/=0, otherwise it is</span>
<a name="15386"><font size=-1>15386     </font></a><span class="string">fixed.</span>
<a name="15387"><font size=-1>15387     </font></a><span class="string">If the Default is used, that is, [[rprim]] is the unity matrix, the three</span>
<a name="15388"><font size=-1>15388     </font></a><span class="string">dimensionless primitive vectors are three unit vectors in cartesian</span>
<a name="15389"><font size=-1>15389     </font></a><span class="string">coordinates. Each will be (possibly) multiplied by the corresponding [[acell]]</span>
<a name="15390"><font size=-1>15390     </font></a><span class="string">value, then (possibly) stretched along the cartesian coordinates by the</span>
<a name="15391"><font size=-1>15391     </font></a><span class="string">corresponding [[scalecart]] value, to give the dimensional primitive vectors,</span>
<a name="15392"><font size=-1>15392     </font></a><span class="string">called [[rprimd]].</span>
<a name="15393"><font size=-1>15393     </font></a><span class="string">In the general case, the dimensional cartesian coordinates of the crystal</span>
<a name="15394"><font size=-1>15394     </font></a><span class="string">primitive translations R1p, R2p and R3p, see [[rprimd]], are</span>
<a name="15395"><font size=-1>15395     </font></a><span class="string"></span>
<a name="15396"><font size=-1>15396     </font></a><span class="string">  * R1p(i)=[[scalecart]](i)[[rprim]](i,1)*[[acell]](1)</span>
<a name="15397"><font size=-1>15397     </font></a><span class="string">  * R2p(i)=[[scalecart]](i)[[rprim]](i,2)*[[acell]](2)</span>
<a name="15398"><font size=-1>15398     </font></a><span class="string">  * R3p(i)=[[scalecart]](i)[[rprim]](i,3)*[[acell]](3)</span>
<a name="15399"><font size=-1>15399     </font></a><span class="string"></span>
<a name="15400"><font size=-1>15400     </font></a><span class="string">where i=1,2,3 is the component of the primitive translation (i.e. x, y, and z).</span>
<a name="15401"><font size=-1>15401     </font></a><span class="string"></span>
<a name="15402"><font size=-1>15402     </font></a><span class="string">The [[rprim]] variable, scaled by [[scalecart]], is thus used to define</span>
<a name="15403"><font size=-1>15403     </font></a><span class="string">directions of the primitive vectors, that will be multiplied (so keeping the</span>
<a name="15404"><font size=-1>15404     </font></a><span class="string">direction unchanged) by the appropriate length scale [[acell]](1),</span>
<a name="15405"><font size=-1>15405     </font></a><span class="string">[[acell]](2), or [[acell]](3), respectively to give the dimensional primitive</span>
<a name="15406"><font size=-1>15406     </font></a><span class="string">translations in real space in cartesian coordinates.</span>
<a name="15407"><font size=-1>15407     </font></a><span class="string">Presently, it is requested that the mixed product (R1xR2).R3 is positive. If</span>
<a name="15408"><font size=-1>15408     </font></a><span class="string">this is not the case, simply exchange a pair of vectors.</span>
<a name="15409"><font size=-1>15409     </font></a><span class="string">To be more specific, keeping the default value of [[scalecart]] = 1 to simplify</span>
<a name="15410"><font size=-1>15410     </font></a><span class="string">the matter, [[rprim]] 1 2 3 4 5 6 7 8 9 corresponds to input of the three</span>
<a name="15411"><font size=-1>15411     </font></a><span class="string">primitive translations R1=(1,2,3) (to be multiplied by [[acell]](1)),</span>
<a name="15412"><font size=-1>15412     </font></a><span class="string">R2=(4,5,6) (to be multiplied by [[acell]](2)), and R3=(7,8,9) (to be</span>
<a name="15413"><font size=-1>15413     </font></a><span class="string">multiplied by [[acell](3)).</span>
<a name="15414"><font size=-1>15414     </font></a><span class="string">Note carefully that the first three numbers input are the first column of</span>
<a name="15415"><font size=-1>15415     </font></a><span class="string">[[rprim]], the next three are the second, and the final three are the third.</span>
<a name="15416"><font size=-1>15416     </font></a><span class="string">This corresponds with the usual Fortran order for arrays. The matrix whose</span>
<a name="15417"><font size=-1>15417     </font></a><span class="string">columns are the reciprocal space primitive translations is the inverse</span>
<a name="15418"><font size=-1>15418     </font></a><span class="string">transpose of the matrix whose columns are the direct space primitive</span>
<a name="15419"><font size=-1>15419     </font></a><span class="string">translations.</span>
<a name="15420"><font size=-1>15420     </font></a><span class="string"></span>
<a name="15421"><font size=-1>15421     </font></a><span class="string">Alternatively to [[rprim]], directions of dimensionless primitive vectors can</span>
<a name="15422"><font size=-1>15422     </font></a><span class="string">be specified by using the input variable [[angdeg]]. This is especially useful</span>
<a name="15423"><font size=-1>15423     </font></a><span class="string">for hexagonal lattices (with 120 or 60 degrees angles). Indeed, in order for</span>
<a name="15424"><font size=-1>15424     </font></a><span class="string">symmetries to be recognized, rprim must be symmetric up to [[tolsym]] (10</span>
<a name="15425"><font size=-1>15425     </font></a><span class="string">digits by default), inducing a specification such as</span>
<a name="15426"><font size=-1>15426     </font></a><span class="string"></span>
<a name="15427"><font size=-1>15427     </font></a><span class="string">      rprim  0.86602540378  0.5  0.0</span>
<a name="15428"><font size=-1>15428     </font></a><span class="string">            -0.86602540378  0.5  0.0</span>
<a name="15429"><font size=-1>15429     </font></a><span class="string">             0.0            0.0  1.0</span>
<a name="15430"><font size=-1>15430     </font></a><span class="string"></span>
<a name="15431"><font size=-1>15431     </font></a><span class="string">that can be avoided thanks to [[angdeg]]:</span>
<a name="15432"><font size=-1>15432     </font></a><span class="string"></span>
<a name="15433"><font size=-1>15433     </font></a><span class="string">      angdeg 90 90 120</span>
<a name="15434"><font size=-1>15434     </font></a><span class="string"></span>
<a name="15435"><font size=-1>15435     </font></a><span class="string">Although the use of [[scalecart]] or [[acell]] is rather equivalent when the</span>
<a name="15436"><font size=-1>15436     </font></a><span class="string">primitive vectors are aligned with the cartesian directions, it is not the</span>
<a name="15437"><font size=-1>15437     </font></a><span class="string">case for non-orthogonal primitive vectors. In particular, beginners often make</span>
<a name="15438"><font size=-1>15438     </font></a><span class="string">the error of trying to use [[acell]] to define primitive vectors in face-</span>
<a name="15439"><font size=-1>15439     </font></a><span class="string">centered tetragonal lattice, or body-centered tetragonal lattice, or similarly</span>
<a name="15440"><font size=-1>15440     </font></a><span class="string">in face or body-centered orthorhombic lattices. Let us take the example of a</span>
<a name="15441"><font size=-1>15441     </font></a><span class="string">body-centered tetragonal lattice, that might be defined using the following</span>
<a name="15442"><font size=-1>15442     </font></a><span class="string">(&quot;a&quot; and &quot;c&quot; have to be replaced by the appropriate conventional cell vector length):</span>
<a name="15443"><font size=-1>15443     </font></a><span class="string"></span>
<a name="15444"><font size=-1>15444     </font></a><span class="string">      rprim  &quot;a&quot;      0        0</span>
<a name="15445"><font size=-1>15445     </font></a><span class="string">              0      &quot;a&quot;       0</span>
<a name="15446"><font size=-1>15446     </font></a><span class="string">             &quot;a/2&quot;   &quot;a/2&quot;    &quot;c/2&quot;</span>
<a name="15447"><font size=-1>15447     </font></a><span class="string">    acell 3*1     scalecart 3*1    !  ( These are default values)</span>
<a name="15448"><font size=-1>15448     </font></a><span class="string"></span>
<a name="15449"><font size=-1>15449     </font></a><span class="string"></span>
<a name="15450"><font size=-1>15450     </font></a><span class="string">The following is a valid, alternative way to define the same primitive vectors:</span>
<a name="15451"><font size=-1>15451     </font></a><span class="string"></span>
<a name="15452"><font size=-1>15452     </font></a><span class="string">      rprim   1        0       0</span>
<a name="15453"><font size=-1>15453     </font></a><span class="string">              0        1       0</span>
<a name="15454"><font size=-1>15454     </font></a><span class="string">              1/2      1/2     1/2</span>
<a name="15455"><font size=-1>15455     </font></a><span class="string">    scalecart  &quot;a&quot;  &quot;a&quot;  &quot;c&quot;</span>
<a name="15456"><font size=-1>15456     </font></a><span class="string">    acell 3*1    !  ( These are default values)</span>
<a name="15457"><font size=-1>15457     </font></a><span class="string"></span>
<a name="15458"><font size=-1>15458     </font></a><span class="string">Indeed, the cell has been stretched along the cartesian coordinates, by &quot;a&quot;,</span>
<a name="15459"><font size=-1>15459     </font></a><span class="string">&quot;a&quot; and &quot;c&quot; factors.</span>
<a name="15460"><font size=-1>15460     </font></a><span class="string"></span>
<a name="15461"><font size=-1>15461     </font></a><span class="string">At variance, the following is WRONG:</span>
<a name="15462"><font size=-1>15462     </font></a><span class="string"></span>
<a name="15463"><font size=-1>15463     </font></a><span class="string">      rprim   1       0       0</span>
<a name="15464"><font size=-1>15464     </font></a><span class="string">              0       1       0</span>
<a name="15465"><font size=-1>15465     </font></a><span class="string">              1/2     1/2     1/2</span>
<a name="15466"><font size=-1>15466     </font></a><span class="string">    acell  &quot;a&quot;  &quot;a&quot;  &quot;c&quot;    !   THIS IS WRONG</span>
<a name="15467"><font size=-1>15467     </font></a><span class="string">    scalecart 3*1    !  ( These are default values)</span>
<a name="15468"><font size=-1>15468     </font></a><span class="string"></span>
<a name="15469"><font size=-1>15469     </font></a><span class="string">Indeed, the latter would correspond to:</span>
<a name="15470"><font size=-1>15470     </font></a><span class="string"></span>
<a name="15471"><font size=-1>15471     </font></a><span class="string">      rprim  &quot;a&quot;      0       0</span>
<a name="15472"><font size=-1>15472     </font></a><span class="string">              0      &quot;a&quot;      0</span>
<a name="15473"><font size=-1>15473     </font></a><span class="string">             &quot;c/2&quot;   &quot;c/2&quot;   &quot;c/2&quot;</span>
<a name="15474"><font size=-1>15474     </font></a><span class="string">    acell 3*1     scalecart 3*1    !  ( These are default values)</span>
<a name="15475"><font size=-1>15475     </font></a><span class="string"></span>
<a name="15476"><font size=-1>15476     </font></a><span class="string">Namely, the third vector has been rescaled by &quot;c&quot;. It is not at all in the</span>
<a name="15477"><font size=-1>15477     </font></a><span class="string">center of the tetragonal cell whose basis vectors are defined by the scaling factor &quot;a&quot;.</span>
<a name="15478"><font size=-1>15478     </font></a><span class="string">As another difference between [[scalecart]] or [[acell]], note that</span>
<a name="15479"><font size=-1>15479     </font></a><span class="string">[[scalecart]] is [[INPUT_ONLY]]: its content will be immediately applied to</span>
<a name="15480"><font size=-1>15480     </font></a><span class="string">rprim, at parsing time, and then scalecart will be set to the default values</span>
<a name="15481"><font size=-1>15481     </font></a><span class="string">(3*1). So, in case [[scalecart]] is used, the echo of [[rprim]] in the output</span>
<a name="15482"><font size=-1>15482     </font></a><span class="string">file is not the value contained in the input file, but the value rescaled by [[scalecart]].</span>
<a name="15483"><font size=-1>15483     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15484"><font size=-1>15484     </font></a><span class="default">),</span>
<a name="15485"><font size=-1>15485     </font></a><span class="default"></span>
<a name="15486"><font size=-1>15486     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15487"><font size=-1>15487     </font></a><span class="default">    abivarname=</span><span class="string">&quot;rprimd&quot;</span><span class="default">,</span>
<a name="15488"><font size=-1>15488     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="15489"><font size=-1>15489     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15490"><font size=-1>15490     </font></a><span class="default">    topics=[</span><span class="string">'UnitCell_internal'</span><span class="default">],</span>
<a name="15491"><font size=-1>15491     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="number">3</span><span class="default">],</span>
<a name="15492"><font size=-1>15492     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Real space PRIMitive translations, Dimensional&quot;</span><span class="default">,</span>
<a name="15493"><font size=-1>15493     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">, </span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="15494"><font size=-1>15494     </font></a><span class="default">    commentdims=</span><span class="string">&quot;Internally, it is represented as rprimd(3,3,[[nimage]]).&quot;</span><span class="default">,</span>
<a name="15495"><font size=-1>15495     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15496"><font size=-1>15496     </font></a><span class="string">This internal variable gives the dimensional real space primitive vectors,</span>
<a name="15497"><font size=-1>15497     </font></a><span class="string">computed from [[acell]], [[scalecart]], and [[rprim]].</span>
<a name="15498"><font size=-1>15498     </font></a><span class="string"></span>
<a name="15499"><font size=-1>15499     </font></a><span class="string">  * R1p(i)=[[rprimd]](i,1)=[[scalecart]](i)*[[rprim]](i,1)*[[acell]](1) for i=1,2,3 (x,y,and z)</span>
<a name="15500"><font size=-1>15500     </font></a><span class="string">  * R2p(i)=[[rprimd]](i,2)=[[scalecart]](i)*[[rprim]](i,2)*[[acell]](2) for i=1,2,3</span>
<a name="15501"><font size=-1>15501     </font></a><span class="string">  * R3p(i)=[[rprimd]](i,3)=[[scalecart]](i)*[[rprim]](i,3)*[[acell]](3) for i=1,2,3</span>
<a name="15502"><font size=-1>15502     </font></a><span class="string"></span>
<a name="15503"><font size=-1>15503     </font></a><span class="string">It is [[EVOLVING]] only if [[ionmov]] == 2 and [[optcell]]/=0, otherwise it is fixed.</span>
<a name="15504"><font size=-1>15504     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15505"><font size=-1>15505     </font></a><span class="default">),</span>
<a name="15506"><font size=-1>15506     </font></a><span class="default"></span>
<a name="15507"><font size=-1>15507     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15508"><font size=-1>15508     </font></a><span class="default">    abivarname=</span><span class="string">&quot;scalecart&quot;</span><span class="default">,</span>
<a name="15509"><font size=-1>15509     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="15510"><font size=-1>15510     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15511"><font size=-1>15511     </font></a><span class="default">    topics=[</span><span class="string">'UnitCell_useful'</span><span class="default">],</span>
<a name="15512"><font size=-1>15512     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="15513"><font size=-1>15513     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">1</span><span class="default">),</span>
<a name="15514"><font size=-1>15514     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SCALE CARTesian coordinates&quot;</span><span class="default">,</span>
<a name="15515"><font size=-1>15515     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="15516"><font size=-1>15516     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15517"><font size=-1>15517     </font></a><span class="string">Gives the scaling factors of cartesian coordinates by which dimensionless</span>
<a name="15518"><font size=-1>15518     </font></a><span class="string">primitive translations (in &quot;[[rprim]]&quot;) are to be multiplied. [[rprim]] input</span>
<a name="15519"><font size=-1>15519     </font></a><span class="string">variable, the [[acell]] input variable, and the associated internal [[rprimd]]</span>
<a name="15520"><font size=-1>15520     </font></a><span class="string">internal variable.</span>
<a name="15521"><font size=-1>15521     </font></a><span class="string">Especially useful for body-centered and face-centered tetragonal lattices, as</span>
<a name="15522"><font size=-1>15522     </font></a><span class="string">well as body-centered and face-centered orthorhombic lattices, see [[rprimd]].</span>
<a name="15523"><font size=-1>15523     </font></a><span class="string">Note that this input variable is [[INPUT_ONLY]]: its content will be</span>
<a name="15524"><font size=-1>15524     </font></a><span class="string">immediately applied to rprim, at parsing time, and then scalecart will be set</span>
<a name="15525"><font size=-1>15525     </font></a><span class="string">to the default values. So, it will not be echoed.</span>
<a name="15526"><font size=-1>15526     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15527"><font size=-1>15527     </font></a><span class="default">),</span>
<a name="15528"><font size=-1>15528     </font></a><span class="default"></span>
<a name="15529"><font size=-1>15529     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15530"><font size=-1>15530     </font></a><span class="default">    abivarname=</span><span class="string">&quot;scphon_supercell&quot;</span><span class="default">,</span>
<a name="15531"><font size=-1>15531     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15532"><font size=-1>15532     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15533"><font size=-1>15533     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="15534"><font size=-1>15534     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="15535"><font size=-1>15535     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">, </span><span class="number">1</span><span class="default">],</span>
<a name="15536"><font size=-1>15536     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Self Consistent PHONon SUPERCELL&quot;</span><span class="default">,</span>
<a name="15537"><font size=-1>15537     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15538"><font size=-1>15538     </font></a><span class="string">Give extent, in number of primitive unit cells, of the supercell being used</span>
<a name="15539"><font size=-1>15539     </font></a><span class="string">for a self-consistent phonon calculation. Presumes the phonon frequencies and</span>
<a name="15540"><font size=-1>15540     </font></a><span class="string">eigenvectors have been calculated in the original primitive unit cell, on a</span>
<a name="15541"><font size=-1>15541     </font></a><span class="string">grid of q-points which corresponds to the supercell in the present calculation.</span>
<a name="15542"><font size=-1>15542     </font></a><span class="string">Experimental.</span>
<a name="15543"><font size=-1>15543     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15544"><font size=-1>15544     </font></a><span class="default">),</span>
<a name="15545"><font size=-1>15545     </font></a><span class="default"></span>
<a name="15546"><font size=-1>15546     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15547"><font size=-1>15547     </font></a><span class="default">    abivarname=</span><span class="string">&quot;scphon_temp&quot;</span><span class="default">,</span>
<a name="15548"><font size=-1>15548     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15549"><font size=-1>15549     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15550"><font size=-1>15550     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">],</span>
<a name="15551"><font size=-1>15551     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15552"><font size=-1>15552     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="15553"><font size=-1>15553     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Self Consistent PHONon TEMPerature&quot;</span><span class="default">,</span>
<a name="15554"><font size=-1>15554     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="15555"><font size=-1>15555     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15556"><font size=-1>15556     </font></a><span class="string">Temperature which is imposed on phonon distribution, in the self-consistent</span>
<a name="15557"><font size=-1>15557     </font></a><span class="string">scheme of [[cite:Souvatzis2008]]. Determines the extent of the</span>
<a name="15558"><font size=-1>15558     </font></a><span class="string">finite displacements used, and consequent anharmonic effects. Experimental.</span>
<a name="15559"><font size=-1>15559     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15560"><font size=-1>15560     </font></a><span class="default">),</span>
<a name="15561"><font size=-1>15561     </font></a><span class="default"></span>
<a name="15562"><font size=-1>15562     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15563"><font size=-1>15563     </font></a><span class="default">    abivarname=</span><span class="string">&quot;shiftk&quot;</span><span class="default">,</span>
<a name="15564"><font size=-1>15564     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="15565"><font size=-1>15565     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15566"><font size=-1>15566     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="15567"><font size=-1>15567     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nshiftk]]'</span><span class="default">],</span>
<a name="15568"><font size=-1>15568     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nshiftk]]&gt;1'</span><span class="default">: </span><span class="keyword">None</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: [</span><span class="number">0.5</span><span class="default">, </span><span class="number">0.5</span><span class="default">, </span><span class="number">0.5</span><span class="default">]}),</span>
<a name="15569"><font size=-1>15569     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SHIFT for K points&quot;</span><span class="default">,</span>
<a name="15570"><font size=-1>15570     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15571"><font size=-1>15571     </font></a><span class="string">It is used only when [[kptopt]] &gt;= 0, and must be defined if [[nshiftk]] is</span>
<a name="15572"><font size=-1>15572     </font></a><span class="string">larger than 1.</span>
<a name="15573"><font size=-1>15573     </font></a><span class="string">[[shiftk]](1:3,1:[[nshiftk]]) defines [[nshiftk]] shifts of the homogeneous</span>
<a name="15574"><font size=-1>15574     </font></a><span class="string">grid of k points based on [[ngkpt]] or [[kptrlatt]].</span>
<a name="15575"><font size=-1>15575     </font></a><span class="string">The shifts induced by [[shiftk]] corresponds to the reduced coordinates in the</span>
<a name="15576"><font size=-1>15576     </font></a><span class="string">coordinate system defining the k-point lattice. For example, if the k point</span>
<a name="15577"><font size=-1>15577     </font></a><span class="string">lattice is defined using [[ngkpt]], the point whose reciprocal space reduced</span>
<a name="15578"><font size=-1>15578     </font></a><span class="string">coordinates are ( [[shiftk]](1,ii)/[[ngkpt]](1) [[shiftk]](2,ii)/[[ngkpt]](2)</span>
<a name="15579"><font size=-1>15579     </font></a><span class="string">[[shiftk]](3,ii)/[[ngkpt]](3) ) belongs to the shifted grid number ii.</span>
<a name="15580"><font size=-1>15580     </font></a><span class="string"></span>
<a name="15581"><font size=-1>15581     </font></a><span class="string">The user might rely on ABINIT to suggest suitable and efficient combinations</span>
<a name="15582"><font size=-1>15582     </font></a><span class="string">of [[kptrlatt]] and [[shiftk]]. The procedure to be followed is described with</span>
<a name="15583"><font size=-1>15583     </font></a><span class="string">the input variables [[kptrlen]]. In what follows, we suggest some interesting</span>
<a name="15584"><font size=-1>15584     </font></a><span class="string">values of the shifts, to be used with even values of [[ngkpt]]. This list is</span>
<a name="15585"><font size=-1>15585     </font></a><span class="string">much less exhaustive than the above-mentioned automatic procedure.</span>
<a name="15586"><font size=-1>15586     </font></a><span class="string"></span>
<a name="15587"><font size=-1>15587     </font></a><span class="string">1) When the primitive vectors of the lattice do NOT form a FCC or a BCC</span>
<a name="15588"><font size=-1>15588     </font></a><span class="string">lattice, the default (shifted) Monkhorst-Pack grids are formed by using</span>
<a name="15589"><font size=-1>15589     </font></a><span class="string">[[nshiftk]] = 1 and [[shiftk]] 0.5 0.5 0.5. This is often the preferred k point</span>
<a name="15590"><font size=-1>15590     </font></a><span class="string">sampling, as the shift improves the sampling efficiency. However, it can also</span>
<a name="15591"><font size=-1>15591     </font></a><span class="string">break symmetry, if the 111 direction is not an axis of rotation, e.g. in</span>
<a name="15592"><font size=-1>15592     </font></a><span class="string">tetragonal or hexagonal systems. Abinit will complain about this breaking, and</span>
<a name="15593"><font size=-1>15593     </font></a><span class="string">you should adapt [[shiftk]]. For a non-shifted Monkhorst-Pack grid, use</span>
<a name="15594"><font size=-1>15594     </font></a><span class="string">[[nshiftk]] = 1 and [[shiftk]] 0.0 0.0 0.0, which will be compatible with all</span>
<a name="15595"><font size=-1>15595     </font></a><span class="string">symmetries, and is necessary for some features such as k-point interpolation.</span>
<a name="15596"><font size=-1>15596     </font></a><span class="string"></span>
<a name="15597"><font size=-1>15597     </font></a><span class="string">2) When the primitive vectors of the lattice form a FCC lattice, with [[rprim]]</span>
<a name="15598"><font size=-1>15598     </font></a><span class="string"></span>
<a name="15599"><font size=-1>15599     </font></a><span class="string">      0.0 0.5 0.5</span>
<a name="15600"><font size=-1>15600     </font></a><span class="string">      0.5 0.0 0.5</span>
<a name="15601"><font size=-1>15601     </font></a><span class="string">      0.5 0.5 0.0</span>
<a name="15602"><font size=-1>15602     </font></a><span class="string"></span>
<a name="15603"><font size=-1>15603     </font></a><span class="string">the (very efficient) usual Monkhorst-Pack sampling will be generated by using</span>
<a name="15604"><font size=-1>15604     </font></a><span class="string">[[nshiftk]] =  4 and [[shiftk]]</span>
<a name="15605"><font size=-1>15605     </font></a><span class="string"></span>
<a name="15606"><font size=-1>15606     </font></a><span class="string">      0.5 0.5 0.5</span>
<a name="15607"><font size=-1>15607     </font></a><span class="string">      0.5 0.0 0.0</span>
<a name="15608"><font size=-1>15608     </font></a><span class="string">      0.0 0.5 0.0</span>
<a name="15609"><font size=-1>15609     </font></a><span class="string">      0.0 0.0 0.5</span>
<a name="15610"><font size=-1>15610     </font></a><span class="string"></span>
<a name="15611"><font size=-1>15611     </font></a><span class="string">3) When the primitive vectors of the lattice form a BCC lattice, with [[rprim]]</span>
<a name="15612"><font size=-1>15612     </font></a><span class="string"></span>
<a name="15613"><font size=-1>15613     </font></a><span class="string">      -0.5  0.5  0.5</span>
<a name="15614"><font size=-1>15614     </font></a><span class="string">       0.5 -0.5  0.5</span>
<a name="15615"><font size=-1>15615     </font></a><span class="string">       0.5  0.5 -0.5</span>
<a name="15616"><font size=-1>15616     </font></a><span class="string"></span>
<a name="15617"><font size=-1>15617     </font></a><span class="string">the usual Monkhorst-Pack sampling will be generated by using [[nshiftk]] =  2</span>
<a name="15618"><font size=-1>15618     </font></a><span class="string">and [[shiftk]]</span>
<a name="15619"><font size=-1>15619     </font></a><span class="string"></span>
<a name="15620"><font size=-1>15620     </font></a><span class="string">      0.25  0.25  0.25</span>
<a name="15621"><font size=-1>15621     </font></a><span class="string">     -0.25 -0.25 -0.25</span>
<a name="15622"><font size=-1>15622     </font></a><span class="string"></span>
<a name="15623"><font size=-1>15623     </font></a><span class="string">However, the simple sampling [[nshiftk]] = 1 and [[shiftk]] 0.5 0.5 0.5 is excellent.</span>
<a name="15624"><font size=-1>15624     </font></a><span class="string"></span>
<a name="15625"><font size=-1>15625     </font></a><span class="string">4) For hexagonal lattices with hexagonal axes, e.g. [[rprim]]</span>
<a name="15626"><font size=-1>15626     </font></a><span class="string"></span>
<a name="15627"><font size=-1>15627     </font></a><span class="string">      1.0  0.0       0.0</span>
<a name="15628"><font size=-1>15628     </font></a><span class="string">     -0.5  sqrt(3)/2 0.0</span>
<a name="15629"><font size=-1>15629     </font></a><span class="string">      0.0  0.0       1.0</span>
<a name="15630"><font size=-1>15630     </font></a><span class="string"></span>
<a name="15631"><font size=-1>15631     </font></a><span class="string">one can use [[nshiftk]] =  1 and [[shiftk]] 0.0 0.0 0.5</span>
<a name="15632"><font size=-1>15632     </font></a><span class="string"></span>
<a name="15633"><font size=-1>15633     </font></a><span class="string">In rhombohedral axes, e.g. using [[angdeg]] 3*60., this corresponds to</span>
<a name="15634"><font size=-1>15634     </font></a><span class="string">[[shiftk]] 0.5 0.5 0.5, to keep the shift along the symmetry axis.</span>
<a name="15635"><font size=-1>15635     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15636"><font size=-1>15636     </font></a><span class="default">),</span>
<a name="15637"><font size=-1>15637     </font></a><span class="default"></span>
<a name="15638"><font size=-1>15638     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15639"><font size=-1>15639     </font></a><span class="default">    abivarname=</span><span class="string">&quot;shiftq&quot;</span><span class="default">,</span>
<a name="15640"><font size=-1>15640     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15641"><font size=-1>15641     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15642"><font size=-1>15642     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="15643"><font size=-1>15643     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nshiftq]]'</span><span class="default">],</span>
<a name="15644"><font size=-1>15644     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nshiftq]]&gt;1'</span><span class="default">: </span><span class="keyword">None</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: [</span><span class="number">0.5</span><span class="default">, </span><span class="number">0.5</span><span class="default">, </span><span class="number">0.5</span><span class="default">]}),</span>
<a name="15645"><font size=-1>15645     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SHIFT for Q points&quot;</span><span class="default">,</span>
<a name="15646"><font size=-1>15646     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="15647"><font size=-1>15647     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15648"><font size=-1>15648     </font></a><span class="string">It is used only when [[qptopt]] &gt;= 0, and must be defined if [[nshiftq]] is larger than 1.</span>
<a name="15649"><font size=-1>15649     </font></a><span class="string">[[shiftq]](1:3,1:[[nshiftq]]) defines [[nshiftq]] shifts of the homogeneous</span>
<a name="15650"><font size=-1>15650     </font></a><span class="string">grid of q points based on [[ngqpt]] or [[qptrlatt]].</span>
<a name="15651"><font size=-1>15651     </font></a><span class="string"></span>
<a name="15652"><font size=-1>15652     </font></a><span class="string">See [[shiftk]] for more information on the definition, use, and suitable</span>
<a name="15653"><font size=-1>15653     </font></a><span class="string">values for these shifts.</span>
<a name="15654"><font size=-1>15654     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15655"><font size=-1>15655     </font></a><span class="default">),</span>
<a name="15656"><font size=-1>15656     </font></a><span class="default"></span>
<a name="15657"><font size=-1>15657     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15658"><font size=-1>15658     </font></a><span class="default">    abivarname=</span><span class="string">&quot;signperm&quot;</span><span class="default">,</span>
<a name="15659"><font size=-1>15659     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="15660"><font size=-1>15660     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15661"><font size=-1>15661     </font></a><span class="default">    topics=[</span><span class="string">'MolecularDynamics_expert'</span><span class="default">],</span>
<a name="15662"><font size=-1>15662     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15663"><font size=-1>15663     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="15664"><font size=-1>15664     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SIGN of PERMutation potential&quot;</span><span class="default">,</span>
<a name="15665"><font size=-1>15665     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15666"><font size=-1>15666     </font></a><span class="string">+1 favors alternation of species -1 favors segregation</span>
<a name="15667"><font size=-1>15667     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15668"><font size=-1>15668     </font></a><span class="default">),</span>
<a name="15669"><font size=-1>15669     </font></a><span class="default"></span>
<a name="15670"><font size=-1>15670     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15671"><font size=-1>15671     </font></a><span class="default">    abivarname=</span><span class="string">&quot;slabwsrad&quot;</span><span class="default">,</span>
<a name="15672"><font size=-1>15672     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15673"><font size=-1>15673     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15674"><font size=-1>15674     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_expert'</span><span class="default">],</span>
<a name="15675"><font size=-1>15675     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15676"><font size=-1>15676     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="15677"><font size=-1>15677     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;jellium SLAB Wigner-Seitz RADius&quot;</span><span class="default">,</span>
<a name="15678"><font size=-1>15678     </font></a><span class="default">    characteristics=[</span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="15679"><font size=-1>15679     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="15680"><font size=-1>15680     </font></a><span class="string">Fix the bulk-mean positive charge density $n_{bulk}$ of a jellium slab (if the</span>
<a name="15681"><font size=-1>15681     </font></a><span class="string">latter is employed, e.g. [[jellslab]]/=0). Often called $r_s$ (see for example</span>
<a name="15682"><font size=-1>15682     </font></a><span class="string">[[cite:Lang1970]]), [[slabwsrad]] is the radius of a</span>
<a name="15683"><font size=-1>15683     </font></a><span class="string">sphere which has the same volume as the average volume per particle in a</span>
<a name="15684"><font size=-1>15684     </font></a><span class="string">homogeneous electron gas with density $n_{bulk}$, so:</span>
<a name="15685"><font size=-1>15685     </font></a><span class="string">\begin{equation}</span>
<a name="15686"><font size=-1>15686     </font></a><span class="string">      1/n_{bulk} = 4/3\: \pi [[slabwsrad]]^3 \nonumber</span>
<a name="15687"><font size=-1>15687     </font></a><span class="string">\end{equation}</span>
<a name="15688"><font size=-1>15688     </font></a><span class="string">For example, the bulk aluminum fcc lattice constant is $a$=4.0495 Angstroms</span>
<a name="15689"><font size=-1>15689     </font></a><span class="string">[WebElements](https://www.webelements.com/), each cubic centered cell includes 4 Al atoms and each atom</span>
<a name="15690"><font size=-1>15690     </font></a><span class="string">has 3 valence electrons, so the average volume per electron is $a^3/12$=37.34</span>
<a name="15691"><font size=-1>15691     </font></a><span class="string">Bohr$^3$ which has to be equal to $4/3\: \pi r_s^3$. Consequently Al has approximately</span>
<a name="15692"><font size=-1>15692     </font></a><span class="string">$r_s$=2.07 Bohr, while for example magnesium has $r_s$=2.65 Bohr, sodium 3.99 Bohr.</span>
<a name="15693"><font size=-1>15693     </font></a><span class="string">By default, given in Bohr atomic units (1 Bohr=0.5291772108 Angstroms).</span>
<a name="15694"><font size=-1>15694     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15695"><font size=-1>15695     </font></a><span class="default">),</span>
<a name="15696"><font size=-1>15696     </font></a><span class="default"></span>
<a name="15697"><font size=-1>15697     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15698"><font size=-1>15698     </font></a><span class="default">    abivarname=</span><span class="string">&quot;slabzbeg&quot;</span><span class="default">,</span>
<a name="15699"><font size=-1>15699     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15700"><font size=-1>15700     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15701"><font size=-1>15701     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_expert'</span><span class="default">],</span>
<a name="15702"><font size=-1>15702     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15703"><font size=-1>15703     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="15704"><font size=-1>15704     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;jellium SLAB BEGinning edge along the z-direction&quot;</span><span class="default">,</span>
<a name="15705"><font size=-1>15705     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="15706"><font size=-1>15706     </font></a><span class="string">Define the edges of the jellium slab (if used, so if [[jellslab]]/=0) along</span>
<a name="15707"><font size=-1>15707     </font></a><span class="string">z, namely the slab starts at a point along z which is expressed in Bohr by</span>
<a name="15708"><font size=-1>15708     </font></a><span class="string">[[slabzbeg]] and it ends at a point expressed in Bohr by [[slabzend]].</span>
<a name="15709"><font size=-1>15709     </font></a><span class="string">The z-direction is parallel to the third crystal primitive lattice vector which has</span>
<a name="15710"><font size=-1>15710     </font></a><span class="string">to be orthogonal to the other ones, so the length of the cell along z is</span>
<a name="15711"><font size=-1>15711     </font></a><span class="string">[[rprimd]](3,3). In addition [[slabzbeg]] and [[slabzend]] have to be such that:</span>
<a name="15712"><font size=-1>15712     </font></a><span class="string"></span>
<a name="15713"><font size=-1>15713     </font></a><span class="string">      0  [[slabzbeg]]  &lt; [[slabzend]]  [[rprimd]](3,3)</span>
<a name="15714"><font size=-1>15714     </font></a><span class="string"></span>
<a name="15715"><font size=-1>15715     </font></a><span class="string">Together with [[slabwsrad]] they define the jellium positive charge density</span>
<a name="15716"><font size=-1>15716     </font></a><span class="string">distribution $n_{+}(x,y,z)$ in this way:</span>
<a name="15717"><font size=-1>15717     </font></a><span class="string"></span>
<a name="15718"><font size=-1>15718     </font></a><span class="string">\begin{eqnarray}</span>
<a name="15719"><font size=-1>15719     </font></a><span class="string">      n_{+}(x,y,z) &amp;=&amp; n_{bulk} \quad \text{if} \quad [[slabzbeg]]  \leq z \leq [[slabzend]]  \nonumber\\</span>
<a name="15720"><font size=-1>15720     </font></a><span class="string">                &amp;=&amp; 0       \quad \text{otherwise}                           \nonumber</span>
<a name="15721"><font size=-1>15721     </font></a><span class="string">\end{eqnarray}</span>
<a name="15722"><font size=-1>15722     </font></a><span class="string"></span>
<a name="15723"><font size=-1>15723     </font></a><span class="string">so the positive charge density is invariant along the xy plane as well as the</span>
<a name="15724"><font size=-1>15724     </font></a><span class="string">electrostatic potential generated by it.</span>
<a name="15725"><font size=-1>15725     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15726"><font size=-1>15726     </font></a><span class="default">),</span>
<a name="15727"><font size=-1>15727     </font></a><span class="default"></span>
<a name="15728"><font size=-1>15728     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15729"><font size=-1>15729     </font></a><span class="default">    abivarname=</span><span class="string">&quot;slabzend&quot;</span><span class="default">,</span>
<a name="15730"><font size=-1>15730     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15731"><font size=-1>15731     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15732"><font size=-1>15732     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_expert'</span><span class="default">],</span>
<a name="15733"><font size=-1>15733     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15734"><font size=-1>15734     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="15735"><font size=-1>15735     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;jellium SLAB ENDing edge along the z-direction&quot;</span><span class="default">,</span>
<a name="15736"><font size=-1>15736     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="15737"><font size=-1>15737     </font></a><span class="string">Define the edges of the jellium slab (if used, so if [[jellslab]]/=0) along</span>
<a name="15738"><font size=-1>15738     </font></a><span class="string">z, namely the slab starts at a point along z which is expressed in Bohr by</span>
<a name="15739"><font size=-1>15739     </font></a><span class="string">[[slabzbeg]] and it ends at a point expressed in Bohr by [[slabzend]].</span>
<a name="15740"><font size=-1>15740     </font></a><span class="string">The z-direction is parallel to the third crystal primitive lattice vector which has</span>
<a name="15741"><font size=-1>15741     </font></a><span class="string">to be orthogonal to the other ones, so the length of the cell along z is</span>
<a name="15742"><font size=-1>15742     </font></a><span class="string">[[rprimd]](3,3). In addition [[slabzbeg]] and [[slabzend]] have to be such that:</span>
<a name="15743"><font size=-1>15743     </font></a><span class="string"></span>
<a name="15744"><font size=-1>15744     </font></a><span class="string">      0  [[slabzbeg]] &lt; [[slabzend]]   [[rprimd]](3,3)</span>
<a name="15745"><font size=-1>15745     </font></a><span class="string"></span>
<a name="15746"><font size=-1>15746     </font></a><span class="string">Together with [[slabwsrad]] they define the jellium positive charge density</span>
<a name="15747"><font size=-1>15747     </font></a><span class="string">distribution $n_{+}(x,y,z)$ in this way:</span>
<a name="15748"><font size=-1>15748     </font></a><span class="string">\begin{eqnarray}</span>
<a name="15749"><font size=-1>15749     </font></a><span class="string">      n_{+}(x,y,z) &amp;=&amp; n_{bulk} \quad  \text{if} \quad [[slabzbeg]] \leq z \leq [[slabzend]] \nonumber \\</span>
<a name="15750"><font size=-1>15750     </font></a><span class="string">                   &amp;=&amp; 0        \quad  \text{otherwise}                                    \nonumber</span>
<a name="15751"><font size=-1>15751     </font></a><span class="string">\end{eqnarray}</span>
<a name="15752"><font size=-1>15752     </font></a><span class="string">so the positive charge density is invariant along the xy plane as well as the</span>
<a name="15753"><font size=-1>15753     </font></a><span class="string">electrostatic potential generated by it.</span>
<a name="15754"><font size=-1>15754     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15755"><font size=-1>15755     </font></a><span class="default">),</span>
<a name="15756"><font size=-1>15756     </font></a><span class="default"></span>
<a name="15757"><font size=-1>15757     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15758"><font size=-1>15758     </font></a><span class="default">    abivarname=</span><span class="string">&quot;slk_rankpp&quot;</span><span class="default">,</span>
<a name="15759"><font size=-1>15759     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15760"><font size=-1>15760     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15761"><font size=-1>15761     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="15762"><font size=-1>15762     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15763"><font size=-1>15763     </font></a><span class="default">    defaultval=[</span><span class="number">1000</span><span class="default">],</span>
<a name="15764"><font size=-1>15764     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ScaLapacK matrix RANK Per Process&quot;</span><span class="default">,</span>
<a name="15765"><font size=-1>15765     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15766"><font size=-1>15766     </font></a><span class="string">This variable controls how the number of processes to be used in Scalapack diagonalization algorithm: [[np_slk]] will be calculated according to this value.</span>
<a name="15767"><font size=-1>15767     </font></a><span class="string">This value is the matrix rank each process will hold for the diagonalization.</span>
<a name="15768"><font size=-1>15768     </font></a><span class="string">For a 1000x1000 matrix with default value, scalapack won't be used.</span>
<a name="15769"><font size=-1>15769     </font></a><span class="string">For a 2000x2000 matrix with default value, scalapack will used 2000/1000=2 MPI.</span>
<a name="15770"><font size=-1>15770     </font></a><span class="string">For a 2000x2000 matrix with a slk_rank=500, scalapack will use 2000/500=4 MPI.</span>
<a name="15771"><font size=-1>15771     </font></a><span class="string">In case of hybrid MPI+OpenMP, the number of thread is also taken into account.</span>
<a name="15772"><font size=-1>15772     </font></a><span class="string">***WARNING*** None of the available scalapack library are thread-safe  (2018). Therefore using both scalapack *and* OpenMP is highly unpredictable.</span>
<a name="15773"><font size=-1>15773     </font></a><span class="string">Furthermore, using multithreaded linear algebra library (MKL ACML...) is more efficient than pure MPI scalapack.</span>
<a name="15774"><font size=-1>15774     </font></a><span class="string"></span>
<a name="15775"><font size=-1>15775     </font></a><span class="string">Usually it is better to tune this variable and let the code do the rest.</span>
<a name="15776"><font size=-1>15776     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15777"><font size=-1>15777     </font></a><span class="default">),</span>
<a name="15778"><font size=-1>15778     </font></a><span class="default"></span>
<a name="15779"><font size=-1>15779     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15780"><font size=-1>15780     </font></a><span class="default">    abivarname=</span><span class="string">&quot;smdelta&quot;</span><span class="default">,</span>
<a name="15781"><font size=-1>15781     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="15782"><font size=-1>15782     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15783"><font size=-1>15783     </font></a><span class="default">    topics=[</span><span class="string">'TDepES_compulsory'</span><span class="default">],</span>
<a name="15784"><font size=-1>15784     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15785"><font size=-1>15785     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15786"><font size=-1>15786     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SMeared DELTA function&quot;</span><span class="default">,</span>
<a name="15787"><font size=-1>15787     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15788"><font size=-1>15788     </font></a><span class="string">When [[smdelta]] in non-zero, it will trigger the calculation of the imaginary</span>
<a name="15789"><font size=-1>15789     </font></a><span class="string">part of the second-order electronic eigenvalues, which can be related to the</span>
<a name="15790"><font size=-1>15790     </font></a><span class="string">electronic lifetimes. The delta function is evaluated using:</span>
<a name="15791"><font size=-1>15791     </font></a><span class="string"></span>
<a name="15792"><font size=-1>15792     </font></a><span class="string">  * when [[smdelta]] == 1, Fermi-Dirac smearing: $$\\frac{0.25}{(cosh(\\frac{x}{2.0}))^2}$$</span>
<a name="15793"><font size=-1>15793     </font></a><span class="string">  * when [[smdelta]] == 2, Cold smearing by Marzari using the parameter $a=-0.5634$ (minimization of the bump): $$\\frac{e^{-x^2}}{\sqrt{\pi}}1.5\ d_0+x(-a\ 1.5\ d_0+x(-1.0\ d_0+a\ x))$$</span>
<a name="15794"><font size=-1>15794     </font></a><span class="string">  * when [[smdelta]] == 3, Cold smearing by Marzari using the parameter $a=-0.8165$ (monotonic function in the tail): as 2 but different $a$</span>
<a name="15795"><font size=-1>15795     </font></a><span class="string">  * when [[smdelta]] == 4, Smearing of Methfessel and Paxton ([[cite:Methfessel1989]]) with Hermite polynomial of degree 2, corresponding to &quot;Cold smearing&quot; of N. Marzari with $a=0$ (so, same smeared delta function as smdelta=2, with different $a$).</span>
<a name="15796"><font size=-1>15796     </font></a><span class="string">  * when [[smdelta]] == 5, Gaussian smearing: $$\\frac{1.0\ d_0\ e^{-x^2}}{\sqrt{\pi}}$$</span>
<a name="15797"><font size=-1>15797     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15798"><font size=-1>15798     </font></a><span class="default">),</span>
<a name="15799"><font size=-1>15799     </font></a><span class="default"></span>
<a name="15800"><font size=-1>15800     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15801"><font size=-1>15801     </font></a><span class="default">    abivarname=</span><span class="string">&quot;so_psp&quot;</span><span class="default">,</span>
<a name="15802"><font size=-1>15802     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15803"><font size=-1>15803     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15804"><font size=-1>15804     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_useful'</span><span class="default">],</span>
<a name="15805"><font size=-1>15805     </font></a><span class="default">    dimensions=[</span><span class="string">'[[npsp]]'</span><span class="default">],</span>
<a name="15806"><font size=-1>15806     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="string">'[[npsp]]'</span><span class="default">, value=</span><span class="number">1</span><span class="default">),</span>
<a name="15807"><font size=-1>15807     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Spin-Orbit treatment for each PSeudoPotential&quot;</span><span class="default">,</span>
<a name="15808"><font size=-1>15808     </font></a><span class="default">    requires=</span><span class="string">&quot;[[nspinor]] == 2 and [[usepaw]] == 0&quot;</span><span class="default">,</span>
<a name="15809"><font size=-1>15809     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15810"><font size=-1>15810     </font></a><span class="string">For each type of atom (each pseudopotential), specify the treatment of spin-orbit</span>
<a name="15811"><font size=-1>15811     </font></a><span class="string">interaction (if [[nspinor]] == 2 and Norm-conserving pseudopotentials i.e. [[usepaw]] == 0)</span>
<a name="15812"><font size=-1>15812     </font></a><span class="string">For PAW calculations with SOC, please refer to [[pawspnorb]].</span>
<a name="15813"><font size=-1>15813     </font></a><span class="string"></span>
<a name="15814"><font size=-1>15814     </font></a><span class="string">  * If 0: no spin-orbit interaction, even if [[nspinor]] = 2</span>
<a name="15815"><font size=-1>15815     </font></a><span class="string">  * If 1: treat spin-orbit as specified in the pseudopotential file.</span>
<a name="15816"><font size=-1>15816     </font></a><span class="string">  * If 2: treat spin-orbit in the HGH form (usual form, although not allowed for all pseudopotentials)</span>
<a name="15817"><font size=-1>15817     </font></a><span class="string">  * If 3: treat spin-orbit in the HFN form (Hemstreet-Fong-Nelson) (actually, not implemented...).</span>
<a name="15818"><font size=-1>15818     </font></a><span class="string"></span>
<a name="15819"><font size=-1>15819     </font></a><span class="string">For typical usage, the default value is OK. If the spin-orbit needs to be</span>
<a name="15820"><font size=-1>15820     </font></a><span class="string">turned off for one atom, 0 might be relevant. Note however, that the code will</span>
<a name="15821"><font size=-1>15821     </font></a><span class="string">stop if [[nspinor]] == 2 is used and one of the pseudopotential does not contain</span>
<a name="15822"><font size=-1>15822     </font></a><span class="string">the information about the spin-orbit interaction (this is the case for some</span>
<a name="15823"><font size=-1>15823     </font></a><span class="string">old pseudopotentials). Indeed, for spinorial calculations, turning off the</span>
<a name="15824"><font size=-1>15824     </font></a><span class="string">spin-orbit interaction is unphysical, and also does not save CPU time.</span>
<a name="15825"><font size=-1>15825     </font></a><span class="string">It should only be done for test purposes</span>
<a name="15826"><font size=-1>15826     </font></a><span class="string"></span>
<a name="15827"><font size=-1>15827     </font></a><span class="string">Note that if [[nspinor]] == 1, the spin-orbit cannot be treated anyhow, so the</span>
<a name="15828"><font size=-1>15828     </font></a><span class="string">value of [[so_psp]] is irrelevant.</span>
<a name="15829"><font size=-1>15829     </font></a><span class="string"></span>
<a name="15830"><font size=-1>15830     </font></a><span class="string">Prior to v5.4, the input variable **so_typat** was used, in place of</span>
<a name="15831"><font size=-1>15831     </font></a><span class="string">[[so_psp]]. Because the values 0 and 1 have been switched between [[so_psp]]</span>
<a name="15832"><font size=-1>15832     </font></a><span class="string">and **so_typat**, it was dangerous to continue to allow the use of **so_typat**.</span>
<a name="15833"><font size=-1>15833     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15834"><font size=-1>15834     </font></a><span class="default">),</span>
<a name="15835"><font size=-1>15835     </font></a><span class="default"></span>
<a name="15836"><font size=-1>15836     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15837"><font size=-1>15837     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spbroad&quot;</span><span class="default">,</span>
<a name="15838"><font size=-1>15838     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="15839"><font size=-1>15839     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15840"><font size=-1>15840     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_useful'</span><span class="default">],</span>
<a name="15841"><font size=-1>15841     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15842"><font size=-1>15842     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="15843"><font size=-1>15843     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPectral BROADening&quot;</span><span class="default">,</span>
<a name="15844"><font size=-1>15844     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="15845"><font size=-1>15845     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3 and [[spmeth]] == 2&quot;</span><span class="default">,</span>
<a name="15846"><font size=-1>15846     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15847"><font size=-1>15847     </font></a><span class="string">When a screening calculation ([[optdriver]] == 3) uses a spectral representation</span>
<a name="15848"><font size=-1>15848     </font></a><span class="string">of the irreducible polarizability in which the delta function is replaced by</span>
<a name="15849"><font size=-1>15849     </font></a><span class="string">the gaussian approximant ([[spmeth]] == 2), the standard deviation of the</span>
<a name="15850"><font size=-1>15850     </font></a><span class="string">gaussian is given by [[spbroad]].</span>
<a name="15851"><font size=-1>15851     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15852"><font size=-1>15852     </font></a><span class="default">),</span>
<a name="15853"><font size=-1>15853     </font></a><span class="default"></span>
<a name="15854"><font size=-1>15854     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15855"><font size=-1>15855     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spgaxor&quot;</span><span class="default">,</span>
<a name="15856"><font size=-1>15856     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="15857"><font size=-1>15857     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15858"><font size=-1>15858     </font></a><span class="default">    topics=[</span><span class="string">'SmartSymm_useful'</span><span class="default">],</span>
<a name="15859"><font size=-1>15859     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15860"><font size=-1>15860     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="15861"><font size=-1>15861     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPace Group: AXes ORientation&quot;</span><span class="default">,</span>
<a name="15862"><font size=-1>15862     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15863"><font size=-1>15863     </font></a><span class="string">It is taken into account only when [[spgroup]]/=0; it allows one to define the</span>
<a name="15864"><font size=-1>15864     </font></a><span class="string">axes orientation for the specific space groups for which this is needed.</span>
<a name="15865"><font size=-1>15865     </font></a><span class="string">Trigonal groups (number 146,148,155,160,161,166,167):</span>
<a name="15866"><font size=-1>15866     </font></a><span class="string"></span>
<a name="15867"><font size=-1>15867     </font></a><span class="string">  * 1 represents the hexagonal axes</span>
<a name="15868"><font size=-1>15868     </font></a><span class="string">  * 2 represents the rhombohedral axes</span>
<a name="15869"><font size=-1>15869     </font></a><span class="string"></span>
<a name="15870"><font size=-1>15870     </font></a><span class="string">Orthorhombic space groups: there are six possibilities corresponding to the</span>
<a name="15871"><font size=-1>15871     </font></a><span class="string">possible axes permutations</span>
<a name="15872"><font size=-1>15872     </font></a><span class="string"></span>
<a name="15873"><font size=-1>15873     </font></a><span class="string">  * 1 abc -&gt; abc</span>
<a name="15874"><font size=-1>15874     </font></a><span class="string">  * 2 abc -&gt; cab</span>
<a name="15875"><font size=-1>15875     </font></a><span class="string">  * 3 abc -&gt; bca</span>
<a name="15876"><font size=-1>15876     </font></a><span class="string">  * 4 abc -&gt; acb</span>
<a name="15877"><font size=-1>15877     </font></a><span class="string">  * 5 abc -&gt; bac</span>
<a name="15878"><font size=-1>15878     </font></a><span class="string">  * 6 abc -&gt; cba</span>
<a name="15879"><font size=-1>15879     </font></a><span class="string"></span>
<a name="15880"><font size=-1>15880     </font></a><span class="string">Monoclinic: there are 3 or 9 possibilities depending on the space group.</span>
<a name="15881"><font size=-1>15881     </font></a><span class="string">For more details see the [[help:spacegroup]].</span>
<a name="15882"><font size=-1>15882     </font></a><span class="string">In the log/output file the notation used to describe the monoclinic</span>
<a name="15883"><font size=-1>15883     </font></a><span class="string">groups is for example: 15:c1, A2/a_c = C2/c where,</span>
<a name="15884"><font size=-1>15884     </font></a><span class="string"></span>
<a name="15885"><font size=-1>15885     </font></a><span class="string">  * 15 represents the space group number,</span>
<a name="15886"><font size=-1>15886     </font></a><span class="string">  * c1 the orientation as it appears on the web page,</span>
<a name="15887"><font size=-1>15887     </font></a><span class="string">  * A is the real Bravais type lattice,</span>
<a name="15888"><font size=-1>15888     </font></a><span class="string">  * 2/a the existent symmetry elements,</span>
<a name="15889"><font size=-1>15889     </font></a><span class="string">  * _c marks the orientation of the two-fold axis or of the mirror plane,</span>
<a name="15890"><font size=-1>15890     </font></a><span class="string">  * C2/c represents the parent space group.</span>
<a name="15891"><font size=-1>15891     </font></a><span class="string"></span>
<a name="15892"><font size=-1>15892     </font></a><span class="string">How to determine which [[spgaxor]] you need:</span>
<a name="15893"><font size=-1>15893     </font></a><span class="string"></span>
<a name="15894"><font size=-1>15894     </font></a><span class="string">  1. check the reduced positions you have, for more symmetric positions, e.g. 1/2 1/4 3/4 etc... Let us say your symmetric positions are in the first coordinate (a axis) and you are using spgroup 62.</span>
<a name="15895"><font size=-1>15895     </font></a><span class="string">  2. look up the raw space group Wyckoff positions on [ the Bilbao server ](http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-wp-list) to see where they put the corresponding symmetric positions. For spgroup 62 Bilbao puts the 1/4 3/4 in the second coordinate, ie along the b axis.</span>
<a name="15896"><font size=-1>15896     </font></a><span class="string">  3. in this case you need to swap the axes from the original abc order to a new order where the Bilbao axis (b) is in the first position. In this case you have 2 possibilities, [[spgaxor]] 3 or 5. If you have more than one highly symmetric coordinate you may have only a single possibility.</span>
<a name="15897"><font size=-1>15897     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15898"><font size=-1>15898     </font></a><span class="default">),</span>
<a name="15899"><font size=-1>15899     </font></a><span class="default"></span>
<a name="15900"><font size=-1>15900     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15901"><font size=-1>15901     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spgorig&quot;</span><span class="default">,</span>
<a name="15902"><font size=-1>15902     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="15903"><font size=-1>15903     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15904"><font size=-1>15904     </font></a><span class="default">    topics=[</span><span class="string">'SmartSymm_useful'</span><span class="default">],</span>
<a name="15905"><font size=-1>15905     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15906"><font size=-1>15906     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="15907"><font size=-1>15907     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPace Group: ORIGin&quot;</span><span class="default">,</span>
<a name="15908"><font size=-1>15908     </font></a><span class="default">    requires=</span><span class="string">&quot;[[spgroup]]!=0&quot;</span><span class="default">,</span>
<a name="15909"><font size=-1>15909     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15910"><font size=-1>15910     </font></a><span class="string">Gives the choice of origin for the axes system.</span>
<a name="15911"><font size=-1>15911     </font></a><span class="string">It is defined according to the origin choice in the International Tables of</span>
<a name="15912"><font size=-1>15912     </font></a><span class="string">Crystallography.</span>
<a name="15913"><font size=-1>15913     </font></a><span class="string">It applies only to the space groups 48, 50, 59, 70, 85, 86, 88, 125, 126, 129,</span>
<a name="15914"><font size=-1>15914     </font></a><span class="string">130, 133, 134, 137, 141, 142, 201, 203, 222, 224, 227, 228.</span>
<a name="15915"><font size=-1>15915     </font></a><span class="string">For more details see the [[help:spacegroup]].</span>
<a name="15916"><font size=-1>15916     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15917"><font size=-1>15917     </font></a><span class="default">),</span>
<a name="15918"><font size=-1>15918     </font></a><span class="default"></span>
<a name="15919"><font size=-1>15919     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15920"><font size=-1>15920     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spgroup&quot;</span><span class="default">,</span>
<a name="15921"><font size=-1>15921     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="15922"><font size=-1>15922     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15923"><font size=-1>15923     </font></a><span class="default">    topics=[</span><span class="string">'crystal_useful'</span><span class="default">, </span><span class="string">'UnitCell_useful'</span><span class="default">, </span><span class="string">'SmartSymm_basic'</span><span class="default">],</span>
<a name="15924"><font size=-1>15924     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15925"><font size=-1>15925     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15926"><font size=-1>15926     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPace GROUP number&quot;</span><span class="default">,</span>
<a name="15927"><font size=-1>15927     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15928"><font size=-1>15928     </font></a><span class="string">Gives the number of the space group.</span>
<a name="15929"><font size=-1>15929     </font></a><span class="string">If [[spgroup]] is 0, the code assumes that all the symmetries are input</span>
<a name="15930"><font size=-1>15930     </font></a><span class="string">through the [[symrel]] matrices and the [[tnons]] vectors, or obtained from</span>
<a name="15931"><font size=-1>15931     </font></a><span class="string">the symmetry finder (the default when [[nsym]] == 0).</span>
<a name="15932"><font size=-1>15932     </font></a><span class="string">It should be between 1 and 230. This option can be used to obtain all the</span>
<a name="15933"><font size=-1>15933     </font></a><span class="string">atoms in the unit cell, starting from the asymmetric unit cell.</span>
<a name="15934"><font size=-1>15934     </font></a><span class="string">The references for computing the symmetry corresponding to the space groups are:</span>
<a name="15935"><font size=-1>15935     </font></a><span class="string"></span>
<a name="15936"><font size=-1>15936     </font></a><span class="string">  * International Tables for Crystallography [[cite:Hahn1983]]</span>
<a name="15937"><font size=-1>15937     </font></a><span class="string">  * The mathematical theory of symmetry in solids, Representation theory for point groups and space groups [[cite:Bradley1972]]</span>
<a name="15938"><font size=-1>15938     </font></a><span class="string"></span>
<a name="15939"><font size=-1>15939     </font></a><span class="string">For more details see the [[help:spacegroup]].</span>
<a name="15940"><font size=-1>15940     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15941"><font size=-1>15941     </font></a><span class="default">),</span>
<a name="15942"><font size=-1>15942     </font></a><span class="default"></span>
<a name="15943"><font size=-1>15943     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15944"><font size=-1>15944     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spgroupma&quot;</span><span class="default">,</span>
<a name="15945"><font size=-1>15945     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="15946"><font size=-1>15946     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="15947"><font size=-1>15947     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_useful'</span><span class="default">, </span><span class="string">'SmartSymm_useful'</span><span class="default">],</span>
<a name="15948"><font size=-1>15948     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="15949"><font size=-1>15949     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="15950"><font size=-1>15950     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPace GROUP number defining a MAgnetic space group&quot;</span><span class="default">,</span>
<a name="15951"><font size=-1>15951     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="15952"><font size=-1>15952     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15953"><font size=-1>15953     </font></a><span class="string">This input variable might be used to define a Shubnikov magnetic space group</span>
<a name="15954"><font size=-1>15954     </font></a><span class="string">(anti-ferromagnetic space group). The user is advised to consult [[cite:Bradley1972]].</span>
<a name="15955"><font size=-1>15955     </font></a><span class="string">A Shubnikov type IV magnetic space group might be defined by its Fedorov space</span>
<a name="15956"><font size=-1>15956     </font></a><span class="string">group (set of spatial symmetries that do not change the magnetization), and an</span>
<a name="15957"><font size=-1>15957     </font></a><span class="string">additional magnetic space group number [[spgroupma]].</span>
<a name="15958"><font size=-1>15958     </font></a><span class="string">A Shubnikov type III magnetic space group might be defined by its Fedorov</span>
<a name="15959"><font size=-1>15959     </font></a><span class="string">space group (set of all spatial symmetries, irrespective of their magnetic</span>
<a name="15960"><font size=-1>15960     </font></a><span class="string">action), and an additional magnetic space group number [[spgroupma]].</span>
<a name="15961"><font size=-1>15961     </font></a><span class="string">For the additional number [[spgroupma]], we follow the definition of Table 7.4</span>
<a name="15962"><font size=-1>15962     </font></a><span class="string">of the above-mentioned [[cite:Bradley1972]].</span>
<a name="15963"><font size=-1>15963     </font></a><span class="string">Thus, one way to specify a Shubnikov IV magnetic space group, is to define</span>
<a name="15964"><font size=-1>15964     </font></a><span class="string">both [[spgroup]] and [[spgroupma]].</span>
<a name="15965"><font size=-1>15965     </font></a><span class="string">For example, the group P2_1/c_prime has [[spgroup]] = 14 and [[spgroupma]] = 78.</span>
<a name="15966"><font size=-1>15966     </font></a><span class="string">Alternatively, for Shubnikov IV magnetic groups, one might define [[spgroup]]</span>
<a name="15967"><font size=-1>15967     </font></a><span class="string">and [[genafm]]. For both the type III and IV, one might define by hand the set</span>
<a name="15968"><font size=-1>15968     </font></a><span class="string">of symmetries, using [[symrel]], [[tnons]] and [[symafm]].</span>
<a name="15969"><font size=-1>15969     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="15970"><font size=-1>15970     </font></a><span class="default">),</span>
<a name="15971"><font size=-1>15971     </font></a><span class="default"></span>
<a name="15972"><font size=-1>15972     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="15973"><font size=-1>15973     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spinat&quot;</span><span class="default">,</span>
<a name="15974"><font size=-1>15974     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="15975"><font size=-1>15975     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="15976"><font size=-1>15976     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_basic'</span><span class="default">, </span><span class="string">'crystal_useful'</span><span class="default">, </span><span class="string">'MagMom_useful'</span><span class="default">],</span>
<a name="15977"><font size=-1>15977     </font></a><span class="default">    dimensions=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[natrd]]&lt;[[natom]]'</span><span class="default">: </span><span class="string">'[3, [[natrd]] ]'</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="string">'[3, [[natom]] ]'</span><span class="default">}),</span>
<a name="15978"><font size=-1>15978     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="15979"><font size=-1>15979     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPIN for AToms&quot;</span><span class="default">,</span>
<a name="15980"><font size=-1>15980     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="15981"><font size=-1>15981     </font></a><span class="string">Gives the initial electronic spin-magnetization for each atom, in unit of $\hbar/2$.</span>
<a name="15982"><font size=-1>15982     </font></a><span class="string"></span>
<a name="15983"><font size=-1>15983     </font></a><span class="string">Note that if [[nspden]] = 2, the z-component must be given for each atom, in</span>
<a name="15984"><font size=-1>15984     </font></a><span class="string">triplets (0 0 z-component).</span>
<a name="15985"><font size=-1>15985     </font></a><span class="string">For example, the electron of an hydrogen atom can be spin up (0 0 1.0) or spin</span>
<a name="15986"><font size=-1>15986     </font></a><span class="string">down (0 0 -1.0).</span>
<a name="15987"><font size=-1>15987     </font></a><span class="string"></span>
<a name="15988"><font size=-1>15988     </font></a><span class="string">This value is only used to create the first exchange and correlation</span>
<a name="15989"><font size=-1>15989     </font></a><span class="string">potential, and is not used anymore afterwards.</span>
<a name="15990"><font size=-1>15990     </font></a><span class="string">It is not checked against the initial occupation numbers [[occ]] for each spin</span>
<a name="15991"><font size=-1>15991     </font></a><span class="string">channel.</span>
<a name="15992"><font size=-1>15992     </font></a><span class="string">It is meant to give an easy way to break the spin symmetry, and to allow to</span>
<a name="15993"><font size=-1>15993     </font></a><span class="string">find stable local spin fluctuations, for example: antiferromagnetism, or the</span>
<a name="15994"><font size=-1>15994     </font></a><span class="string">spontaneous spatial spin separation of elongated H$_2$ molecule.</span>
<a name="15995"><font size=-1>15995     </font></a><span class="string"></span>
<a name="15996"><font size=-1>15996     </font></a><span class="string">  * If the atom manipulator is used, [[spinat]] will be related to the preprocessed set of atoms,</span>
<a name="15997"><font size=-1>15997     </font></a><span class="string">  generated by the atom manipulator. The user must thus foresee the effect of this atom manipulator (see [[objarf]]).</span>
<a name="15998"><font size=-1>15998     </font></a><span class="string"></span>
<a name="15999"><font size=-1>15999     </font></a><span class="string">  * If the atom manipulator is not used, and the symmetries are not specified by the user ([[nsym]] = 0),</span>
<a name="16000"><font size=-1>16000     </font></a><span class="string">spinat will be used, if present, to determine the anti-ferromagnetic characteristics of the symmetry operations, see [[symafm]].</span>
<a name="16001"><font size=-1>16001     </font></a><span class="string">In case of collinear antiferromagnetism ([[nsppol]] = 1, [[nspinor]] = 1,</span>
<a name="16002"><font size=-1>16002     </font></a><span class="string">[[nspden]] = 2), these symmetries are used to symmetrize the density.</span>
<a name="16003"><font size=-1>16003     </font></a><span class="string">In case of non-collinear magnetism ([[nsppol]] = 1, [[nspinor]] = 2,</span>
<a name="16004"><font size=-1>16004     </font></a><span class="string">[[nspden]] = 4), they are also used to symmetrize the density. In the latter</span>
<a name="16005"><font size=-1>16005     </font></a><span class="string">case, this strongly constrains the magnetization (imposing its direction). If</span>
<a name="16006"><font size=-1>16006     </font></a><span class="string">the user want to let all degrees of freedom of the magnetization evolve, it is</span>
<a name="16007"><font size=-1>16007     </font></a><span class="string">then recommended to put [[nsym]] = 1.</span>
<a name="16008"><font size=-1>16008     </font></a><span class="string"></span>
<a name="16009"><font size=-1>16009     </font></a><span class="string">* If the symmetries are specified, and the irreducible set of atoms is specified, the anti-ferromagnetic characteristics of the symmetry operations [[symafm]] will be used to generate [[spinat]] for all the non-irreducible atoms.</span>
<a name="16010"><font size=-1>16010     </font></a><span class="string"></span>
<a name="16011"><font size=-1>16011     </font></a><span class="string">* In the case of PAW+U calculations using the [[dmatpawu]] initial occupation matrix, and if [[nspden]] = 4, [[spinat]] is also used to determine the direction of the integrated magnetization matrix.</span>
<a name="16012"><font size=-1>16012     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16013"><font size=-1>16013     </font></a><span class="default">),</span>
<a name="16014"><font size=-1>16014     </font></a><span class="default"></span>
<a name="16015"><font size=-1>16015     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16016"><font size=-1>16016     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spinmagntarget&quot;</span><span class="default">,</span>
<a name="16017"><font size=-1>16017     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="16018"><font size=-1>16018     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16019"><font size=-1>16019     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_useful'</span><span class="default">],</span>
<a name="16020"><font size=-1>16020     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16021"><font size=-1>16021     </font></a><span class="default">    defaultval=-</span><span class="number">99.99</span><span class="default">,</span>
<a name="16022"><font size=-1>16022     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPIN-MAGNetization TARGET&quot;</span><span class="default">,</span>
<a name="16023"><font size=-1>16023     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16024"><font size=-1>16024     </font></a><span class="string">This input variable is active only in the [[nsppol]] = 2 case. If</span>
<a name="16025"><font size=-1>16025     </font></a><span class="string">[[spinmagntarget]] is not the &quot;magic&quot; value of -99.99, the spin-</span>
<a name="16026"><font size=-1>16026     </font></a><span class="string">magnetization of the primitive cell will be fixed (or optimized, if it is not</span>
<a name="16027"><font size=-1>16027     </font></a><span class="string">possible to impose it) to the value of [[spinmagntarget]], in Bohr magneton</span>
<a name="16028"><font size=-1>16028     </font></a><span class="string">units (for an Hydrogen atom, it is 1).</span>
<a name="16029"><font size=-1>16029     </font></a><span class="string">If [[occopt]] is a metallic one, the Fermi energies for spin up and spin down</span>
<a name="16030"><font size=-1>16030     </font></a><span class="string">are adjusted to give the target spin-polarisation (this is equivalent to an</span>
<a name="16031"><font size=-1>16031     </font></a><span class="string">exchange splitting). If [[occopt]] = 1 and [[nsppol]] = 2, the occupation numbers</span>
<a name="16032"><font size=-1>16032     </font></a><span class="string">for spin up and spin down will be adjusted to give the required spin-</span>
<a name="16033"><font size=-1>16033     </font></a><span class="string">magnetization (occupation numbers are identical for all k-points, with</span>
<a name="16034"><font size=-1>16034     </font></a><span class="string">[[occopt]] = 1). The definition of [[spinmagntarget]] is actually requested in</span>
<a name="16035"><font size=-1>16035     </font></a><span class="string">this case, except for the single isolated Hydrogen atom.</span>
<a name="16036"><font size=-1>16036     </font></a><span class="string">If [[spinmagntarget]] is the default one, the spin-magnetization will not be</span>
<a name="16037"><font size=-1>16037     </font></a><span class="string">constrained, and will be determined self-consistently, by having the same spin</span>
<a name="16038"><font size=-1>16038     </font></a><span class="string">up and spin down Fermi energy in the metallic case, while for the other cases,</span>
<a name="16039"><font size=-1>16039     </font></a><span class="string">there will be no spin-magnetization, except for an odd number of electrons if</span>
<a name="16040"><font size=-1>16040     </font></a><span class="string">[[occopt]] = 1 and [[nsppol]] = 2.</span>
<a name="16041"><font size=-1>16041     </font></a><span class="string"></span>
<a name="16042"><font size=-1>16042     </font></a><span class="string">!!! note</span>
<a name="16043"><font size=-1>16043     </font></a><span class="string">    For the time being, only the spin down Fermi energy is written out in</span>
<a name="16044"><font size=-1>16044     </font></a><span class="string">    the main output file. In the fixed magnetic moment case, it differs from the</span>
<a name="16045"><font size=-1>16045     </font></a><span class="string">    spin up Fermi energy.</span>
<a name="16046"><font size=-1>16046     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16047"><font size=-1>16047     </font></a><span class="default">),</span>
<a name="16048"><font size=-1>16048     </font></a><span class="default"></span>
<a name="16049"><font size=-1>16049     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16050"><font size=-1>16050     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spmeth&quot;</span><span class="default">,</span>
<a name="16051"><font size=-1>16051     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="16052"><font size=-1>16052     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16053"><font size=-1>16053     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_useful'</span><span class="default">],</span>
<a name="16054"><font size=-1>16054     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16055"><font size=-1>16055     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="16056"><font size=-1>16056     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPectral METHod&quot;</span><span class="default">,</span>
<a name="16057"><font size=-1>16057     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 4&quot;</span><span class="default">,</span>
<a name="16058"><font size=-1>16058     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="16059"><font size=-1>16059     </font></a><span class="string">The [[spmeth]] input variable defines the method used to calculate the</span>
<a name="16060"><font size=-1>16060     </font></a><span class="string">irreducible polarizability $\chi^{(0)}_{KS}$.</span>
<a name="16061"><font size=-1>16061     </font></a><span class="string"></span>
<a name="16062"><font size=-1>16062     </font></a><span class="string">By default $\chi^{(0)}_{KS}$ is calculated employing the Adler-Wiser</span>
<a name="16063"><font size=-1>16063     </font></a><span class="string">expression ([[spmeth]] = 0) with a CPU effort that scales linearly with the</span>
<a name="16064"><font size=-1>16064     </font></a><span class="string">number of frequencies. This approach is convenient when few frequencies are</span>
<a name="16065"><font size=-1>16065     </font></a><span class="string">required, and is usually used in conjunction with plasmon-pole models in which</span>
<a name="16066"><font size=-1>16066     </font></a><span class="string">only one or two frequencies are calculated, according to the value of</span>
<a name="16067"><font size=-1>16067     </font></a><span class="string">[[ppmodel]].</span>
<a name="16068"><font size=-1>16068     </font></a><span class="string">Unfortunately a calculation based on the Adler-Wiser expression might be quite</span>
<a name="16069"><font size=-1>16069     </font></a><span class="string">CPU demanding if the matrix elements of the self-energy operator are evaluated</span>
<a name="16070"><font size=-1>16070     </font></a><span class="string">by performing numerically the convolution defining the self-energy. The</span>
<a name="16071"><font size=-1>16071     </font></a><span class="string">integrand function, indeed, has poles above and below the real axis, and the</span>
<a name="16072"><font size=-1>16072     </font></a><span class="string">screened interaction has to be evaluated on a dense frequency mesh in order to</span>
<a name="16073"><font size=-1>16073     </font></a><span class="string">obtain accurate results.</span>
<a name="16074"><font size=-1>16074     </font></a><span class="string"></span>
<a name="16075"><font size=-1>16075     </font></a><span class="string">In the spectral method ([[spmeth]] = 1 or 2) the irreducible polarizability is</span>
<a name="16076"><font size=-1>16076     </font></a><span class="string">expressed as the Hilbert transform of the imaginary part. The advantage in</span>
<a name="16077"><font size=-1>16077     </font></a><span class="string">using this approach consists in the fact that, once the spectral function is</span>
<a name="16078"><font size=-1>16078     </font></a><span class="string">known, the irreducible polarizability for an arbitrary frequency can be easily</span>
<a name="16079"><font size=-1>16079     </font></a><span class="string">obtained through inexpensive integrations. On the other hand, an accurate</span>
<a name="16080"><font size=-1>16080     </font></a><span class="string">evaluation of the imaginary part requires a dense frequency mesh due to the</span>
<a name="16081"><font size=-1>16081     </font></a><span class="string">presence of delta functions. Two different approaches can be used to</span>
<a name="16082"><font size=-1>16082     </font></a><span class="string">approximate these delta functions thus allowing the use of affordable</span>
<a name="16083"><font size=-1>16083     </font></a><span class="string">frequency grids.</span>
<a name="16084"><font size=-1>16084     </font></a><span class="string"></span>
<a name="16085"><font size=-1>16085     </font></a><span class="string">Summarizing:</span>
<a name="16086"><font size=-1>16086     </font></a><span class="string"></span>
<a name="16087"><font size=-1>16087     </font></a><span class="string">  * 0 --&gt;  use Adler-Wiser expression to calculate $\chi^{(0)}_{KS}$</span>
<a name="16088"><font size=-1>16088     </font></a><span class="string">  * 1 --&gt;  use the spectral method approximating the delta function with a triangular approximant as proposed in **REF TO BE ADDED**</span>
<a name="16089"><font size=-1>16089     </font></a><span class="string">  * 2 --&gt; use spectral method but approximating the delta function with a Taylor expansion of the exponential as proposed in **REF TO BE ADDED**</span>
<a name="16090"><font size=-1>16090     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16091"><font size=-1>16091     </font></a><span class="default">),</span>
<a name="16092"><font size=-1>16092     </font></a><span class="default"></span>
<a name="16093"><font size=-1>16093     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16094"><font size=-1>16094     </font></a><span class="default">    abivarname=</span><span class="string">&quot;spnorbscl&quot;</span><span class="default">,</span>
<a name="16095"><font size=-1>16095     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="16096"><font size=-1>16096     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16097"><font size=-1>16097     </font></a><span class="default">    topics=[</span><span class="string">'PAW_expert'</span><span class="default">, </span><span class="string">'spinpolarisation_useful'</span><span class="default">],</span>
<a name="16098"><font size=-1>16098     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16099"><font size=-1>16099     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="16100"><font size=-1>16100     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SPin-ORBit SCaLing&quot;</span><span class="default">,</span>
<a name="16101"><font size=-1>16101     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[pawspnorb]] &gt;= 1&quot;</span><span class="default">,</span>
<a name="16102"><font size=-1>16102     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16103"><font size=-1>16103     </font></a><span class="string">Scaling of the spin-orbit interaction. The default values gives the first-</span>
<a name="16104"><font size=-1>16104     </font></a><span class="string">principles value, while other values are used for the analysis of the effect</span>
<a name="16105"><font size=-1>16105     </font></a><span class="string">of the spin-orbit interaction, but are not expected to correspond to any</span>
<a name="16106"><font size=-1>16106     </font></a><span class="string">physical situation.</span>
<a name="16107"><font size=-1>16107     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16108"><font size=-1>16108     </font></a><span class="default">),</span>
<a name="16109"><font size=-1>16109     </font></a><span class="default"></span>
<a name="16110"><font size=-1>16110     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16111"><font size=-1>16111     </font></a><span class="default">    abivarname=</span><span class="string">&quot;stmbias&quot;</span><span class="default">,</span>
<a name="16112"><font size=-1>16112     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="16113"><font size=-1>16113     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16114"><font size=-1>16114     </font></a><span class="default">    topics=[</span><span class="string">'STM_compulsory'</span><span class="default">],</span>
<a name="16115"><font size=-1>16115     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16116"><font size=-1>16116     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16117"><font size=-1>16117     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Scanning Tunneling Microscopy BIAS voltage&quot;</span><span class="default">,</span>
<a name="16118"><font size=-1>16118     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="16119"><font size=-1>16119     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16120"><font size=-1>16120     </font></a><span class="string">Gives, in Hartree, the bias of the STM tip, with respect to the sample, in</span>
<a name="16121"><font size=-1>16121     </font></a><span class="string">order to generate the STM density map.</span>
<a name="16122"><font size=-1>16122     </font></a><span class="string">Used with positive [[iscf]], [[occopt]] = 7 (metallic, gaussian), [[nstep]] = 1,</span>
<a name="16123"><font size=-1>16123     </font></a><span class="string">and positive [[prtstm]], this value is used to generate a charge density map</span>
<a name="16124"><font size=-1>16124     </font></a><span class="string">from electrons close to the Fermi energy, in a (positive or negative) energy</span>
<a name="16125"><font size=-1>16125     </font></a><span class="string">range. Positive [[stmbias]] will lead to the inclusion of occupied (valence)</span>
<a name="16126"><font size=-1>16126     </font></a><span class="string">states only, while negative [[stmbias]] will lead to the inclusion of</span>
<a name="16127"><font size=-1>16127     </font></a><span class="string">unoccupied (conduction) states only.</span>
<a name="16128"><font size=-1>16128     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[stmbias]] has</span>
<a name="16129"><font size=-1>16129     </font></a><span class="string">the '[[ENERGY]]' characteristics (0.001 Ha = 27.2113845 meV = 315.773 Kelvin).</span>
<a name="16130"><font size=-1>16130     </font></a><span class="string">With [[occopt]] = 7, one has also to specify an independent broadening [[tsmear]].</span>
<a name="16131"><font size=-1>16131     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16132"><font size=-1>16132     </font></a><span class="default">),</span>
<a name="16133"><font size=-1>16133     </font></a><span class="default"></span>
<a name="16134"><font size=-1>16134     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16135"><font size=-1>16135     </font></a><span class="default">    abivarname=</span><span class="string">&quot;strfact&quot;</span><span class="default">,</span>
<a name="16136"><font size=-1>16136     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="16137"><font size=-1>16137     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16138"><font size=-1>16138     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_basic'</span><span class="default">],</span>
<a name="16139"><font size=-1>16139     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16140"><font size=-1>16140     </font></a><span class="default">    defaultval=</span><span class="number">100</span><span class="default">,</span>
<a name="16141"><font size=-1>16141     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;STRess FACTor&quot;</span><span class="default">,</span>
<a name="16142"><font size=-1>16142     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16143"><font size=-1>16143     </font></a><span class="string">The stresses multiplied by [[strfact]] will be treated like forces in the</span>
<a name="16144"><font size=-1>16144     </font></a><span class="string">process of optimization ([[ionmov]] = 2, non-zero [[optcell]]).</span>
<a name="16145"><font size=-1>16145     </font></a><span class="string">For example, the stopping criterion defined by [[tolmxf]] relates to these</span>
<a name="16146"><font size=-1>16146     </font></a><span class="string">scaled stresses.</span>
<a name="16147"><font size=-1>16147     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16148"><font size=-1>16148     </font></a><span class="default">),</span>
<a name="16149"><font size=-1>16149     </font></a><span class="default"></span>
<a name="16150"><font size=-1>16150     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16151"><font size=-1>16151     </font></a><span class="default">    abivarname=</span><span class="string">&quot;string_algo&quot;</span><span class="default">,</span>
<a name="16152"><font size=-1>16152     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="16153"><font size=-1>16153     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16154"><font size=-1>16154     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_useful'</span><span class="default">],</span>
<a name="16155"><font size=-1>16155     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16156"><font size=-1>16156     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="16157"><font size=-1>16157     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;STRING method ALGOrithm&quot;</span><span class="default">,</span>
<a name="16158"><font size=-1>16158     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16159"><font size=-1>16159     </font></a><span class="string">Relevant only when [[imgmov]] = 2 (String Method).</span>
<a name="16160"><font size=-1>16160     </font></a><span class="string">Gives the variant of the String Method method used.</span>
<a name="16161"><font size=-1>16161     </font></a><span class="string">Possible values can be:</span>
<a name="16162"><font size=-1>16162     </font></a><span class="string"></span>
<a name="16163"><font size=-1>16163     </font></a><span class="string">  * 0 --&gt;  **Original String Method**.</span>
<a name="16164"><font size=-1>16164     </font></a><span class="string">NOT YET IMPLEMENTED.</span>
<a name="16165"><font size=-1>16165     </font></a><span class="string">See [[cite:Weinan2002]]</span>
<a name="16166"><font size=-1>16166     </font></a><span class="string"></span>
<a name="16167"><font size=-1>16167     </font></a><span class="string">  * 1 --&gt; **Simplified String Method** with parametrization by **equal arc length**.</span>
<a name="16168"><font size=-1>16168     </font></a><span class="string">Instead of using the normal force (wrt the band), the full force is used; the</span>
<a name="16169"><font size=-1>16169     </font></a><span class="string">reparametrization is enforced by keeping the points of the string equally</span>
<a name="16170"><font size=-1>16170     </font></a><span class="string">spaced.</span>
<a name="16171"><font size=-1>16171     </font></a><span class="string">See [[cite:Weinan2007]]</span>
<a name="16172"><font size=-1>16172     </font></a><span class="string"></span>
<a name="16173"><font size=-1>16173     </font></a><span class="string">  * 2 --&gt; **Simplified String Method** with parametrization by **energy-weighted arc length**.</span>
<a name="16174"><font size=-1>16174     </font></a><span class="string">A variant of the Simplified String Method (like 1-); the reparametrization is</span>
<a name="16175"><font size=-1>16175     </font></a><span class="string">done by using energy-weight arc-lengths, giving a finer distribution near the</span>
<a name="16176"><font size=-1>16176     </font></a><span class="string">saddle point.</span>
<a name="16177"><font size=-1>16177     </font></a><span class="string">See [[cite:Weinan2007]] and [[cite:Goodrow2009]]</span>
<a name="16178"><font size=-1>16178     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16179"><font size=-1>16179     </font></a><span class="default">),</span>
<a name="16180"><font size=-1>16180     </font></a><span class="default"></span>
<a name="16181"><font size=-1>16181     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16182"><font size=-1>16182     </font></a><span class="default">    abivarname=</span><span class="string">&quot;strprecon&quot;</span><span class="default">,</span>
<a name="16183"><font size=-1>16183     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="16184"><font size=-1>16184     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16185"><font size=-1>16185     </font></a><span class="default">    topics=[</span><span class="string">'ForcesStresses_useful'</span><span class="default">, </span><span class="string">'GeoOpt_useful'</span><span class="default">],</span>
<a name="16186"><font size=-1>16186     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16187"><font size=-1>16187     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="16188"><font size=-1>16188     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;STRess PRECONditioner&quot;</span><span class="default">,</span>
<a name="16189"><font size=-1>16189     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16190"><font size=-1>16190     </font></a><span class="string">This is a scaling factor to initialize the part of the Hessian related to the</span>
<a name="16191"><font size=-1>16191     </font></a><span class="string">treatment of the stresses (optimisation of the unit cell). In case there is an</span>
<a name="16192"><font size=-1>16192     </font></a><span class="string">instability, decrease the default value, e.g. set it to 0.1.</span>
<a name="16193"><font size=-1>16193     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16194"><font size=-1>16194     </font></a><span class="default">),</span>
<a name="16195"><font size=-1>16195     </font></a><span class="default"></span>
<a name="16196"><font size=-1>16196     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16197"><font size=-1>16197     </font></a><span class="default">    abivarname=</span><span class="string">&quot;strtarget&quot;</span><span class="default">,</span>
<a name="16198"><font size=-1>16198     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="16199"><font size=-1>16199     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16200"><font size=-1>16200     </font></a><span class="default">    topics=[</span><span class="string">'ForcesStresses_useful'</span><span class="default">, </span><span class="string">'GeoOpt_useful'</span><span class="default">],</span>
<a name="16201"><font size=-1>16201     </font></a><span class="default">    dimensions=[</span><span class="number">6</span><span class="default">],</span>
<a name="16202"><font size=-1>16202     </font></a><span class="default">    defaultval=[</span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">],</span>
<a name="16203"><font size=-1>16203     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;STRess TARGET&quot;</span><span class="default">,</span>
<a name="16204"><font size=-1>16204     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16205"><font size=-1>16205     </font></a><span class="string">The components of the stress tensor must be stored according to: (1,1) --&gt;1;</span>
<a name="16206"><font size=-1>16206     </font></a><span class="string">(2,2) --&gt; 2; (3,3) --&gt; 3; (2,3) --&gt; 4; (3,1) --&gt; 5; (1,2) --&gt;6. The conversion factor</span>
<a name="16207"><font size=-1>16207     </font></a><span class="string">between Ha/Bohr**3 and GPa is: 1 Ha/Bohr**3 = 29421.033d0 GPa.</span>
<a name="16208"><font size=-1>16208     </font></a><span class="string">Not used if [[optcell]] == 0.</span>
<a name="16209"><font size=-1>16209     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16210"><font size=-1>16210     </font></a><span class="default">),</span>
<a name="16211"><font size=-1>16211     </font></a><span class="default"></span>
<a name="16212"><font size=-1>16212     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16213"><font size=-1>16213     </font></a><span class="default">    abivarname=</span><span class="string">&quot;symafm&quot;</span><span class="default">,</span>
<a name="16214"><font size=-1>16214     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="16215"><font size=-1>16215     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16216"><font size=-1>16216     </font></a><span class="default">    topics=[</span><span class="string">'spinpolarisation_useful'</span><span class="default">],</span>
<a name="16217"><font size=-1>16217     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nsym]]'</span><span class="default">],</span>
<a name="16218"><font size=-1>16218     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="string">'[[nsym]]'</span><span class="default">, value=</span><span class="number">1</span><span class="default">),</span>
<a name="16219"><font size=-1>16219     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SYMmetries, Anti-FerroMagnetic characteristics&quot;</span><span class="default">,</span>
<a name="16220"><font size=-1>16220     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16221"><font size=-1>16221     </font></a><span class="string">In case the material is magnetic (well, this is only interesting in the case</span>
<a name="16222"><font size=-1>16222     </font></a><span class="string">of antiferromagnetism, collinear or not), additional symmetries might appear,</span>
<a name="16223"><font size=-1>16223     </font></a><span class="string">that change the sign of the magnetization. They have been introduced by</span>
<a name="16224"><font size=-1>16224     </font></a><span class="string">Shubnikov (1951). They can be used by ABINIT to decrease the CPU time, by</span>
<a name="16225"><font size=-1>16225     </font></a><span class="string">using them to decrease the number of k-points.</span>
<a name="16226"><font size=-1>16226     </font></a><span class="string">[[symafm]] should be set to +1 for all the usual symmetry operations, that do</span>
<a name="16227"><font size=-1>16227     </font></a><span class="string">not change the sign of the magnetization, while it should be set to -1 for the</span>
<a name="16228"><font size=-1>16228     </font></a><span class="string">magnetization-changing symmetries.</span>
<a name="16229"><font size=-1>16229     </font></a><span class="string">If the symmetry operations are not specified by the user in the input file,</span>
<a name="16230"><font size=-1>16230     </font></a><span class="string">that is, if [[nsym]] = 0, then ABINIT will use the values of [[spinat]] to</span>
<a name="16231"><font size=-1>16231     </font></a><span class="string">determine the content of [[symafm]].</span>
<a name="16232"><font size=-1>16232     </font></a><span class="string">The symmetries found as &quot;antiferro magnetic&quot; ([[symafm]] = -1) are used to</span>
<a name="16233"><font size=-1>16233     </font></a><span class="string">symmetrize density and magnetization in the following cases:</span>
<a name="16234"><font size=-1>16234     </font></a><span class="string"></span>
<a name="16235"><font size=-1>16235     </font></a><span class="string">  * antiferromagnetism ([[nsppol]] = 1, [[nspinor]] = 1, [[nspden]] = 2)</span>
<a name="16236"><font size=-1>16236     </font></a><span class="string">  * non-collinear magnetism ([[nsppol]] = 1, [[nspinor]] = 2, [[nspden]] = 4)</span>
<a name="16237"><font size=-1>16237     </font></a><span class="string"></span>
<a name="16238"><font size=-1>16238     </font></a><span class="string">In other cases they are not used.</span>
<a name="16239"><font size=-1>16239     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16240"><font size=-1>16240     </font></a><span class="default">),</span>
<a name="16241"><font size=-1>16241     </font></a><span class="default"></span>
<a name="16242"><font size=-1>16242     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16243"><font size=-1>16243     </font></a><span class="default">    abivarname=</span><span class="string">&quot;symchi&quot;</span><span class="default">,</span>
<a name="16244"><font size=-1>16244     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="16245"><font size=-1>16245     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16246"><font size=-1>16246     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">],</span>
<a name="16247"><font size=-1>16247     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16248"><font size=-1>16248     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="16249"><font size=-1>16249     </font></a><span class="default">    mnemonics=</span><span class="string">r&quot;SYMmetryze $\chi_0$&quot;</span><span class="default">,</span>
<a name="16250"><font size=-1>16250     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="16251"><font size=-1>16251     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] == 3&quot;</span><span class="default">,</span>
<a name="16252"><font size=-1>16252     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16253"><font size=-1>16253     </font></a><span class="string">The evaluation of the irreducible polarizability for a given q point requires</span>
<a name="16254"><font size=-1>16254     </font></a><span class="string">an integration over the Brillouin zone (BZ) which is approximated by a</span>
<a name="16255"><font size=-1>16255     </font></a><span class="string">discrete sum over k points. In principle the integrand function should be</span>
<a name="16256"><font size=-1>16256     </font></a><span class="string">evaluated for each k-point in the BZ, however it is possible to reduce the</span>
<a name="16257"><font size=-1>16257     </font></a><span class="string">number of points to be explicitly considered by taking advantage of symmetry</span>
<a name="16258"><font size=-1>16258     </font></a><span class="string">properties. The development input variable [[symchi]] is used to choose</span>
<a name="16259"><font size=-1>16259     </font></a><span class="string">between these two equivalent methods:</span>
<a name="16260"><font size=-1>16260     </font></a><span class="string"></span>
<a name="16261"><font size=-1>16261     </font></a><span class="string">  * 0 --&gt;  the summation over k points is performed considering **all** the points in the BZ (useful for testing and debugging).</span>
<a name="16262"><font size=-1>16262     </font></a><span class="string">  * 1 --&gt;  the summation is restricted to the k points belonging to the irreducible wedge defined by the little group associated to the external vector q.</span>
<a name="16263"><font size=-1>16263     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16264"><font size=-1>16264     </font></a><span class="default">),</span>
<a name="16265"><font size=-1>16265     </font></a><span class="default"></span>
<a name="16266"><font size=-1>16266     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16267"><font size=-1>16267     </font></a><span class="default">    abivarname=</span><span class="string">&quot;symdynmat&quot;</span><span class="default">,</span>
<a name="16268"><font size=-1>16268     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="16269"><font size=-1>16269     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16270"><font size=-1>16270     </font></a><span class="default">    topics=[</span><span class="string">'Phonons_useful'</span><span class="default">],</span>
<a name="16271"><font size=-1>16271     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16272"><font size=-1>16272     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="16273"><font size=-1>16273     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SYMmetrize the DYNamical MATrix&quot;</span><span class="default">,</span>
<a name="16274"><font size=-1>16274     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16275"><font size=-1>16275     </font></a><span class="string">If symdynmat is equal to 1, the dynamical matrix is symmetrized before the</span>
<a name="16276"><font size=-1>16276     </font></a><span class="string">diagonalization (same meaning as the corresponding anaddb variable). Note that</span>
<a name="16277"><font size=-1>16277     </font></a><span class="string">[[symdynmat]] == 1 will automatically enable the symmetrization of the electron-</span>
<a name="16278"><font size=-1>16278     </font></a><span class="string">phonon linewidths.</span>
<a name="16279"><font size=-1>16279     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16280"><font size=-1>16280     </font></a><span class="default">),</span>
<a name="16281"><font size=-1>16281     </font></a><span class="default"></span>
<a name="16282"><font size=-1>16282     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16283"><font size=-1>16283     </font></a><span class="default">    abivarname=</span><span class="string">&quot;symmorphi&quot;</span><span class="default">,</span>
<a name="16284"><font size=-1>16284     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="16285"><font size=-1>16285     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16286"><font size=-1>16286     </font></a><span class="default">    topics=[</span><span class="string">'crystal_expert'</span><span class="default">, </span><span class="string">'GW_useful'</span><span class="default">],</span>
<a name="16287"><font size=-1>16287     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16288"><font size=-1>16288     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="16289"><font size=-1>16289     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SYMMORPHIc symmetry operation selection&quot;</span><span class="default">,</span>
<a name="16290"><font size=-1>16290     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="16291"><font size=-1>16291     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16292"><font size=-1>16292     </font></a><span class="string">With [[symmorphi]] = 1, symmetry operations with a non-symmorphic vector are</span>
<a name="16293"><font size=-1>16293     </font></a><span class="string">allowed. With [[symmorphi]] = 0, they are not allowed. In the latter case, if</span>
<a name="16294"><font size=-1>16294     </font></a><span class="string">the symmetry operations are specified in the input file, the code will stop</span>
<a name="16295"><font size=-1>16295     </font></a><span class="string">and print an error message if a non-symmorphic vector is encountered. By</span>
<a name="16296"><font size=-1>16296     </font></a><span class="string">contrast, if the symmetry operations are to be determined automatically (if</span>
<a name="16297"><font size=-1>16297     </font></a><span class="string">[[nsym]] = 0), then the set of symmetries will not include the non-symmorphic</span>
<a name="16298"><font size=-1>16298     </font></a><span class="string">operations.</span>
<a name="16299"><font size=-1>16299     </font></a><span class="string"></span>
<a name="16300"><font size=-1>16300     </font></a><span class="string">Note: this feature exist because in a previous status of the GW calculations,</span>
<a name="16301"><font size=-1>16301     </font></a><span class="string">non-symmorphic symmetry operations could not be exploited. Thus, the k points</span>
<a name="16302"><font size=-1>16302     </font></a><span class="string">were restricted to the IBZ. In order to prepare GW calculations, and to</span>
<a name="16303"><font size=-1>16303     </font></a><span class="string">perform GW calculations, [[symmorphi]] = 0 was to be used, together with [[nsym]] = 0.</span>
<a name="16304"><font size=-1>16304     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16305"><font size=-1>16305     </font></a><span class="default">),</span>
<a name="16306"><font size=-1>16306     </font></a><span class="default"></span>
<a name="16307"><font size=-1>16307     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16308"><font size=-1>16308     </font></a><span class="default">    abivarname=</span><span class="string">&quot;symrel&quot;</span><span class="default">,</span>
<a name="16309"><font size=-1>16309     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16310"><font size=-1>16310     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16311"><font size=-1>16311     </font></a><span class="default">    topics=[</span><span class="string">'crystal_useful'</span><span class="default">],</span>
<a name="16312"><font size=-1>16312     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="number">3</span><span class="default">, </span><span class="string">'[[nsym]]'</span><span class="default">],</span>
<a name="16313"><font size=-1>16313     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[nsym]] == 1'</span><span class="default">: [[</span><span class="number">1</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">], [</span><span class="number">0</span><span class="default">, </span><span class="number">1</span><span class="default">, </span><span class="number">0</span><span class="default">], [</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">1</span><span class="default">]], </span><span class="string">'defaultval'</span><span class="default">: </span><span class="keyword">None</span><span class="default">}),</span>
<a name="16314"><font size=-1>16314     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SYMmetry in REaL space&quot;</span><span class="default">,</span>
<a name="16315"><font size=-1>16315     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16316"><font size=-1>16316     </font></a><span class="string">Gives &quot;[[nsym]]&quot; 3x3 matrices expressing space group symmetries in terms of</span>
<a name="16317"><font size=-1>16317     </font></a><span class="string">their action on the direct (or real) space primitive translations.</span>
<a name="16318"><font size=-1>16318     </font></a><span class="string">It turns out that these can always be expressed as integers.</span>
<a name="16319"><font size=-1>16319     </font></a><span class="string">Always give the identity matrix even if no other symmetries hold, e.g.</span>
<a name="16320"><font size=-1>16320     </font></a><span class="string">[[symrel]] 1 0 0 0 1 0 0 0 1</span>
<a name="16321"><font size=-1>16321     </font></a><span class="string">Also note that for this array as for all others the array elements are filled</span>
<a name="16322"><font size=-1>16322     </font></a><span class="string">in a columnwise order as is usual for Fortran.</span>
<a name="16323"><font size=-1>16323     </font></a><span class="string">The relation between the above symmetry matrices [[symrel]], expressed in the</span>
<a name="16324"><font size=-1>16324     </font></a><span class="string">basis of primitive translations, and the same symmetry matrices expressed in</span>
<a name="16325"><font size=-1>16325     </font></a><span class="string">cartesian coordinates, is as follows. Denote the matrix whose columns are the</span>
<a name="16326"><font size=-1>16326     </font></a><span class="string">primitive translations as R, and denote the cartesian symmetry matrix as S.</span>
<a name="16327"><font size=-1>16327     </font></a><span class="string">Then [[symrel]] = R(inverse) * S * R</span>
<a name="16328"><font size=-1>16328     </font></a><span class="string">where matrix multiplication is implied.</span>
<a name="16329"><font size=-1>16329     </font></a><span class="string">When the symmetry finder is used (see [[nsym]]), [[symrel]] will be computed automatically.</span>
<a name="16330"><font size=-1>16330     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16331"><font size=-1>16331     </font></a><span class="default">),</span>
<a name="16332"><font size=-1>16332     </font></a><span class="default"></span>
<a name="16333"><font size=-1>16333     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16334"><font size=-1>16334     </font></a><span class="default">    abivarname=</span><span class="string">&quot;symsigma&quot;</span><span class="default">,</span>
<a name="16335"><font size=-1>16335     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="16336"><font size=-1>16336     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16337"><font size=-1>16337     </font></a><span class="default">    topics=[</span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="16338"><font size=-1>16338     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16339"><font size=-1>16339     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="16340"><font size=-1>16340     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;SYMmetrization of SIGMA matrix elements&quot;</span><span class="default">,</span>
<a name="16341"><font size=-1>16341     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [4, 7]&quot;</span><span class="default">,</span>
<a name="16342"><font size=-1>16342     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16343"><font size=-1>16343     </font></a><span class="string">This option activates the symmetrization of the self-energy matrix elements ([[symsigma]] = 1).</span>
<a name="16344"><font size=-1>16344     </font></a><span class="string">In this case the BZ integration defining the self-energy</span>
<a name="16345"><font size=-1>16345     </font></a><span class="string">matrix elements is reduced to an appropriate irreducible wedge defined</span>
<a name="16346"><font size=-1>16346     </font></a><span class="string">by the point group of the wave-vector k specified in the [[kptgw]] list.</span>
<a name="16347"><font size=-1>16347     </font></a><span class="string"></span>
<a name="16348"><font size=-1>16348     </font></a><span class="string">The symmetrized expression leads to a considerable speedup of the run, especially</span>
<a name="16349"><font size=-1>16349     </font></a><span class="string">for high-symmetry k points e.g. $\Gamma$.</span>
<a name="16350"><font size=-1>16350     </font></a><span class="string">Unfortunately, this option is not yet compatible with self-consistent GW</span>
<a name="16351"><font size=-1>16351     </font></a><span class="string">calculations (see [[gwcalctyp]]).</span>
<a name="16352"><font size=-1>16352     </font></a><span class="string"></span>
<a name="16353"><font size=-1>16353     </font></a><span class="string">The code constructs a symmetric invariant</span>
<a name="16354"><font size=-1>16354     </font></a><span class="string">for the diagonal matrix elements of the self-energy by averaging the self-energy matrix</span>
<a name="16355"><font size=-1>16355     </font></a><span class="string">elements within the degenerate subspace. Therefore, particular care has to be</span>
<a name="16356"><font size=-1>16356     </font></a><span class="string">taken in the presence of accidental degeneracies. Since calculations</span>
<a name="16357"><font size=-1>16357     </font></a><span class="string">performed with [[symsigma]] = 1 will not be able to remove the initial</span>
<a name="16358"><font size=-1>16358     </font></a><span class="string">accidental degeneracy. This is the reason why this option is not activated by default.</span>
<a name="16359"><font size=-1>16359     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16360"><font size=-1>16360     </font></a><span class="default">),</span>
<a name="16361"><font size=-1>16361     </font></a><span class="default"></span>
<a name="16362"><font size=-1>16362     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16363"><font size=-1>16363     </font></a><span class="default">    abivarname=</span><span class="string">&quot;td_maxene&quot;</span><span class="default">,</span>
<a name="16364"><font size=-1>16364     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="16365"><font size=-1>16365     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16366"><font size=-1>16366     </font></a><span class="default">    topics=[</span><span class="string">'TDDFT_useful'</span><span class="default">],</span>
<a name="16367"><font size=-1>16367     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16368"><font size=-1>16368     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16369"><font size=-1>16369     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Time-Dependent dft: MAXimal kohn-sham ENErgy difference&quot;</span><span class="default">,</span>
<a name="16370"><font size=-1>16370     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16371"><font size=-1>16371     </font></a><span class="string">The Matrix to be diagonalized in the Casida framework (see [[cite:Casida1995]])</span>
<a name="16372"><font size=-1>16372     </font></a><span class="string">is a NxN matrix, where, by default, N is the product of the number of occupied</span>
<a name="16373"><font size=-1>16373     </font></a><span class="string">states by the number of unoccupied states. The input variable [[td_maxene]]</span>
<a name="16374"><font size=-1>16374     </font></a><span class="string">allows one to diminish N: it selects only the pairs of occupied and unoccupied</span>
<a name="16375"><font size=-1>16375     </font></a><span class="string">states for which the Kohn-Sham energy difference is less than [[td_maxene]].</span>
<a name="16376"><font size=-1>16376     </font></a><span class="string">The default value 0.0 means that all pairs are taken into account.</span>
<a name="16377"><font size=-1>16377     </font></a><span class="string">See [[td_mexcit]] for an alternative way to decrease N.</span>
<a name="16378"><font size=-1>16378     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16379"><font size=-1>16379     </font></a><span class="default">),</span>
<a name="16380"><font size=-1>16380     </font></a><span class="default"></span>
<a name="16381"><font size=-1>16381     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16382"><font size=-1>16382     </font></a><span class="default">    abivarname=</span><span class="string">&quot;td_mexcit&quot;</span><span class="default">,</span>
<a name="16383"><font size=-1>16383     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="16384"><font size=-1>16384     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16385"><font size=-1>16385     </font></a><span class="default">    topics=[</span><span class="string">'TDDFT_useful'</span><span class="default">],</span>
<a name="16386"><font size=-1>16386     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16387"><font size=-1>16387     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="16388"><font size=-1>16388     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Time-Dependent dft: Maximal number of EXCITations&quot;</span><span class="default">,</span>
<a name="16389"><font size=-1>16389     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16390"><font size=-1>16390     </font></a><span class="string">The Matrix to be diagonalized in the Casida framework (see [[cite:Casida1995]])</span>
<a name="16391"><font size=-1>16391     </font></a><span class="string">is a NxN matrix, where, by default, N is the product of the number of occupied</span>
<a name="16392"><font size=-1>16392     </font></a><span class="string">states by the number of unoccupied states. The input variable [[td_mexcit]]</span>
<a name="16393"><font size=-1>16393     </font></a><span class="string">allows one to diminish N: it selects the first [[td_mexcit]] pairs of occupied and</span>
<a name="16394"><font size=-1>16394     </font></a><span class="string">unoccupied states, ordered with respect to increasing Kohn-Sham energy difference.</span>
<a name="16395"><font size=-1>16395     </font></a><span class="string">However, when [[td_mexcit]] is zero, all pairs are allowed.</span>
<a name="16396"><font size=-1>16396     </font></a><span class="string">See [[td_maxene]] for an alternative way to decrease N.</span>
<a name="16397"><font size=-1>16397     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16398"><font size=-1>16398     </font></a><span class="default">),</span>
<a name="16399"><font size=-1>16399     </font></a><span class="default"></span>
<a name="16400"><font size=-1>16400     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16401"><font size=-1>16401     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tfkinfunc&quot;</span><span class="default">,</span>
<a name="16402"><font size=-1>16402     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="16403"><font size=-1>16403     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16404"><font size=-1>16404     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_compulsory'</span><span class="default">],</span>
<a name="16405"><font size=-1>16405     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16406"><font size=-1>16406     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="16407"><font size=-1>16407     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Thomas-Fermi KINetic energy FUNCtional&quot;</span><span class="default">,</span>
<a name="16408"><font size=-1>16408     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="16409"><font size=-1>16409     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16410"><font size=-1>16410     </font></a><span class="string">  * [[tfkinfunc]] = 1: Thomas-Fermi kinetic functional (explicit functional of the density) is used instead of Kohn-Sham kinetic</span>
<a name="16411"><font size=-1>16411     </font></a><span class="string">  energy functional (implicit functional of the density through Kohn-Sham wavefunctions). See [[cite:Perrot1979]].</span>
<a name="16412"><font size=-1>16412     </font></a><span class="string"></span>
<a name="16413"><font size=-1>16413     </font></a><span class="string">  * [[tfkinfunc]] = 11: Thomas-Fermi-Weizsacker kinetic functional with Gradient Corrections is used.</span>
<a name="16414"><font size=-1>16414     </font></a><span class="string">The convergence of a calculation with this functional needs to be initialized</span>
<a name="16415"><font size=-1>16415     </font></a><span class="string">from a calculation without Gradient Correction. This is automatically done</span>
<a name="16416"><font size=-1>16416     </font></a><span class="string">with [[tfkinfunc]] = 11. For the initialization steps, the [[tfw_toldfe]]</span>
<a name="16417"><font size=-1>16417     </font></a><span class="string">criterion is used. When it is reached, then the Gradient Correction is added</span>
<a name="16418"><font size=-1>16418     </font></a><span class="string">and the SCF cycle continues.</span>
<a name="16419"><font size=-1>16419     </font></a><span class="string">Note: to obtain the convergence of a Molecular Dynamics simulation with TFW,</span>
<a name="16420"><font size=-1>16420     </font></a><span class="string">it is necessary to find the best set of preconditionning parameters</span>
<a name="16421"><font size=-1>16421     </font></a><span class="string">([[diemix]], [[diemac]], [[dielng]]) and the best value of [[npulayit]] (if</span>
<a name="16422"><font size=-1>16422     </font></a><span class="string">the default Pulay mixing is used).</span>
<a name="16423"><font size=-1>16423     </font></a><span class="string"></span>
<a name="16424"><font size=-1>16424     </font></a><span class="string">  * [[tfkinfunc]] = 12: same as **tfkinfunc** =11, but without the initialization steps.</span>
<a name="16425"><font size=-1>16425     </font></a><span class="string">  Gradient correction is directly added.</span>
<a name="16426"><font size=-1>16426     </font></a><span class="string"></span>
<a name="16427"><font size=-1>16427     </font></a><span class="string">  * [[tfkinfunc]] = 2: the Recursion Method is used in order to compute electronic density,</span>
<a name="16428"><font size=-1>16428     </font></a><span class="string">  entropy, Fermi energy and eigenvalues energy. This method computes the density</span>
<a name="16429"><font size=-1>16429     </font></a><span class="string">  without computing any orbital, is efficient at high temperature, with a efficient</span>
<a name="16430"><font size=-1>16430     </font></a><span class="string">  parallelization (almost perfect scalability).</span>
<a name="16431"><font size=-1>16431     </font></a><span class="string">  When that option is in use, the [[ecut]] input variable is no longer a convergence</span>
<a name="16432"><font size=-1>16432     </font></a><span class="string">  parameter; [[ngfft]] becomes the main convergence parameter: you should adapt ecut</span>
<a name="16433"><font size=-1>16433     </font></a><span class="string">  for the ngfft grid you need (it is not yet automatically computed).</span>
<a name="16434"><font size=-1>16434     </font></a><span class="string">  Other convergence parameter are for the energetic values: [[recnrec]], [[recptrott]], [[recnpath]].</span>
<a name="16435"><font size=-1>16435     </font></a><span class="string"></span>
<a name="16436"><font size=-1>16436     </font></a><span class="string">Since the convergence of the self-consistent cycle is determined directly by</span>
<a name="16437"><font size=-1>16437     </font></a><span class="string">the convergence of the density: [[toldfe]], [[toldff]], [[tolrff]],</span>
<a name="16438"><font size=-1>16438     </font></a><span class="string">[[tolvrs]], [[tolwfr]] are not used, and are replaced by [[rectolden]]; the</span>
<a name="16439"><font size=-1>16439     </font></a><span class="string">energetic values, except for the fermi energy, are only computed during the</span>
<a name="16440"><font size=-1>16440     </font></a><span class="string">latest SFC cycle: the output file will show a jump of the total energy at the</span>
<a name="16441"><font size=-1>16441     </font></a><span class="string">end, but it is not because of a bad convergence behavior. Computational speed</span>
<a name="16442"><font size=-1>16442     </font></a><span class="string">can be improved by the use of [[recrcut]] and [[recgratio]]. The recursion</span>
<a name="16443"><font size=-1>16443     </font></a><span class="string">method has not been tested in the case of non cubic cell or with the use of</span>
<a name="16444"><font size=-1>16444     </font></a><span class="string">symmetries.</span>
<a name="16445"><font size=-1>16445     </font></a><span class="string">In the recursion method the following variables are set to: [[useylm]] = 1,</span>
<a name="16446"><font size=-1>16446     </font></a><span class="string">[[userec]] = 1.</span>
<a name="16447"><font size=-1>16447     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16448"><font size=-1>16448     </font></a><span class="default">),</span>
<a name="16449"><font size=-1>16449     </font></a><span class="default"></span>
<a name="16450"><font size=-1>16450     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16451"><font size=-1>16451     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tfw_toldfe&quot;</span><span class="default">,</span>
<a name="16452"><font size=-1>16452     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="16453"><font size=-1>16453     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16454"><font size=-1>16454     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_useful'</span><span class="default">],</span>
<a name="16455"><font size=-1>16455     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16456"><font size=-1>16456     </font></a><span class="default">    defaultval=</span><span class="string">&quot;1.0E-6 or [[toldfe]] is present&quot;</span><span class="default">,</span>
<a name="16457"><font size=-1>16457     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Thomas-Fermi-Weizsacker: TOLerance on the DiFference of total Energy, for initialization steps&quot;</span><span class="default">,</span>
<a name="16458"><font size=-1>16458     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="16459"><font size=-1>16459     </font></a><span class="default">    requires=</span><span class="string">&quot;[[tfkinfunc]] = 11&quot;</span><span class="default">,</span>
<a name="16460"><font size=-1>16460     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16461"><font size=-1>16461     </font></a><span class="string">This input variable has the same definition as [[toldfe]] and is only relevant</span>
<a name="16462"><font size=-1>16462     </font></a><span class="string">when [[tfkinfunc]] = 11.</span>
<a name="16463"><font size=-1>16463     </font></a><span class="string">It sets a tolerance for absolute differences of total energy that, reached</span>
<a name="16464"><font size=-1>16464     </font></a><span class="string">TWICE successively, will cause the initialization steps (without gradient</span>
<a name="16465"><font size=-1>16465     </font></a><span class="string">correction) to stop and the gradient correction to be added.</span>
<a name="16466"><font size=-1>16466     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since it has the</span>
<a name="16467"><font size=-1>16467     </font></a><span class="string">'ENERGY' characteristics.</span>
<a name="16468"><font size=-1>16468     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16469"><font size=-1>16469     </font></a><span class="default">),</span>
<a name="16470"><font size=-1>16470     </font></a><span class="default"></span>
<a name="16471"><font size=-1>16471     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16472"><font size=-1>16472     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tim1rev&quot;</span><span class="default">,</span>
<a name="16473"><font size=-1>16473     </font></a><span class="default">    varset=</span><span class="string">&quot;dfpt&quot;</span><span class="default">,</span>
<a name="16474"><font size=-1>16474     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16475"><font size=-1>16475     </font></a><span class="default">    topics=[</span><span class="string">'DFPT_expert'</span><span class="default">, </span><span class="string">'DFPT_internal'</span><span class="default">],</span>
<a name="16476"><font size=-1>16476     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16477"><font size=-1>16477     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="16478"><font size=-1>16478     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TIMe 1st order REVersal&quot;</span><span class="default">,</span>
<a name="16479"><font size=-1>16479     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="16480"><font size=-1>16480     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16481"><font size=-1>16481     </font></a><span class="string">Allowed values are 0 or 1.</span>
<a name="16482"><font size=-1>16482     </font></a><span class="string"></span>
<a name="16483"><font size=-1>16483     </font></a><span class="string">If tim1rev is equal to 1, the Sternheimer equation is solved simultaneously at</span>
<a name="16484"><font size=-1>16484     </font></a><span class="string">+q and -q perturbation wavevectors. The first order potential at -q is taken</span>
<a name="16485"><font size=-1>16485     </font></a><span class="string">to be equal to the Hermitian conjugate of the first order potential at +q.</span>
<a name="16486"><font size=-1>16486     </font></a><span class="string">The wavefunctions from both +q and -q are then combined to generate the first order density.</span>
<a name="16487"><font size=-1>16487     </font></a><span class="string">Relevant in the case of magnetic field perturbation (but will be relevant also in case of non-zero frequency DFPT, when implemented).</span>
<a name="16488"><font size=-1>16488     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16489"><font size=-1>16489     </font></a><span class="default">),</span>
<a name="16490"><font size=-1>16490     </font></a><span class="default"></span>
<a name="16491"><font size=-1>16491     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16492"><font size=-1>16492     </font></a><span class="default">    abivarname=</span><span class="string">&quot;timopt&quot;</span><span class="default">,</span>
<a name="16493"><font size=-1>16493     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="16494"><font size=-1>16494     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16495"><font size=-1>16495     </font></a><span class="default">    topics=[</span><span class="string">'Control_expert'</span><span class="default">],</span>
<a name="16496"><font size=-1>16496     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16497"><font size=-1>16497     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[SEQUENTIAL]]'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="16498"><font size=-1>16498     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TIMing OPTion&quot;</span><span class="default">,</span>
<a name="16499"><font size=-1>16499     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="16500"><font size=-1>16500     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16501"><font size=-1>16501     </font></a><span class="string">This input variable allows one to modulate the use of the timing routines.</span>
<a name="16502"><font size=-1>16502     </font></a><span class="string"></span>
<a name="16503"><font size=-1>16503     </font></a><span class="string">  * If 0  --&gt;  as soon as possible, suppresses all calls to timing routines</span>
<a name="16504"><font size=-1>16504     </font></a><span class="string">  * If 1  --&gt;  usual timing behaviour, with short analysis, appropriate for</span>
<a name="16505"><font size=-1>16505     </font></a><span class="string">sequential execution</span>
<a name="16506"><font size=-1>16506     </font></a><span class="string">  * If 2  --&gt;  close to [[timopt]] = 1, except that the analysis routine does not time</span>
<a name="16507"><font size=-1>16507     </font></a><span class="string">the timer, appropriate for parallel execution.</span>
<a name="16508"><font size=-1>16508     </font></a><span class="string">  * If 3  --&gt;  close to [[timopt]] = 1, except that the different parts of the lobpcg</span>
<a name="16509"><font size=-1>16509     </font></a><span class="string">routine are timed in detail.</span>
<a name="16510"><font size=-1>16510     </font></a><span class="string">  * If 4  --&gt;  close to [[timopt]] = 1, except that the different parts of the lobpcg</span>
<a name="16511"><font size=-1>16511     </font></a><span class="string">routine are timed in detail. A different splitting of lobpcg than for</span>
<a name="16512"><font size=-1>16512     </font></a><span class="string">[[timopt]] = -3 is provided.</span>
<a name="16513"><font size=-1>16513     </font></a><span class="string">  * If -1  --&gt;  a full analysis of timings is delivered</span>
<a name="16514"><font size=-1>16514     </font></a><span class="string">  * If -2  --&gt;  a full analysis of timings is delivered, except timing the timer</span>
<a name="16515"><font size=-1>16515     </font></a><span class="string">  * If -3  --&gt;  a full analysis of timings is delivered, including the detailed</span>
<a name="16516"><font size=-1>16516     </font></a><span class="string">timing of the different parts of the lobpcg routine. (this takes time, and is</span>
<a name="16517"><font size=-1>16517     </font></a><span class="string">discouraged for too small runs - the timing would take more time than the run</span>
<a name="16518"><font size=-1>16518     </font></a><span class="string">!). The timer is timed.</span>
<a name="16519"><font size=-1>16519     </font></a><span class="string">  * If -4  --&gt;  a full analysis of timings is delivered, including the detailed</span>
<a name="16520"><font size=-1>16520     </font></a><span class="string">timing of the different parts of the lobpcg routine. A different splitting of</span>
<a name="16521"><font size=-1>16521     </font></a><span class="string">lobpcg than for [[timopt]] = -3 is provided (this takes time, and is discouraged</span>
<a name="16522"><font size=-1>16522     </font></a><span class="string">for too small runs - the timing would take more time than the run !). The</span>
<a name="16523"><font size=-1>16523     </font></a><span class="string">timer is timed. The sum of the independent parts is closer to 100% than for [[timopt]] = -3.</span>
<a name="16524"><font size=-1>16524     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16525"><font size=-1>16525     </font></a><span class="default">),</span>
<a name="16526"><font size=-1>16526     </font></a><span class="default"></span>
<a name="16527"><font size=-1>16527     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16528"><font size=-1>16528     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tl_nprccg&quot;</span><span class="default">,</span>
<a name="16529"><font size=-1>16529     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="16530"><font size=-1>16530     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16531"><font size=-1>16531     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_expert'</span><span class="default">],</span>
<a name="16532"><font size=-1>16532     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16533"><font size=-1>16533     </font></a><span class="default">    defaultval=</span><span class="number">30</span><span class="default">,</span>
<a name="16534"><font size=-1>16534     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TaiL maximum Number of PReConditionner Conjugate Gradient iterations&quot;</span><span class="default">,</span>
<a name="16535"><font size=-1>16535     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16536"><font size=-1>16536     </font></a><span class="string">This variable is similar to [[wvl_nprccg]] but for the preconditionner</span>
<a name="16537"><font size=-1>16537     </font></a><span class="string">iterations during the tail corrections (see [[tl_radius]]).</span>
<a name="16538"><font size=-1>16538     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16539"><font size=-1>16539     </font></a><span class="default">),</span>
<a name="16540"><font size=-1>16540     </font></a><span class="default"></span>
<a name="16541"><font size=-1>16541     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16542"><font size=-1>16542     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tl_radius&quot;</span><span class="default">,</span>
<a name="16543"><font size=-1>16543     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="16544"><font size=-1>16544     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16545"><font size=-1>16545     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_useful'</span><span class="default">],</span>
<a name="16546"><font size=-1>16546     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16547"><font size=-1>16547     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16548"><font size=-1>16548     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TaiL expansion RADIUS&quot;</span><span class="default">,</span>
<a name="16549"><font size=-1>16549     </font></a><span class="default">    characteristics=[</span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="16550"><font size=-1>16550     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16551"><font size=-1>16551     </font></a><span class="string">In the wavelet computation case, the linkage between the grid and the free</span>
<a name="16552"><font size=-1>16552     </font></a><span class="string">boundary conditions can be smoothed using an exponential decay. This means a</span>
<a name="16553"><font size=-1>16553     </font></a><span class="string">correction on the energy at the end on each wavefunction optimisation run. If</span>
<a name="16554"><font size=-1>16554     </font></a><span class="string">this parameter is set to zero, no tail computation is done. On the contrary,</span>
<a name="16555"><font size=-1>16555     </font></a><span class="string">put it to a positive value makes the tail correction available. The value</span>
<a name="16556"><font size=-1>16556     </font></a><span class="string">correspond to a length in atomic units being the spacial expansion with the</span>
<a name="16557"><font size=-1>16557     </font></a><span class="string">exponential decay around the grid.</span>
<a name="16558"><font size=-1>16558     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16559"><font size=-1>16559     </font></a><span class="default">),</span>
<a name="16560"><font size=-1>16560     </font></a><span class="default"></span>
<a name="16561"><font size=-1>16561     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16562"><font size=-1>16562     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tnons&quot;</span><span class="default">,</span>
<a name="16563"><font size=-1>16563     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16564"><font size=-1>16564     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16565"><font size=-1>16565     </font></a><span class="default">    topics=[</span><span class="string">'crystal_useful'</span><span class="default">],</span>
<a name="16566"><font size=-1>16566     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[nsym]]'</span><span class="default">],</span>
<a name="16567"><font size=-1>16567     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Translation NON-Symmorphic vectors&quot;</span><span class="default">,</span>
<a name="16568"><font size=-1>16568     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16569"><font size=-1>16569     </font></a><span class="string">Gives the (nonsymmorphic) translation vectors associated with the symmetries</span>
<a name="16570"><font size=-1>16570     </font></a><span class="string">expressed in &quot;[[symrel]]&quot;.</span>
<a name="16571"><font size=-1>16571     </font></a><span class="string">These may all be 0, or may be fractional (nonprimitive) translations expressed</span>
<a name="16572"><font size=-1>16572     </font></a><span class="string">relative to the real space primitive translations (so, using the &quot;reduced&quot;</span>
<a name="16573"><font size=-1>16573     </font></a><span class="string">system of coordinates, see &quot;[[xred]]&quot;). If all elements of the space group</span>
<a name="16574"><font size=-1>16574     </font></a><span class="string">leave 0 0 0 invariant, then these are all 0.</span>
<a name="16575"><font size=-1>16575     </font></a><span class="string">When the symmetry finder is used (see [[nsym]]), [[tnons]] is computed</span>
<a name="16576"><font size=-1>16576     </font></a><span class="string">automatically.</span>
<a name="16577"><font size=-1>16577     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16578"><font size=-1>16578     </font></a><span class="default">),</span>
<a name="16579"><font size=-1>16579     </font></a><span class="default"></span>
<a name="16580"><font size=-1>16580     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16581"><font size=-1>16581     </font></a><span class="default">    abivarname=</span><span class="string">&quot;toldfe&quot;</span><span class="default">,</span>
<a name="16582"><font size=-1>16582     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16583"><font size=-1>16583     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16584"><font size=-1>16584     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_basic'</span><span class="default">],</span>
<a name="16585"><font size=-1>16585     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16586"><font size=-1>16586     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16587"><font size=-1>16587     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the DiFference of total Energy&quot;</span><span class="default">,</span>
<a name="16588"><font size=-1>16588     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="16589"><font size=-1>16589     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria [[tolwfr]], [[toldff]], [[tolrff]], [[toldfe]] or [[tolvrs]] must differ from zero.&quot;</span><span class="default">,</span>
<a name="16590"><font size=-1>16590     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[tolwfr]] or [[toldff]] or [[tolrff]] or [[tolvrs]]&quot;</span><span class="default">,</span>
<a name="16591"><font size=-1>16591     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16592"><font size=-1>16592     </font></a><span class="string">Sets a tolerance for absolute differences of total energy that, reached TWICE</span>
<a name="16593"><font size=-1>16593     </font></a><span class="string">successively, will cause one SCF cycle to stop (and ions to be moved).</span>
<a name="16594"><font size=-1>16594     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[toldfe]] has</span>
<a name="16595"><font size=-1>16595     </font></a><span class="string">the '[[ENERGY]]' characteristics. (1 Ha=27.2113845 eV)</span>
<a name="16596"><font size=-1>16596     </font></a><span class="string">If set to zero, this stopping condition is ignored.</span>
<a name="16597"><font size=-1>16597     </font></a><span class="string">Effective only when SCF cycles are done ([[iscf]]&gt;0).</span>
<a name="16598"><font size=-1>16598     </font></a><span class="string">Because of machine precision, it is not worth to try to obtain differences in</span>
<a name="16599"><font size=-1>16599     </font></a><span class="string">energy that are smaller than about 1.0d-12 of the total energy. To get</span>
<a name="16600"><font size=-1>16600     </font></a><span class="string">accurate stresses may be quite demanding.</span>
<a name="16601"><font size=-1>16601     </font></a><span class="string">When the geometry is optimized (relaxation of atomic positions or primitive</span>
<a name="16602"><font size=-1>16602     </font></a><span class="string">vectors), the use of [[toldfe]] is to be avoided. The use of [[toldff]] or</span>
<a name="16603"><font size=-1>16603     </font></a><span class="string">[[tolrff]] is by far preferable, in order to have a handle on the geometry</span>
<a name="16604"><font size=-1>16604     </font></a><span class="string">characteristics. When all forces vanish by symmetry (e.g. optimization of the</span>
<a name="16605"><font size=-1>16605     </font></a><span class="string">lattice parameters of a high-symmetry crystal), then place [[toldfe]] to</span>
<a name="16606"><font size=-1>16606     </font></a><span class="string">1.0d-12, or use (better) [[tolvrs]].</span>
<a name="16607"><font size=-1>16607     </font></a><span class="string">Since [[toldfe]], [[toldff]], [[tolrff]], [[tolvrs]] and [[tolwfr]] are aimed</span>
<a name="16608"><font size=-1>16608     </font></a><span class="string">at the same goal (causing the SCF cycle to stop), they are seen as a unique</span>
<a name="16609"><font size=-1>16609     </font></a><span class="string">input variable at reading. Hence, it is forbidden that two of these input</span>
<a name="16610"><font size=-1>16610     </font></a><span class="string">variables have non-zero values for the same dataset, or generically (for all</span>
<a name="16611"><font size=-1>16611     </font></a><span class="string">datasets). However, a non-zero value for one such variable for one dataset</span>
<a name="16612"><font size=-1>16612     </font></a><span class="string">will have precedence on the non-zero value for another input variable defined</span>
<a name="16613"><font size=-1>16613     </font></a><span class="string">generically.</span>
<a name="16614"><font size=-1>16614     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16615"><font size=-1>16615     </font></a><span class="default">),</span>
<a name="16616"><font size=-1>16616     </font></a><span class="default"></span>
<a name="16617"><font size=-1>16617     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16618"><font size=-1>16618     </font></a><span class="default">    abivarname=</span><span class="string">&quot;toldff&quot;</span><span class="default">,</span>
<a name="16619"><font size=-1>16619     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16620"><font size=-1>16620     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16621"><font size=-1>16621     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_basic'</span><span class="default">, </span><span class="string">'ForcesStresses_basic'</span><span class="default">],</span>
<a name="16622"><font size=-1>16622     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16623"><font size=-1>16623     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16624"><font size=-1>16624     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the DiFference of Forces&quot;</span><span class="default">,</span>
<a name="16625"><font size=-1>16625     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria [[tolwfr]], [[toldff]], [[tolrff]], [[toldfe]] or [[tolvrs]] must differ from zero.&quot;</span><span class="default">,</span>
<a name="16626"><font size=-1>16626     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[tolwfr]] or [[toldfe]] or [[tolrff]] or [[tolvrs]]&quot;</span><span class="default">,</span>
<a name="16627"><font size=-1>16627     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16628"><font size=-1>16628     </font></a><span class="string">Sets a tolerance for differences of forces (in hartree/Bohr) that, reached</span>
<a name="16629"><font size=-1>16629     </font></a><span class="string">TWICE successively, will cause one SCF cycle to stop (and ions to be moved).</span>
<a name="16630"><font size=-1>16630     </font></a><span class="string">If set to zero, this stopping condition is ignored.</span>
<a name="16631"><font size=-1>16631     </font></a><span class="string">Effective only when SCF cycles are done ([[iscf]]&gt;0). This tolerance applies</span>
<a name="16632"><font size=-1>16632     </font></a><span class="string">to any particular cartesian component of any atom, INCLUDING fixed ones. This</span>
<a name="16633"><font size=-1>16633     </font></a><span class="string">is to be used when trying to equilibrate a structure to its lowest energy</span>
<a name="16634"><font size=-1>16634     </font></a><span class="string">configuration ([[ionmov]] = 2), or in case of molecular dynamics ([[ionmov]] = 1)</span>
<a name="16635"><font size=-1>16635     </font></a><span class="string">A value ten times smaller than [[tolmxf]] is suggested (for example 5.0d-6</span>
<a name="16636"><font size=-1>16636     </font></a><span class="string">hartree/Bohr).</span>
<a name="16637"><font size=-1>16637     </font></a><span class="string">This stopping criterion is not allowed for RF calculations.</span>
<a name="16638"><font size=-1>16638     </font></a><span class="string">Since [[toldfe]], [[toldff]], [[tolrff]], [[tolvrs]] and [[tolwfr]] are aimed</span>
<a name="16639"><font size=-1>16639     </font></a><span class="string">at the same goal (causing the SCF cycle to stop), they are seen as a unique</span>
<a name="16640"><font size=-1>16640     </font></a><span class="string">input variable at reading. Hence, it is forbidden that two of these input</span>
<a name="16641"><font size=-1>16641     </font></a><span class="string">variables have non-zero values for the same dataset, or generically (for all</span>
<a name="16642"><font size=-1>16642     </font></a><span class="string">datasets). However, a non-zero value for one such variable for one dataset</span>
<a name="16643"><font size=-1>16643     </font></a><span class="string">will have precedence on the non-zero value for another input variable defined</span>
<a name="16644"><font size=-1>16644     </font></a><span class="string">generically.</span>
<a name="16645"><font size=-1>16645     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16646"><font size=-1>16646     </font></a><span class="default">),</span>
<a name="16647"><font size=-1>16647     </font></a><span class="default"></span>
<a name="16648"><font size=-1>16648     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16649"><font size=-1>16649     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolimg&quot;</span><span class="default">,</span>
<a name="16650"><font size=-1>16650     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="16651"><font size=-1>16651     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16652"><font size=-1>16652     </font></a><span class="default">    topics=[</span><span class="string">'TransPath_basic'</span><span class="default">],</span>
<a name="16653"><font size=-1>16653     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16654"><font size=-1>16654     </font></a><span class="default">    defaultval=</span><span class="number">5e-05</span><span class="default">,</span>
<a name="16655"><font size=-1>16655     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the mean total energy for IMaGes&quot;</span><span class="default">,</span>
<a name="16656"><font size=-1>16656     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="16657"><font size=-1>16657     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16658"><font size=-1>16658     </font></a><span class="string">Sets a maximal absolute energy tolerance (in hartree, averaged over dynamic</span>
<a name="16659"><font size=-1>16659     </font></a><span class="string">images) below which iterations on images (the one governed by the</span>
<a name="16660"><font size=-1>16660     </font></a><span class="string">[[ntimimage]] input variable) will stop.</span>
<a name="16661"><font size=-1>16661     </font></a><span class="string">This is to be used when trying to optimize a population of structures to their</span>
<a name="16662"><font size=-1>16662     </font></a><span class="string">lowest energy configuration, taking into account the particular algorithm</span>
<a name="16663"><font size=-1>16663     </font></a><span class="string">defined by [[imgmov]]</span>
<a name="16664"><font size=-1>16664     </font></a><span class="string">A value of about 5.0d-5 hartree or smaller is suggested (this corresponds to</span>
<a name="16665"><font size=-1>16665     </font></a><span class="string">about 3.7d-7 eV).</span>
<a name="16666"><font size=-1>16666     </font></a><span class="string">No meaning for RF calculations.</span>
<a name="16667"><font size=-1>16667     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16668"><font size=-1>16668     </font></a><span class="default">),</span>
<a name="16669"><font size=-1>16669     </font></a><span class="default"></span>
<a name="16670"><font size=-1>16670     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16671"><font size=-1>16671     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolmxde&quot;</span><span class="default">,</span>
<a name="16672"><font size=-1>16672     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="16673"><font size=-1>16673     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16674"><font size=-1>16674     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_basic'</span><span class="default">],</span>
<a name="16675"><font size=-1>16675     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16676"><font size=-1>16676     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16677"><font size=-1>16677     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the MaXimal Difference in Energy&quot;</span><span class="default">,</span>
<a name="16678"><font size=-1>16678     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="16679"><font size=-1>16679     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16680"><font size=-1>16680     </font></a><span class="string">Sets a maximal difference in energy with respect to the two previous steps</span>
<a name="16681"><font size=-1>16681     </font></a><span class="string">below which BFGS structural relaxation iterations will stop.</span>
<a name="16682"><font size=-1>16682     </font></a><span class="string">A value of about 0.0005 eV/atom or smaller is suggested.</span>
<a name="16683"><font size=-1>16683     </font></a><span class="string">In order to use tolmxde, you should explicitly set tolmxf to 0.0.</span>
<a name="16684"><font size=-1>16684     </font></a><span class="string">No meaning for RF calculations.</span>
<a name="16685"><font size=-1>16685     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16686"><font size=-1>16686     </font></a><span class="default">),</span>
<a name="16687"><font size=-1>16687     </font></a><span class="default"></span>
<a name="16688"><font size=-1>16688     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16689"><font size=-1>16689     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolmxf&quot;</span><span class="default">,</span>
<a name="16690"><font size=-1>16690     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="16691"><font size=-1>16691     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16692"><font size=-1>16692     </font></a><span class="default">    topics=[</span><span class="string">'GeoOpt_basic'</span><span class="default">],</span>
<a name="16693"><font size=-1>16693     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16694"><font size=-1>16694     </font></a><span class="default">    defaultval=</span><span class="number">5e-05</span><span class="default">,</span>
<a name="16695"><font size=-1>16695     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the MaXimal Force&quot;</span><span class="default">,</span>
<a name="16696"><font size=-1>16696     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16697"><font size=-1>16697     </font></a><span class="string">Sets a maximal absolute force tolerance (in hartree/Bohr) below which BFGS</span>
<a name="16698"><font size=-1>16698     </font></a><span class="string">structural relaxation iterations will stop.</span>
<a name="16699"><font size=-1>16699     </font></a><span class="string">Can also control tolerance on stresses, when [[optcell]] /=0, using the</span>
<a name="16700"><font size=-1>16700     </font></a><span class="string">conversion factor [[strfact]]. This tolerance applies to any particular</span>
<a name="16701"><font size=-1>16701     </font></a><span class="string">cartesian component of any atom, excluding fixed ones. See the parameter</span>
<a name="16702"><font size=-1>16702     </font></a><span class="string">[[ionmov]].</span>
<a name="16703"><font size=-1>16703     </font></a><span class="string">This is to be used when trying to equilibrate a structure to its lowest energy</span>
<a name="16704"><font size=-1>16704     </font></a><span class="string">configuration ( [[ionmov]] =2).</span>
<a name="16705"><font size=-1>16705     </font></a><span class="string">A value of about 5.0d-5 hartree/Bohr or smaller is suggested (this corresponds</span>
<a name="16706"><font size=-1>16706     </font></a><span class="string">to about 2.5d-3 eV/Angstrom).</span>
<a name="16707"><font size=-1>16707     </font></a><span class="string">No meaning for RF calculations.</span>
<a name="16708"><font size=-1>16708     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16709"><font size=-1>16709     </font></a><span class="default">),</span>
<a name="16710"><font size=-1>16710     </font></a><span class="default"></span>
<a name="16711"><font size=-1>16711     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16712"><font size=-1>16712     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolrde&quot;</span><span class="default">,</span>
<a name="16713"><font size=-1>16713     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="16714"><font size=-1>16714     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16715"><font size=-1>16715     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_expert'</span><span class="default">],</span>
<a name="16716"><font size=-1>16716     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16717"><font size=-1>16717     </font></a><span class="default">    defaultval=</span><span class="number">0.005</span><span class="default">,</span>
<a name="16718"><font size=-1>16718     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the Relative Difference of Eigenenergies&quot;</span><span class="default">,</span>
<a name="16719"><font size=-1>16719     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16720"><font size=-1>16720     </font></a><span class="string">Sets a tolerance for the ratio of differences of eigenenergies in the line</span>
<a name="16721"><font size=-1>16721     </font></a><span class="string">minimisation conjugate-gradient algorithm. It compares the decrease of the</span>
<a name="16722"><font size=-1>16722     </font></a><span class="string">eigenenergy due to the last line minimisation, with the one observed for the</span>
<a name="16723"><font size=-1>16723     </font></a><span class="string">first line minimisation. When the ratio is lower than [[tolrde]], the next</span>
<a name="16724"><font size=-1>16724     </font></a><span class="string">line minimisations are skipped.</span>
<a name="16725"><font size=-1>16725     </font></a><span class="string">The number of line minimisations is limited by [[nline]] anyhow.</span>
<a name="16726"><font size=-1>16726     </font></a><span class="string">This stopping criterion is present for both GS and RF calculations. In RF</span>
<a name="16727"><font size=-1>16727     </font></a><span class="string">calculations, [[tolrde]] is actually doubled before comparing with the above-</span>
<a name="16728"><font size=-1>16728     </font></a><span class="string">mentioned ratio, for historical reasons.</span>
<a name="16729"><font size=-1>16729     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16730"><font size=-1>16730     </font></a><span class="default">),</span>
<a name="16731"><font size=-1>16731     </font></a><span class="default"></span>
<a name="16732"><font size=-1>16732     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16733"><font size=-1>16733     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolrff&quot;</span><span class="default">,</span>
<a name="16734"><font size=-1>16734     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16735"><font size=-1>16735     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16736"><font size=-1>16736     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_basic'</span><span class="default">, </span><span class="string">'ForcesStresses_basic'</span><span class="default">],</span>
<a name="16737"><font size=-1>16737     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16738"><font size=-1>16738     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16739"><font size=-1>16739     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the Relative diFference of Forces&quot;</span><span class="default">,</span>
<a name="16740"><font size=-1>16740     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria [[tolwfr]], [[toldff]], [[tolrff]], [[toldfe]] or [[tolvrs]] must differ from zero.&quot;</span><span class="default">,</span>
<a name="16741"><font size=-1>16741     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[tolwfr]] or [[toldfe]] or [[toldff]] or [[tolvrs]]'&quot;</span><span class="default">,</span>
<a name="16742"><font size=-1>16742     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16743"><font size=-1>16743     </font></a><span class="string">Sets a tolerance for the ratio of differences of forces (in hartree/Bohr) to</span>
<a name="16744"><font size=-1>16744     </font></a><span class="string">maximum force, that, reached TWICE successively, will cause one SCF cycle to</span>
<a name="16745"><font size=-1>16745     </font></a><span class="string">stop (and ions to be moved): diffor &lt; tolrff * maxfor.</span>
<a name="16746"><font size=-1>16746     </font></a><span class="string">If set to zero, this stopping condition is ignored.</span>
<a name="16747"><font size=-1>16747     </font></a><span class="string">Effective only when SCF cycles are done ([[iscf]]&gt;0). This tolerance applies</span>
<a name="16748"><font size=-1>16748     </font></a><span class="string">to any particular cartesian component of any atom, INCLUDING fixed ones. This</span>
<a name="16749"><font size=-1>16749     </font></a><span class="string">is to be used when trying to equilibrate a structure to its lowest energy</span>
<a name="16750"><font size=-1>16750     </font></a><span class="string">configuration ([[ionmov]] = 2), or in case of molecular dynamics ([[ionmov]] = 1)</span>
<a name="16751"><font size=-1>16751     </font></a><span class="string">A value of 0.02 is suggested.</span>
<a name="16752"><font size=-1>16752     </font></a><span class="string">This stopping criterion is not allowed for RF calculations.</span>
<a name="16753"><font size=-1>16753     </font></a><span class="string">Since [[toldfe]], [[toldff]], [[tolrff]], [[tolvrs]] and [[tolwfr]] are aimed</span>
<a name="16754"><font size=-1>16754     </font></a><span class="string">at the same goal (causing the SCF cycle to stop), they are seen as a unique</span>
<a name="16755"><font size=-1>16755     </font></a><span class="string">input variable at reading. Hence, it is forbidden that two of these input</span>
<a name="16756"><font size=-1>16756     </font></a><span class="string">variables have non-zero values for the same dataset, or generically (for all</span>
<a name="16757"><font size=-1>16757     </font></a><span class="string">datasets). However, a non-zero value for one such variable for one dataset</span>
<a name="16758"><font size=-1>16758     </font></a><span class="string">will have precedence on the non-zero value for another input variable defined</span>
<a name="16759"><font size=-1>16759     </font></a><span class="string">generically.</span>
<a name="16760"><font size=-1>16760     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16761"><font size=-1>16761     </font></a><span class="default">),</span>
<a name="16762"><font size=-1>16762     </font></a><span class="default"></span>
<a name="16763"><font size=-1>16763     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16764"><font size=-1>16764     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolsym&quot;</span><span class="default">,</span>
<a name="16765"><font size=-1>16765     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="16766"><font size=-1>16766     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16767"><font size=-1>16767     </font></a><span class="default">    topics=[</span><span class="string">'crystal_useful'</span><span class="default">],</span>
<a name="16768"><font size=-1>16768     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16769"><font size=-1>16769     </font></a><span class="default">    defaultval=</span><span class="number">1e-08</span><span class="default">,</span>
<a name="16770"><font size=-1>16770     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLERANCE for SYMmetries&quot;</span><span class="default">,</span>
<a name="16771"><font size=-1>16771     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16772"><font size=-1>16772     </font></a><span class="string">Gives the tolerance on the atomic positions (reduced coordinates), primitive</span>
<a name="16773"><font size=-1>16773     </font></a><span class="string">vectors, or magnetization, to be considered equivalent, thanks to symmetry</span>
<a name="16774"><font size=-1>16774     </font></a><span class="string">operations. This is used in the recognition of the set of symmetries of the</span>
<a name="16775"><font size=-1>16775     </font></a><span class="string">system, or the application of the symmetry operations to generate from a</span>
<a name="16776"><font size=-1>16776     </font></a><span class="string">reduced set of atoms, the full set of atoms. Note that a value larger than</span>
<a name="16777"><font size=-1>16777     </font></a><span class="string">0.01 is considered to be unacceptable, whatever the value of [[tolsym]]</span>
<a name="16778"><font size=-1>16778     </font></a><span class="string">(so, it is not worth to set [[tolsym]] bigger than 0.01).</span>
<a name="16779"><font size=-1>16779     </font></a><span class="string"></span>
<a name="16780"><font size=-1>16780     </font></a><span class="string">Note: ABINIT needs the atomic positions to be symmetric to each others</span>
<a name="16781"><font size=-1>16781     </font></a><span class="string">within 1.e-8, irrespective of [[tolsym]].</span>
<a name="16782"><font size=-1>16782     </font></a><span class="string">So, if [[tolsym]] is set to a larger value than 1.e-8, then the</span>
<a name="16783"><font size=-1>16783     </font></a><span class="string">input atomic coordinates will be nevertheless automatically symmetrized by the symmetry</span>
<a name="16784"><font size=-1>16784     </font></a><span class="string">operations that will have been found.</span>
<a name="16785"><font size=-1>16785     </font></a><span class="string">&quot;&quot;&quot;</span>
<a name="16786"><font size=-1>16786     </font></a><span class="string"></span><span class="default">),</span>
<a name="16787"><font size=-1>16787     </font></a><span class="default"></span>
<a name="16788"><font size=-1>16788     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16789"><font size=-1>16789     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolvrs&quot;</span><span class="default">,</span>
<a name="16790"><font size=-1>16790     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16791"><font size=-1>16791     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16792"><font size=-1>16792     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_basic'</span><span class="default">],</span>
<a name="16793"><font size=-1>16793     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16794"><font size=-1>16794     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16795"><font size=-1>16795     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on the potential V(r) ReSidual&quot;</span><span class="default">,</span>
<a name="16796"><font size=-1>16796     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria [[tolwfr]], [[toldff]], [[tolrff]], [[toldfe]] or [[tolvrs]] must differ from zero.&quot;</span><span class="default">,</span>
<a name="16797"><font size=-1>16797     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[tolwfr]] or [[toldfe]] or [[toldff]] or [[tolrff]]'&quot;</span><span class="default">,</span>
<a name="16798"><font size=-1>16798     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16799"><font size=-1>16799     </font></a><span class="string">Sets a tolerance for potential residual that, when reached, will cause one SCF</span>
<a name="16800"><font size=-1>16800     </font></a><span class="string">cycle to stop (and ions to be moved).</span>
<a name="16801"><font size=-1>16801     </font></a><span class="string">If set to zero, this stopping condition is ignored.</span>
<a name="16802"><font size=-1>16802     </font></a><span class="string">Effective only when SCF cycles are done ([[iscf]]&gt;0).</span>
<a name="16803"><font size=-1>16803     </font></a><span class="string">To get accurate stresses may be quite demanding. For simple materials with</span>
<a name="16804"><font size=-1>16804     </font></a><span class="string">internal positions determined by symmetries, a value of [[tolvrs]] = 10^-12</span>
<a name="16805"><font size=-1>16805     </font></a><span class="string">empirically leads to a very approximate 10^-6 atomic unit accuracy for the</span>
<a name="16806"><font size=-1>16806     </font></a><span class="string">optimized lattice parameter.</span>
<a name="16807"><font size=-1>16807     </font></a><span class="string"></span>
<a name="16808"><font size=-1>16808     </font></a><span class="string">Additional explanation: the residual of the potential is the difference</span>
<a name="16809"><font size=-1>16809     </font></a><span class="string">between the input potential and the output potential, when the latter is</span>
<a name="16810"><font size=-1>16810     </font></a><span class="string">obtained from the density determined from the eigenfunctions of the input</span>
<a name="16811"><font size=-1>16811     </font></a><span class="string">potential. When the self-consistency loop is achieved, both input and output</span>
<a name="16812"><font size=-1>16812     </font></a><span class="string">potentials must be equal, and the residual of the potential must be zero. The</span>
<a name="16813"><font size=-1>16813     </font></a><span class="string">tolerance on the potential residual is imposed by first subtracting the mean</span>
<a name="16814"><font size=-1>16814     </font></a><span class="string">of the residual of the potential (or the trace of the potential matrix, if the</span>
<a name="16815"><font size=-1>16815     </font></a><span class="string">system is spin-polarized), then summing the square of this function over all</span>
<a name="16816"><font size=-1>16816     </font></a><span class="string">FFT grid points. The result should be lower than [[tolvrs]].</span>
<a name="16817"><font size=-1>16817     </font></a><span class="string">Since [[toldfe]], [[toldff]], [[tolrff]], [[tolvrs]] and [[tolwfr]] are aimed</span>
<a name="16818"><font size=-1>16818     </font></a><span class="string">at the same goal (causing the SCF cycle to stop), they are seen as a unique</span>
<a name="16819"><font size=-1>16819     </font></a><span class="string">input variable at reading. Hence, it is forbidden that two of these input</span>
<a name="16820"><font size=-1>16820     </font></a><span class="string">variables have non-zero values for the same dataset, or generically (for all</span>
<a name="16821"><font size=-1>16821     </font></a><span class="string">datasets). However, a non-zero value for one such variable for one dataset</span>
<a name="16822"><font size=-1>16822     </font></a><span class="string">will have precedence on the non-zero value for another input variable defined</span>
<a name="16823"><font size=-1>16823     </font></a><span class="string">generically.</span>
<a name="16824"><font size=-1>16824     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16825"><font size=-1>16825     </font></a><span class="default">),</span>
<a name="16826"><font size=-1>16826     </font></a><span class="default"></span>
<a name="16827"><font size=-1>16827     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16828"><font size=-1>16828     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tolwfr&quot;</span><span class="default">,</span>
<a name="16829"><font size=-1>16829     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16830"><font size=-1>16830     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16831"><font size=-1>16831     </font></a><span class="default">    topics=[</span><span class="string">'SCFControl_basic'</span><span class="default">],</span>
<a name="16832"><font size=-1>16832     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16833"><font size=-1>16833     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16834"><font size=-1>16834     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TOLerance on WaveFunction squared Residual&quot;</span><span class="default">,</span>
<a name="16835"><font size=-1>16835     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria [[tolwfr]], [[toldff]], [[tolrff]], [[toldfe]] or [[tolvrs]] must differ from zero.&quot;</span><span class="default">,</span>
<a name="16836"><font size=-1>16836     </font></a><span class="default">    excludes=</span><span class="string">&quot;[[toldfe]] or [[toldff]] or [[tolrff]] or [[tolvrs]]&quot;</span><span class="default">,</span>
<a name="16837"><font size=-1>16837     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16838"><font size=-1>16838     </font></a><span class="string">The signification of this tolerance depends on the basis set. In plane waves,</span>
<a name="16839"><font size=-1>16839     </font></a><span class="string">it gives a convergence tolerance for the largest squared &quot;residual&quot; (defined</span>
<a name="16840"><font size=-1>16840     </font></a><span class="string">below) for any given band. The squared residual is:</span>
<a name="16841"><font size=-1>16841     </font></a><span class="string"></span>
<a name="16842"><font size=-1>16842     </font></a><span class="string">      &lt; nk|(H-E)2|nk &gt;,    E = &lt; nk|H|nk &gt;</span>
<a name="16843"><font size=-1>16843     </font></a><span class="string"></span>
<a name="16844"><font size=-1>16844     </font></a><span class="string">which clearly is nonnegative and goes to 0 as the iterations converge to an</span>
<a name="16845"><font size=-1>16845     </font></a><span class="string">eigenstate. With the squared residual expressed in Hartrees  2  (Hartrees</span>
<a name="16846"><font size=-1>16846     </font></a><span class="string">squared), the largest squared residual (called residm) encountered over all</span>
<a name="16847"><font size=-1>16847     </font></a><span class="string">bands and k points must be less than [[tolwfr]] for iterations to halt due to</span>
<a name="16848"><font size=-1>16848     </font></a><span class="string">successful convergence.</span>
<a name="16849"><font size=-1>16849     </font></a><span class="string">Note that if [[iscf]]&gt;0, this criterion should be replaced by those based on</span>
<a name="16850"><font size=-1>16850     </font></a><span class="string">[[toldfe]] (preferred for [[ionmov]] == 0), [[toldff]] [[tolrff]] (preferred for</span>
<a name="16851"><font size=-1>16851     </font></a><span class="string">[[ionmov]]/=0), or [[tolvrs]] (preferred for theoretical reasons!).</span>
<a name="16852"><font size=-1>16852     </font></a><span class="string">When [[tolwfr]] is 0.0, this criterion is ignored, and a finite value of</span>
<a name="16853"><font size=-1>16853     </font></a><span class="string">[[toldfe]], [[toldff]] or [[tolvrs]] must be specified. This also imposes a</span>
<a name="16854"><font size=-1>16854     </font></a><span class="string">restriction on taking an ion step; ion steps are not permitted unless the</span>
<a name="16855"><font size=-1>16855     </font></a><span class="string">largest squared residual is less than [[tolwfr]], ensuring accurate forces.</span>
<a name="16856"><font size=-1>16856     </font></a><span class="string">To get accurate stresses may be quite demanding.</span>
<a name="16857"><font size=-1>16857     </font></a><span class="string">Note that the preparatory GS calculations before a RF calculations must be</span>
<a name="16858"><font size=-1>16858     </font></a><span class="string">highly converged.</span>
<a name="16859"><font size=-1>16859     </font></a><span class="string">Typical values for these preparatory runs are [[tolwfr]] between 1.0d-16 and 1.0d-22.</span>
<a name="16860"><font size=-1>16860     </font></a><span class="string"></span>
<a name="16861"><font size=-1>16861     </font></a><span class="string">Note that [[tolwfr]] is often used in the test cases, but this is [[tolwfr]]</span>
<a name="16862"><font size=-1>16862     </font></a><span class="string">purely for historical reasons: except when [[iscf]] &lt;0, other criteria should be used.</span>
<a name="16863"><font size=-1>16863     </font></a><span class="string"></span>
<a name="16864"><font size=-1>16864     </font></a><span class="string">In the wavelet case (see [[usewvl]] = 1), this criterion is the favoured one.</span>
<a name="16865"><font size=-1>16865     </font></a><span class="string">It is based on the norm 2 of the gradient of the wavefunctions. Typical values</span>
<a name="16866"><font size=-1>16866     </font></a><span class="string">range from 5*10  -4  to 5*10  -5.</span>
<a name="16867"><font size=-1>16867     </font></a><span class="string"></span>
<a name="16868"><font size=-1>16868     </font></a><span class="string">Since [[toldfe]], [[toldff]], [[tolrff]], [[tolvrs]] and [[tolwfr]] are aimed</span>
<a name="16869"><font size=-1>16869     </font></a><span class="string">at the same goal (causing the SCF cycle to stop), they are seen as a unique</span>
<a name="16870"><font size=-1>16870     </font></a><span class="string">input variable at reading. Hence, it is forbidden that two of these input</span>
<a name="16871"><font size=-1>16871     </font></a><span class="string">variables have non-zero values for the same dataset, or generically (for all</span>
<a name="16872"><font size=-1>16872     </font></a><span class="string">datasets). However, a non-zero value for one such variable for one dataset</span>
<a name="16873"><font size=-1>16873     </font></a><span class="string">will have precedence on the non-zero value for another input variable defined generically.</span>
<a name="16874"><font size=-1>16874     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16875"><font size=-1>16875     </font></a><span class="default">),</span>
<a name="16876"><font size=-1>16876     </font></a><span class="default"></span>
<a name="16877"><font size=-1>16877     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16878"><font size=-1>16878     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tphysel&quot;</span><span class="default">,</span>
<a name="16879"><font size=-1>16879     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="16880"><font size=-1>16880     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16881"><font size=-1>16881     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_useful'</span><span class="default">],</span>
<a name="16882"><font size=-1>16882     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16883"><font size=-1>16883     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="16884"><font size=-1>16884     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Temperature (PHYSical) of the ELectrons&quot;</span><span class="default">,</span>
<a name="16885"><font size=-1>16885     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="16886"><font size=-1>16886     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16887"><font size=-1>16887     </font></a><span class="string">Gives, in Hartree, the physical temperature of the system, in case</span>
<a name="16888"><font size=-1>16888     </font></a><span class="string">[[occopt]] = 4, 5, 6, or 7.\n</span>
<a name="16889"><font size=-1>16889     </font></a><span class="string">Can be specified in Ha (the default), Ry, eV or Kelvin, since [[tphysel]] has the</span>
<a name="16890"><font size=-1>16890     </font></a><span class="string">'[[ENERGY]]' characteristics (0.001 Ha = 27.2113845 meV = 315.773 Kelvin). One</span>
<a name="16891"><font size=-1>16891     </font></a><span class="string">has to specify an independent broadening [[tsmear]]. The combination of the</span>
<a name="16892"><font size=-1>16892     </font></a><span class="string">two parameters [[tphysel]] and [[tsmear]] is described in [[cite:Verstraete2002]].</span>
<a name="16893"><font size=-1>16893     </font></a><span class="string">Note that the signification of the entropy is modified with respect to the usual entropy.</span>
<a name="16894"><font size=-1>16894     </font></a><span class="string">The choice has been made to use [[tsmear]] as a prefactor of the entropy, to</span>
<a name="16895"><font size=-1>16895     </font></a><span class="string">define the entropy contribution to the free energy.</span>
<a name="16896"><font size=-1>16896     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16897"><font size=-1>16897     </font></a><span class="default">),</span>
<a name="16898"><font size=-1>16898     </font></a><span class="default"></span>
<a name="16899"><font size=-1>16899     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16900"><font size=-1>16900     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tsmear&quot;</span><span class="default">,</span>
<a name="16901"><font size=-1>16901     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="16902"><font size=-1>16902     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="16903"><font size=-1>16903     </font></a><span class="default">    topics=[</span><span class="string">'BandOcc_basic'</span><span class="default">, </span><span class="string">'STM_basic'</span><span class="default">],</span>
<a name="16904"><font size=-1>16904     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16905"><font size=-1>16905     </font></a><span class="default">    defaultval=</span><span class="number">0.01</span><span class="default">,</span>
<a name="16906"><font size=-1>16906     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Temperature of SMEARing&quot;</span><span class="default">,</span>
<a name="16907"><font size=-1>16907     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="16908"><font size=-1>16908     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16909"><font size=-1>16909     </font></a><span class="string">Gives the broadening of occupation numbers [[occ]], in the metallic cases</span>
<a name="16910"><font size=-1>16910     </font></a><span class="string">([[occopt]] = 3, 4, 5, 6 and 7). Can be specified in Ha (the default), eV, Ry,</span>
<a name="16911"><font size=-1>16911     </font></a><span class="string">or Kelvin, since [[tsmear]] has the '[[ENERGY]]' characteristics (0.001 Ha =</span>
<a name="16912"><font size=-1>16912     </font></a><span class="string">27.2113845 meV = 315.773 Kelvin).</span>
<a name="16913"><font size=-1>16913     </font></a><span class="string">Default is 0.01 Ha. This should be OK using gaussian like smearings ([[occopt]] = 4,5,6,7)</span>
<a name="16914"><font size=-1>16914     </font></a><span class="string">for a free-electron metal like Al. For d-band metals, you may need to</span>
<a name="16915"><font size=-1>16915     </font></a><span class="string">use less.</span>
<a name="16916"><font size=-1>16916     </font></a><span class="string">Always check the convergence of the calculation with respect to this</span>
<a name="16917"><font size=-1>16917     </font></a><span class="string">parameter, and simultaneously, with respect to the sampling of k-points (see</span>
<a name="16918"><font size=-1>16918     </font></a><span class="string">[[nkpt]])</span>
<a name="16919"><font size=-1>16919     </font></a><span class="string">If [[occopt]] = 3, [[tsmear]] is the physical temperature, as the broadening is</span>
<a name="16920"><font size=-1>16920     </font></a><span class="string">based on Fermi-Dirac statistics. However, if [[occopt]] = 4, 5, 6, or 7, the</span>
<a name="16921"><font size=-1>16921     </font></a><span class="string">broadening is not based on Fermi-Dirac statistics, and [[tsmear]] is only a</span>
<a name="16922"><font size=-1>16922     </font></a><span class="string">convergence parameter. It is still possible to define a physical temperature,</span>
<a name="16923"><font size=-1>16923     </font></a><span class="string">thanks to the input variable [[tphysel]] (See also [[cite:Verstraete2002]]).</span>
<a name="16924"><font size=-1>16924     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16925"><font size=-1>16925     </font></a><span class="default">),</span>
<a name="16926"><font size=-1>16926     </font></a><span class="default"></span>
<a name="16927"><font size=-1>16927     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16928"><font size=-1>16928     </font></a><span class="default">    abivarname=</span><span class="string">&quot;typat&quot;</span><span class="default">,</span>
<a name="16929"><font size=-1>16929     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="16930"><font size=-1>16930     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16931"><font size=-1>16931     </font></a><span class="default">    topics=[</span><span class="string">'crystal_basic'</span><span class="default">, </span><span class="string">'AtomTypes_basic'</span><span class="default">],</span>
<a name="16932"><font size=-1>16932     </font></a><span class="default">    dimensions=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[natrd]]&lt;[[natom]]'</span><span class="default">: [</span><span class="number">3</span><span class="default">, </span><span class="string">'[[natrd]]'</span><span class="default">], </span><span class="string">'defaultval'</span><span class="default">: [</span><span class="number">3</span><span class="default">, </span><span class="string">'[[natom]]'</span><span class="default">]}),</span>
<a name="16933"><font size=-1>16933     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[natom]] == 1'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="keyword">None</span><span class="default">}),</span>
<a name="16934"><font size=-1>16934     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;TYPe of AToms&quot;</span><span class="default">,</span>
<a name="16935"><font size=-1>16935     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16936"><font size=-1>16936     </font></a><span class="string">Array giving an integer label to every atom in the unit cell to denote its</span>
<a name="16937"><font size=-1>16937     </font></a><span class="string">type.</span>
<a name="16938"><font size=-1>16938     </font></a><span class="string">The different types of atoms are constructed from the pseudopotential files.</span>
<a name="16939"><font size=-1>16939     </font></a><span class="string">There are at most [[ntypat]] types of atoms.</span>
<a name="16940"><font size=-1>16940     </font></a><span class="string">As an example, for BaTiO3, where the pseudopotential for Ba is number 1, the</span>
<a name="16941"><font size=-1>16941     </font></a><span class="string">one of Ti is number 2, and the one of O is number 3, the actual value of the</span>
<a name="16942"><font size=-1>16942     </font></a><span class="string">[[typat]] array might be:</span>
<a name="16943"><font size=-1>16943     </font></a><span class="string"></span>
<a name="16944"><font size=-1>16944     </font></a><span class="string">      typat 1 2 3 3 3</span>
<a name="16945"><font size=-1>16945     </font></a><span class="string"></span>
<a name="16946"><font size=-1>16946     </font></a><span class="string">The array [[typat]] has to agree with the actual locations of atoms given in</span>
<a name="16947"><font size=-1>16947     </font></a><span class="string">[[xred]], [[xcart]] or [[xangst]], and the input of pseudopotentials has to</span>
<a name="16948"><font size=-1>16948     </font></a><span class="string">be ordered to agree with the atoms identified in [[typat]].</span>
<a name="16949"><font size=-1>16949     </font></a><span class="string">The nuclear charge of the elements, given by the array [[znucl]], also must</span>
<a name="16950"><font size=-1>16950     </font></a><span class="string">agree with the type of atoms designated in &quot;[[typat]]&quot;.</span>
<a name="16951"><font size=-1>16951     </font></a><span class="string">The array [[typat]] is not constrained to be increasing. An internal</span>
<a name="16952"><font size=-1>16952     </font></a><span class="string">representation of the list of atoms, deep in the code (array atindx), groups</span>
<a name="16953"><font size=-1>16953     </font></a><span class="string">the atoms of same type together. This should be transparent to the user, while</span>
<a name="16954"><font size=-1>16954     </font></a><span class="string">keeping efficiency.</span>
<a name="16955"><font size=-1>16955     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16956"><font size=-1>16956     </font></a><span class="default">),</span>
<a name="16957"><font size=-1>16957     </font></a><span class="default"></span>
<a name="16958"><font size=-1>16958     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16959"><font size=-1>16959     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ucrpa&quot;</span><span class="default">,</span>
<a name="16960"><font size=-1>16960     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="16961"><font size=-1>16961     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16962"><font size=-1>16962     </font></a><span class="default">    topics=[</span><span class="string">'CRPA_compulsory'</span><span class="default">],</span>
<a name="16963"><font size=-1>16963     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="16964"><font size=-1>16964     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="16965"><font size=-1>16965     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;calculation of the screened interaction U with the Constrained RPA method&quot;</span><span class="default">,</span>
<a name="16966"><font size=-1>16966     </font></a><span class="default">    requires=</span><span class="string">&quot;[[nspinor]] == 1&quot;</span><span class="default">,</span>
<a name="16967"><font size=-1>16967     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="16968"><font size=-1>16968     </font></a><span class="string">When equal to one or two, this variable allows one to calculate U with</span>
<a name="16969"><font size=-1>16969     </font></a><span class="string">the cRPA method. An explicit test is shown in automatic tests</span>
<a name="16970"><font size=-1>16970     </font></a><span class="string">[[test:v7_23]], [[test:v7_24]], [[test:v7_25]], [[test:v7_68]], and [[test:v7_69]].</span>
<a name="16971"><font size=-1>16971     </font></a><span class="string">The present implementation is parallelized (as for usual GW</span>
<a name="16972"><font size=-1>16972     </font></a><span class="string">calculations), use symmetry over k points only for calculations involving one</span>
<a name="16973"><font size=-1>16973     </font></a><span class="string">correlated atom, and can be use when correlated bands are entangled or not.</span>
<a name="16974"><font size=-1>16974     </font></a><span class="string">The constrained calculation of the polarisability can be done by eliminating</span>
<a name="16975"><font size=-1>16975     </font></a><span class="string">transition betweens correlated bands (and not orbitals) with the variable</span>
<a name="16976"><font size=-1>16976     </font></a><span class="string">[[ucrpa_bands]].</span>
<a name="16977"><font size=-1>16977     </font></a><span class="string"></span>
<a name="16978"><font size=-1>16978     </font></a><span class="string">For [[ucrpa]] = 1, two solutions are possible. The first one is to specify</span>
<a name="16979"><font size=-1>16979     </font></a><span class="string">(with the variable [[ucrpa_bands]]) the bands to exclude from the</span>
<a name="16980"><font size=-1>16980     </font></a><span class="string">polarisability calculation. The second solution is to provide an energy window</span>
<a name="16981"><font size=-1>16981     </font></a><span class="string">(with the variable [[ucrpa_window]]). The electronic transitions inside this</span>
<a name="16982"><font size=-1>16982     </font></a><span class="string">window will not be taken into account in the polarisability calculation.</span>
<a name="16983"><font size=-1>16983     </font></a><span class="string"></span>
<a name="16984"><font size=-1>16984     </font></a><span class="string">For [[ucrpa]] = 2, the ucrpa_bands should be equal to the [[dmftbandi]] and</span>
<a name="16985"><font size=-1>16985     </font></a><span class="string">[[dmftbandf]] values, and the polarisability of the correlated subspace is</span>
<a name="16986"><font size=-1>16986     </font></a><span class="string">constructed with a band and k point dependent weight.</span>
<a name="16987"><font size=-1>16987     </font></a><span class="string"></span>
<a name="16988"><font size=-1>16988     </font></a><span class="string">The implementation is restricted to the case of [[nspinor]] = 1 (collinear case).</span>
<a name="16989"><font size=-1>16989     </font></a><span class="string"></span>
<a name="16990"><font size=-1>16990     </font></a><span class="string">A short presentation of the method and some aspect of the implementation can</span>
<a name="16991"><font size=-1>16991     </font></a><span class="string">be found in Sec. II and Appendix A of [[cite:Amadon2014]].</span>
<a name="16992"><font size=-1>16992     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="16993"><font size=-1>16993     </font></a><span class="default">),</span>
<a name="16994"><font size=-1>16994     </font></a><span class="default"></span>
<a name="16995"><font size=-1>16995     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="16996"><font size=-1>16996     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ucrpa_bands&quot;</span><span class="default">,</span>
<a name="16997"><font size=-1>16997     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="16998"><font size=-1>16998     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="16999"><font size=-1>16999     </font></a><span class="default">    topics=[</span><span class="string">'CRPA_basic'</span><span class="default">],</span>
<a name="17000"><font size=-1>17000     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="17001"><font size=-1>17001     </font></a><span class="default">    defaultval=[-</span><span class="number">1</span><span class="default">, -</span><span class="number">1</span><span class="default">],</span>
<a name="17002"><font size=-1>17002     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;For the calculation of U with the Constrained RPA method, gives correlated BANDS&quot;</span><span class="default">,</span>
<a name="17003"><font size=-1>17003     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;That is, the default includes no band.&quot;</span><span class="default">,</span>
<a name="17004"><font size=-1>17004     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17005"><font size=-1>17005     </font></a><span class="string">Gives the first and last correlated bands for the cRPA calculation of the polarisability.</span>
<a name="17006"><font size=-1>17006     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17007"><font size=-1>17007     </font></a><span class="default">),</span>
<a name="17008"><font size=-1>17008     </font></a><span class="default"></span>
<a name="17009"><font size=-1>17009     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17010"><font size=-1>17010     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ucrpa_window&quot;</span><span class="default">,</span>
<a name="17011"><font size=-1>17011     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="17012"><font size=-1>17012     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17013"><font size=-1>17013     </font></a><span class="default">    topics=[</span><span class="string">'CRPA_basic'</span><span class="default">],</span>
<a name="17014"><font size=-1>17014     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="17015"><font size=-1>17015     </font></a><span class="default">    defaultval=[-</span><span class="number">1</span><span class="default">, -</span><span class="number">1</span><span class="default">],</span>
<a name="17016"><font size=-1>17016     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;For the calculation of U with the Constrained RPA method, gives energy WINDOW&quot;</span><span class="default">,</span>
<a name="17017"><font size=-1>17017     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;That is, the energy window is empty by default.&quot;</span><span class="default">,</span>
<a name="17018"><font size=-1>17018     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17019"><font size=-1>17019     </font></a><span class="string">Specify a window of energy for the cRPA calculation of the polarisability. The</span>
<a name="17020"><font size=-1>17020     </font></a><span class="string">transition inside this window will not be taken into account in the</span>
<a name="17021"><font size=-1>17021     </font></a><span class="string">constrained polarisabilty calculations.</span>
<a name="17022"><font size=-1>17022     </font></a><span class="string"></span>
<a name="17023"><font size=-1>17023     </font></a><span class="string">The lower bound and the upper bound energies must be specified (two real</span>
<a name="17024"><font size=-1>17024     </font></a><span class="string">numbers) with respect to the position of the Fermi level.</span>
<a name="17025"><font size=-1>17025     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17026"><font size=-1>17026     </font></a><span class="default">),</span>
<a name="17027"><font size=-1>17027     </font></a><span class="default"></span>
<a name="17028"><font size=-1>17028     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17029"><font size=-1>17029     </font></a><span class="default">    abivarname=</span><span class="string">&quot;udtset&quot;</span><span class="default">,</span>
<a name="17030"><font size=-1>17030     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="17031"><font size=-1>17031     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17032"><font size=-1>17032     </font></a><span class="default">    topics=[</span><span class="string">'multidtset_basic'</span><span class="default">],</span>
<a name="17033"><font size=-1>17033     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="17034"><font size=-1>17034     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Upper limit on DaTa SETs&quot;</span><span class="default">,</span>
<a name="17035"><font size=-1>17035     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;It is not used when it is not defined&quot;</span><span class="default">,</span>
<a name="17036"><font size=-1>17036     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17037"><font size=-1>17037     </font></a><span class="string">Used to define the set of indices in the multi-data set mode, when a double</span>
<a name="17038"><font size=-1>17038     </font></a><span class="string">loop is needed (see later).</span>
<a name="17039"><font size=-1>17039     </font></a><span class="string">The values of [[udtset]](1) must be between 1 and 999, the values of</span>
<a name="17040"><font size=-1>17040     </font></a><span class="string">[[udtset]](2) must be between 1 and 9, and their product must be equal to</span>
<a name="17041"><font size=-1>17041     </font></a><span class="string">[[ndtset]].</span>
<a name="17042"><font size=-1>17042     </font></a><span class="string">The values of [[jdtset]] are obtained by looping on the two indices defined by</span>
<a name="17043"><font size=-1>17043     </font></a><span class="string">[[udtset]](1) and [[udtset]](2) as follows:</span>
<a name="17044"><font size=-1>17044     </font></a><span class="string"></span>
<a name="17045"><font size=-1>17045     </font></a><span class="string">```fortran</span>
<a name="17046"><font size=-1>17046     </font></a><span class="string">do i1=1,intarr(1)</span>
<a name="17047"><font size=-1>17047     </font></a><span class="string"> do i2=1,intarr(2)</span>
<a name="17048"><font size=-1>17048     </font></a><span class="string">  idtset=idtset+1</span>
<a name="17049"><font size=-1>17049     </font></a><span class="string">  dtsets(idtset)%jdtset=i1*10+i2</span>
<a name="17050"><font size=-1>17050     </font></a><span class="string"> end do</span>
<a name="17051"><font size=-1>17051     </font></a><span class="string">end do</span>
<a name="17052"><font size=-1>17052     </font></a><span class="string">```</span>
<a name="17053"><font size=-1>17053     </font></a><span class="string"></span>
<a name="17054"><font size=-1>17054     </font></a><span class="string">So, [[udtset]](2) sets the largest value for the unity digit, that varies</span>
<a name="17055"><font size=-1>17055     </font></a><span class="string">between 1 and [[udtset]](2).</span>
<a name="17056"><font size=-1>17056     </font></a><span class="string">If [[udtset]] is used, the input variable [[jdtset]] cannot be used.</span>
<a name="17057"><font size=-1>17057     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17058"><font size=-1>17058     </font></a><span class="default">),</span>
<a name="17059"><font size=-1>17059     </font></a><span class="default"></span>
<a name="17060"><font size=-1>17060     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17061"><font size=-1>17061     </font></a><span class="default">    abivarname=</span><span class="string">&quot;upawu&quot;</span><span class="default">,</span>
<a name="17062"><font size=-1>17062     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="17063"><font size=-1>17063     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17064"><font size=-1>17064     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_compulsory'</span><span class="default">],</span>
<a name="17065"><font size=-1>17065     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="17066"><font size=-1>17066     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="17067"><font size=-1>17067     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;value of U for PAW+U&quot;</span><span class="default">,</span>
<a name="17068"><font size=-1>17068     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="17069"><font size=-1>17069     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[usepawu]] == 1&quot;</span><span class="default">,</span>
<a name="17070"><font size=-1>17070     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17071"><font size=-1>17071     </font></a><span class="string">Gives the value of the screened coulomb interaction between correlated</span>
<a name="17072"><font size=-1>17072     </font></a><span class="string">electrons corresponding to [[lpawu]] for each species.</span>
<a name="17073"><font size=-1>17073     </font></a><span class="string">In the case where [[lpawu]] =-1, the value is not used.</span>
<a name="17074"><font size=-1>17074     </font></a><span class="string">In the case of a GW calculation, the U interaction defined by [[upawu]] will</span>
<a name="17075"><font size=-1>17075     </font></a><span class="string">be REMOVED from the self energy. In particular, for G0 W0 calculations</span>
<a name="17076"><font size=-1>17076     </font></a><span class="string">(perturbative calculations), the energy eigenvalues obtained after an</span>
<a name="17077"><font size=-1>17077     </font></a><span class="string">underlying DFT+U calculation will be</span>
<a name="17078"><font size=-1>17078     </font></a><span class="string">$E_{GW} = E_{DFT+U} + &lt; \\phi | Self-energy - U | \\phi&gt;$</span>
<a name="17079"><font size=-1>17079     </font></a><span class="string">Actually, in order to perform a GW @ DFT+U calculation, one should define the</span>
<a name="17080"><font size=-1>17080     </font></a><span class="string">same value of U in the self-energy calculation, than the one defined in the</span>
<a name="17081"><font size=-1>17081     </font></a><span class="string">DFT calculation. The easiest is actually to define the value of U for the</span>
<a name="17082"><font size=-1>17082     </font></a><span class="string">whole set of calculations (for the different datasets), including the</span>
<a name="17083"><font size=-1>17083     </font></a><span class="string">screening, even if the U value does not play explicitly a role in the</span>
<a name="17084"><font size=-1>17084     </font></a><span class="string">computation of the latter (well, the input wavefunctions will be different</span>
<a name="17085"><font size=-1>17085     </font></a><span class="string">anyhow).</span>
<a name="17086"><font size=-1>17086     </font></a><span class="string">It is possible to perform calculations of the type GW+$U^{'}$ @ DFT+U, so</span>
<a name="17087"><font size=-1>17087     </font></a><span class="string">keeping a $U^{'}$ interaction (usually smaller than the initial U) in the GW</span>
<a name="17088"><font size=-1>17088     </font></a><span class="string">calculation.</span>
<a name="17089"><font size=-1>17089     </font></a><span class="string">This value will be subtracted in the GW correction calculation, as outlined</span>
<a name="17090"><font size=-1>17090     </font></a><span class="string">above.</span>
<a name="17091"><font size=-1>17091     </font></a><span class="string">Explicitly, in order to do a calculation of a material with a DFT U value of</span>
<a name="17092"><font size=-1>17092     </font></a><span class="string">7.5 eV, followed by a GW calculation where there is a residual U value of 2</span>
<a name="17093"><font size=-1>17093     </font></a><span class="string">eV, one has to define:</span>
<a name="17094"><font size=-1>17094     </font></a><span class="string"></span>
<a name="17095"><font size=-1>17095     </font></a><span class="string">      upawu1   7.5 eV   ! This is for the DFT calculation</span>
<a name="17096"><font size=-1>17096     </font></a><span class="string">    ...</span>
<a name="17097"><font size=-1>17097     </font></a><span class="string">    optdriver4  4</span>
<a name="17098"><font size=-1>17098     </font></a><span class="string">    upawu4   5.5 eV   ! This is for the screening calculation</span>
<a name="17099"><font size=-1>17099     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17100"><font size=-1>17100     </font></a><span class="default">),</span>
<a name="17101"><font size=-1>17101     </font></a><span class="default"></span>
<a name="17102"><font size=-1>17102     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17103"><font size=-1>17103     </font></a><span class="default">    abivarname=</span><span class="string">&quot;use_gemm_nonlop&quot;</span><span class="default">,</span>
<a name="17104"><font size=-1>17104     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17105"><font size=-1>17105     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17106"><font size=-1>17106     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="17107"><font size=-1>17107     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17108"><font size=-1>17108     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17109"><font size=-1>17109     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE the GEMM routine for the application of the NON-Local OPerator&quot;</span><span class="default">,</span>
<a name="17110"><font size=-1>17110     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17111"><font size=-1>17111     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;because it is not usually worth using it unless bandpp is large and it requires additional memory&quot;</span><span class="default">,</span>
<a name="17112"><font size=-1>17112     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17113"><font size=-1>17113     </font></a><span class="string">This keyword tells abinit to use a BLAS routine to speed up the computation of</span>
<a name="17114"><font size=-1>17114     </font></a><span class="string">the non-local operator. This requires the pre-computation of a large matrix,</span>
<a name="17115"><font size=-1>17115     </font></a><span class="string">and has a significant memory overhead. In exchange, it provides improved</span>
<a name="17116"><font size=-1>17116     </font></a><span class="string">performance when used on several bands at once (Chebyshev or LOBPCG algorithm</span>
<a name="17117"><font size=-1>17117     </font></a><span class="string">with [[bandpp]]</span>
<a name="17118"><font size=-1>17118     </font></a><span class="string"></span>
<a name="17119"><font size=-1>17119     </font></a><span class="string">The memory overhead is proportional to the number of atoms, the number of</span>
<a name="17120"><font size=-1>17120     </font></a><span class="string">plane waves, and the number of projectors per atom. It can be mitigated by</span>
<a name="17121"><font size=-1>17121     </font></a><span class="string">distributing the array with [[npfft]]</span>
<a name="17122"><font size=-1>17122     </font></a><span class="string"></span>
<a name="17123"><font size=-1>17123     </font></a><span class="string">The performance depends crucially on having a good BLAS installed. Provided</span>
<a name="17124"><font size=-1>17124     </font></a><span class="string">the BLAS supports OpenMP, this option also yields very good scaling for the</span>
<a name="17125"><font size=-1>17125     </font></a><span class="string">nonlocal operator.</span>
<a name="17126"><font size=-1>17126     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17127"><font size=-1>17127     </font></a><span class="default">),</span>
<a name="17128"><font size=-1>17128     </font></a><span class="default"></span>
<a name="17129"><font size=-1>17129     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17130"><font size=-1>17130     </font></a><span class="default">    abivarname=</span><span class="string">&quot;use_gpu_cuda&quot;</span><span class="default">,</span>
<a name="17131"><font size=-1>17131     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="17132"><font size=-1>17132     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17133"><font size=-1>17133     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="17134"><font size=-1>17134     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17135"><font size=-1>17135     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[optdriver]] == 0 and [[CUDA]]'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="17136"><font size=-1>17136     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;activate USE of GPU accelerators with CUDA (nvidia)&quot;</span><span class="default">,</span>
<a name="17137"><font size=-1>17137     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17138"><font size=-1>17138     </font></a><span class="string">Only available if ABINIT executable has been compiled with cuda nvcc compiler.</span>
<a name="17139"><font size=-1>17139     </font></a><span class="string">This parameter activates the use of NVidia graphic accelerators (GPU) if</span>
<a name="17140"><font size=-1>17140     </font></a><span class="string">present.</span>
<a name="17141"><font size=-1>17141     </font></a><span class="string">If [[use_gpu_cuda]] = 1, some parts of the computation are transmitted to the</span>
<a name="17142"><font size=-1>17142     </font></a><span class="string">GPUs.</span>
<a name="17143"><font size=-1>17143     </font></a><span class="string">If [[use_gpu_cuda]] = 0, no computation is done on GPUs, even if present.</span>
<a name="17144"><font size=-1>17144     </font></a><span class="string"></span>
<a name="17145"><font size=-1>17145     </font></a><span class="string">Note that, while running ABINIT on GPUs, it is recommended to use MAGMA</span>
<a name="17146"><font size=-1>17146     </font></a><span class="string">external library (i.e. Lapack on GPUs). The latter is activated during</span>
<a name="17147"><font size=-1>17147     </font></a><span class="string">compilation stage (see &quot;configure&quot; step of ABINIT compilation process). If</span>
<a name="17148"><font size=-1>17148     </font></a><span class="string">MAGMA is not used, ABINIT performances on GPUs can be poor.</span>
<a name="17149"><font size=-1>17149     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17150"><font size=-1>17150     </font></a><span class="default">),</span>
<a name="17151"><font size=-1>17151     </font></a><span class="default"></span>
<a name="17152"><font size=-1>17152     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17153"><font size=-1>17153     </font></a><span class="default">    abivarname=</span><span class="string">&quot;use_nonscf_gkk&quot;</span><span class="default">,</span>
<a name="17154"><font size=-1>17154     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17155"><font size=-1>17155     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17156"><font size=-1>17156     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_useful'</span><span class="default">],</span>
<a name="17157"><font size=-1>17157     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17158"><font size=-1>17158     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17159"><font size=-1>17159     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE NON-SCF calculation of GKK matrix elements (electron phonon)&quot;</span><span class="default">,</span>
<a name="17160"><font size=-1>17160     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17161"><font size=-1>17161     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Default is 0 for the moment. Do not use non-scf method.&quot;</span><span class="default">,</span>
<a name="17162"><font size=-1>17162     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17163"><font size=-1>17163     </font></a><span class="string">When this flag is activated during a phonon calculation with abinit, all of</span>
<a name="17164"><font size=-1>17164     </font></a><span class="string">the perturbations are cycled through, but only the symmetry-irreducible ones</span>
<a name="17165"><font size=-1>17165     </font></a><span class="string">are calculated self-consistently. For the others the perturbed density is</span>
<a name="17166"><font size=-1>17166     </font></a><span class="string">rotated by the appropriate symop and the gkk matrix elements are calculated</span>
<a name="17167"><font size=-1>17167     </font></a><span class="string">non-self-consistently. As they do not depend on the perturbed wave functions,</span>
<a name="17168"><font size=-1>17168     </font></a><span class="string">they are correct from the first iteration, and nstep is set to 1 for those</span>
<a name="17169"><font size=-1>17169     </font></a><span class="string">perturbations. Note that the resulting 1DEN files are simply the</span>
<a name="17170"><font size=-1>17170     </font></a><span class="string">rotate/symmetric ones and that the resulting 1WF files are garbage (completely</span>
<a name="17171"><font size=-1>17171     </font></a><span class="string">unconverged) except the matrix elements in the header (equivalent to GKK</span>
<a name="17172"><font size=-1>17172     </font></a><span class="string">files, but please use the latter much smaller files for el-ph calculations).</span>
<a name="17173"><font size=-1>17173     </font></a><span class="string">The new default behavior with [[use_nonscf_gkk]] = 1 should be transparent for</span>
<a name="17174"><font size=-1>17174     </font></a><span class="string">the user, with the same output files but a much quicker execution.</span>
<a name="17175"><font size=-1>17175     </font></a><span class="string"></span>
<a name="17176"><font size=-1>17176     </font></a><span class="string">Caveat: Note that very tight convergence of ground state and phonon</span>
<a name="17177"><font size=-1>17177     </font></a><span class="string">calculations is necessary to get good GKK matrix elements! [[tolwfr]] = 1.e-24</span>
<a name="17178"><font size=-1>17178     </font></a><span class="string">or so is recommended everywhere. There may be problems using use_nonscf_gkk =</span>
<a name="17179"><font size=-1>17179     </font></a><span class="string">1 with non-symmorphic symmetries - please check (at least) that lifetimes for</span>
<a name="17180"><font size=-1>17180     </font></a><span class="string">phonons go to 0 for acoustic modes at Gamma.</span>
<a name="17181"><font size=-1>17181     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17182"><font size=-1>17182     </font></a><span class="default">),</span>
<a name="17183"><font size=-1>17183     </font></a><span class="default"></span>
<a name="17184"><font size=-1>17184     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17185"><font size=-1>17185     </font></a><span class="default">    abivarname=</span><span class="string">&quot;use_slk&quot;</span><span class="default">,</span>
<a name="17186"><font size=-1>17186     </font></a><span class="default">    varset=</span><span class="string">&quot;paral&quot;</span><span class="default">,</span>
<a name="17187"><font size=-1>17187     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17188"><font size=-1>17188     </font></a><span class="default">    topics=[</span><span class="string">'parallelism_expert'</span><span class="default">],</span>
<a name="17189"><font size=-1>17189     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17190"><font size=-1>17190     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17191"><font size=-1>17191     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE ScaLapacK&quot;</span><span class="default">,</span>
<a name="17192"><font size=-1>17192     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17193"><font size=-1>17193     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17194"><font size=-1>17194     </font></a><span class="string">If set to 1, enable the use of ScaLapack within LOBPCG.</span>
<a name="17195"><font size=-1>17195     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17196"><font size=-1>17196     </font></a><span class="default">),</span>
<a name="17197"><font size=-1>17197     </font></a><span class="default"></span>
<a name="17198"><font size=-1>17198     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17199"><font size=-1>17199     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usedmatpu&quot;</span><span class="default">,</span>
<a name="17200"><font size=-1>17200     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="17201"><font size=-1>17201     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17202"><font size=-1>17202     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_useful'</span><span class="default">],</span>
<a name="17203"><font size=-1>17203     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17204"><font size=-1>17204     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17205"><font size=-1>17205     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE of an initial Density MATrix in Paw+U&quot;</span><span class="default">,</span>
<a name="17206"><font size=-1>17206     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1 and [[usepawu]] == 1&quot;</span><span class="default">,</span>
<a name="17207"><font size=-1>17207     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17208"><font size=-1>17208     </font></a><span class="string">When [[usedmatpu]]/=0, an initial density matrix (given by [[dmatpawu]]</span>
<a name="17209"><font size=-1>17209     </font></a><span class="string">keyword) is used and kept fixed during the first ABS([[usedmatpu]]) SCF steps.</span>
<a name="17210"><font size=-1>17210     </font></a><span class="string">This starting value of the density matrix can be useful to find the correct</span>
<a name="17211"><font size=-1>17211     </font></a><span class="string">ground state. Within LDA+U formalism, finding the minimal energy of the system</span>
<a name="17212"><font size=-1>17212     </font></a><span class="string">is tricky; thus it is advised to test several values of the initial density</span>
<a name="17213"><font size=-1>17213     </font></a><span class="string">matrix.</span>
<a name="17214"><font size=-1>17214     </font></a><span class="string">Note also that the density matrix has to respect some symmetry rules</span>
<a name="17215"><font size=-1>17215     </font></a><span class="string">determined by the space group. If the symmetry is not respected in the input,</span>
<a name="17216"><font size=-1>17216     </font></a><span class="string">the matrix is however automatically symmetrised.</span>
<a name="17217"><font size=-1>17217     </font></a><span class="string"></span>
<a name="17218"><font size=-1>17218     </font></a><span class="string">The sign of [[usedmatpu]] has influence only when [[ionmov]] /= 0 (dynamics or relaxation):</span>
<a name="17219"><font size=-1>17219     </font></a><span class="string"></span>
<a name="17220"><font size=-1>17220     </font></a><span class="string">- When [[usedmatpu]]&gt;0, the density matrix is kept constant only at first ionic step</span>
<a name="17221"><font size=-1>17221     </font></a><span class="string">- When [[usedmatpu]]&lt;0, the density matrix is kept constant at each ionic step</span>
<a name="17222"><font size=-1>17222     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17223"><font size=-1>17223     </font></a><span class="default">),</span>
<a name="17224"><font size=-1>17224     </font></a><span class="default"></span>
<a name="17225"><font size=-1>17225     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17226"><font size=-1>17226     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usedmft&quot;</span><span class="default">,</span>
<a name="17227"><font size=-1>17227     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17228"><font size=-1>17228     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17229"><font size=-1>17229     </font></a><span class="default">    topics=[</span><span class="string">'DMFT_compulsory'</span><span class="default">],</span>
<a name="17230"><font size=-1>17230     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17231"><font size=-1>17231     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17232"><font size=-1>17232     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE Dynamical Mean Field Theory&quot;</span><span class="default">,</span>
<a name="17233"><font size=-1>17233     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17234"><font size=-1>17234     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17235"><font size=-1>17235     </font></a><span class="string">If set to 1, enable the use of DFT+DMFT, see in particular the important</span>
<a name="17236"><font size=-1>17236     </font></a><span class="string">variables [[dmft_solv]], [[dmftbandi]], [[dmftbandf]], [[dmft_nwli]],</span>
<a name="17237"><font size=-1>17237     </font></a><span class="string">[[dmft_nwlo]], [[dmft_tollc]], [[dmft_tolfreq]], and [[dmft_iter]].</span>
<a name="17238"><font size=-1>17238     </font></a><span class="string"></span>
<a name="17239"><font size=-1>17239     </font></a><span class="string">The current implementation uses Wannier functions obtained from</span>
<a name="17240"><font size=-1>17240     </font></a><span class="string">[[ cite:Amadon2008 | projected local orbitals ]] as</span>
<a name="17241"><font size=-1>17241     </font></a><span class="string">correlated orbitals (see [[dmftbandi]] and [[dmftbandf]] input variables to</span>
<a name="17242"><font size=-1>17242     </font></a><span class="string">define them).</span>
<a name="17243"><font size=-1>17243     </font></a><span class="string"></span>
<a name="17244"><font size=-1>17244     </font></a><span class="string">The Green functions are computed on a mesh of linear Matsubara frequencies.</span>
<a name="17245"><font size=-1>17245     </font></a><span class="string">However, most of the code uses logarithmic Matsubara grid to lower the</span>
<a name="17246"><font size=-1>17246     </font></a><span class="string">computational cost. Both [[dmft_nwli]] and [[dmft_nwlo]] are thus convergence</span>
<a name="17247"><font size=-1>17247     </font></a><span class="string">parameters.</span>
<a name="17248"><font size=-1>17248     </font></a><span class="string"></span>
<a name="17249"><font size=-1>17249     </font></a><span class="string">DMFT is currently available for collinear ([[nspinor]] = 1) polarized or</span>
<a name="17250"><font size=-1>17250     </font></a><span class="string">unpolarized calculations ([[nspden]] = [[nsppol]] = 2 or [[nspden]] = [[nsppol]] = 1)</span>
<a name="17251"><font size=-1>17251     </font></a><span class="string">and for non collinear calculations ([[nspinor]] = 2,[[nspden]] = 4,[[nsppol]] = 1).</span>
<a name="17252"><font size=-1>17252     </font></a><span class="string">However it is not yet available for collinear antiferromagnetic calculations</span>
<a name="17253"><font size=-1>17253     </font></a><span class="string">([[nspden]] = 2,[[nsppol]] = 1) and non collinear non magnetic calculations</span>
<a name="17254"><font size=-1>17254     </font></a><span class="string">([[nspden]] = 1, [[nsppol]] = 1,[[nspinor]] = 2). CTQMC calculations</span>
<a name="17255"><font size=-1>17255     </font></a><span class="string">([[dmft_solv]] = 5) are not yet possible if [[nspinor]] = 2.</span>
<a name="17256"><font size=-1>17256     </font></a><span class="string"></span>
<a name="17257"><font size=-1>17257     </font></a><span class="string">Only static calculations without relaxation or dynamics are possible (forces</span>
<a name="17258"><font size=-1>17258     </font></a><span class="string">and stress are not computed in the scheme: so the computed values should NOT</span>
<a name="17259"><font size=-1>17259     </font></a><span class="string">be trusted).</span>
<a name="17260"><font size=-1>17260     </font></a><span class="string"></span>
<a name="17261"><font size=-1>17261     </font></a><span class="string">When correlated density matrices are diagonal, all values of [[upawu]] and</span>
<a name="17262"><font size=-1>17262     </font></a><span class="string">[[jpawu]] are possible. If the correlated density matrices are non diagonal,</span>
<a name="17263"><font size=-1>17263     </font></a><span class="string">only [[jpawu]] = 0 is implemented.</span>
<a name="17264"><font size=-1>17264     </font></a><span class="string"></span>
<a name="17265"><font size=-1>17265     </font></a><span class="string">Relevant direct output quantities from converged DMFT calculations are total</span>
<a name="17266"><font size=-1>17266     </font></a><span class="string">energy and occupation of correlated orbitals. For Hubbard I calculation</span>
<a name="17267"><font size=-1>17267     </font></a><span class="string">([[dmft_solv]] = 2), total and partial spectral functions can be obtained with</span>
<a name="17268"><font size=-1>17268     </font></a><span class="string">prtdos=1 and can be found in files OUTSpFunc* (where OUT is the root for</span>
<a name="17269"><font size=-1>17269     </font></a><span class="string">output files). For CTQMC calculations ([[dmft_solv]] = 5), imaginary time</span>
<a name="17270"><font size=-1>17270     </font></a><span class="string">impurity Green function are output of the calculations and can be used to</span>
<a name="17271"><font size=-1>17271     </font></a><span class="string">produce spectral function using an external Maximum Entropy Code.</span>
<a name="17272"><font size=-1>17272     </font></a><span class="string"></span>
<a name="17273"><font size=-1>17273     </font></a><span class="string">A typical DFT+DMFT calculation involves two runs. First, a DFT calculation is</span>
<a name="17274"><font size=-1>17274     </font></a><span class="string">fully converged (even unoccupied wavefunctions have to be converged). Then,</span>
<a name="17275"><font size=-1>17275     </font></a><span class="string">the DFT+DMFT calculation is started using DFT wavefunctions or density files.</span>
<a name="17276"><font size=-1>17276     </font></a><span class="string">As DFT+DMFT calculations (with CTQMC) are computationally expensive, it is</span>
<a name="17277"><font size=-1>17277     </font></a><span class="string">convenient to use prtden=-1, to write DEN file at each DFT iteration, in order</span>
<a name="17278"><font size=-1>17278     </font></a><span class="string">to be able to restart the calculation easily.</span>
<a name="17279"><font size=-1>17279     </font></a><span class="string"></span>
<a name="17280"><font size=-1>17280     </font></a><span class="string">For details of the implementation with Wannier functions see [[cite:Amadon2008]],</span>
<a name="17281"><font size=-1>17281     </font></a><span class="string">for self-consistency and Hubbard I</span>
<a name="17282"><font size=-1>17282     </font></a><span class="string">implementation see [[cite:Amadon2012]]. If [[usedmft]] = 1 and [[nbandkss]]/=0, then, the DFT+DMFT</span>
<a name="17283"><font size=-1>17283     </font></a><span class="string">calculation is not done and only projections are computed at the end of the</span>
<a name="17284"><font size=-1>17284     </font></a><span class="string">calculation. They can be used by an external code or used to compute the</span>
<a name="17285"><font size=-1>17285     </font></a><span class="string">screened interaction (see variable [[ucrpa]]).</span>
<a name="17286"><font size=-1>17286     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17287"><font size=-1>17287     </font></a><span class="default">),</span>
<a name="17288"><font size=-1>17288     </font></a><span class="default"></span>
<a name="17289"><font size=-1>17289     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17290"><font size=-1>17290     </font></a><span class="default">    abivarname=</span><span class="string">&quot;useexexch&quot;</span><span class="default">,</span>
<a name="17291"><font size=-1>17291     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="17292"><font size=-1>17292     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17293"><font size=-1>17293     </font></a><span class="default">    topics=[</span><span class="string">'xc_useful'</span><span class="default">],</span>
<a name="17294"><font size=-1>17294     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17295"><font size=-1>17295     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17296"><font size=-1>17296     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE of EXact EXCHange&quot;</span><span class="default">,</span>
<a name="17297"><font size=-1>17297     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="17298"><font size=-1>17298     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17299"><font size=-1>17299     </font></a><span class="string">When [[useexexch]] = 1, the hybrid functional PBE0 is used in PAW, inside PAW</span>
<a name="17300"><font size=-1>17300     </font></a><span class="string">spheres only, and only for correlated orbitals given by [[lexexch]]. To change</span>
<a name="17301"><font size=-1>17301     </font></a><span class="string">the ratio of exact exchange, see also [[exchmix]].</span>
<a name="17302"><font size=-1>17302     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17303"><font size=-1>17303     </font></a><span class="default">),</span>
<a name="17304"><font size=-1>17304     </font></a><span class="default"></span>
<a name="17305"><font size=-1>17305     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17306"><font size=-1>17306     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usefock&quot;</span><span class="default">,</span>
<a name="17307"><font size=-1>17307     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="17308"><font size=-1>17308     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17309"><font size=-1>17309     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_internal'</span><span class="default">],</span>
<a name="17310"><font size=-1>17310     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17311"><font size=-1>17311     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17312"><font size=-1>17312     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE FOCK exact exchange&quot;</span><span class="default">,</span>
<a name="17313"><font size=-1>17313     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="17314"><font size=-1>17314     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17315"><font size=-1>17315     </font></a><span class="string">This internal variable is automatically set to 1 when the value of [[ixc]]</span>
<a name="17316"><font size=-1>17316     </font></a><span class="string">refers to an Hartree-Fock calculation or hybrid functionals.</span>
<a name="17317"><font size=-1>17317     </font></a><span class="string"></span>
<a name="17318"><font size=-1>17318     </font></a><span class="string">  * 0  --&gt;  No use of exact exchange.</span>
<a name="17319"><font size=-1>17319     </font></a><span class="string">  * 1  --&gt;  exact exchange is required for the calculation.</span>
<a name="17320"><font size=-1>17320     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17321"><font size=-1>17321     </font></a><span class="default">),</span>
<a name="17322"><font size=-1>17322     </font></a><span class="default"></span>
<a name="17323"><font size=-1>17323     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17324"><font size=-1>17324     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usekden&quot;</span><span class="default">,</span>
<a name="17325"><font size=-1>17325     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="17326"><font size=-1>17326     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17327"><font size=-1>17327     </font></a><span class="default">    topics=[</span><span class="string">'xc_expert'</span><span class="default">],</span>
<a name="17328"><font size=-1>17328     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17329"><font size=-1>17329     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17330"><font size=-1>17330     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE Kinetic energy DENsity&quot;</span><span class="default">,</span>
<a name="17331"><font size=-1>17331     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17332"><font size=-1>17332     </font></a><span class="string">If [[usekden]] = 1 the kinetic energy density will be computed during</span>
<a name="17333"><font size=-1>17333     </font></a><span class="string">the self-consistent loop, in a way similar to the computation of the density.</span>
<a name="17334"><font size=-1>17334     </font></a><span class="string">This is needed if a meta-GGA is to be used as XC functional. By default</span>
<a name="17335"><font size=-1>17335     </font></a><span class="string">([[usekden]] = 0), the kinetic energy density is not computed during the self-</span>
<a name="17336"><font size=-1>17336     </font></a><span class="string">consistent loop.</span>
<a name="17337"><font size=-1>17337     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17338"><font size=-1>17338     </font></a><span class="default">),</span>
<a name="17339"><font size=-1>17339     </font></a><span class="default"></span>
<a name="17340"><font size=-1>17340     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17341"><font size=-1>17341     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usepaw&quot;</span><span class="default">,</span>
<a name="17342"><font size=-1>17342     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="17343"><font size=-1>17343     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17344"><font size=-1>17344     </font></a><span class="default">    topics=[</span><span class="string">'PAW_internal'</span><span class="default">],</span>
<a name="17345"><font size=-1>17345     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17346"><font size=-1>17346     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[AUTO_FROM_PSP]]&quot;</span><span class="default">,</span>
<a name="17347"><font size=-1>17347     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE Projector Augmented Waves method&quot;</span><span class="default">,</span>
<a name="17348"><font size=-1>17348     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="17349"><font size=-1>17349     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17350"><font size=-1>17350     </font></a><span class="string">This variable is determined by the pseudopotentials files. PAW calculations</span>
<a name="17351"><font size=-1>17351     </font></a><span class="string">(see [[tutorial:paw1]]) can only be performed with PAW atomic data input files,</span>
<a name="17352"><font size=-1>17352     </font></a><span class="string">while pseudopotential calculations are performed in ABINIT with norm-conserving</span>
<a name="17353"><font size=-1>17353     </font></a><span class="string">pseudopotential input files. Most functionalities in ABINIT are</span>
<a name="17354"><font size=-1>17354     </font></a><span class="string">available with either type of calculation.</span>
<a name="17355"><font size=-1>17355     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17356"><font size=-1>17356     </font></a><span class="default">),</span>
<a name="17357"><font size=-1>17357     </font></a><span class="default"></span>
<a name="17358"><font size=-1>17358     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17359"><font size=-1>17359     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usepawu&quot;</span><span class="default">,</span>
<a name="17360"><font size=-1>17360     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="17361"><font size=-1>17361     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17362"><font size=-1>17362     </font></a><span class="default">    topics=[</span><span class="string">'DFT+U_compulsory'</span><span class="default">, </span><span class="string">'PAW_useful'</span><span class="default">, </span><span class="string">'GW_useful'</span><span class="default">, </span><span class="string">'SelfEnergy_useful'</span><span class="default">],</span>
<a name="17363"><font size=-1>17363     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17364"><font size=-1>17364     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17365"><font size=-1>17365     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE PAW+U (spherical part)&quot;</span><span class="default">,</span>
<a name="17366"><font size=-1>17366     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="17367"><font size=-1>17367     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="17368"><font size=-1>17368     </font></a><span class="string">Must be non-zero if a DFT+U calculation is done, or if a GW calculation</span>
<a name="17369"><font size=-1>17369     </font></a><span class="string">following a DFT+U calculation is done (important!).</span>
<a name="17370"><font size=-1>17370     </font></a><span class="string"></span>
<a name="17371"><font size=-1>17371     </font></a><span class="string">  * If set to 0, the LDA+U method is not used.</span>
<a name="17372"><font size=-1>17372     </font></a><span class="string"></span>
<a name="17373"><font size=-1>17373     </font></a><span class="string">  * If set to 1, 2 or 4, the LDA+U method (cf [[cite:Anisimov1991a]]) is used. The full rotationally invariant formulation is used (see Eq. (3) of [[cite:Liechtenstein1995]]) for the interaction term of the energy. Two choices are allowed concerning the double counting term:</span>
<a name="17374"><font size=-1>17374     </font></a><span class="string"></span>
<a name="17375"><font size=-1>17375     </font></a><span class="string">    * If [[usepawu]] = 1, the Full Localized Limit (FLL) (or Atomic limit) double counting is used (cf Eq. (4) of [[cite:Liechtenstein1995]] or Eq. (8) of [[cite:Czyzyk1994]]).</span>
<a name="17376"><font size=-1>17376     </font></a><span class="string"></span>
<a name="17377"><font size=-1>17377     </font></a><span class="string">    * If [[usepawu]] = 2, the Around Mean Field (AMF) double counting is used (cf Eq. (7) of [[cite:Czyzyk1994]]). Not valid if nspinor=2.</span>
<a name="17378"><font size=-1>17378     </font></a><span class="string"></span>
<a name="17379"><font size=-1>17379     </font></a><span class="string">    * If [[usepawu]] = 4, the FLL double counting is used. However, and in comparison to usepaw=1, the calculation is done without</span>
<a name="17380"><font size=-1>17380     </font></a><span class="string">    polarization in the exchange correlation functional (cf [[cite:Park2015]] and [[cite:Chen2016a]]). In this case, one must use [[iscf]]&lt;10.</span>
<a name="17381"><font size=-1>17381     </font></a><span class="string"></span>
<a name="17382"><font size=-1>17382     </font></a><span class="string">If LDA+U is activated ([[usepawu]] = 1 or 2), the [[lpawu]], [[upawu]] and</span>
<a name="17383"><font size=-1>17383     </font></a><span class="string">[[jpawu]] input variables are read.</span>
<a name="17384"><font size=-1>17384     </font></a><span class="string">The implementation is done inside PAW augmentation regions only (cf [[cite:Bengone2000]]).</span>
<a name="17385"><font size=-1>17385     </font></a><span class="string">The initial density matrix can be given in the input file (see [[usedmatpu]]).</span>
<a name="17386"><font size=-1>17386     </font></a><span class="string">The expression of the density matrix is chosen thanks to [[dmatpuopt]].</span>
<a name="17387"><font size=-1>17387     </font></a><span class="string">In the case of a GW calculation on top of a DFT+U, the absence of definition</span>
<a name="17388"><font size=-1>17388     </font></a><span class="string">of a U value in the self-energy will LEAVE the underlying U from the DFT</span>
<a name="17389"><font size=-1>17389     </font></a><span class="string">calculation. Thus, the code will actually do a GW+U @ DFT+U calculation. Note</span>
<a name="17390"><font size=-1>17390     </font></a><span class="string">that the screening calculation will not be affected by the presence/absence of</span>
<a name="17391"><font size=-1>17391     </font></a><span class="string">a U value.</span>
<a name="17392"><font size=-1>17392     </font></a><span class="string">Actually, in order to perform a GW @ DFT+U calculation, one should define the</span>
<a name="17393"><font size=-1>17393     </font></a><span class="string">same value of U in the self-energy calculation, than the one defined in the</span>
<a name="17394"><font size=-1>17394     </font></a><span class="string">DFT calculation. The code will know that the interaction corresponding to that</span>
<a name="17395"><font size=-1>17395     </font></a><span class="string">value has to be SUBTRACTED inside the self-energy. The easiest is actually to</span>
<a name="17396"><font size=-1>17396     </font></a><span class="string">define the presence of U for the whole set of calculations (for the different</span>
<a name="17397"><font size=-1>17397     </font></a><span class="string">datasets), including the screening, even if the U value does not play</span>
<a name="17398"><font size=-1>17398     </font></a><span class="string">explicitly a role in the computation of the latter (well, the input</span>
<a name="17399"><font size=-1>17399     </font></a><span class="string">wavefunctions will be different anyhow).</span>
<a name="17400"><font size=-1>17400     </font></a><span class="string">It is possible to perform calculations of the type GW+$U^{'}$ @ DFT+U, so</span>
<a name="17401"><font size=-1>17401     </font></a><span class="string">keeping a smaller U interaction in the GW calculation, by subtracting a</span>
<a name="17402"><font size=-1>17402     </font></a><span class="string">smaller U than the one used in the DFT calculation. See the description of the</span>
<a name="17403"><font size=-1>17403     </font></a><span class="string">[[upawu]] input variable.</span>
<a name="17404"><font size=-1>17404     </font></a><span class="string"></span>
<a name="17405"><font size=-1>17405     </font></a><span class="string"></span>
<a name="17406"><font size=-1>17406     </font></a><span class="string">Suggested acknowledgment:[[cite:Amadon2008a]].</span>
<a name="17407"><font size=-1>17407     </font></a><span class="string"></span>
<a name="17408"><font size=-1>17408     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17409"><font size=-1>17409     </font></a><span class="default">),</span>
<a name="17410"><font size=-1>17410     </font></a><span class="default"></span>
<a name="17411"><font size=-1>17411     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17412"><font size=-1>17412     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usepotzero&quot;</span><span class="default">,</span>
<a name="17413"><font size=-1>17413     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17414"><font size=-1>17414     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17415"><font size=-1>17415     </font></a><span class="default">    topics=[</span><span class="string">'Coulomb_useful'</span><span class="default">],</span>
<a name="17416"><font size=-1>17416     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17417"><font size=-1>17417     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17418"><font size=-1>17418     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE POTential ZERO&quot;</span><span class="default">,</span>
<a name="17419"><font size=-1>17419     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17420"><font size=-1>17420     </font></a><span class="string">Fix the convention for the choice of the average value of the Hartree potential, as described in [[cite:Bruneval2014]].</span>
<a name="17421"><font size=-1>17421     </font></a><span class="string">  * [[usepotzero]] = 0, the usual convention: the smooth potential is set to zero average value.</span>
<a name="17422"><font size=-1>17422     </font></a><span class="string">  * [[usepotzero]] = 1, the new convention: the all-electron physical potential is set to zero average value.</span>
<a name="17423"><font size=-1>17423     </font></a><span class="string">  * [[usepotzero]] = 2, the PWscf convention: the potential of equivalent point charges is set to</span>
<a name="17424"><font size=-1>17424     </font></a><span class="string">  zero average value (convention also valid for NC pseudopotentials).</span>
<a name="17425"><font size=-1>17425     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17426"><font size=-1>17426     </font></a><span class="default">),</span>
<a name="17427"><font size=-1>17427     </font></a><span class="default"></span>
<a name="17428"><font size=-1>17428     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17429"><font size=-1>17429     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userec&quot;</span><span class="default">,</span>
<a name="17430"><font size=-1>17430     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="17431"><font size=-1>17431     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17432"><font size=-1>17432     </font></a><span class="default">    topics=[</span><span class="string">'Recursion_internal'</span><span class="default">],</span>
<a name="17433"><font size=-1>17433     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17434"><font size=-1>17434     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17435"><font size=-1>17435     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE RECursion&quot;</span><span class="default">,</span>
<a name="17436"><font size=-1>17436     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="17437"><font size=-1>17437     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17438"><font size=-1>17438     </font></a><span class="string">This internal variable is set to 1 when the recursion method is activated (see [[tfkinfunc]]).</span>
<a name="17439"><font size=-1>17439     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17440"><font size=-1>17440     </font></a><span class="default">),</span>
<a name="17441"><font size=-1>17441     </font></a><span class="default"></span>
<a name="17442"><font size=-1>17442     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17443"><font size=-1>17443     </font></a><span class="default">    abivarname=</span><span class="string">&quot;useria&quot;</span><span class="default">,</span>
<a name="17444"><font size=-1>17444     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17445"><font size=-1>17445     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17446"><font size=-1>17446     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17447"><font size=-1>17447     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17448"><font size=-1>17448     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17449"><font size=-1>17449     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Integer variable A&quot;</span><span class="default">,</span>
<a name="17450"><font size=-1>17450     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17451"><font size=-1>17451     </font></a><span class="string">These are user-definable integers which the user may input and then utilize in</span>
<a name="17452"><font size=-1>17452     </font></a><span class="string">subroutines of his/her own design. They are not used in the official versions</span>
<a name="17453"><font size=-1>17453     </font></a><span class="string">of the ABINIT code, and should ease independent developments (hopefully</span>
<a name="17454"><font size=-1>17454     </font></a><span class="string">integrated in the official version afterwards).</span>
<a name="17455"><font size=-1>17455     </font></a><span class="string">Internally, they are available in the dtset structured datatype, e.g. `dtset%useria`.</span>
<a name="17456"><font size=-1>17456     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17457"><font size=-1>17457     </font></a><span class="default">),</span>
<a name="17458"><font size=-1>17458     </font></a><span class="default"></span>
<a name="17459"><font size=-1>17459     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17460"><font size=-1>17460     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userib&quot;</span><span class="default">,</span>
<a name="17461"><font size=-1>17461     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17462"><font size=-1>17462     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17463"><font size=-1>17463     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17464"><font size=-1>17464     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17465"><font size=-1>17465     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17466"><font size=-1>17466     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Integer variable B&quot;</span><span class="default">,</span>
<a name="17467"><font size=-1>17467     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17468"><font size=-1>17468     </font></a><span class="string">These are user-definable integers which the user may input and then utilize in</span>
<a name="17469"><font size=-1>17469     </font></a><span class="string">subroutines of his/her own design. They are not used in the official versions</span>
<a name="17470"><font size=-1>17470     </font></a><span class="string">of the ABINIT code, and should ease independent developments (hopefully</span>
<a name="17471"><font size=-1>17471     </font></a><span class="string">integrated in the official version afterwards).</span>
<a name="17472"><font size=-1>17472     </font></a><span class="string">Internally, they are available in the dtset structured datatype, e.g. `dtset%useria`.</span>
<a name="17473"><font size=-1>17473     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17474"><font size=-1>17474     </font></a><span class="default">),</span>
<a name="17475"><font size=-1>17475     </font></a><span class="default"></span>
<a name="17476"><font size=-1>17476     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17477"><font size=-1>17477     </font></a><span class="default">    abivarname=</span><span class="string">&quot;useric&quot;</span><span class="default">,</span>
<a name="17478"><font size=-1>17478     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17479"><font size=-1>17479     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17480"><font size=-1>17480     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17481"><font size=-1>17481     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17482"><font size=-1>17482     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17483"><font size=-1>17483     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Integer variable C&quot;</span><span class="default">,</span>
<a name="17484"><font size=-1>17484     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17485"><font size=-1>17485     </font></a><span class="string">These are user-definable integers which the user may input and then utilize in</span>
<a name="17486"><font size=-1>17486     </font></a><span class="string">subroutines of his/her own design. They are not used in the official versions</span>
<a name="17487"><font size=-1>17487     </font></a><span class="string">of the ABINIT code, and should ease independent developments (hopefully</span>
<a name="17488"><font size=-1>17488     </font></a><span class="string">integrated in the official version afterwards).</span>
<a name="17489"><font size=-1>17489     </font></a><span class="string">Internally, they are available in the dtset structured datatype, e.g. `dtset%useria`.</span>
<a name="17490"><font size=-1>17490     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17491"><font size=-1>17491     </font></a><span class="default">),</span>
<a name="17492"><font size=-1>17492     </font></a><span class="default"></span>
<a name="17493"><font size=-1>17493     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17494"><font size=-1>17494     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userid&quot;</span><span class="default">,</span>
<a name="17495"><font size=-1>17495     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17496"><font size=-1>17496     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17497"><font size=-1>17497     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17498"><font size=-1>17498     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17499"><font size=-1>17499     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17500"><font size=-1>17500     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Integer variable D&quot;</span><span class="default">,</span>
<a name="17501"><font size=-1>17501     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17502"><font size=-1>17502     </font></a><span class="string">These are user-definable integers which the user may input and then utilize in</span>
<a name="17503"><font size=-1>17503     </font></a><span class="string">subroutines of his/her own design. They are not used in the official versions</span>
<a name="17504"><font size=-1>17504     </font></a><span class="string">of the ABINIT code, and should ease independent developments (hopefully</span>
<a name="17505"><font size=-1>17505     </font></a><span class="string">integrated in the official version afterwards).</span>
<a name="17506"><font size=-1>17506     </font></a><span class="string">Internally, they are available in the dtset structured datatype, e.g. `dtset%useria`.</span>
<a name="17507"><font size=-1>17507     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17508"><font size=-1>17508     </font></a><span class="default">),</span>
<a name="17509"><font size=-1>17509     </font></a><span class="default"></span>
<a name="17510"><font size=-1>17510     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17511"><font size=-1>17511     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userie&quot;</span><span class="default">,</span>
<a name="17512"><font size=-1>17512     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17513"><font size=-1>17513     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17514"><font size=-1>17514     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17515"><font size=-1>17515     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17516"><font size=-1>17516     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17517"><font size=-1>17517     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Integer variable E&quot;</span><span class="default">,</span>
<a name="17518"><font size=-1>17518     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17519"><font size=-1>17519     </font></a><span class="string">These are user-definable integers which the user may input and then utilize in</span>
<a name="17520"><font size=-1>17520     </font></a><span class="string">subroutines of his/her own design. They are not used in the official versions</span>
<a name="17521"><font size=-1>17521     </font></a><span class="string">of the ABINIT code, and should ease independent developments (hopefully</span>
<a name="17522"><font size=-1>17522     </font></a><span class="string">integrated in the official version afterwards).</span>
<a name="17523"><font size=-1>17523     </font></a><span class="string">Internally, they are available in the dtset structured datatype, e.g. `dtset%useria`.</span>
<a name="17524"><font size=-1>17524     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17525"><font size=-1>17525     </font></a><span class="default">),</span>
<a name="17526"><font size=-1>17526     </font></a><span class="default"></span>
<a name="17527"><font size=-1>17527     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17528"><font size=-1>17528     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userra&quot;</span><span class="default">,</span>
<a name="17529"><font size=-1>17529     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17530"><font size=-1>17530     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17531"><font size=-1>17531     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17532"><font size=-1>17532     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17533"><font size=-1>17533     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="17534"><font size=-1>17534     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Real variable A&quot;</span><span class="default">,</span>
<a name="17535"><font size=-1>17535     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17536"><font size=-1>17536     </font></a><span class="string">These are user-definable with the same purpose as [[useria]] and cie.</span>
<a name="17537"><font size=-1>17537     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17538"><font size=-1>17538     </font></a><span class="default">),</span>
<a name="17539"><font size=-1>17539     </font></a><span class="default"></span>
<a name="17540"><font size=-1>17540     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17541"><font size=-1>17541     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userrb&quot;</span><span class="default">,</span>
<a name="17542"><font size=-1>17542     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17543"><font size=-1>17543     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17544"><font size=-1>17544     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17545"><font size=-1>17545     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17546"><font size=-1>17546     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="17547"><font size=-1>17547     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Real variable B&quot;</span><span class="default">,</span>
<a name="17548"><font size=-1>17548     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17549"><font size=-1>17549     </font></a><span class="string">These are user-definable with the same purpose as [[useria]] and cie.</span>
<a name="17550"><font size=-1>17550     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17551"><font size=-1>17551     </font></a><span class="default">),</span>
<a name="17552"><font size=-1>17552     </font></a><span class="default"></span>
<a name="17553"><font size=-1>17553     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17554"><font size=-1>17554     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userrc&quot;</span><span class="default">,</span>
<a name="17555"><font size=-1>17555     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17556"><font size=-1>17556     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17557"><font size=-1>17557     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17558"><font size=-1>17558     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17559"><font size=-1>17559     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="17560"><font size=-1>17560     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Real variable C&quot;</span><span class="default">,</span>
<a name="17561"><font size=-1>17561     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17562"><font size=-1>17562     </font></a><span class="string">These are user-definable with the same purpose as [[useria]] and cie.</span>
<a name="17563"><font size=-1>17563     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17564"><font size=-1>17564     </font></a><span class="default">),</span>
<a name="17565"><font size=-1>17565     </font></a><span class="default"></span>
<a name="17566"><font size=-1>17566     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17567"><font size=-1>17567     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userrd&quot;</span><span class="default">,</span>
<a name="17568"><font size=-1>17568     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17569"><font size=-1>17569     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17570"><font size=-1>17570     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17571"><font size=-1>17571     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17572"><font size=-1>17572     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="17573"><font size=-1>17573     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Real variable D&quot;</span><span class="default">,</span>
<a name="17574"><font size=-1>17574     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17575"><font size=-1>17575     </font></a><span class="string">These are user-definable with the same purpose as [[useria]] and cie.</span>
<a name="17576"><font size=-1>17576     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17577"><font size=-1>17577     </font></a><span class="default">),</span>
<a name="17578"><font size=-1>17578     </font></a><span class="default"></span>
<a name="17579"><font size=-1>17579     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17580"><font size=-1>17580     </font></a><span class="default">    abivarname=</span><span class="string">&quot;userre&quot;</span><span class="default">,</span>
<a name="17581"><font size=-1>17581     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17582"><font size=-1>17582     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17583"><font size=-1>17583     </font></a><span class="default">    topics=[</span><span class="string">'Dev_expert'</span><span class="default">],</span>
<a name="17584"><font size=-1>17584     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17585"><font size=-1>17585     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="17586"><font size=-1>17586     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USER Real variable E&quot;</span><span class="default">,</span>
<a name="17587"><font size=-1>17587     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17588"><font size=-1>17588     </font></a><span class="string">These are user-definable with the same purpose as [[useria]] and cie.</span>
<a name="17589"><font size=-1>17589     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17590"><font size=-1>17590     </font></a><span class="default">),</span>
<a name="17591"><font size=-1>17591     </font></a><span class="default"></span>
<a name="17592"><font size=-1>17592     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17593"><font size=-1>17593     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usewvl&quot;</span><span class="default">,</span>
<a name="17594"><font size=-1>17594     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="17595"><font size=-1>17595     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17596"><font size=-1>17596     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_compulsory'</span><span class="default">],</span>
<a name="17597"><font size=-1>17597     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17598"><font size=-1>17598     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17599"><font size=-1>17599     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Use WaVeLet basis set&quot;</span><span class="default">,</span>
<a name="17600"><font size=-1>17600     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;use plane-wave basis set&quot;</span><span class="default">,</span>
<a name="17601"><font size=-1>17601     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17602"><font size=-1>17602     </font></a><span class="string">Used to define if the calculation is done on a wavelet basis set or not.</span>
<a name="17603"><font size=-1>17603     </font></a><span class="string">The values of [[usewvl]] must be 0 or 1. Putting [[usewvl]] to 1, makes</span>
<a name="17604"><font size=-1>17604     </font></a><span class="string">[[icoulomb]] mandatory to 1. The number of band ([[nband]]) must be set</span>
<a name="17605"><font size=-1>17605     </font></a><span class="string">manually to the strict number need for an isolator system ( _i.e._ number of</span>
<a name="17606"><font size=-1>17606     </font></a><span class="string">electron over two). The cut-off is not relevant in the wavelet case, use</span>
<a name="17607"><font size=-1>17607     </font></a><span class="string">[[wvl_hgrid]] instead.</span>
<a name="17608"><font size=-1>17608     </font></a><span class="string">In wavelet case, the system must be isolated systems (molecules or clusters).</span>
<a name="17609"><font size=-1>17609     </font></a><span class="string">All geometry optimization are available (see [[ionmov]], especially the</span>
<a name="17610"><font size=-1>17610     </font></a><span class="string">geometry optimisation and the molecular dynamics).</span>
<a name="17611"><font size=-1>17611     </font></a><span class="string">The spin computation is not currently possible with wavelets and metallic</span>
<a name="17612"><font size=-1>17612     </font></a><span class="string">systems may be slow to converge.</span>
<a name="17613"><font size=-1>17613     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17614"><font size=-1>17614     </font></a><span class="default">),</span>
<a name="17615"><font size=-1>17615     </font></a><span class="default"></span>
<a name="17616"><font size=-1>17616     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17617"><font size=-1>17617     </font></a><span class="default">    abivarname=</span><span class="string">&quot;usexcnhat&quot;</span><span class="default">,</span>
<a name="17618"><font size=-1>17618     </font></a><span class="default">    varset=</span><span class="string">&quot;paw&quot;</span><span class="default">,</span>
<a name="17619"><font size=-1>17619     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17620"><font size=-1>17620     </font></a><span class="default">    topics=[</span><span class="string">'PAW_useful'</span><span class="default">],</span>
<a name="17621"><font size=-1>17621     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17622"><font size=-1>17622     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="17623"><font size=-1>17623     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE eXchange-Correlation with NHAT (compensation charge density)&quot;</span><span class="default">,</span>
<a name="17624"><font size=-1>17624     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usepaw]] == 1&quot;</span><span class="default">,</span>
<a name="17625"><font size=-1>17625     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17626"><font size=-1>17626     </font></a><span class="string"></span>
<a name="17627"><font size=-1>17627     </font></a><span class="string">This flag determines how the exchange-correlation terms are computed for the</span>
<a name="17628"><font size=-1>17628     </font></a><span class="string">pseudo-density.</span>
<a name="17629"><font size=-1>17629     </font></a><span class="string">When [[usexcnhat]] = 0, exchange-correlation potential does not include the</span>
<a name="17630"><font size=-1>17630     </font></a><span class="string">compensation charge density, i.e. $V_{xc}=V_{xc}(\\tilde{n}_{core} + \\tilde{n}_{valence})$.</span>
<a name="17631"><font size=-1>17631     </font></a><span class="string">When [[usexcnhat]] = 1, exchange-correlation potential includes the compensation</span>
<a name="17632"><font size=-1>17632     </font></a><span class="string">charge density, i.e. $V_{xc}=V_{xc}(\\tilde{n}_{core} + \\tilde{n}_{valence}+\\hat{n})$.</span>
<a name="17633"><font size=-1>17633     </font></a><span class="string">When [[usexcnhat]] = -1,the value of [[usexcnhat]] is determined from the</span>
<a name="17634"><font size=-1>17634     </font></a><span class="string">reading of the PAW dataset file (pseudopotential file). When PAW datasets with</span>
<a name="17635"><font size=-1>17635     </font></a><span class="string">different treatment of $V_{xc}$ are used in the same run, the code stops.</span>
<a name="17636"><font size=-1>17636     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17637"><font size=-1>17637     </font></a><span class="default">),</span>
<a name="17638"><font size=-1>17638     </font></a><span class="default"></span>
<a name="17639"><font size=-1>17639     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17640"><font size=-1>17640     </font></a><span class="default">    abivarname=</span><span class="string">&quot;useylm&quot;</span><span class="default">,</span>
<a name="17641"><font size=-1>17641     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="17642"><font size=-1>17642     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17643"><font size=-1>17643     </font></a><span class="default">    topics=[</span><span class="string">'TuningSpeed_expert'</span><span class="default">],</span>
<a name="17644"><font size=-1>17644     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17645"><font size=-1>17645     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#9320">ValueWithConditions</a>({</span><span class="string">'[[tfkinfunc]] == 1'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'[[usepaw]] == 1'</span><span class="default">: </span><span class="number">1</span><span class="default">, </span><span class="string">'defaultval'</span><span class="default">: </span><span class="number">0</span><span class="default">}),</span>
<a name="17646"><font size=-1>17646     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;USE YLM (the spherical harmonics)&quot;</span><span class="default">,</span>
<a name="17647"><font size=-1>17647     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17648"><font size=-1>17648     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17649"><font size=-1>17649     </font></a><span class="string">When this flag is activated, the non-local operator is applied using an</span>
<a name="17650"><font size=-1>17650     </font></a><span class="string">algorithm based on spherical harmonics. Non-local projectors are used with</span>
<a name="17651"><font size=-1>17651     </font></a><span class="string">their usual form:</span>
<a name="17652"><font size=-1>17652     </font></a><span class="string"></span>
<a name="17653"><font size=-1>17653     </font></a><span class="string">$$P_{lmn}(r) = Y_{lm}(r) p_{ln}(r)$$</span>
<a name="17654"><font size=-1>17654     </font></a><span class="string"></span>
<a name="17655"><font size=-1>17655     </font></a><span class="string">When [[useylm]] = 0, the sum over $Y_{lm}$ can be reduced to a Legendre polynomial form.</span>
<a name="17656"><font size=-1>17656     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17657"><font size=-1>17657     </font></a><span class="default">),</span>
<a name="17658"><font size=-1>17658     </font></a><span class="default"></span>
<a name="17659"><font size=-1>17659     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17660"><font size=-1>17660     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vaclst&quot;</span><span class="default">,</span>
<a name="17661"><font size=-1>17661     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="17662"><font size=-1>17662     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17663"><font size=-1>17663     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="17664"><font size=-1>17664     </font></a><span class="default">    dimensions=[</span><span class="string">'[[vacnum]]'</span><span class="default">],</span>
<a name="17665"><font size=-1>17665     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;VACancies LiST&quot;</span><span class="default">,</span>
<a name="17666"><font size=-1>17666     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="17667"><font size=-1>17667     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17668"><font size=-1>17668     </font></a><span class="string">Gives the identification number(s) of atoms to be subtracted from the set of</span>
<a name="17669"><font size=-1>17669     </font></a><span class="string">atoms that are obtained after having rotated, translated and repeated the objects.</span>
<a name="17670"><font size=-1>17670     </font></a><span class="string">Useful to created vacancies.</span>
<a name="17671"><font size=-1>17671     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17672"><font size=-1>17672     </font></a><span class="default">),</span>
<a name="17673"><font size=-1>17673     </font></a><span class="default"></span>
<a name="17674"><font size=-1>17674     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17675"><font size=-1>17675     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vacnum&quot;</span><span class="default">,</span>
<a name="17676"><font size=-1>17676     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="17677"><font size=-1>17677     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17678"><font size=-1>17678     </font></a><span class="default">    topics=[</span><span class="string">'AtomManipulator_useful'</span><span class="default">],</span>
<a name="17679"><font size=-1>17679     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17680"><font size=-1>17680     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="17681"><font size=-1>17681     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;VACancies NUMber&quot;</span><span class="default">,</span>
<a name="17682"><font size=-1>17682     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17683"><font size=-1>17683     </font></a><span class="string">Gives the number of atoms to be subtracted from the list of atoms after the</span>
<a name="17684"><font size=-1>17684     </font></a><span class="string">rotations, translations and repetitions have been done. The list of these</span>
<a name="17685"><font size=-1>17685     </font></a><span class="string">atoms is contained in [[vaclst]].</span>
<a name="17686"><font size=-1>17686     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17687"><font size=-1>17687     </font></a><span class="default">),</span>
<a name="17688"><font size=-1>17688     </font></a><span class="default"></span>
<a name="17689"><font size=-1>17689     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17690"><font size=-1>17690     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vacuum&quot;</span><span class="default">,</span>
<a name="17691"><font size=-1>17691     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="17692"><font size=-1>17692     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17693"><font size=-1>17693     </font></a><span class="default">    topics=[</span><span class="string">'k-points_expert'</span><span class="default">],</span>
<a name="17694"><font size=-1>17694     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="17695"><font size=-1>17695     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;VACUUM identification&quot;</span><span class="default">,</span>
<a name="17696"><font size=-1>17696     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="17697"><font size=-1>17697     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17698"><font size=-1>17698     </font></a><span class="string">Establishes the presence (if [[vacuum]] = 1) or absence (if [[vacuum]] = 0) of a vacuum layer, along the</span>
<a name="17699"><font size=-1>17699     </font></a><span class="string">three possible directions normal to the primitive axes.</span>
<a name="17700"><font size=-1>17700     </font></a><span class="string"></span>
<a name="17701"><font size=-1>17701     </font></a><span class="string">This information might be used to generate k-point grids, if [[kptopt]] = 0 and</span>
<a name="17702"><font size=-1>17702     </font></a><span class="string">neither [[ngkpt]] nor [[kptrlatt]] are defined (see explanations with the</span>
<a name="17703"><font size=-1>17703     </font></a><span class="string">input variable [[prtkpt]]).</span>
<a name="17704"><font size=-1>17704     </font></a><span class="string">It will allow to select a zero-, one-, two- or three-dimensional grid of k</span>
<a name="17705"><font size=-1>17705     </font></a><span class="string">points. The coordinate of the k points along vacuum directions is</span>
<a name="17706"><font size=-1>17706     </font></a><span class="string">automatically set to zero.</span>
<a name="17707"><font size=-1>17707     </font></a><span class="string"></span>
<a name="17708"><font size=-1>17708     </font></a><span class="string">If [[vacuum]] is not defined, the input variable [[vacwidth]] will be used to</span>
<a name="17709"><font size=-1>17709     </font></a><span class="string">determine automatically whether the distance between atoms is sufficient to</span>
<a name="17710"><font size=-1>17710     </font></a><span class="string">have the presence or absence of vacuum.</span>
<a name="17711"><font size=-1>17711     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17712"><font size=-1>17712     </font></a><span class="default">),</span>
<a name="17713"><font size=-1>17713     </font></a><span class="default"></span>
<a name="17714"><font size=-1>17714     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17715"><font size=-1>17715     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vacwidth&quot;</span><span class="default">,</span>
<a name="17716"><font size=-1>17716     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="17717"><font size=-1>17717     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17718"><font size=-1>17718     </font></a><span class="default">    topics=[</span><span class="string">'k-points_expert'</span><span class="default">],</span>
<a name="17719"><font size=-1>17719     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17720"><font size=-1>17720     </font></a><span class="default">    defaultval=</span><span class="number">10.0</span><span class="default">,</span>
<a name="17721"><font size=-1>17721     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;VACuum WIDTH&quot;</span><span class="default">,</span>
<a name="17722"><font size=-1>17722     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">, </span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="17723"><font size=-1>17723     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17724"><font size=-1>17724     </font></a><span class="string">Give a minimum &quot;projected&quot; distance between atoms to be found in order to</span>
<a name="17725"><font size=-1>17725     </font></a><span class="string">declare that there is some [[vacuum]] present for each of the three</span>
<a name="17726"><font size=-1>17726     </font></a><span class="string">directions. By default, given in Bohr atomic units (1 Bohr=0.5291772108</span>
<a name="17727"><font size=-1>17727     </font></a><span class="string">Angstroms), although Angstrom can be specified, if preferred, since</span>
<a name="17728"><font size=-1>17728     </font></a><span class="string">[[vacwidth]] has the '[[LENGTH]]' characteristics.</span>
<a name="17729"><font size=-1>17729     </font></a><span class="string">The precise requirement is that a slab of width [[vacwidth]], delimited by two</span>
<a name="17730"><font size=-1>17730     </font></a><span class="string">planes of constant reduced coordinates in the investigated direction, must be empty of atoms.</span>
<a name="17731"><font size=-1>17731     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17732"><font size=-1>17732     </font></a><span class="default">),</span>
<a name="17733"><font size=-1>17733     </font></a><span class="default"></span>
<a name="17734"><font size=-1>17734     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17735"><font size=-1>17735     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vcutgeo&quot;</span><span class="default">,</span>
<a name="17736"><font size=-1>17736     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="17737"><font size=-1>17737     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17738"><font size=-1>17738     </font></a><span class="default">    topics=[</span><span class="string">'GWls_compulsory'</span><span class="default">, </span><span class="string">'Susceptibility_basic'</span><span class="default">, </span><span class="string">'SelfEnergy_basic'</span><span class="default">],</span>
<a name="17739"><font size=-1>17739     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="17740"><font size=-1>17740     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">3</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="17741"><font size=-1>17741     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;V (potential) CUT-off GEOmetry&quot;</span><span class="default">,</span>
<a name="17742"><font size=-1>17742     </font></a><span class="default">    requires=</span><span class="string">&quot;[[icutcoul]] in [1,2]&quot;</span><span class="default">,</span>
<a name="17743"><font size=-1>17743     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17744"><font size=-1>17744     </font></a><span class="string">[[vcutgeo]] is used in conjunction with [[icutcoul]] to specify the geometry</span>
<a name="17745"><font size=-1>17745     </font></a><span class="string">used to truncate the Coulomb interaction, as well as the particular approach</span>
<a name="17746"><font size=-1>17746     </font></a><span class="string">to be used. It has a meaning only for the cylindrical symmetry</span>
<a name="17747"><font size=-1>17747     </font></a><span class="string">([[icutcoul]] = 1) or in the case of surfaces ([[icutcoul]] = 2). For each</span>
<a name="17748"><font size=-1>17748     </font></a><span class="string">geometry, two different definitions of the cutoff region are available (see</span>
<a name="17749"><font size=-1>17749     </font></a><span class="string">Phys. Rev. B 73, 233103 and Phys. Rev. B 73, 205119 for a complete description</span>
<a name="17750"><font size=-1>17750     </font></a><span class="string">of the methods)</span>
<a name="17751"><font size=-1>17751     </font></a><span class="string"></span>
<a name="17752"><font size=-1>17752     </font></a><span class="string">In the method of Ismail-Beigi [[cite:Ismail-Beigi2006]], the cutoff region is given by the</span>
<a name="17753"><font size=-1>17753     </font></a><span class="string">Wigner-Seitz cell centered on the axis of the cylinder. The cutoff region is</span>
<a name="17754"><font size=-1>17754     </font></a><span class="string">thus automatically defined by the unit cell and there is no need to specify</span>
<a name="17755"><font size=-1>17755     </font></a><span class="string">When [[rcut]].</span>
<a name="17756"><font size=-1>17756     </font></a><span class="string"></span>
<a name="17757"><font size=-1>17757     </font></a><span class="string">To define a cylinder along the z-axis use the following lines:</span>
<a name="17758"><font size=-1>17758     </font></a><span class="string">```</span>
<a name="17759"><font size=-1>17759     </font></a><span class="string">icutcoul 1</span>
<a name="17760"><font size=-1>17760     </font></a><span class="string">vcutgeo  0 0 1</span>
<a name="17761"><font size=-1>17761     </font></a><span class="string">```</span>
<a name="17762"><font size=-1>17762     </font></a><span class="string"></span>
<a name="17763"><font size=-1>17763     </font></a><span class="string">Please note that the method of Ismail-Beigi is implemented only in the case if an</span>
<a name="17764"><font size=-1>17764     </font></a><span class="string">orthorhombic Bravais lattic. For hexagonal lattices, one has to use the method</span>
<a name="17765"><font size=-1>17765     </font></a><span class="string">of Rozzi [[cite:Rozzi2006]]. In this case, the interaction is truncated</span>
<a name="17766"><font size=-1>17766     </font></a><span class="string">in a finite cylinder. Contrarily to the first approach, here one has to</span>
<a name="17767"><font size=-1>17767     </font></a><span class="string">specify both the radius of the cylinder with [[rcut]] as well as the length of</span>
<a name="17768"><font size=-1>17768     </font></a><span class="string">the cylinder along the periodic dimension that should always be smaller than</span>
<a name="17769"><font size=-1>17769     </font></a><span class="string">the extension of the Born von Karman box. The length of the cylinder is given</span>
<a name="17770"><font size=-1>17770     </font></a><span class="string">in terms of the fraction of the primitive vector along the periodic direction.</span>
<a name="17771"><font size=-1>17771     </font></a><span class="string"></span>
<a name="17772"><font size=-1>17772     </font></a><span class="string">For example, in order to define a finite cylinder along z of radius 2.5 Bohr</span>
<a name="17773"><font size=-1>17773     </font></a><span class="string">and length 3*R3,</span>
<a name="17774"><font size=-1>17774     </font></a><span class="string">```</span>
<a name="17775"><font size=-1>17775     </font></a><span class="string">icutcoul 1</span>
<a name="17776"><font size=-1>17776     </font></a><span class="string">vcutgeo  0 0 -3.0 # note the minus sign</span>
<a name="17777"><font size=-1>17777     </font></a><span class="string">rcut     2.5</span>
<a name="17778"><font size=-1>17778     </font></a><span class="string">```</span>
<a name="17779"><font size=-1>17779     </font></a><span class="string"></span>
<a name="17780"><font size=-1>17780     </font></a><span class="string">For surface calculations ([[icutcoul]] = 2), [[vcutgeo]] is used to define the</span>
<a name="17781"><font size=-1>17781     </font></a><span class="string">two periodic directions defining the surface. Also in this case two different</span>
<a name="17782"><font size=-1>17782     </font></a><span class="string">techniques are available. In the method of Ismail-Beigi, the (positive) non-zero</span>
<a name="17783"><font size=-1>17783     </font></a><span class="string">components of vcutgeo define the periodic directions of the infinite surface.</span>
<a name="17784"><font size=-1>17784     </font></a><span class="string">The interaction is truncated within a slab of width L where L is the length of</span>
<a name="17785"><font size=-1>17785     </font></a><span class="string">the primitive vector of the lattice along the non-periodic dimension. For</span>
<a name="17786"><font size=-1>17786     </font></a><span class="string">example:</span>
<a name="17787"><font size=-1>17787     </font></a><span class="string">```</span>
<a name="17788"><font size=-1>17788     </font></a><span class="string">icutcoul 2</span>
<a name="17789"><font size=-1>17789     </font></a><span class="string">vcutgeo  1 1 0</span>
<a name="17790"><font size=-1>17790     </font></a><span class="string">```</span>
<a name="17791"><font size=-1>17791     </font></a><span class="string"></span>
<a name="17792"><font size=-1>17792     </font></a><span class="string">It is also possible to define a finite</span>
<a name="17793"><font size=-1>17793     </font></a><span class="string">surface by employing negative values. For example:</span>
<a name="17794"><font size=-1>17794     </font></a><span class="string">```</span>
<a name="17795"><font size=-1>17795     </font></a><span class="string">icutcoul 2</span>
<a name="17796"><font size=-1>17796     </font></a><span class="string">vcutgeo -3 -2 0</span>
<a name="17797"><font size=-1>17797     </font></a><span class="string">```</span>
<a name="17798"><font size=-1>17798     </font></a><span class="string">**Definition to be added**</span>
<a name="17799"><font size=-1>17799     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17800"><font size=-1>17800     </font></a><span class="default">),</span>
<a name="17801"><font size=-1>17801     </font></a><span class="default"></span>
<a name="17802"><font size=-1>17802     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17803"><font size=-1>17803     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_acutmin&quot;</span><span class="default">,</span>
<a name="17804"><font size=-1>17804     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17805"><font size=-1>17805     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17806"><font size=-1>17806     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17807"><font size=-1>17807     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17808"><font size=-1>17808     </font></a><span class="default">    defaultval=</span><span class="number">10</span><span class="default">,</span>
<a name="17809"><font size=-1>17809     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF MINimum Angular CUT-off&quot;</span><span class="default">,</span>
<a name="17810"><font size=-1>17810     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17811"><font size=-1>17811     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17812"><font size=-1>17812     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17813"><font size=-1>17813     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build angular meshes for the vdW-DF kernel.</span>
<a name="17814"><font size=-1>17814     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17815"><font size=-1>17815     </font></a><span class="default">),</span>
<a name="17816"><font size=-1>17816     </font></a><span class="default"></span>
<a name="17817"><font size=-1>17817     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17818"><font size=-1>17818     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_aratio&quot;</span><span class="default">,</span>
<a name="17819"><font size=-1>17819     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17820"><font size=-1>17820     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17821"><font size=-1>17821     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17822"><font size=-1>17822     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17823"><font size=-1>17823     </font></a><span class="default">    defaultval=</span><span class="number">30</span><span class="default">,</span>
<a name="17824"><font size=-1>17824     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;&quot;&quot;vdW-DF Angle RATIO between the highest and lowest angles.&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17825"><font size=-1>17825     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17826"><font size=-1>17826     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17827"><font size=-1>17827     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17828"><font size=-1>17828     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build angular meshes for the vdW-DF kernel.</span>
<a name="17829"><font size=-1>17829     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17830"><font size=-1>17830     </font></a><span class="default">),</span>
<a name="17831"><font size=-1>17831     </font></a><span class="default"></span>
<a name="17832"><font size=-1>17832     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17833"><font size=-1>17833     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_damax&quot;</span><span class="default">,</span>
<a name="17834"><font size=-1>17834     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17835"><font size=-1>17835     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17836"><font size=-1>17836     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17837"><font size=-1>17837     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17838"><font size=-1>17838     </font></a><span class="default">    defaultval=</span><span class="number">0.5</span><span class="default">,</span>
<a name="17839"><font size=-1>17839     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Delta for Angles, MAXimum&quot;</span><span class="default">,</span>
<a name="17840"><font size=-1>17840     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17841"><font size=-1>17841     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17842"><font size=-1>17842     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17843"><font size=-1>17843     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build angular meshes for the vdW-DF kernel.</span>
<a name="17844"><font size=-1>17844     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17845"><font size=-1>17845     </font></a><span class="default">),</span>
<a name="17846"><font size=-1>17846     </font></a><span class="default"></span>
<a name="17847"><font size=-1>17847     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17848"><font size=-1>17848     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_damin&quot;</span><span class="default">,</span>
<a name="17849"><font size=-1>17849     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17850"><font size=-1>17850     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17851"><font size=-1>17851     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17852"><font size=-1>17852     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17853"><font size=-1>17853     </font></a><span class="default">    defaultval=</span><span class="number">0.01</span><span class="default">,</span>
<a name="17854"><font size=-1>17854     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Delta for Angles, MINimum&quot;</span><span class="default">,</span>
<a name="17855"><font size=-1>17855     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17856"><font size=-1>17856     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17857"><font size=-1>17857     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17858"><font size=-1>17858     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build angular meshes for the vdW-DF kernel.</span>
<a name="17859"><font size=-1>17859     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17860"><font size=-1>17860     </font></a><span class="default">),</span>
<a name="17861"><font size=-1>17861     </font></a><span class="default"></span>
<a name="17862"><font size=-1>17862     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17863"><font size=-1>17863     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_dcut&quot;</span><span class="default">,</span>
<a name="17864"><font size=-1>17864     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17865"><font size=-1>17865     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17866"><font size=-1>17866     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17867"><font size=-1>17867     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17868"><font size=-1>17868     </font></a><span class="default">    defaultval=</span><span class="number">30</span><span class="default">,</span>
<a name="17869"><font size=-1>17869     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF D-mesh CUT-off&quot;</span><span class="default">,</span>
<a name="17870"><font size=-1>17870     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17871"><font size=-1>17871     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17872"><font size=-1>17872     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17873"><font size=-1>17873     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="17874"><font size=-1>17874     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17875"><font size=-1>17875     </font></a><span class="default">),</span>
<a name="17876"><font size=-1>17876     </font></a><span class="default"></span>
<a name="17877"><font size=-1>17877     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17878"><font size=-1>17878     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_dratio&quot;</span><span class="default">,</span>
<a name="17879"><font size=-1>17879     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17880"><font size=-1>17880     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17881"><font size=-1>17881     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17882"><font size=-1>17882     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17883"><font size=-1>17883     </font></a><span class="default">    defaultval=</span><span class="number">20</span><span class="default">,</span>
<a name="17884"><font size=-1>17884     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;&quot;&quot;vdW-DF, between the highest and</span>
<a name="17885"><font size=-1>17885     </font></a><span class="string">lowest D, RATIO.&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17886"><font size=-1>17886     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17887"><font size=-1>17887     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17888"><font size=-1>17888     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17889"><font size=-1>17889     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="17890"><font size=-1>17890     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17891"><font size=-1>17891     </font></a><span class="default">),</span>
<a name="17892"><font size=-1>17892     </font></a><span class="default"></span>
<a name="17893"><font size=-1>17893     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17894"><font size=-1>17894     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_dsoft&quot;</span><span class="default">,</span>
<a name="17895"><font size=-1>17895     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17896"><font size=-1>17896     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17897"><font size=-1>17897     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17898"><font size=-1>17898     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17899"><font size=-1>17899     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="17900"><font size=-1>17900     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Distance for SOFTening.&quot;</span><span class="default">,</span>
<a name="17901"><font size=-1>17901     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17902"><font size=-1>17902     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17903"><font size=-1>17903     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17904"><font size=-1>17904     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="17905"><font size=-1>17905     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17906"><font size=-1>17906     </font></a><span class="default">),</span>
<a name="17907"><font size=-1>17907     </font></a><span class="default"></span>
<a name="17908"><font size=-1>17908     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17909"><font size=-1>17909     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_gcut&quot;</span><span class="default">,</span>
<a name="17910"><font size=-1>17910     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17911"><font size=-1>17911     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="17912"><font size=-1>17912     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17913"><font size=-1>17913     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17914"><font size=-1>17914     </font></a><span class="default">    defaultval=</span><span class="number">5</span><span class="default">,</span>
<a name="17915"><font size=-1>17915     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF G-space CUT-off&quot;</span><span class="default">,</span>
<a name="17916"><font size=-1>17916     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17917"><font size=-1>17917     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17918"><font size=-1>17918     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17919"><font size=-1>17919     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to filter the vdW-DF kernel in reciprocal space.</span>
<a name="17920"><font size=-1>17920     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17921"><font size=-1>17921     </font></a><span class="default">),</span>
<a name="17922"><font size=-1>17922     </font></a><span class="default"></span>
<a name="17923"><font size=-1>17923     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17924"><font size=-1>17924     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_ndpts&quot;</span><span class="default">,</span>
<a name="17925"><font size=-1>17925     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17926"><font size=-1>17926     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17927"><font size=-1>17927     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17928"><font size=-1>17928     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17929"><font size=-1>17929     </font></a><span class="default">    defaultval=</span><span class="number">20</span><span class="default">,</span>
<a name="17930"><font size=-1>17930     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Number of D-mesh PoinTS&quot;</span><span class="default">,</span>
<a name="17931"><font size=-1>17931     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17932"><font size=-1>17932     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17933"><font size=-1>17933     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17934"><font size=-1>17934     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="17935"><font size=-1>17935     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17936"><font size=-1>17936     </font></a><span class="default">),</span>
<a name="17937"><font size=-1>17937     </font></a><span class="default"></span>
<a name="17938"><font size=-1>17938     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17939"><font size=-1>17939     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_ngpts&quot;</span><span class="default">,</span>
<a name="17940"><font size=-1>17940     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17941"><font size=-1>17941     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17942"><font size=-1>17942     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17943"><font size=-1>17943     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17944"><font size=-1>17944     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="17945"><font size=-1>17945     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Number of G-mesh PoinTS&quot;</span><span class="default">,</span>
<a name="17946"><font size=-1>17946     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17947"><font size=-1>17947     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17948"><font size=-1>17948     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17949"><font size=-1>17949     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="17950"><font size=-1>17950     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17951"><font size=-1>17951     </font></a><span class="default">),</span>
<a name="17952"><font size=-1>17952     </font></a><span class="default"></span>
<a name="17953"><font size=-1>17953     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17954"><font size=-1>17954     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_nqpts&quot;</span><span class="default">,</span>
<a name="17955"><font size=-1>17955     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17956"><font size=-1>17956     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17957"><font size=-1>17957     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17958"><font size=-1>17958     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17959"><font size=-1>17959     </font></a><span class="default">    defaultval=</span><span class="number">30</span><span class="default">,</span>
<a name="17960"><font size=-1>17960     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Number of Q-mesh PoinTS&quot;</span><span class="default">,</span>
<a name="17961"><font size=-1>17961     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17962"><font size=-1>17962     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17963"><font size=-1>17963     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17964"><font size=-1>17964     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="17965"><font size=-1>17965     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17966"><font size=-1>17966     </font></a><span class="default">),</span>
<a name="17967"><font size=-1>17967     </font></a><span class="default"></span>
<a name="17968"><font size=-1>17968     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17969"><font size=-1>17969     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_nrpts&quot;</span><span class="default">,</span>
<a name="17970"><font size=-1>17970     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17971"><font size=-1>17971     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17972"><font size=-1>17972     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17973"><font size=-1>17973     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17974"><font size=-1>17974     </font></a><span class="default">    defaultval=</span><span class="number">2048</span><span class="default">,</span>
<a name="17975"><font size=-1>17975     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Number of R-PoinTS&quot;</span><span class="default">,</span>
<a name="17976"><font size=-1>17976     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17977"><font size=-1>17977     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17978"><font size=-1>17978     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17979"><font size=-1>17979     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to define the sampling of the vdW-DF-kernel in real-space.</span>
<a name="17980"><font size=-1>17980     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17981"><font size=-1>17981     </font></a><span class="default">),</span>
<a name="17982"><font size=-1>17982     </font></a><span class="default"></span>
<a name="17983"><font size=-1>17983     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17984"><font size=-1>17984     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_nsmooth&quot;</span><span class="default">,</span>
<a name="17985"><font size=-1>17985     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="17986"><font size=-1>17986     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="17987"><font size=-1>17987     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="17988"><font size=-1>17988     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="17989"><font size=-1>17989     </font></a><span class="default">    defaultval=</span><span class="number">12</span><span class="default">,</span>
<a name="17990"><font size=-1>17990     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Number of SMOOTHening iterations&quot;</span><span class="default">,</span>
<a name="17991"><font size=-1>17991     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="17992"><font size=-1>17992     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="17993"><font size=-1>17993     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="17994"><font size=-1>17994     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to exponentially smoothen q near q0.</span>
<a name="17995"><font size=-1>17995     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="17996"><font size=-1>17996     </font></a><span class="default">),</span>
<a name="17997"><font size=-1>17997     </font></a><span class="default"></span>
<a name="17998"><font size=-1>17998     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="17999"><font size=-1>17999     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_phisoft&quot;</span><span class="default">,</span>
<a name="18000"><font size=-1>18000     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18001"><font size=-1>18001     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18002"><font size=-1>18002     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18003"><font size=-1>18003     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18004"><font size=-1>18004     </font></a><span class="default">    defaultval=-</span><span class="number">1.0</span><span class="default">,</span>
<a name="18005"><font size=-1>18005     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF PHI value SOFTening.&quot;</span><span class="default">,</span>
<a name="18006"><font size=-1>18006     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18007"><font size=-1>18007     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18008"><font size=-1>18008     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18009"><font size=-1>18009     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="18010"><font size=-1>18010     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18011"><font size=-1>18011     </font></a><span class="default">),</span>
<a name="18012"><font size=-1>18012     </font></a><span class="default"></span>
<a name="18013"><font size=-1>18013     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18014"><font size=-1>18014     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_qcut&quot;</span><span class="default">,</span>
<a name="18015"><font size=-1>18015     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18016"><font size=-1>18016     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18017"><font size=-1>18017     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18018"><font size=-1>18018     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18019"><font size=-1>18019     </font></a><span class="default">    defaultval=</span><span class="number">5</span><span class="default">,</span>
<a name="18020"><font size=-1>18020     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Q-mesh CUT-off&quot;</span><span class="default">,</span>
<a name="18021"><font size=-1>18021     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18022"><font size=-1>18022     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18023"><font size=-1>18023     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18024"><font size=-1>18024     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="18025"><font size=-1>18025     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18026"><font size=-1>18026     </font></a><span class="default">),</span>
<a name="18027"><font size=-1>18027     </font></a><span class="default"></span>
<a name="18028"><font size=-1>18028     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18029"><font size=-1>18029     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_qratio&quot;</span><span class="default">,</span>
<a name="18030"><font size=-1>18030     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18031"><font size=-1>18031     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18032"><font size=-1>18032     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18033"><font size=-1>18033     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18034"><font size=-1>18034     </font></a><span class="default">    defaultval=</span><span class="number">20</span><span class="default">,</span>
<a name="18035"><font size=-1>18035     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF, between highest and lowest Q, RATIO.&quot;</span><span class="default">,</span>
<a name="18036"><font size=-1>18036     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18037"><font size=-1>18037     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18038"><font size=-1>18038     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18039"><font size=-1>18039     </font></a><span class="string">Used when [[vdw_xc]]&gt;0,.</span>
<a name="18040"><font size=-1>18040     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18041"><font size=-1>18041     </font></a><span class="default">),</span>
<a name="18042"><font size=-1>18042     </font></a><span class="default"></span>
<a name="18043"><font size=-1>18043     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18044"><font size=-1>18044     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_rcut&quot;</span><span class="default">,</span>
<a name="18045"><font size=-1>18045     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18046"><font size=-1>18046     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18047"><font size=-1>18047     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18048"><font size=-1>18048     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18049"><font size=-1>18049     </font></a><span class="default">    defaultval=</span><span class="number">100</span><span class="default">,</span>
<a name="18050"><font size=-1>18050     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF Real-space CUT-off&quot;</span><span class="default">,</span>
<a name="18051"><font size=-1>18051     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18052"><font size=-1>18052     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18053"><font size=-1>18053     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18054"><font size=-1>18054     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to define the vdW-DF kernel cut-off radius.</span>
<a name="18055"><font size=-1>18055     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18056"><font size=-1>18056     </font></a><span class="default">),</span>
<a name="18057"><font size=-1>18057     </font></a><span class="default"></span>
<a name="18058"><font size=-1>18058     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18059"><font size=-1>18059     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_rsoft&quot;</span><span class="default">,</span>
<a name="18060"><font size=-1>18060     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18061"><font size=-1>18061     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18062"><font size=-1>18062     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18063"><font size=-1>18063     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18064"><font size=-1>18064     </font></a><span class="default">    defaultval=</span><span class="number">0.0</span><span class="default">,</span>
<a name="18065"><font size=-1>18065     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF radius SOFTening.&quot;</span><span class="default">,</span>
<a name="18066"><font size=-1>18066     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18067"><font size=-1>18067     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18068"><font size=-1>18068     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18069"><font size=-1>18069     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="18070"><font size=-1>18070     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18071"><font size=-1>18071     </font></a><span class="default">),</span>
<a name="18072"><font size=-1>18072     </font></a><span class="default"></span>
<a name="18073"><font size=-1>18073     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18074"><font size=-1>18074     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_threshold&quot;</span><span class="default">,</span>
<a name="18075"><font size=-1>18075     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18076"><font size=-1>18076     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18077"><font size=-1>18077     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18078"><font size=-1>18078     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18079"><font size=-1>18079     </font></a><span class="default">    defaultval=</span><span class="number">0.01</span><span class="default">,</span>
<a name="18080"><font size=-1>18080     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF energy calculation THRESHOLD&quot;</span><span class="default">,</span>
<a name="18081"><font size=-1>18081     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18082"><font size=-1>18082     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18083"><font size=-1>18083     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18084"><font size=-1>18084     </font></a><span class="string">Sets a threshold for the energy gradient that, when reached, will cause the</span>
<a name="18085"><font size=-1>18085     </font></a><span class="string">vdW-DF interactions to be calculated.</span>
<a name="18086"><font size=-1>18086     </font></a><span class="string">Adjust it to a big value (e.g. 1e12) to enable it all along the SCF</span>
<a name="18087"><font size=-1>18087     </font></a><span class="string">calculation. Too small values, as well as negative values, will result in the</span>
<a name="18088"><font size=-1>18088     </font></a><span class="string">vdW-DF energy contributions never being calculated.</span>
<a name="18089"><font size=-1>18089     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18090"><font size=-1>18090     </font></a><span class="default">),</span>
<a name="18091"><font size=-1>18091     </font></a><span class="default"></span>
<a name="18092"><font size=-1>18092     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18093"><font size=-1>18093     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_tolerance&quot;</span><span class="default">,</span>
<a name="18094"><font size=-1>18094     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18095"><font size=-1>18095     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18096"><font size=-1>18096     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18097"><font size=-1>18097     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18098"><font size=-1>18098     </font></a><span class="default">    defaultval=</span><span class="number">1e-13</span><span class="default">,</span>
<a name="18099"><font size=-1>18099     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF global TOLERANCE.&quot;</span><span class="default">,</span>
<a name="18100"><font size=-1>18100     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18101"><font size=-1>18101     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18102"><font size=-1>18102     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18103"><font size=-1>18103     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="18104"><font size=-1>18104     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18105"><font size=-1>18105     </font></a><span class="default">),</span>
<a name="18106"><font size=-1>18106     </font></a><span class="default"></span>
<a name="18107"><font size=-1>18107     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18108"><font size=-1>18108     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_tweaks&quot;</span><span class="default">,</span>
<a name="18109"><font size=-1>18109     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18110"><font size=-1>18110     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18111"><font size=-1>18111     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18112"><font size=-1>18112     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18113"><font size=-1>18113     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18114"><font size=-1>18114     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF TWEAKS.&quot;</span><span class="default">,</span>
<a name="18115"><font size=-1>18115     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18116"><font size=-1>18116     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18117"><font size=-1>18117     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18118"><font size=-1>18118     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, to build the vdW-DF kernel.</span>
<a name="18119"><font size=-1>18119     </font></a><span class="string"></span>
<a name="18120"><font size=-1>18120     </font></a><span class="string">!!! important</span>
<a name="18121"><font size=-1>18121     </font></a><span class="string"></span>
<a name="18122"><font size=-1>18122     </font></a><span class="string">    Modifying this variable will likely transform the</span>
<a name="18123"><font size=-1>18123     </font></a><span class="string">    calculated energies and their gradients into garbage.</span>
<a name="18124"><font size=-1>18124     </font></a><span class="string">    You have been warned!</span>
<a name="18125"><font size=-1>18125     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18126"><font size=-1>18126     </font></a><span class="default">),</span>
<a name="18127"><font size=-1>18127     </font></a><span class="default"></span>
<a name="18128"><font size=-1>18128     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18129"><font size=-1>18129     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_df_zab&quot;</span><span class="default">,</span>
<a name="18130"><font size=-1>18130     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18131"><font size=-1>18131     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18132"><font size=-1>18132     </font></a><span class="default">    topics=[</span><span class="string">'vdw_expert'</span><span class="default">],</span>
<a name="18133"><font size=-1>18133     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18134"><font size=-1>18134     </font></a><span class="default">    defaultval=-</span><span class="number">0.8491</span><span class="default">,</span>
<a name="18135"><font size=-1>18135     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vdW-DF ZAB parameter&quot;</span><span class="default">,</span>
<a name="18136"><font size=-1>18136     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18137"><font size=-1>18137     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]]&gt;0&quot;</span><span class="default">,</span>
<a name="18138"><font size=-1>18138     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18139"><font size=-1>18139     </font></a><span class="string">Used when [[vdw_xc]]&gt;0, as introduced in [[cite:Dion2004]].</span>
<a name="18140"><font size=-1>18140     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18141"><font size=-1>18141     </font></a><span class="default">),</span>
<a name="18142"><font size=-1>18142     </font></a><span class="default"></span>
<a name="18143"><font size=-1>18143     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18144"><font size=-1>18144     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_nfrag&quot;</span><span class="default">,</span>
<a name="18145"><font size=-1>18145     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18146"><font size=-1>18146     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18147"><font size=-1>18147     </font></a><span class="default">    topics=[</span><span class="string">'vdw_basic'</span><span class="default">],</span>
<a name="18148"><font size=-1>18148     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18149"><font size=-1>18149     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="18150"><font size=-1>18150     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Van Der Waals Number of interacting FRAGments&quot;</span><span class="default">,</span>
<a name="18151"><font size=-1>18151     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18152"><font size=-1>18152     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]] in [10,11]&quot;</span><span class="default">,</span>
<a name="18153"><font size=-1>18153     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18154"><font size=-1>18154     </font></a><span class="string">The absolute value of vdw_nfrag is the number of vdW interacting fragments in</span>
<a name="18155"><font size=-1>18155     </font></a><span class="string">the unit cell. As wannierization takes place in reciprocal space, the MLWF</span>
<a name="18156"><font size=-1>18156     </font></a><span class="string">center positions could be translated by some lattice vector from the cell</span>
<a name="18157"><font size=-1>18157     </font></a><span class="string">where atoms are placed. If [[vdw_nfrag]] &gt;= 1 then MLWFs are translated to the</span>
<a name="18158"><font size=-1>18158     </font></a><span class="string">original unit cell, otherwise the program will keep the positions obtained by</span>
<a name="18159"><font size=-1>18159     </font></a><span class="string">Wannier90. The later is usually correct if some atoms are located at the</span>
<a name="18160"><font size=-1>18160     </font></a><span class="string">corners or at limiting faces of the unit cell.</span>
<a name="18161"><font size=-1>18161     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18162"><font size=-1>18162     </font></a><span class="default">),</span>
<a name="18163"><font size=-1>18163     </font></a><span class="default"></span>
<a name="18164"><font size=-1>18164     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18165"><font size=-1>18165     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_supercell&quot;</span><span class="default">,</span>
<a name="18166"><font size=-1>18166     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18167"><font size=-1>18167     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18168"><font size=-1>18168     </font></a><span class="default">    topics=[</span><span class="string">'vdw_basic'</span><span class="default">],</span>
<a name="18169"><font size=-1>18169     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="18170"><font size=-1>18170     </font></a><span class="default">    defaultval=[</span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">],</span>
<a name="18171"><font size=-1>18171     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Van Der Waals correction from Wannier functions in SUPERCELL&quot;</span><span class="default">,</span>
<a name="18172"><font size=-1>18172     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18173"><font size=-1>18173     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]] in [10,11]&quot;</span><span class="default">,</span>
<a name="18174"><font size=-1>18174     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18175"><font size=-1>18175     </font></a><span class="string">Set of dimensionless positive numbers which define the maximum multiples of</span>
<a name="18176"><font size=-1>18176     </font></a><span class="string">the primitive translations ([[rprimd]]) in the supercell construction. Each</span>
<a name="18177"><font size=-1>18177     </font></a><span class="string">component of vdw_supercell indicates the maximum number of cells along both</span>
<a name="18178"><font size=-1>18178     </font></a><span class="string">positive or negative directions of the corresponding primitive vector i.e. the</span>
<a name="18179"><font size=-1>18179     </font></a><span class="string">components of [[rprimd]]. In the case of layered systems for which vdW</span>
<a name="18180"><font size=-1>18180     </font></a><span class="string">interactions occur between layers made of tightly bound atoms, the evaluation</span>
<a name="18181"><font size=-1>18181     </font></a><span class="string">of vdW corrections coming from MLWFs in the same layer (fragment) must be</span>
<a name="18182"><font size=-1>18182     </font></a><span class="string">avoided. Both a negative or null value for one component of [[vdw_supercell]]</span>
<a name="18183"><font size=-1>18183     </font></a><span class="string">will indicate that the corresponding direction is normal to the layers.</span>
<a name="18184"><font size=-1>18184     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18185"><font size=-1>18185     </font></a><span class="default">),</span>
<a name="18186"><font size=-1>18186     </font></a><span class="default"></span>
<a name="18187"><font size=-1>18187     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18188"><font size=-1>18188     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_tol&quot;</span><span class="default">,</span>
<a name="18189"><font size=-1>18189     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18190"><font size=-1>18190     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18191"><font size=-1>18191     </font></a><span class="default">    topics=[</span><span class="string">'vdw_compulsory'</span><span class="default">],</span>
<a name="18192"><font size=-1>18192     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18193"><font size=-1>18193     </font></a><span class="default">    defaultval=</span><span class="number">1e-10</span><span class="default">,</span>
<a name="18194"><font size=-1>18194     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Van Der Waals TOLerance&quot;</span><span class="default">,</span>
<a name="18195"><font size=-1>18195     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18196"><font size=-1>18196     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]] == 5&quot;</span><span class="default">,</span>
<a name="18197"><font size=-1>18197     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18198"><font size=-1>18198     </font></a><span class="string">The DFT-D methods [[cite:Grimme2010]] dispersion potentials, [[vdw_xc]] == 5 or</span>
<a name="18199"><font size=-1>18199     </font></a><span class="string">6 or 7, include a pair potential. The number of pairs of atoms contributing to</span>
<a name="18200"><font size=-1>18200     </font></a><span class="string">the potential is necessarily limited. To be included in the potential a pair</span>
<a name="18201"><font size=-1>18201     </font></a><span class="string">of atom must have contribution to the energy larger than [[vdw_tol]].</span>
<a name="18202"><font size=-1>18202     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18203"><font size=-1>18203     </font></a><span class="default">),</span>
<a name="18204"><font size=-1>18204     </font></a><span class="default"></span>
<a name="18205"><font size=-1>18205     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18206"><font size=-1>18206     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_tol_3bt&quot;</span><span class="default">,</span>
<a name="18207"><font size=-1>18207     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18208"><font size=-1>18208     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18209"><font size=-1>18209     </font></a><span class="default">    topics=[</span><span class="string">'vdw_basic'</span><span class="default">],</span>
<a name="18210"><font size=-1>18210     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18211"><font size=-1>18211     </font></a><span class="default">    defaultval=-</span><span class="number">1</span><span class="default">,</span>
<a name="18212"><font size=-1>18212     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Van Der Waals TOLerance for 3-Body Term&quot;</span><span class="default">,</span>
<a name="18213"><font size=-1>18213     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18214"><font size=-1>18214     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Do include the 3-body term in the correction&quot;</span><span class="default">,</span>
<a name="18215"><font size=-1>18215     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]] == 6&quot;</span><span class="default">,</span>
<a name="18216"><font size=-1>18216     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18217"><font size=-1>18217     </font></a><span class="string">Control the computation of the 3-body correction inside DFT-D3 dispersion</span>
<a name="18218"><font size=-1>18218     </font></a><span class="string">correction (Grimme approach) to the total energy:</span>
<a name="18219"><font size=-1>18219     </font></a><span class="string"></span>
<a name="18220"><font size=-1>18220     </font></a><span class="string">  * If **vdw_tol_3bt** &lt;0, no 3-body correction.</span>
<a name="18221"><font size=-1>18221     </font></a><span class="string">  * If **vdw_tol_3bt** &gt;0, the 3-body term is included with a tolerance = **vdw_tol_3bt**.</span>
<a name="18222"><font size=-1>18222     </font></a><span class="string"></span>
<a name="18223"><font size=-1>18223     </font></a><span class="string">DFT-D3 as proposed by S. Grimme adds two contributions to the total energy in</span>
<a name="18224"><font size=-1>18224     </font></a><span class="string">order to take into account of the dispersion:</span>
<a name="18225"><font size=-1>18225     </font></a><span class="string"></span>
<a name="18226"><font size=-1>18226     </font></a><span class="string">  * A pair-wise potential for which the tolerance is controlled by [[vdw_tol]]</span>
<a name="18227"><font size=-1>18227     </font></a><span class="string"></span>
<a name="18228"><font size=-1>18228     </font></a><span class="string">  * A 3-body term which is obtained by summing over all triplets of atoms. Each individual contribution depends of the distances and angles between the three atoms. As it is impossible to sum over all the triplets in a periodic system, one has to define a stopping criterium which is here that an additional contribution to the energy must be higher than **vdw_tol_3bt**</span>
<a name="18229"><font size=-1>18229     </font></a><span class="string"></span>
<a name="18230"><font size=-1>18230     </font></a><span class="string">The last term has been predicted to have an important effect for large</span>
<a name="18231"><font size=-1>18231     </font></a><span class="string">molecules [[cite:Grimme2010]]. It is however quite costly in computational</span>
<a name="18232"><font size=-1>18232     </font></a><span class="string">time for periodic systems and seems to lead to an overestimation of lattice</span>
<a name="18233"><font size=-1>18233     </font></a><span class="string">parameters for weakly bound systems [[cite:Grimme2011]]. Still, its</span>
<a name="18234"><font size=-1>18234     </font></a><span class="string">contribution to energy, to forces and to stress is available (not planned for</span>
<a name="18235"><font size=-1>18235     </font></a><span class="string">elastic constants, dynamical matrix and internal strains).</span>
<a name="18236"><font size=-1>18236     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18237"><font size=-1>18237     </font></a><span class="default">),</span>
<a name="18238"><font size=-1>18238     </font></a><span class="default"></span>
<a name="18239"><font size=-1>18239     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18240"><font size=-1>18240     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_typfrag&quot;</span><span class="default">,</span>
<a name="18241"><font size=-1>18241     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18242"><font size=-1>18242     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18243"><font size=-1>18243     </font></a><span class="default">    topics=[</span><span class="string">'vdw_basic'</span><span class="default">],</span>
<a name="18244"><font size=-1>18244     </font></a><span class="default">    dimensions=[</span><span class="string">'[[natom]]'</span><span class="default">],</span>
<a name="18245"><font size=-1>18245     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="number">1</span><span class="default">, value=</span><span class="string">'[[natom]]'</span><span class="default">),</span>
<a name="18246"><font size=-1>18246     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Van Der Waals TYPe of FRAGment&quot;</span><span class="default">,</span>
<a name="18247"><font size=-1>18247     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18248"><font size=-1>18248     </font></a><span class="default">    requires=</span><span class="string">&quot;[[vdw_xc]] in [10,11]&quot;</span><span class="default">,</span>
<a name="18249"><font size=-1>18249     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18250"><font size=-1>18250     </font></a><span class="string">This array defines the interacting fragments by assigning to each atom an</span>
<a name="18251"><font size=-1>18251     </font></a><span class="string">integer index from 1 to **vdw_nfrag**. The ordering of [[vdw_typfrag]] is the</span>
<a name="18252"><font size=-1>18252     </font></a><span class="string">same as [[typat]] or [[xcart]]. Internally each MLWF is assigned to a given</span>
<a name="18253"><font size=-1>18253     </font></a><span class="string">fragment by computing the distance to the atoms. MLWFs belong to the same</span>
<a name="18254"><font size=-1>18254     </font></a><span class="string">fragment as their nearest atom. The resulting set of MLWFs in each interacting</span>
<a name="18255"><font size=-1>18255     </font></a><span class="string">fragment can be found in the output file in xyz format for easy visualization.</span>
<a name="18256"><font size=-1>18256     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18257"><font size=-1>18257     </font></a><span class="default">),</span>
<a name="18258"><font size=-1>18258     </font></a><span class="default"></span>
<a name="18259"><font size=-1>18259     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18260"><font size=-1>18260     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vdw_xc&quot;</span><span class="default">,</span>
<a name="18261"><font size=-1>18261     </font></a><span class="default">    varset=</span><span class="string">&quot;vdw&quot;</span><span class="default">,</span>
<a name="18262"><font size=-1>18262     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18263"><font size=-1>18263     </font></a><span class="default">    topics=[</span><span class="string">'vdw_compulsory'</span><span class="default">],</span>
<a name="18264"><font size=-1>18264     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18265"><font size=-1>18265     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18266"><font size=-1>18266     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Van Der Waals eXchange-Correlation functional&quot;</span><span class="default">,</span>
<a name="18267"><font size=-1>18267     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18268"><font size=-1>18268     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18269"><font size=-1>18269     </font></a><span class="string">Selects a van-der-Waals density functional to apply the corresponding</span>
<a name="18270"><font size=-1>18270     </font></a><span class="string">correction to the exchange-correlation energy. If set to zero, no correction</span>
<a name="18271"><font size=-1>18271     </font></a><span class="string">will be applied.</span>
<a name="18272"><font size=-1>18272     </font></a><span class="string">Possible values are:</span>
<a name="18273"><font size=-1>18273     </font></a><span class="string"></span>
<a name="18274"><font size=-1>18274     </font></a><span class="string">  * 0: no correction.</span>
<a name="18275"><font size=-1>18275     </font></a><span class="string">  * 1: apply vdW-DF1 (DRSLL) from [[cite:Dion2004]].</span>
<a name="18276"><font size=-1>18276     </font></a><span class="string">  * 2: apply vdw-DF2 (LMKLL) from [[cite:Lee2010]].</span>
<a name="18277"><font size=-1>18277     </font></a><span class="string">  * 5: apply vdw-DFT-D2 as proposed by S. Grimme [[cite:Grimme2006]] (adding a semi-empirical dispersion potential). Available only for ground-state calculations and response functions; see [[vdw_tol]] variable to control convergence.</span>
<a name="18278"><font size=-1>18278     </font></a><span class="string">  * 6: apply vdw-DFT-D3 as proposed by S. Grimme [[cite:Grimme2010]] (refined version of DFT-D2). Available only for ground-state calculations and response functions; see [[vdw_tol]] variable to control convergence and [[vdw_tol_3bt]] variable to include 3-body corrections.</span>
<a name="18279"><font size=-1>18279     </font></a><span class="string">  * 7: apply vdw-DFT-D3(BJ) as proposed by Grimme (based on Becke-Jonhson method from [[cite:Becke2006]]). Available only for ground-state calculations and response functions; see [[vdw_tol]] variable to control convergence.</span>
<a name="18280"><font size=-1>18280     </font></a><span class="string">  * 10: evaluate the vdW correlation energy from maximally localized Wannier functions, as proposed by P. L. Silvestrelli, also known as vdW-WF1 method [[cite:Silvestrelli2008]]. For details on this implementation please check [[cite:Espejo2012]]. The improvements introduced by Andrinopoulos _et al._ [[cite:Andrinopoulos2011]], namely the amalgamation procedure, splitting of p-like MLWFs into two s-like Wannier functions and fractional occupation of MLWFs are performed automatically.</span>
<a name="18281"><font size=-1>18281     </font></a><span class="string">  * 11: evaluate the vdW correlation energy from maximally localized Wannier functions, as proposed by A. Ambrosetti and P. L. Silvestrelli, also known as vdW-WF2 method [[cite:Ambrosetti2012]].</span>
<a name="18282"><font size=-1>18282     </font></a><span class="string">  * 14: apply DFT/vdW-QHO-WF method as proposed by Silvestrelli, which combines the quantum harmonic oscillator-model with localized Wannier functions [[cite:Silvestrelli2013]]. For periodic systems a supercell approach has to be used since **vdw_supercell** is not enabled in this case.</span>
<a name="18283"><font size=-1>18283     </font></a><span class="string"></span>
<a name="18284"><font size=-1>18284     </font></a><span class="string">For [[vdw_xc]] = 1 and [[vdw_xc]] = 2, the implementation follows the strategy</span>
<a name="18285"><font size=-1>18285     </font></a><span class="string">devised in the article of Roman-Perez and Soler [[cite:Romanperez2009]].</span>
<a name="18286"><font size=-1>18286     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18287"><font size=-1>18287     </font></a><span class="default">),</span>
<a name="18288"><font size=-1>18288     </font></a><span class="default"></span>
<a name="18289"><font size=-1>18289     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18290"><font size=-1>18290     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vel&quot;</span><span class="default">,</span>
<a name="18291"><font size=-1>18291     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="18292"><font size=-1>18292     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18293"><font size=-1>18293     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_useful'</span><span class="default">, </span><span class="string">'MolecularDynamics_basic'</span><span class="default">],</span>
<a name="18294"><font size=-1>18294     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[natom]]'</span><span class="default">],</span>
<a name="18295"><font size=-1>18295     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0</span><span class="default">),</span>
<a name="18296"><font size=-1>18296     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;VELocity&quot;</span><span class="default">,</span>
<a name="18297"><font size=-1>18297     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="18298"><font size=-1>18298     </font></a><span class="default">    commentdims=</span><span class="string">&quot;It is represented internally as [[vel]](3,[[natom]],[[nimage]])&quot;</span><span class="default">,</span>
<a name="18299"><font size=-1>18299     </font></a><span class="default">    requires=</span><span class="string">&quot;[[ionmov]] &gt; 0&quot;</span><span class="default">,</span>
<a name="18300"><font size=-1>18300     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18301"><font size=-1>18301     </font></a><span class="string">Gives the starting velocities of atoms, in cartesian coordinates, in</span>
<a name="18302"><font size=-1>18302     </font></a><span class="string">Bohr/atomic time units (atomic time units given where [[dtion]] is described).</span>
<a name="18303"><font size=-1>18303     </font></a><span class="string">For [[ionmov]] = 8 (Nose thermostat), if [[vel]] is not initialized, a random</span>
<a name="18304"><font size=-1>18304     </font></a><span class="string">initial velocity giving the right kinetic energy will be generated.</span>
<a name="18305"><font size=-1>18305     </font></a><span class="string">If the atom manipulator is used, [[vel]] will be related to the preprocessed</span>
<a name="18306"><font size=-1>18306     </font></a><span class="string">set of atoms, generated by the atom manipulator. The user must thus foresee</span>
<a name="18307"><font size=-1>18307     </font></a><span class="string">the effect of this atom manipulator (see [[objarf]]).</span>
<a name="18308"><font size=-1>18308     </font></a><span class="string">Velocities evolve is [[ionmov]] == 1.</span>
<a name="18309"><font size=-1>18309     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18310"><font size=-1>18310     </font></a><span class="default">),</span>
<a name="18311"><font size=-1>18311     </font></a><span class="default"></span>
<a name="18312"><font size=-1>18312     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18313"><font size=-1>18313     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vel_cell&quot;</span><span class="default">,</span>
<a name="18314"><font size=-1>18314     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="18315"><font size=-1>18315     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18316"><font size=-1>18316     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_expert'</span><span class="default">],</span>
<a name="18317"><font size=-1>18317     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="number">3</span><span class="default">],</span>
<a name="18318"><font size=-1>18318     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">3</span><span class="default">),</span>
<a name="18319"><font size=-1>18319     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;VELocity of the CELL parameters&quot;</span><span class="default">,</span>
<a name="18320"><font size=-1>18320     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="18321"><font size=-1>18321     </font></a><span class="default">    commentdims=</span><span class="string">&quot;It is represented internally as [[vel_cell]](3,3,[[nimage]])&quot;</span><span class="default">,</span>
<a name="18322"><font size=-1>18322     </font></a><span class="default">    requires=</span><span class="string">&quot;&quot;&quot;[[imgmov]] in [9,13] and [[optcell]] &gt; 0</span>
<a name="18323"><font size=-1>18323     </font></a><span class="string">(Path-Integral Molecular Dynamics with NPT algorithm)&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18324"><font size=-1>18324     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18325"><font size=-1>18325     </font></a><span class="string">Irrelevant unless [[imgmov]] = 9 or 13 and [[optcell]]&gt;0 (Path-Integral</span>
<a name="18326"><font size=-1>18326     </font></a><span class="string">Molecular Dynamics with NPT algorithm).</span>
<a name="18327"><font size=-1>18327     </font></a><span class="string">Gives the starting velocities of the dimensional cell parameters in</span>
<a name="18328"><font size=-1>18328     </font></a><span class="string">Bohr/atomic time units (atomic time units given where [[dtion]] is described).</span>
<a name="18329"><font size=-1>18329     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18330"><font size=-1>18330     </font></a><span class="default">),</span>
<a name="18331"><font size=-1>18331     </font></a><span class="default"></span>
<a name="18332"><font size=-1>18332     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18333"><font size=-1>18333     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vis&quot;</span><span class="default">,</span>
<a name="18334"><font size=-1>18334     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="18335"><font size=-1>18335     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18336"><font size=-1>18336     </font></a><span class="default">    topics=[</span><span class="string">'PIMD_basic'</span><span class="default">, </span><span class="string">'MolecularDynamics_basic'</span><span class="default">],</span>
<a name="18337"><font size=-1>18337     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18338"><font size=-1>18338     </font></a><span class="default">    defaultval=</span><span class="number">100</span><span class="default">,</span>
<a name="18339"><font size=-1>18339     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;VIScosity&quot;</span><span class="default">,</span>
<a name="18340"><font size=-1>18340     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="18341"><font size=-1>18341     </font></a><span class="string">The equation of motion is:</span>
<a name="18342"><font size=-1>18342     </font></a><span class="string"></span>
<a name="18343"><font size=-1>18343     </font></a><span class="string">M  I  d  2  R  I  /dt  2  = F  I  - [[vis]] dR  I  /dt</span>
<a name="18344"><font size=-1>18344     </font></a><span class="string"></span>
<a name="18345"><font size=-1>18345     </font></a><span class="string">The atomic unit of viscosity is hartree * (atomic time units)/Bohr 2. Units</span>
<a name="18346"><font size=-1>18346     </font></a><span class="string">are not critical as this is a fictitious damping used to relax structures. A</span>
<a name="18347"><font size=-1>18347     </font></a><span class="string">typical value for silicon is 400 with [[dtion]] of 350 and atomic mass 28</span>
<a name="18348"><font size=-1>18348     </font></a><span class="string">[[amu]]. Critical damping is most desirable and is found only by optimizing</span>
<a name="18349"><font size=-1>18349     </font></a><span class="string">[[vis]] for a given situation.</span>
<a name="18350"><font size=-1>18350     </font></a><span class="string"></span>
<a name="18351"><font size=-1>18351     </font></a><span class="string">In the case of Path-Integral Molecular Dynamics using the Langevin Thermostat</span>
<a name="18352"><font size=-1>18352     </font></a><span class="string">([[imgmov]] = 9), [[vis]] defines the friction coefficient, in atomic units.</span>
<a name="18353"><font size=-1>18353     </font></a><span class="string">Typical value range is 0.00001-0.001.</span>
<a name="18354"><font size=-1>18354     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18355"><font size=-1>18355     </font></a><span class="default">),</span>
<a name="18356"><font size=-1>18356     </font></a><span class="default"></span>
<a name="18357"><font size=-1>18357     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18358"><font size=-1>18358     </font></a><span class="default">    abivarname=</span><span class="string">&quot;vprtrb&quot;</span><span class="default">,</span>
<a name="18359"><font size=-1>18359     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="18360"><font size=-1>18360     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18361"><font size=-1>18361     </font></a><span class="default">    topics=[</span><span class="string">'Artificial_useful'</span><span class="default">],</span>
<a name="18362"><font size=-1>18362     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="18363"><font size=-1>18363     </font></a><span class="default">    defaultval=[</span><span class="number">0.0</span><span class="default">, </span><span class="number">0.0</span><span class="default">],</span>
<a name="18364"><font size=-1>18364     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;potential -V- for the PeRTuRBation&quot;</span><span class="default">,</span>
<a name="18365"><font size=-1>18365     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">, </span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="18366"><font size=-1>18366     </font></a><span class="default">    requires=</span><span class="string">&quot;[[qprtrb]]&quot;</span><span class="default">,</span>
<a name="18367"><font size=-1>18367     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18368"><font size=-1>18368     </font></a><span class="string">Gives the real and imaginary parts of a scalar potential perturbation. Can be</span>
<a name="18369"><font size=-1>18369     </font></a><span class="string">specified in Ha (the default), Ry, eV or Kelvin, since [[vprtrb]] has the</span>
<a name="18370"><font size=-1>18370     </font></a><span class="string">'[[ENERGY]]' characteristics.</span>
<a name="18371"><font size=-1>18371     </font></a><span class="string">This is made available for testing responses to such perturbations. The form</span>
<a name="18372"><font size=-1>18372     </font></a><span class="string">of the perturbation, which is added to the local potential, is:</span>
<a name="18373"><font size=-1>18373     </font></a><span class="string"></span>
<a name="18374"><font size=-1>18374     </font></a><span class="string">  * ([[vprtrb]](1)$+I$[[vprtrb]](2)$)/2$ at $G=$[[qprtrb]] and</span>
<a name="18375"><font size=-1>18375     </font></a><span class="string">  * ([[vprtrb]](1)$-I$[[vprtrb]](2)$)/2$ at $G=-$[[qprtrb]] (see [[qprtrb]] also).</span>
<a name="18376"><font size=-1>18376     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18377"><font size=-1>18377     </font></a><span class="default">),</span>
<a name="18378"><font size=-1>18378     </font></a><span class="default"></span>
<a name="18379"><font size=-1>18379     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18380"><font size=-1>18380     </font></a><span class="default">    abivarname=</span><span class="string">&quot;w90iniprj&quot;</span><span class="default">,</span>
<a name="18381"><font size=-1>18381     </font></a><span class="default">    varset=</span><span class="string">&quot;w90&quot;</span><span class="default">,</span>
<a name="18382"><font size=-1>18382     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18383"><font size=-1>18383     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_basic'</span><span class="default">],</span>
<a name="18384"><font size=-1>18384     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18385"><font size=-1>18385     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="18386"><font size=-1>18386     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Wannier90- INItial PROJections&quot;</span><span class="default">,</span>
<a name="18387"><font size=-1>18387     </font></a><span class="default">    requires=</span><span class="string">&quot;[[prtwant]] == 2 or [[prtwant]] == 3&quot;</span><span class="default">,</span>
<a name="18388"><font size=-1>18388     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18389"><font size=-1>18389     </font></a><span class="string">In order to find the Maximally Localized Wannier Functions, the user has to</span>
<a name="18390"><font size=-1>18390     </font></a><span class="string">provide an initial guess. A set of localized trial orbitals is chosen</span>
<a name="18391"><font size=-1>18391     </font></a><span class="string">corresponding to some rough initial guess at the Wannier Functions, and these</span>
<a name="18392"><font size=-1>18392     </font></a><span class="string">are projected onto the Bloch eigenstates. See [[cite:Souza2002a]].</span>
<a name="18393"><font size=-1>18393     </font></a><span class="string">These initial projections are stored in a file **.amn** and the variable</span>
<a name="18394"><font size=-1>18394     </font></a><span class="string">**w90iniprj** is used to construct them:</span>
<a name="18395"><font size=-1>18395     </font></a><span class="string"></span>
<a name="18396"><font size=-1>18396     </font></a><span class="string">  * **w90iniprj** =1: Random projections.</span>
<a name="18397"><font size=-1>18397     </font></a><span class="string"></span>
<a name="18398"><font size=-1>18398     </font></a><span class="string">  * **w90iniprj** =2: The initial projections will be a linear combination of hydrogenic atomic orbitals.</span>
<a name="18399"><font size=-1>18399     </font></a><span class="string">The user has to define the projections in the secondary input file</span>
<a name="18400"><font size=-1>18400     </font></a><span class="string">wannier90.win.</span>
<a name="18401"><font size=-1>18401     </font></a><span class="string">Information about how to define them can be found in the manual of Wannier90.</span>
<a name="18402"><font size=-1>18402     </font></a><span class="string">See [www.wannier.org](http://www.wannier.org)</span>
<a name="18403"><font size=-1>18403     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18404"><font size=-1>18404     </font></a><span class="default">),</span>
<a name="18405"><font size=-1>18405     </font></a><span class="default"></span>
<a name="18406"><font size=-1>18406     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18407"><font size=-1>18407     </font></a><span class="default">    abivarname=</span><span class="string">&quot;w90prtunk&quot;</span><span class="default">,</span>
<a name="18408"><font size=-1>18408     </font></a><span class="default">    varset=</span><span class="string">&quot;w90&quot;</span><span class="default">,</span>
<a name="18409"><font size=-1>18409     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18410"><font size=-1>18410     </font></a><span class="default">    topics=[</span><span class="string">'Wannier_basic'</span><span class="default">],</span>
<a name="18411"><font size=-1>18411     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18412"><font size=-1>18412     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18413"><font size=-1>18413     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Wannier90- PRINT UNKp.s file&quot;</span><span class="default">,</span>
<a name="18414"><font size=-1>18414     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;&quot;&quot;The default is set to zero because UNKp.s files occupy a lot of memory.&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18415"><font size=-1>18415     </font></a><span class="default">    requires=</span><span class="string">&quot;[[prtwant]] == 2 or [[prtwant]] == 3&quot;</span><span class="default">,</span>
<a name="18416"><font size=-1>18416     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18417"><font size=-1>18417     </font></a><span class="string">Defines whether or not the UNKp.s file will be printed.</span>
<a name="18418"><font size=-1>18418     </font></a><span class="string"></span>
<a name="18419"><font size=-1>18419     </font></a><span class="string">  * [[w90prtunk]] = 0: Do not print the UNKp.s files</span>
<a name="18420"><font size=-1>18420     </font></a><span class="string"></span>
<a name="18421"><font size=-1>18421     </font></a><span class="string">  * [[w90prtunk]] = 1: Print the UNKp.s files on a fine grid</span>
<a name="18422"><font size=-1>18422     </font></a><span class="string"></span>
<a name="18423"><font size=-1>18423     </font></a><span class="string">  * [[w90prtunk]]&gt;1: Print the UNKp.s files on a coarse grid</span>
<a name="18424"><font size=-1>18424     </font></a><span class="string"></span>
<a name="18425"><font size=-1>18425     </font></a><span class="string">Instead of printing every record we will print every [[w90prtunk]] records. This</span>
<a name="18426"><font size=-1>18426     </font></a><span class="string">is useful to reduce the size of the UNKp.s files, but, the quality is also reduced.</span>
<a name="18427"><font size=-1>18427     </font></a><span class="string"></span>
<a name="18428"><font size=-1>18428     </font></a><span class="string">These files contain the periodic part of the bloch states represented on a</span>
<a name="18429"><font size=-1>18429     </font></a><span class="string">regular real space grid. They are indexed by k-point **p** (from 1 to nkpt)</span>
<a name="18430"><font size=-1>18430     </font></a><span class="string">and spin **s** ('1' for 'up','2' for 'down').</span>
<a name="18431"><font size=-1>18431     </font></a><span class="string"></span>
<a name="18432"><font size=-1>18432     </font></a><span class="string">The name of the wavefunction file is assumed to have the form:</span>
<a name="18433"><font size=-1>18433     </font></a><span class="string"></span>
<a name="18434"><font size=-1>18434     </font></a><span class="string">write(wfnname,200) **p**, **spin**</span>
<a name="18435"><font size=-1>18435     </font></a><span class="string">200 format ('UNK',i5.5,'.',i1)</span>
<a name="18436"><font size=-1>18436     </font></a><span class="string"></span>
<a name="18437"><font size=-1>18437     </font></a><span class="string">These file are unformatted. The first line of each file contains 5 integers:</span>
<a name="18438"><font size=-1>18438     </font></a><span class="string">the number of grid points in each direction ( **n1**, **n2** and **n3** ),</span>
<a name="18439"><font size=-1>18439     </font></a><span class="string">the k-point number **ikpt** and the total number of bands mband in the file.</span>
<a name="18440"><font size=-1>18440     </font></a><span class="string">The following rows contain the wavefunctions in real space.</span>
<a name="18441"><font size=-1>18441     </font></a><span class="string"></span>
<a name="18442"><font size=-1>18442     </font></a><span class="string">These files are written in the following way for the coarse grid:</span>
<a name="18443"><font size=-1>18443     </font></a><span class="string"></span>
<a name="18444"><font size=-1>18444     </font></a><span class="string">```fortran</span>
<a name="18445"><font size=-1>18445     </font></a><span class="string">     write(iun_plot) n1/w90prtunk,n2/w90prtunk,n3/w90prtunk,ikpt,nband</span>
<a name="18446"><font size=-1>18446     </font></a><span class="string">     write(iun_plot) (((fofr(1,jj1,jj2,jj3),fofr(2,jj1,jj2,jj3),&amp;</span>
<a name="18447"><font size=-1>18447     </font></a><span class="string">    &amp;      jj1=1,n1,w90prtunk),jj2=1,n2,w90prtunk),jj3=1,n3,w90prtunk)</span>
<a name="18448"><font size=-1>18448     </font></a><span class="string">```</span>
<a name="18449"><font size=-1>18449     </font></a><span class="string"></span>
<a name="18450"><font size=-1>18450     </font></a><span class="string">Where **fofr** is a double precision variable which contains the wavefunctions</span>
<a name="18451"><font size=-1>18451     </font></a><span class="string">in real space. Note that in order to reduce the size of the UNK files we are</span>
<a name="18452"><font size=-1>18452     </font></a><span class="string">just including records in the wavefunctions for 1/(w90prtunk$^3$) of the grid</span>
<a name="18453"><font size=-1>18453     </font></a><span class="string">points. That is why we divide **n1**, **n2** and **n3** by [[w90prtunk]]. The output .xsf files</span>
<a name="18454"><font size=-1>18454     </font></a><span class="string">for plotting with XCrysDen will also be on the coarse grid. When this does not</span>
<a name="18455"><font size=-1>18455     </font></a><span class="string">produce an acceptable plot, [[w90prtunk]] can be set to 1 to output every grid point.</span>
<a name="18456"><font size=-1>18456     </font></a><span class="string">(You should try spline interpolation in XCrysDen first.)</span>
<a name="18457"><font size=-1>18457     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18458"><font size=-1>18458     </font></a><span class="default">),</span>
<a name="18459"><font size=-1>18459     </font></a><span class="default"></span>
<a name="18460"><font size=-1>18460     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18461"><font size=-1>18461     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wfmix&quot;</span><span class="default">,</span>
<a name="18462"><font size=-1>18462     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18463"><font size=-1>18463     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18464"><font size=-1>18464     </font></a><span class="default">    topics=[</span><span class="string">'Hybrids_useful'</span><span class="default">],</span>
<a name="18465"><font size=-1>18465     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18466"><font size=-1>18466     </font></a><span class="default">    defaultval=</span><span class="number">1.0</span><span class="default">,</span>
<a name="18467"><font size=-1>18467     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaveFunctions MIXing factor&quot;</span><span class="default">,</span>
<a name="18468"><font size=-1>18468     </font></a><span class="default">    requires=</span><span class="string">&quot;[[usefock]] &gt; 0 and [[nnsclohf]] &gt;0 and [[fockoptmix]]/100 &gt; 0&quot;</span><span class="default">,</span>
<a name="18469"><font size=-1>18469     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18470"><font size=-1>18470     </font></a><span class="string">When the wavefunctions are determined using a SCF double loop (hybrid</span>
<a name="18471"><font size=-1>18471     </font></a><span class="string">functionals), [[wfmix]] provides the mixing factor to obtain the new input</span>
<a name="18472"><font size=-1>18472     </font></a><span class="string">wavefunctions by the combination of the earlier input wavefunctions and</span>
<a name="18473"><font size=-1>18473     </font></a><span class="string">corresponding (DFT-preconditioned) output wavefunctions at the level of the</span>
<a name="18474"><font size=-1>18474     </font></a><span class="string">outer loop, according to the algorithm specified by [[fockoptmix]]/100. If</span>
<a name="18475"><font size=-1>18475     </font></a><span class="string">[[wfmix]] is 1.0, the output wavefunctions only will determine the new input</span>
<a name="18476"><font size=-1>18476     </font></a><span class="string">wavefunctions. This might possibly lead to instabilities. If [[wfmix]] is</span>
<a name="18477"><font size=-1>18477     </font></a><span class="string">smaller than 1.0, the whole iteration procedure is damped, which might allow</span>
<a name="18478"><font size=-1>18478     </font></a><span class="string">better stability, but might be slower. If it is larger than 1.0, perhaps less</span>
<a name="18479"><font size=-1>18479     </font></a><span class="string">iterations will be needed (if there is no instability).</span>
<a name="18480"><font size=-1>18480     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18481"><font size=-1>18481     </font></a><span class="default">),</span>
<a name="18482"><font size=-1>18482     </font></a><span class="default"></span>
<a name="18483"><font size=-1>18483     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18484"><font size=-1>18484     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wfoptalg&quot;</span><span class="default">,</span>
<a name="18485"><font size=-1>18485     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="18486"><font size=-1>18486     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18487"><font size=-1>18487     </font></a><span class="default">    topics=[</span><span class="string">'SCFAlgorithms_basic'</span><span class="default">],</span>
<a name="18488"><font size=-1>18488     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18489"><font size=-1>18489     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[AUTO_FROM_PSP]]&quot;</span><span class="default">,</span>
<a name="18490"><font size=-1>18490     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaveFunction OPTimisation ALGorithm&quot;</span><span class="default">,</span>
<a name="18491"><font size=-1>18491     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18492"><font size=-1>18492     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;0 when [[usepaw]] = 0 (norm-conserving pseudopotentials), 10 when [[usepaw]] = 1 (PAW); 114 if [[paral_kgb]] = 1.&quot;</span><span class="default">,</span>
<a name="18493"><font size=-1>18493     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18494"><font size=-1>18494     </font></a><span class="string">Allows one to choose the algorithm for the optimisation of the wavefunctions.</span>
<a name="18495"><font size=-1>18495     </font></a><span class="string">The different possibilities are:</span>
<a name="18496"><font size=-1>18496     </font></a><span class="string"></span>
<a name="18497"><font size=-1>18497     </font></a><span class="string">  * [[wfoptalg]] = 0: standard state-by-state conjugate gradient algorithm, with no possibility to parallelize over the states;</span>
<a name="18498"><font size=-1>18498     </font></a><span class="string"></span>
<a name="18499"><font size=-1>18499     </font></a><span class="string">  * [[wfoptalg]] = 2: minimisation of the residual with respect to different shifts, in order to cover the whole set of occupied bands,</span>
<a name="18500"><font size=-1>18500     </font></a><span class="string">  with possibility to parallelize over blocks of states (or bands). The number of states in a block is defined in [[nbdblock]]. THIS IS STILL IN DEVELOPMENT.</span>
<a name="18501"><font size=-1>18501     </font></a><span class="string"></span>
<a name="18502"><font size=-1>18502     </font></a><span class="string">  * [[wfoptalg]] = 3: minimisation of the residual with respect to a shift. Available only in the non-self-consistent case [[iscf]] = -2,</span>
<a name="18503"><font size=-1>18503     </font></a><span class="string">  in order to find eigenvalues and wavefunctions close to a prescribed value.</span>
<a name="18504"><font size=-1>18504     </font></a><span class="string"></span>
<a name="18505"><font size=-1>18505     </font></a><span class="string">  * [[wfoptalg]] = 4: (see also [[wfoptalg]] = 14), a parallel code based on the Locally Optimal Block Preconditioned Conjugate Gradient (LOBPCG)</span>
<a name="18506"><font size=-1>18506     </font></a><span class="string">  method of [[cite:Knyazev2001 ]].</span>
<a name="18507"><font size=-1>18507     </font></a><span class="string">  The implementation rests on the [matlab program by Knyazev](http://www.mathworks.com/matlabcentral/fileexchange/48-lobpcg-m) [[cite:Knyazev2007]].</span>
<a name="18508"><font size=-1>18508     </font></a><span class="string">  For more information see [[cite:Bottin2008]]</span>
<a name="18509"><font size=-1>18509     </font></a><span class="string"></span>
<a name="18510"><font size=-1>18510     </font></a><span class="string">  * [[wfoptalg]] = 10: (for PAW) standard state-by-state conjugate gradient algorithm, with no possibility to parallelize over the states,</span>
<a name="18511"><font size=-1>18511     </font></a><span class="string">  but modified scheme described in [[cite:Kresse1996]] (modified kinetic energy, modified preconditionning, minimal orthogonalization, ...);</span>
<a name="18512"><font size=-1>18512     </font></a><span class="string"></span>
<a name="18513"><font size=-1>18513     </font></a><span class="string">  * [[wfoptalg]] = 14: the recommended for parallel code, the same as [[wfoptalg]] = 4 except that the preconditioning of the block vectors does not</span>
<a name="18514"><font size=-1>18514     </font></a><span class="string">  depend on the kinetic energy of each band, and the orthogonalization after the LOBPCG algorithm is no longer performed. The first modification increases the convergence and the second one the efficiency.</span>
<a name="18515"><font size=-1>18515     </font></a><span class="string"></span>
<a name="18516"><font size=-1>18516     </font></a><span class="string">  * [[wfoptalg]] = 114: A new version of [[wfoptalg]] = 14 which is more efficient for few blocks and can take advantage of OpenMP if abinit is compiled with a multithreaded linear algebra library.</span>
<a name="18517"><font size=-1>18517     </font></a><span class="string">  With more than 1 thread [[npfft]] shoud NOT be used for the time being.</span>
<a name="18518"><font size=-1>18518     </font></a><span class="string"></span>
<a name="18519"><font size=-1>18519     </font></a><span class="string">  * [[wfoptalg]] = 1: new algorithm based on Chebyshev filtering, designed for very large number of processors, in the regime</span>
<a name="18520"><font size=-1>18520     </font></a><span class="string">  where LOBPCG does not scale anymore. It is not able to use preconditionning and therefore might converge slower than other algorithms.</span>
<a name="18521"><font size=-1>18521     </font></a><span class="string">  By design, it will **not** converge the last bands: it is recommended to use slightly more bands than necessary.</span>
<a name="18522"><font size=-1>18522     </font></a><span class="string">  For usage with [[tolwfr]], it is imperative to use [[nbdbuf]]. For more performance, try [[use_gemm_nonlop]].</span>
<a name="18523"><font size=-1>18523     </font></a><span class="string">  For more information, see the [ performance guide ](../../theory/howto_chebfi.pdf) and the [[cite:Levitt2015]]. Status: experimental but usable.</span>
<a name="18524"><font size=-1>18524     </font></a><span class="string">  Questions and bug reports should be sent to antoine (dot) levitt (at) gmail.com.</span>
<a name="18525"><font size=-1>18525     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18526"><font size=-1>18526     </font></a><span class="default">),</span>
<a name="18527"><font size=-1>18527     </font></a><span class="default"></span>
<a name="18528"><font size=-1>18528     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18529"><font size=-1>18529     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wtatcon&quot;</span><span class="default">,</span>
<a name="18530"><font size=-1>18530     </font></a><span class="default">    varset=</span><span class="string">&quot;rlx&quot;</span><span class="default">,</span>
<a name="18531"><font size=-1>18531     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18532"><font size=-1>18532     </font></a><span class="default">    topics=[</span><span class="string">'GeoConstraints_useful'</span><span class="default">],</span>
<a name="18533"><font size=-1>18533     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[natcon]]'</span><span class="default">, </span><span class="string">'[[nconeq]]'</span><span class="default">],</span>
<a name="18534"><font size=-1>18534     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18535"><font size=-1>18535     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WeighTs for AToms in CONstraint equations&quot;</span><span class="default">,</span>
<a name="18536"><font size=-1>18536     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="18537"><font size=-1>18537     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="18538"><font size=-1>18538     </font></a><span class="string">Gives the weights determining how the motion of atoms is constrained during</span>
<a name="18539"><font size=-1>18539     </font></a><span class="string">structural optimization or molecular dynamics (see [[nconeq]], [[natcon]],</span>
<a name="18540"><font size=-1>18540     </font></a><span class="string">and [[iatcon]]). For each of the [[nconeq]] independent constraint equations,</span>
<a name="18541"><font size=-1>18541     </font></a><span class="string">wtatcon is a 3*[[natcon]] array giving weights, W  I, for the x, y, and z</span>
<a name="18542"><font size=-1>18542     </font></a><span class="string">components of each of the atoms (labeled by I) in the list of indices</span>
<a name="18543"><font size=-1>18543     </font></a><span class="string">[[iatcon]]. Prior to taking an atomic step, the calculated forces, F  I, are</span>
<a name="18544"><font size=-1>18544     </font></a><span class="string">replaced by projected forces, F'  I, which satisfy the set of constraint equations</span>
<a name="18545"><font size=-1>18545     </font></a><span class="string"></span>
<a name="18546"><font size=-1>18546     </font></a><span class="string">Sum  mu=x,y,z; I=1,natcon: W  mu,I  * F'  mu,I  = 0 for each of the [[nconeq]] arrays W  I.</span>
<a name="18547"><font size=-1>18547     </font></a><span class="string"></span>
<a name="18548"><font size=-1>18548     </font></a><span class="string">Different types of motion constraints can be implemented this way. For example,</span>
<a name="18549"><font size=-1>18549     </font></a><span class="string"></span>
<a name="18550"><font size=-1>18550     </font></a><span class="string">    nconeq 1 natcon 2 iatcon 1 2 wtatcon 0 0 +1 0 0 -1</span>
<a name="18551"><font size=-1>18551     </font></a><span class="string"></span>
<a name="18552"><font size=-1>18552     </font></a><span class="string">could be used to constrain the relative height difference of two adsorbate</span>
<a name="18553"><font size=-1>18553     </font></a><span class="string">atoms on a surface (assuming their masses are equal), since F'  z,1  - F'</span>
<a name="18554"><font size=-1>18554     </font></a><span class="string">z,2  = 0 implies z  1  - z  2  = constant.</span>
<a name="18555"><font size=-1>18555     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18556"><font size=-1>18556     </font></a><span class="default">),</span>
<a name="18557"><font size=-1>18557     </font></a><span class="default"></span>
<a name="18558"><font size=-1>18558     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18559"><font size=-1>18559     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wtk&quot;</span><span class="default">,</span>
<a name="18560"><font size=-1>18560     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="18561"><font size=-1>18561     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18562"><font size=-1>18562     </font></a><span class="default">    topics=[</span><span class="string">'k-points_useful'</span><span class="default">],</span>
<a name="18563"><font size=-1>18563     </font></a><span class="default">    dimensions=[</span><span class="string">'[[nkpt]]'</span><span class="default">],</span>
<a name="18564"><font size=-1>18564     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="string">'[[nkpt]]'</span><span class="default">, value=</span><span class="number">1.0</span><span class="default">),</span>
<a name="18565"><font size=-1>18565     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WeighTs for K points&quot;</span><span class="default">,</span>
<a name="18566"><font size=-1>18566     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Except when [[kptopt]]/=0&quot;</span><span class="default">,</span>
<a name="18567"><font size=-1>18567     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18568"><font size=-1>18568     </font></a><span class="string">Gives the k point weights.</span>
<a name="18569"><font size=-1>18569     </font></a><span class="string">The k point weights will have their sum (re)normalized to 1 (unless</span>
<a name="18570"><font size=-1>18570     </font></a><span class="string">[[occopt]] = 2 and [[kptopt]] = 0; see description of [[occopt]]) within the</span>
<a name="18571"><font size=-1>18571     </font></a><span class="string">program and therefore may be input with any arbitrary normalization. This</span>
<a name="18572"><font size=-1>18572     </font></a><span class="string">feature helps avoid the need for many digits in representing fractional weights such as 1/3.</span>
<a name="18573"><font size=-1>18573     </font></a><span class="string">[[wtk]] is ignored if [[iscf]] is not positive, except if [[iscf]] = -3.</span>
<a name="18574"><font size=-1>18574     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18575"><font size=-1>18575     </font></a><span class="default">),</span>
<a name="18576"><font size=-1>18576     </font></a><span class="default"></span>
<a name="18577"><font size=-1>18577     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18578"><font size=-1>18578     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wtq&quot;</span><span class="default">,</span>
<a name="18579"><font size=-1>18579     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18580"><font size=-1>18580     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18581"><font size=-1>18581     </font></a><span class="default">    topics=[</span><span class="string">'q-points_useful'</span><span class="default">],</span>
<a name="18582"><font size=-1>18582     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18583"><font size=-1>18583     </font></a><span class="default">    defaultval=</span><span class="number">1</span><span class="default">,</span>
<a name="18584"><font size=-1>18584     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WeighTs for the current Q-points&quot;</span><span class="default">,</span>
<a name="18585"><font size=-1>18585     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;Except when [[qptopt]]/=0&quot;</span><span class="default">,</span>
<a name="18586"><font size=-1>18586     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18587"><font size=-1>18587     </font></a><span class="string">Gives the current q-point weight.</span>
<a name="18588"><font size=-1>18588     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18589"><font size=-1>18589     </font></a><span class="default">),</span>
<a name="18590"><font size=-1>18590     </font></a><span class="default"></span>
<a name="18591"><font size=-1>18591     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18592"><font size=-1>18592     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wvl_bigdft_comp&quot;</span><span class="default">,</span>
<a name="18593"><font size=-1>18593     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18594"><font size=-1>18594     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18595"><font size=-1>18595     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_expert'</span><span class="default">],</span>
<a name="18596"><font size=-1>18596     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18597"><font size=-1>18597     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18598"><font size=-1>18598     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaVeLet BIGDFT Comparison&quot;</span><span class="default">,</span>
<a name="18599"><font size=-1>18599     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18600"><font size=-1>18600     </font></a><span class="string">This variable is used for the wavelets capabilities of ABINIT (see [[usewvl]]).</span>
<a name="18601"><font size=-1>18601     </font></a><span class="string">It is used to compare the results obtained with ABINIT with those obtained</span>
<a name="18602"><font size=-1>18602     </font></a><span class="string">with BigDFT stand-alone. When it is set to 1, ABINIT will follow the workflow</span>
<a name="18603"><font size=-1>18603     </font></a><span class="string">as in BigDFT stand-alone. Therefore, the results must be exactly the same with the two codes.</span>
<a name="18604"><font size=-1>18604     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18605"><font size=-1>18605     </font></a><span class="default">),</span>
<a name="18606"><font size=-1>18606     </font></a><span class="default"></span>
<a name="18607"><font size=-1>18607     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18608"><font size=-1>18608     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wvl_crmult&quot;</span><span class="default">,</span>
<a name="18609"><font size=-1>18609     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18610"><font size=-1>18610     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18611"><font size=-1>18611     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_basic'</span><span class="default">],</span>
<a name="18612"><font size=-1>18612     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18613"><font size=-1>18613     </font></a><span class="default">    defaultval=</span><span class="number">6.0</span><span class="default">,</span>
<a name="18614"><font size=-1>18614     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaVeLet Coarse grid Radius MULTiplier&quot;</span><span class="default">,</span>
<a name="18615"><font size=-1>18615     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18616"><font size=-1>18616     </font></a><span class="string">This factor is used to define the expansion of the coarse resolution grid in</span>
<a name="18617"><font size=-1>18617     </font></a><span class="string">the case of wavelets (see [[usewvl]]). The grid is made of points inside</span>
<a name="18618"><font size=-1>18618     </font></a><span class="string">spheres centered on atoms. The radius of these spheres are the product between</span>
<a name="18619"><font size=-1>18619     </font></a><span class="string">this factor and the covalent radius of element (read from the pseudo-potential file).</span>
<a name="18620"><font size=-1>18620     </font></a><span class="string">This factor is responsible for the amount of used memory (see also [[wvl_hgrid]]).</span>
<a name="18621"><font size=-1>18621     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18622"><font size=-1>18622     </font></a><span class="default">),</span>
<a name="18623"><font size=-1>18623     </font></a><span class="default"></span>
<a name="18624"><font size=-1>18624     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18625"><font size=-1>18625     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wvl_frmult&quot;</span><span class="default">,</span>
<a name="18626"><font size=-1>18626     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18627"><font size=-1>18627     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18628"><font size=-1>18628     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_basic'</span><span class="default">],</span>
<a name="18629"><font size=-1>18629     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18630"><font size=-1>18630     </font></a><span class="default">    defaultval=</span><span class="number">10.0</span><span class="default">,</span>
<a name="18631"><font size=-1>18631     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaVeLet Fine grid Radius MULTiplier&quot;</span><span class="default">,</span>
<a name="18632"><font size=-1>18632     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18633"><font size=-1>18633     </font></a><span class="string">This factor is used to define the expansion of the fine resolution grid in</span>
<a name="18634"><font size=-1>18634     </font></a><span class="string">the case of wavelets (see [[usewvl]]). This fine resolution grid has the same</span>
<a name="18635"><font size=-1>18635     </font></a><span class="string">grid step than the coarse one (see [[wvl_crmult]] ), but on each point, 8</span>
<a name="18636"><font size=-1>18636     </font></a><span class="string">coefficients are stored instead of one, increasing the precision of the</span>
<a name="18637"><font size=-1>18637     </font></a><span class="string">calculation in this area. The grid is made of points inside spheres centered</span>
<a name="18638"><font size=-1>18638     </font></a><span class="string">on atoms. The radius of these spheres are the product between this factor and</span>
<a name="18639"><font size=-1>18639     </font></a><span class="string">a value read from the pseudo-potential file.</span>
<a name="18640"><font size=-1>18640     </font></a><span class="string">This factor is responsible for the amount of used memory (see also [[wvl_hgrid]]).</span>
<a name="18641"><font size=-1>18641     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18642"><font size=-1>18642     </font></a><span class="default">),</span>
<a name="18643"><font size=-1>18643     </font></a><span class="default"></span>
<a name="18644"><font size=-1>18644     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18645"><font size=-1>18645     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wvl_hgrid&quot;</span><span class="default">,</span>
<a name="18646"><font size=-1>18646     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="18647"><font size=-1>18647     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18648"><font size=-1>18648     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_basic'</span><span class="default">],</span>
<a name="18649"><font size=-1>18649     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18650"><font size=-1>18650     </font></a><span class="default">    defaultval=</span><span class="number">0.5</span><span class="default">,</span>
<a name="18651"><font size=-1>18651     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaVeLet H step GRID&quot;</span><span class="default">,</span>
<a name="18652"><font size=-1>18652     </font></a><span class="default">    characteristics=[</span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="18653"><font size=-1>18653     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18654"><font size=-1>18654     </font></a><span class="string">It gives the step size in real space for the grid resolution in the wavelet</span>
<a name="18655"><font size=-1>18655     </font></a><span class="string">basis set. This value is highly responsible for the memory occupation in the</span>
<a name="18656"><font size=-1>18656     </font></a><span class="string">wavelet computation. The value is a length in atomic units.</span>
<a name="18657"><font size=-1>18657     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18658"><font size=-1>18658     </font></a><span class="default">),</span>
<a name="18659"><font size=-1>18659     </font></a><span class="default"></span>
<a name="18660"><font size=-1>18660     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18661"><font size=-1>18661     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wvl_ngauss&quot;</span><span class="default">,</span>
<a name="18662"><font size=-1>18662     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18663"><font size=-1>18663     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18664"><font size=-1>18664     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_expert'</span><span class="default">],</span>
<a name="18665"><font size=-1>18665     </font></a><span class="default">    dimensions=[</span><span class="number">2</span><span class="default">],</span>
<a name="18666"><font size=-1>18666     </font></a><span class="default">    defaultval=[</span><span class="number">1</span><span class="default">, </span><span class="number">100</span><span class="default">],</span>
<a name="18667"><font size=-1>18667     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaVeLet Number of GAUSSians&quot;</span><span class="default">,</span>
<a name="18668"><font size=-1>18668     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18669"><font size=-1>18669     </font></a><span class="string">In the wavelet-PAW computation case, projectors may be fitted to a sum of</span>
<a name="18670"><font size=-1>18670     </font></a><span class="string">complex Gaussians. The fit is done for [[wvl_ngauss]](1), [[wvl_ngauss]](1)+1... up</span>
<a name="18671"><font size=-1>18671     </font></a><span class="string">to [[wvl_ngauss]](2) Gaussians.</span>
<a name="18672"><font size=-1>18672     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18673"><font size=-1>18673     </font></a><span class="default">),</span>
<a name="18674"><font size=-1>18674     </font></a><span class="default"></span>
<a name="18675"><font size=-1>18675     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18676"><font size=-1>18676     </font></a><span class="default">    abivarname=</span><span class="string">&quot;wvl_nprccg&quot;</span><span class="default">,</span>
<a name="18677"><font size=-1>18677     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18678"><font size=-1>18678     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18679"><font size=-1>18679     </font></a><span class="default">    topics=[</span><span class="string">'Wavelets_expert'</span><span class="default">],</span>
<a name="18680"><font size=-1>18680     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18681"><font size=-1>18681     </font></a><span class="default">    defaultval=</span><span class="number">5</span><span class="default">,</span>
<a name="18682"><font size=-1>18682     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;WaVeLet maximum Number of PReConditionner Conjugate Gradient iterations&quot;</span><span class="default">,</span>
<a name="18683"><font size=-1>18683     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18684"><font size=-1>18684     </font></a><span class="string">In the wavelet computation case, the wavefunctions are directly minimised</span>
<a name="18685"><font size=-1>18685     </font></a><span class="string">using a real-space preconditionner. This preconditionner has internally some</span>
<a name="18686"><font size=-1>18686     </font></a><span class="string">conjugate gradient iterations. This value defines a boundary for the number of</span>
<a name="18687"><font size=-1>18687     </font></a><span class="string">conjugate gradient iterations on each wavefunction convergence step.</span>
<a name="18688"><font size=-1>18688     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18689"><font size=-1>18689     </font></a><span class="default">),</span>
<a name="18690"><font size=-1>18690     </font></a><span class="default"></span>
<a name="18691"><font size=-1>18691     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18692"><font size=-1>18692     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xangst&quot;</span><span class="default">,</span>
<a name="18693"><font size=-1>18693     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="18694"><font size=-1>18694     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18695"><font size=-1>18695     </font></a><span class="default">    topics=[</span><span class="string">'crystal_compulsory'</span><span class="default">],</span>
<a name="18696"><font size=-1>18696     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'min([[natom]],[[natrd]])'</span><span class="default">],</span>
<a name="18697"><font size=-1>18697     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vectors (X) of atom positions in cartesian coordinates -length in ANGSTrom-&quot;</span><span class="default">,</span>
<a name="18698"><font size=-1>18698     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="18699"><font size=-1>18699     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18700"><font size=-1>18700     </font></a><span class="string">Gives the cartesian coordinates of atoms within unit cell, in angstrom. This</span>
<a name="18701"><font size=-1>18701     </font></a><span class="string">information is redundant with that supplied by array [[xred]] or [[xcart]].</span>
<a name="18702"><font size=-1>18702     </font></a><span class="string">If [[xred]] and [[xangst]] are ABSENT from the input file and [[xcart]] is</span>
<a name="18703"><font size=-1>18703     </font></a><span class="string">provided, then the values of [[xred]] will be computed from the provided</span>
<a name="18704"><font size=-1>18704     </font></a><span class="string">[[xcart]] (i.e. the user may use xangst instead of [[xred]] or [[xcart]] to</span>
<a name="18705"><font size=-1>18705     </font></a><span class="string">provide starting coordinates).</span>
<a name="18706"><font size=-1>18706     </font></a><span class="string">One and only one of [[xred]], [[xcart]] and [[xangst]] must be provided.</span>
<a name="18707"><font size=-1>18707     </font></a><span class="string">The conversion factor between Bohr and Angstrom is 1 Bohr=0.5291772108</span>
<a name="18708"><font size=-1>18708     </font></a><span class="string">Angstrom, see the [NIST site](http://physics.nist.gov/cuu/Constants/index.html).</span>
<a name="18709"><font size=-1>18709     </font></a><span class="string">Atomic positions evolve if [[ionmov]]/=0. In constrast with [[xred]] and</span>
<a name="18710"><font size=-1>18710     </font></a><span class="string">[[xcart]], [[xangst]] is not internal.</span>
<a name="18711"><font size=-1>18711     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18712"><font size=-1>18712     </font></a><span class="default">),</span>
<a name="18713"><font size=-1>18713     </font></a><span class="default"></span>
<a name="18714"><font size=-1>18714     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18715"><font size=-1>18715     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xc_denpos&quot;</span><span class="default">,</span>
<a name="18716"><font size=-1>18716     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="18717"><font size=-1>18717     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18718"><font size=-1>18718     </font></a><span class="default">    topics=[</span><span class="string">'xc_expert'</span><span class="default">],</span>
<a name="18719"><font size=-1>18719     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18720"><font size=-1>18720     </font></a><span class="default">    defaultval=</span><span class="number">1e-14</span><span class="default">,</span>
<a name="18721"><font size=-1>18721     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;eXchange-Correlation - DENsity POSitivity value&quot;</span><span class="default">,</span>
<a name="18722"><font size=-1>18722     </font></a><span class="default">    characteristics=[</span><span class="string">'[[DEVELOP]]'</span><span class="default">],</span>
<a name="18723"><font size=-1>18723     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18724"><font size=-1>18724     </font></a><span class="string">For the evaluation of the exchange-correlation functionals, the density cannot</span>
<a name="18725"><font size=-1>18725     </font></a><span class="string">be negative, or even too small (e.g. the LDA exchange kernel behaves like the</span>
<a name="18726"><font size=-1>18726     </font></a><span class="string">density at power -(2/3), and the density is used at the denominator of</span>
<a name="18727"><font size=-1>18727     </font></a><span class="string">different factors in GGAs and metaGGAs. [[xc_denpos]] is the smallest value</span>
<a name="18728"><font size=-1>18728     </font></a><span class="string">that the density can assume at the time of the evaluation of a XC functional,</span>
<a name="18729"><font size=-1>18729     </font></a><span class="string">in ABINIT. When then computed density drops below [[xc_denpos]] before</span>
<a name="18730"><font size=-1>18730     </font></a><span class="string">attacking the evaluation of the XC functional, then it will be (only for that</span>
<a name="18731"><font size=-1>18731     </font></a><span class="string">purpose) replaced by [[xc_denpos]]. Note that the evaluation of the gradients</span>
<a name="18732"><font size=-1>18732     </font></a><span class="string">or other quantities that are density-dependent is performed before this replacement.</span>
<a name="18733"><font size=-1>18733     </font></a><span class="string"></span>
<a name="18734"><font size=-1>18734     </font></a><span class="string">It has been observed that the SCF cycle of the Tran-Blaha mGGA can be quite</span>
<a name="18735"><font size=-1>18735     </font></a><span class="string">hard to make converge, for systems for which there is some vacuum. In this</span>
<a name="18736"><font size=-1>18736     </font></a><span class="string">case, setting [[xc_denpos]] to 1.0e-7 ... 1.0e-6 has been seen to allow good</span>
<a name="18737"><font size=-1>18737     </font></a><span class="string">convergence. Of course, this will affect the numerical results somehow, and</span>
<a name="18738"><font size=-1>18738     </font></a><span class="string">one should play a bit with this value to avoid incorrect calculations.</span>
<a name="18739"><font size=-1>18739     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18740"><font size=-1>18740     </font></a><span class="default">),</span>
<a name="18741"><font size=-1>18741     </font></a><span class="default"></span>
<a name="18742"><font size=-1>18742     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18743"><font size=-1>18743     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xc_tb09_c&quot;</span><span class="default">,</span>
<a name="18744"><font size=-1>18744     </font></a><span class="default">    varset=</span><span class="string">&quot;dev&quot;</span><span class="default">,</span>
<a name="18745"><font size=-1>18745     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18746"><font size=-1>18746     </font></a><span class="default">    topics=[</span><span class="string">'xc_expert'</span><span class="default">],</span>
<a name="18747"><font size=-1>18747     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18748"><font size=-1>18748     </font></a><span class="default">    defaultval=</span><span class="number">99.99</span><span class="default">,</span>
<a name="18749"><font size=-1>18749     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Value of the c parameter in the eXchange-Correlation TB09 functional&quot;</span><span class="default">,</span>
<a name="18750"><font size=-1>18750     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="18751"><font size=-1>18751     </font></a><span class="string">The modified Becke-Johnson exchange-correlation functional by</span>
<a name="18752"><font size=-1>18752     </font></a><span class="string">[[cite:Tran2009 | Tran and Blaha]] reads:</span>
<a name="18753"><font size=-1>18753     </font></a><span class="string"></span>
<a name="18754"><font size=-1>18754     </font></a><span class="string">$$ V_x(r) =</span>
<a name="18755"><font size=-1>18755     </font></a><span class="string">c V_x^{BR}(r) +</span>
<a name="18756"><font size=-1>18756     </font></a><span class="string">(3c - 2) \frac{1}{\pi} \sqrt{\frac{5}{12}}</span>
<a name="18757"><font size=-1>18757     </font></a><span class="string">\sqrt{2 \frac{t(r)}{\rho(r)}} $$</span>
<a name="18758"><font size=-1>18758     </font></a><span class="string"></span>
<a name="18759"><font size=-1>18759     </font></a><span class="string">where $\rho(r)$ is the electron density,</span>
<a name="18760"><font size=-1>18760     </font></a><span class="string">$t(r)$ is the kinetic-energy density, and</span>
<a name="18761"><font size=-1>18761     </font></a><span class="string">$ V_x^{BR}(r)$ is the Becke-Roussel potential.</span>
<a name="18762"><font size=-1>18762     </font></a><span class="string"></span>
<a name="18763"><font size=-1>18763     </font></a><span class="string">In this equation the parameter $c$ can be evaluated at each SCF step according</span>
<a name="18764"><font size=-1>18764     </font></a><span class="string">to the following equation:</span>
<a name="18765"><font size=-1>18765     </font></a><span class="string"></span>
<a name="18766"><font size=-1>18766     </font></a><span class="string">$$ c = \alpha + \beta</span>
<a name="18767"><font size=-1>18767     </font></a><span class="string">\left( \frac{1}{V_{cell}}</span>
<a name="18768"><font size=-1>18768     </font></a><span class="string">\int_{V_{cell}} \frac{|\nabla \rho(r)|}{\rho(r)}</span>
<a name="18769"><font size=-1>18769     </font></a><span class="string">d^3r \right)^{1/2} $$</span>
<a name="18770"><font size=-1>18770     </font></a><span class="string"></span>
<a name="18771"><font size=-1>18771     </font></a><span class="string">The $c$ parameter is evaluated thanks to the previous equation when xc_tb09_c is</span>
<a name="18772"><font size=-1>18772     </font></a><span class="string">equal to the &quot;magic&quot; default value 99.99. The $c$ parameter can also be fixed to</span>
<a name="18773"><font size=-1>18773     </font></a><span class="string">some (property-optimized or material-optimized) value by using this variable.</span>
<a name="18774"><font size=-1>18774     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18775"><font size=-1>18775     </font></a><span class="default">),</span>
<a name="18776"><font size=-1>18776     </font></a><span class="default"></span>
<a name="18777"><font size=-1>18777     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18778"><font size=-1>18778     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xcart&quot;</span><span class="default">,</span>
<a name="18779"><font size=-1>18779     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="18780"><font size=-1>18780     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18781"><font size=-1>18781     </font></a><span class="default">    topics=[</span><span class="string">'crystal_compulsory'</span><span class="default">],</span>
<a name="18782"><font size=-1>18782     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'min([[natom]],[[natrd]])'</span><span class="default">],</span>
<a name="18783"><font size=-1>18783     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vectors (X) of atom positions in CARTesian coordinates&quot;</span><span class="default">,</span>
<a name="18784"><font size=-1>18784     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">, </span><span class="string">'[[LENGTH]]'</span><span class="default">],</span>
<a name="18785"><font size=-1>18785     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18786"><font size=-1>18786     </font></a><span class="string">Gives the cartesian coordinates of atoms within unit cell. This information is</span>
<a name="18787"><font size=-1>18787     </font></a><span class="string">redundant with that supplied by array [[xred]] or [[xangst]]. By default,</span>
<a name="18788"><font size=-1>18788     </font></a><span class="string">[[xcart]] is given in Bohr atomic units (1 Bohr=0.5291772108 Angstroms),</span>
<a name="18789"><font size=-1>18789     </font></a><span class="string">although Angstrom can be specified, if preferred, since [[xcart]] has the</span>
<a name="18790"><font size=-1>18790     </font></a><span class="string">'[[LENGTH]]' characteristics.</span>
<a name="18791"><font size=-1>18791     </font></a><span class="string">If [[xred]] and [[xangst]] are ABSENT from the input file and [[xcart]] is</span>
<a name="18792"><font size=-1>18792     </font></a><span class="string">provided, then the values of [[xred]] will be computed from the provided</span>
<a name="18793"><font size=-1>18793     </font></a><span class="string">[[xcart]] (i.e. the user may use [[xcart]] instead of [[xred]] or [[xangst]]</span>
<a name="18794"><font size=-1>18794     </font></a><span class="string">to provide starting coordinates).</span>
<a name="18795"><font size=-1>18795     </font></a><span class="string">One and only one of [[xred]], [[xcart]] and **xangst** must be provided.</span>
<a name="18796"><font size=-1>18796     </font></a><span class="string">Atomic positions evolve if [[ionmov]]/=0.</span>
<a name="18797"><font size=-1>18797     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18798"><font size=-1>18798     </font></a><span class="default">),</span>
<a name="18799"><font size=-1>18799     </font></a><span class="default"></span>
<a name="18800"><font size=-1>18800     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18801"><font size=-1>18801     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xclevel&quot;</span><span class="default">,</span>
<a name="18802"><font size=-1>18802     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="18803"><font size=-1>18803     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18804"><font size=-1>18804     </font></a><span class="default">    topics=[</span><span class="string">'xc_internal'</span><span class="default">, </span><span class="string">'TDDFT_useful'</span><span class="default">],</span>
<a name="18805"><font size=-1>18805     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18806"><font size=-1>18806     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18807"><font size=-1>18807     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;eXchange Correlation functional LEVEL&quot;</span><span class="default">,</span>
<a name="18808"><font size=-1>18808     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="18809"><font size=-1>18809     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18810"><font size=-1>18810     </font></a><span class="string">Automatically determined from the value of [[ixc]].</span>
<a name="18811"><font size=-1>18811     </font></a><span class="string"></span>
<a name="18812"><font size=-1>18812     </font></a><span class="string">  * 0  --&gt;  No XC contribution.</span>
<a name="18813"><font size=-1>18813     </font></a><span class="string">  * 1  --&gt;  LDA functional.</span>
<a name="18814"><font size=-1>18814     </font></a><span class="string">  * 2  --&gt;  GGA functional or hybrid functional based on GGA.</span>
<a name="18815"><font size=-1>18815     </font></a><span class="string">  * 3  --&gt;  Functional for TDDFT.</span>
<a name="18816"><font size=-1>18816     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18817"><font size=-1>18817     </font></a><span class="default">),</span>
<a name="18818"><font size=-1>18818     </font></a><span class="default"></span>
<a name="18819"><font size=-1>18819     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18820"><font size=-1>18820     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xred&quot;</span><span class="default">,</span>
<a name="18821"><font size=-1>18821     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="18822"><font size=-1>18822     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18823"><font size=-1>18823     </font></a><span class="default">    topics=[</span><span class="string">'crystal_compulsory'</span><span class="default">],</span>
<a name="18824"><font size=-1>18824     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'min([[natom]],[[natrd]])'</span><span class="default">],</span>
<a name="18825"><font size=-1>18825     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="18826"><font size=-1>18826     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;vectors (X) of atom positions in REDuced coordinates&quot;</span><span class="default">,</span>
<a name="18827"><font size=-1>18827     </font></a><span class="default">    characteristics=[</span><span class="string">'[[EVOLVING]]'</span><span class="default">],</span>
<a name="18828"><font size=-1>18828     </font></a><span class="default">    commentdims=</span><span class="string">&quot;represented internally as xred(3,[[natom]],[[nimage]])&quot;</span><span class="default">,</span>
<a name="18829"><font size=-1>18829     </font></a><span class="default">    text=</span><span class="string">r&quot;&quot;&quot;</span>
<a name="18830"><font size=-1>18830     </font></a><span class="string">Gives the atomic locations within unit cell in coordinates relative to real</span>
<a name="18831"><font size=-1>18831     </font></a><span class="string">space primitive translations (NOT in cartesian coordinates). Thus these are</span>
<a name="18832"><font size=-1>18832     </font></a><span class="string">fractional numbers typically between 0 and 1 and are dimensionless. The</span>
<a name="18833"><font size=-1>18833     </font></a><span class="string">cartesian coordinates of atoms (in Bohr) are given by:</span>
<a name="18834"><font size=-1>18834     </font></a><span class="string">R_cartesian = xred1*rprimd1+xred2*rprimd2+xred3*rprimd3</span>
<a name="18835"><font size=-1>18835     </font></a><span class="string">where (xred1,xred2,xred3) are the &quot;reduced coordinates&quot; given in columns of</span>
<a name="18836"><font size=-1>18836     </font></a><span class="string">&quot;[[xred]]&quot;, (rprimd1,rprimd2,rprimd3) are the columns of primitive vectors</span>
<a name="18837"><font size=-1>18837     </font></a><span class="string">array &quot;[[rprimd]]&quot; in Bohr.</span>
<a name="18838"><font size=-1>18838     </font></a><span class="string"></span>
<a name="18839"><font size=-1>18839     </font></a><span class="string">If you prefer to work only with cartesian coordinates, you may work entirely</span>
<a name="18840"><font size=-1>18840     </font></a><span class="string">with &quot;[[xcart]]&quot; or &quot;[[xangst]]&quot; and ignore [[xred]], in which case [[xred]]</span>
<a name="18841"><font size=-1>18841     </font></a><span class="string">must be absent from the input file.</span>
<a name="18842"><font size=-1>18842     </font></a><span class="string">One and only one of [[xred]], [[xcart]] and [[xangst]] must be provided.</span>
<a name="18843"><font size=-1>18843     </font></a><span class="string">Atomic positions evolve if [[ionmov]]/=0.</span>
<a name="18844"><font size=-1>18844     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18845"><font size=-1>18845     </font></a><span class="default">),</span>
<a name="18846"><font size=-1>18846     </font></a><span class="default"></span>
<a name="18847"><font size=-1>18847     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18848"><font size=-1>18848     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xredsph_extra&quot;</span><span class="default">,</span>
<a name="18849"><font size=-1>18849     </font></a><span class="default">    varset=</span><span class="string">&quot;gstate&quot;</span><span class="default">,</span>
<a name="18850"><font size=-1>18850     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18851"><font size=-1>18851     </font></a><span class="default">    topics=[</span><span class="string">'printing_prdos'</span><span class="default">],</span>
<a name="18852"><font size=-1>18852     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">, </span><span class="string">'[[natsph_extra]]'</span><span class="default">],</span>
<a name="18853"><font size=-1>18853     </font></a><span class="default">    defaultval=<a href="dictionary_A.html#6402">MultipleValue</a>(number=</span><span class="keyword">None</span><span class="default">, value=</span><span class="number">0.0</span><span class="default">),</span>
<a name="18854"><font size=-1>18854     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;X(position) in REDuced coordinates of the SPHeres for dos projection in the EXTRA set&quot;</span><span class="default">,</span>
<a name="18855"><font size=-1>18855     </font></a><span class="default">    requires=</span><span class="string">&quot;[[natsph_extra]] &gt; 0&quot;</span><span class="default">,</span>
<a name="18856"><font size=-1>18856     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18857"><font size=-1>18857     </font></a><span class="string">The positions in reduced coordinates of extra spheres used in the DOS</span>
<a name="18858"><font size=-1>18858     </font></a><span class="string">projection, simulating an STS signal. See [[natsph_extra]] for a more complete description.</span>
<a name="18859"><font size=-1>18859     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18860"><font size=-1>18860     </font></a><span class="default">),</span>
<a name="18861"><font size=-1>18861     </font></a><span class="default"></span>
<a name="18862"><font size=-1>18862     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18863"><font size=-1>18863     </font></a><span class="default">    abivarname=</span><span class="string">&quot;xyzfile&quot;</span><span class="default">,</span>
<a name="18864"><font size=-1>18864     </font></a><span class="default">    varset=</span><span class="string">&quot;geo&quot;</span><span class="default">,</span>
<a name="18865"><font size=-1>18865     </font></a><span class="default">    vartype=</span><span class="string">&quot;string&quot;</span><span class="default">,</span>
<a name="18866"><font size=-1>18866     </font></a><span class="default">    topics=[</span><span class="string">'crystal_useful'</span><span class="default">],</span>
<a name="18867"><font size=-1>18867     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18868"><font size=-1>18868     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;XYZ FILE input for geometry&quot;</span><span class="default">,</span>
<a name="18869"><font size=-1>18869     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INPUT_ONLY]]'</span><span class="default">],</span>
<a name="18870"><font size=-1>18870     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18871"><font size=-1>18871     </font></a><span class="string">Gives the name of a xyz format file, to take [[natom]], [[ntypat]], [[typat]],</span>
<a name="18872"><font size=-1>18872     </font></a><span class="string">[[znucl]], and [[xangst]] from. This input can not be mixed with normal atom</span>
<a name="18873"><font size=-1>18873     </font></a><span class="string">specifications for other datasets.</span>
<a name="18874"><font size=-1>18874     </font></a><span class="string"></span>
<a name="18875"><font size=-1>18875     </font></a><span class="string">Notes: do not quote the file name in the abinit input file, simply leave a</span>
<a name="18876"><font size=-1>18876     </font></a><span class="string">space after xyzfile. The xyz format is the number of atoms on the first line,</span>
<a name="18877"><font size=-1>18877     </font></a><span class="string">a comment line, then one line per atom, with the element as a 2 letter symbol</span>
<a name="18878"><font size=-1>18878     </font></a><span class="string">(&quot;As&quot; &quot;O&quot; or &quot;Pu&quot;) and the three cartesian coordinates in Angstrom.</span>
<a name="18879"><font size=-1>18879     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18880"><font size=-1>18880     </font></a><span class="default">),</span>
<a name="18881"><font size=-1>18881     </font></a><span class="default"></span>
<a name="18882"><font size=-1>18882     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18883"><font size=-1>18883     </font></a><span class="default">    abivarname=</span><span class="string">&quot;zcut&quot;</span><span class="default">,</span>
<a name="18884"><font size=-1>18884     </font></a><span class="default">    varset=</span><span class="string">&quot;gw&quot;</span><span class="default">,</span>
<a name="18885"><font size=-1>18885     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18886"><font size=-1>18886     </font></a><span class="default">    topics=[</span><span class="string">'Susceptibility_expert'</span><span class="default">, </span><span class="string">'BSE_expert'</span><span class="default">, </span><span class="string">'SelfEnergy_expert'</span><span class="default">],</span>
<a name="18887"><font size=-1>18887     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18888"><font size=-1>18888     </font></a><span class="default">    defaultval=</span><span class="number">0.0036749326</span><span class="default">,</span>
<a name="18889"><font size=-1>18889     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Z-CUT&quot;</span><span class="default">,</span>
<a name="18890"><font size=-1>18890     </font></a><span class="default">    characteristics=[</span><span class="string">'[[ENERGY]]'</span><span class="default">],</span>
<a name="18891"><font size=-1>18891     </font></a><span class="default">    commentdefault=</span><span class="string">&quot;0.0036749326 Ha = 0.1 eV&quot;</span><span class="default">,</span>
<a name="18892"><font size=-1>18892     </font></a><span class="default">    requires=</span><span class="string">&quot;[[optdriver]] in [3,4,99]&quot;</span><span class="default">,</span>
<a name="18893"><font size=-1>18893     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18894"><font size=-1>18894     </font></a><span class="string">It is meant to avoid some divergences that might occur during the evaluation</span>
<a name="18895"><font size=-1>18895     </font></a><span class="string">of the Adler-Wiser expression of the irreducible polarizability</span>
<a name="18896"><font size=-1>18896     </font></a><span class="string">([[optdriver]] = 3) or during the numerical treatment of the integrals defining</span>
<a name="18897"><font size=-1>18897     </font></a><span class="string">the contribution to the self-energy matrix elements ([[optdriver]] = 4). If the</span>
<a name="18898"><font size=-1>18898     </font></a><span class="string">denominator becomes smaller than [[zcut]], a small imaginary part (depending</span>
<a name="18899"><font size=-1>18899     </font></a><span class="string">on [[zcut]]) is added, in order to avoid the divergence.</span>
<a name="18900"><font size=-1>18900     </font></a><span class="string"></span>
<a name="18901"><font size=-1>18901     </font></a><span class="string">When [[optdriver]] = 99, [[zcut]] defines the small complex shift used to avoid</span>
<a name="18902"><font size=-1>18902     </font></a><span class="string">divergences in the expression for the macroscopic dielectric function. It</span>
<a name="18903"><font size=-1>18903     </font></a><span class="string">simulates the experimental uncertainty and the finite lifetime of the</span>
<a name="18904"><font size=-1>18904     </font></a><span class="string">quasiparticles (although the true lifetime should be k- and band-dependent).</span>
<a name="18905"><font size=-1>18905     </font></a><span class="string">The value of [[zcut]] affects the number of iteration needed to achieve</span>
<a name="18906"><font size=-1>18906     </font></a><span class="string">convergence in the Haydock iterative method. In this case, [[zcut]] should be</span>
<a name="18907"><font size=-1>18907     </font></a><span class="string">larger than the typical distance between the eigenvalues of the exciton</span>
<a name="18908"><font size=-1>18908     </font></a><span class="string">Hamiltonian.</span>
<a name="18909"><font size=-1>18909     </font></a><span class="string">Ideally, one should make a convergence study decreasing the value of [[zcut]]</span>
<a name="18910"><font size=-1>18910     </font></a><span class="string">for increasing number of k points.</span>
<a name="18911"><font size=-1>18911     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18912"><font size=-1>18912     </font></a><span class="default">),</span>
<a name="18913"><font size=-1>18913     </font></a><span class="default"></span>
<a name="18914"><font size=-1>18914     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18915"><font size=-1>18915     </font></a><span class="default">    abivarname=</span><span class="string">&quot;zeemanfield&quot;</span><span class="default">,</span>
<a name="18916"><font size=-1>18916     </font></a><span class="default">    varset=</span><span class="string">&quot;ffield&quot;</span><span class="default">,</span>
<a name="18917"><font size=-1>18917     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18918"><font size=-1>18918     </font></a><span class="default">    topics=[</span><span class="string">'MagField_basic'</span><span class="default">],</span>
<a name="18919"><font size=-1>18919     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="18920"><font size=-1>18920     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18921"><font size=-1>18921     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;ZEEMAN FIELD&quot;</span><span class="default">,</span>
<a name="18922"><font size=-1>18922     </font></a><span class="default">    characteristics=[</span><span class="string">'[[MAGNETIC_FIELD]]'</span><span class="default">],</span>
<a name="18923"><font size=-1>18923     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18924"><font size=-1>18924     </font></a><span class="string">Give the value of the Zeeman field, $H$, acting on the spinorial wavefunctions.</span>
<a name="18925"><font size=-1>18925     </font></a><span class="string">Note that Tesla are admitted. This sets the magnitude of $\mu_0H$, in Tesla,</span>
<a name="18926"><font size=-1>18926     </font></a><span class="string">with H in Amperes/metre.</span>
<a name="18927"><font size=-1>18927     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18928"><font size=-1>18928     </font></a><span class="default">),</span>
<a name="18929"><font size=-1>18929     </font></a><span class="default"></span>
<a name="18930"><font size=-1>18930     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18931"><font size=-1>18931     </font></a><span class="default">    abivarname=</span><span class="string">&quot;ziontypat&quot;</span><span class="default">,</span>
<a name="18932"><font size=-1>18932     </font></a><span class="default">    varset=</span><span class="string">&quot;internal&quot;</span><span class="default">,</span>
<a name="18933"><font size=-1>18933     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18934"><font size=-1>18934     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_internal'</span><span class="default">, </span><span class="string">'PseudosPAW_internal'</span><span class="default">],</span>
<a name="18935"><font size=-1>18935     </font></a><span class="default">    dimensions=[</span><span class="string">'[[ntypat]]'</span><span class="default">],</span>
<a name="18936"><font size=-1>18936     </font></a><span class="default">    defaultval=</span><span class="string">&quot;[[AUTO_FROM_PSP]]&quot;</span><span class="default">,</span>
<a name="18937"><font size=-1>18937     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Z (charge) of the IONs for the different TYPes of AToms&quot;</span><span class="default">,</span>
<a name="18938"><font size=-1>18938     </font></a><span class="default">    characteristics=[</span><span class="string">'[[INTERNAL_ONLY]]'</span><span class="default">],</span>
<a name="18939"><font size=-1>18939     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18940"><font size=-1>18940     </font></a><span class="string">Charge of the pseudo-ion (=number of valence electrons that are needed to</span>
<a name="18941"><font size=-1>18941     </font></a><span class="string">screen exactly the pseudopotential).</span>
<a name="18942"><font size=-1>18942     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18943"><font size=-1>18943     </font></a><span class="default">),</span>
<a name="18944"><font size=-1>18944     </font></a><span class="default"></span>
<a name="18945"><font size=-1>18945     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18946"><font size=-1>18946     </font></a><span class="default">    abivarname=</span><span class="string">&quot;znucl&quot;</span><span class="default">,</span>
<a name="18947"><font size=-1>18947     </font></a><span class="default">    varset=</span><span class="string">&quot;basic&quot;</span><span class="default">,</span>
<a name="18948"><font size=-1>18948     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18949"><font size=-1>18949     </font></a><span class="default">    topics=[</span><span class="string">'AtomTypes_compulsory'</span><span class="default">, </span><span class="string">'PseudosPAW_compulsory'</span><span class="default">],</span>
<a name="18950"><font size=-1>18950     </font></a><span class="default">    dimensions=[</span><span class="string">'[[npsp]]'</span><span class="default">],</span>
<a name="18951"><font size=-1>18951     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;charge -Z- of the NUCLeus&quot;</span><span class="default">,</span>
<a name="18952"><font size=-1>18952     </font></a><span class="default">    characteristics=[</span><span class="string">'[[NO_MULTI]]'</span><span class="default">],</span>
<a name="18953"><font size=-1>18953     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18954"><font size=-1>18954     </font></a><span class="string">Gives nuclear charge for each type of pseudopotential, in order.</span>
<a name="18955"><font size=-1>18955     </font></a><span class="string">If [[znucl]] does not agree with nuclear charge, as given in pseudopotential</span>
<a name="18956"><font size=-1>18956     </font></a><span class="string">files, the program writes an error message and stops.</span>
<a name="18957"><font size=-1>18957     </font></a><span class="string"></span>
<a name="18958"><font size=-1>18958     </font></a><span class="string">!!! note</span>
<a name="18959"><font size=-1>18959     </font></a><span class="string">    In the pseudopotential files, [[znucl]] is called &quot;zatom&quot;.</span>
<a name="18960"><font size=-1>18960     </font></a><span class="string"></span>
<a name="18961"><font size=-1>18961     </font></a><span class="string">For a &quot;dummy&quot; atom, with [[znucl]] = 0, as used in the case of calculations</span>
<a name="18962"><font size=-1>18962     </font></a><span class="string">with only a jellium surface, ABINIT sets arbitrarily the covalent radius to one.</span>
<a name="18963"><font size=-1>18963     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18964"><font size=-1>18964     </font></a><span class="default">),</span>
<a name="18965"><font size=-1>18965     </font></a><span class="default"></span><span class="comment">#{&quot;abinit_version&quot;: &quot;8.7.3&quot;},</span>
<a name="18966"><font size=-1>18966     </font></a><span class="comment"><a href="dictionary_A.html#9338">Variable</a></span><span class="default">(</span>
<a name="18967"><font size=-1>18967     </font></a><span class="default">    abivarname=</span><span class="string">&quot;tmesh&quot;</span><span class="default">,</span>
<a name="18968"><font size=-1>18968     </font></a><span class="default">    varset=</span><span class="string">&quot;eph&quot;</span><span class="default">,</span>
<a name="18969"><font size=-1>18969     </font></a><span class="default">    topics=[</span><span class="string">'ElPhonInt_basic'</span><span class="default">],</span>
<a name="18970"><font size=-1>18970     </font></a><span class="default">    vartype=</span><span class="string">&quot;real&quot;</span><span class="default">,</span>
<a name="18971"><font size=-1>18971     </font></a><span class="default">    defaultval=[</span><span class="number">5.0</span><span class="default">, </span><span class="number">59.0</span><span class="default">, </span><span class="number">6.0</span><span class="default">],</span>
<a name="18972"><font size=-1>18972     </font></a><span class="default">    dimensions=[</span><span class="number">3</span><span class="default">],</span>
<a name="18973"><font size=-1>18973     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;Temperature MESH&quot;</span><span class="default">,</span>
<a name="18974"><font size=-1>18974     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18975"><font size=-1>18975     </font></a><span class="string">This variable defines the linear mesh of temperatures used in the EPH code ([[optdriver]] = 7).</span>
<a name="18976"><font size=-1>18976     </font></a><span class="string">The first entry gives the initial temperature in Kelvin, the second entry the linear step in Kelvin,</span>
<a name="18977"><font size=-1>18977     </font></a><span class="string">the third entry is the number of points in the mesh. The default value corresponds to 6 points between 5 K and 300 K.</span>
<a name="18978"><font size=-1>18978     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="18979"><font size=-1>18979     </font></a><span class="default">),</span>
<a name="18980"><font size=-1>18980     </font></a><span class="default"></span>
<a name="18981"><font size=-1>18981     </font></a><span class="default"><a href="dictionary_A.html#9338">Variable</a>(</span>
<a name="18982"><font size=-1>18982     </font></a><span class="default">    abivarname=</span><span class="string">&quot;prtkbff&quot;</span><span class="default">,</span>
<a name="18983"><font size=-1>18983     </font></a><span class="default">    varset=</span><span class="string">&quot;files&quot;</span><span class="default">,</span>
<a name="18984"><font size=-1>18984     </font></a><span class="default">    topics=[</span><span class="string">'printing_prden'</span><span class="default">],</span>
<a name="18985"><font size=-1>18985     </font></a><span class="default">    vartype=</span><span class="string">&quot;integer&quot;</span><span class="default">,</span>
<a name="18986"><font size=-1>18986     </font></a><span class="default">    defaultval=</span><span class="number">0</span><span class="default">,</span>
<a name="18987"><font size=-1>18987     </font></a><span class="default">    dimensions=</span><span class="string">&quot;scalar&quot;</span><span class="default">,</span>
<a name="18988"><font size=-1>18988     </font></a><span class="default">    requires=</span><span class="string">&quot;[[iomode]] == 3&quot;</span><span class="default">,</span>
<a name="18989"><font size=-1>18989     </font></a><span class="default">    mnemonics=</span><span class="string">&quot;PRinT Kleynman-Bylander Form Factors&quot;</span><span class="default">,</span>
<a name="18990"><font size=-1>18990     </font></a><span class="default">    text=</span><span class="string">&quot;&quot;&quot;</span>
<a name="18991"><font size=-1>18991     </font></a><span class="string">This input variable activates the output of the Kleynman-Bylander form factors in the **netcdf** WFK file</span>
<a name="18992"><font size=-1>18992     </font></a><span class="string">produced at the end of the ground-state calculation. Remember to set [[iomode]] to 3.</span>
<a name="18993"><font size=-1>18993     </font></a><span class="string"></span>
<a name="18994"><font size=-1>18994     </font></a><span class="string">The form factors are needed to compute the matrix elements of the commutator [Vnl, r]</span>
<a name="18995"><font size=-1>18995     </font></a><span class="string">of the non-local part of the (NC) pseudopotentials.</span>
<a name="18996"><font size=-1>18996     </font></a><span class="string">This WFK file can therefore be used to perform optical and/or many-body calculations with external codes such as DP/EXC and Yambo.</span>
<a name="18997"><font size=-1>18997     </font></a><span class="string">The option is ignored if PAW.</span>
<a name="18998"><font size=-1>18998     </font></a><span class="string"></span>
<a name="18999"><font size=-1>18999     </font></a><span class="string">!!! important</span>
<a name="19000"><font size=-1>19000     </font></a><span class="string"></span>
<a name="19001"><font size=-1>19001     </font></a><span class="string">    At the time of writing (|today|, [[istwfk]] must be set to 1 for all k-points in the IBZ</span>
<a name="19002"><font size=-1>19002     </font></a><span class="string">    since external codes do not support wavefunctions given on the reduced G-sphere.</span>
<a name="19003"><font size=-1>19003     </font></a><span class="string">    Moreover [[useylm]] must be 0 (default if NC pseudos).</span>
<a name="19004"><font size=-1>19004     </font></a><span class="string">&quot;&quot;&quot;</span><span class="default">,</span>
<a name="19005"><font size=-1>19005     </font></a><span class="default">),</span>
<a name="19006"><font size=-1>19006     </font></a><span class="default"></span>
<a name="19007"><font size=-1>19007     </font></a><span class="default">]</span>
<a name="19008"><font size=-1>19008     </font></a><span class="default"></span>
<a name="19009"><font size=-1>19009     </font></a><span class="default"></span>
</pre></body></html>
